[2021-03-01 15:30:11,333] config.py->setup_cfg_with_hparams line:84 [INFO]Running with full config:
DEFAULT_CUDNN_BENCHMARK: True
SEED: 3278
VERSION: 1
abtfs:
    blur:
        blur_limit: 3
        enable: 0
    bright:
        clip_limit: 1
        enable: 1
    channel_dropout:
        drop_range: (1, 1)
        enable: 0
        fill_value: 127
    channel_shuffle:
        enable: 0
    cutout:
        enable: 1
        fill_value: 127
        num_holes: 10
        size: 20
    distortion:
        enable: 0
    hue:
        enable: 0
    noise:
        enable: 1
    random_grid_shuffle:
        enable: 0
        grid: 2
    rotate:
        enable: 1
        p: 1
        rotate_limit: 45
        scale_limit: 0.2
        shift_limit: 0.0625
cam:
    debug: False
    featmaps_module_name: 'glob_avgpool'
    label: -1
    model_path: ''
    save_path: './cam_results'
    scan_path: ''
    weights_module_name: 'fc'
dataloader:
    num_workers: 40
    sample_test: 'default'
    sample_train: 'default'
    sampler:
        replacement: True
        weights_cls: [0, 0.23, 0.77]
dataset:
    batch_size: 9
    dir: '/home/datasets/COVID-19_CTs/CCCCI_cleaned/dataset_cleaned'
    is_3d: True
    is_color: False
    is_train: False
    name: 'CTDataset'
    slice_num: 64
    subset_train: 1.0
    subset_valid: 1.0
    test_list: '/home/datasets/COVID-19_CTs/ccccii/ct_test.json'
    train_list: '/home/datasets/COVID-19_CTs/ccccii/ct_train.json'
    valid_list: '/home/datasets/COVID-19_CTs/ccccii/ct_test.json'
hooks:
    early_stopping:
        min_delta: 0.0
        mode: 'max'
        monitor: 'valid_acc_1'
        patience: 20
        setting: 2
        verbose: 1
    model_checkpoint:
        filepath: ''
        mode: 'max'
        monitor: 'valid_acc_1'
        period: 1
        prefix: ''
        save_top_k: 1
        save_weights_only: False
        setting: 2
        verbose: 1
hparams: Namespace(cam_only=False, config_file='./config/ccccii_config.yml', opts=['trainer.gpus', '[1]', 'model.name', 'mc3_18', 'dataset.slice_num', '64', 'dataset.batch_size', '9', 'trainer.logger.test_tube.name', 'ccccii_mc3_18_bs9_s64'], predict_only=False, test_only=False)
input:
    size: (128, 128)
label_transforms:
    name: 'default'
log:
    name: './output/ccccii_mc3_18_bs9_s64/version_0/log.txt'
    path: './output/ccccii_mc3_18_bs9_s64/version_0'
loss:
    class_weight: []
    focal_loss:
        alpha: []
        gamma: 2
        size_average: True
    label_smoothing: 0.1
    name: 'CrossEntropy'
mixup:
    alpha: 0.4
    enable: 0
model:
    classes: 3
    dropout: 0
    finetune: False
    model_depth: 101
    n_input_channels: 1
    name: 'mc3_18'
    pretrained: False
module:
    analyze_result: True
    name: 'CTModule'
optim:
    base_lr: 0.001
    momentum: 0.9
    name: 'adam'
    scheduler:
        gamma: 0.1
        milestones: [10, 25, 35, 50]
        mode: 'min'
        name: 'CosineAnnealingLR'
        patience: 10
        step_size: 10
        t_0: 5
        t_max: 100
        t_mul: 20
        verbose: True
    weight_decay: 0.0005
predict_only:
    load_ckpt:
        checkpoint_path: ''
    load_metric:
        map_location: 'cuda:0'
        on_gpu: True
        tags_csv: ''
        weights_path: ''
    to_pred_file_path: ''
    type: 'ckpt'
topk: [1, 1]
trainer:
    accumulate_grad_batches: 1
    amp_level: 'O1'
    auto_lr_find: False
    auto_scale_batch_size: False
    auto_select_gpus: False
    benchmark: False
    check_val_every_n_epoch: 1
    default_root_dir: './output'
    default_save_path: './output'
    distributed_backend: 'dp'
    fast_dev_run: False
    gpus: [1]
    gradient_clip_val: 0
    log_gpu_memory: ''
    log_save_interval: 100
    logger:
        mlflow:
            experiment_name: 'torchline_logs'
            tracking_uri: './output'
        setting: 2
        test_tube:
            name: 'ccccii_mc3_18_bs9_s64'
            save_dir: './output'
            version: -1
        type: 'test_tube'
    max_epochs: 100
    max_steps: 99999999
    min_epochs: 99
    min_steps: 99999999
    name: 'DefaultTrainer'
    num_nodes: 1
    num_sanity_val_steps: 5
    num_tpu_cores: ''
    overfit_pct: 0.0
    precision: 32
    print_nan_grads: True
    process_position: 0
    progress_bar_refresh_rate: 0
    reload_dataloaders_every_epoch: False
    replace_sampler_ddp: True
    resume_from_checkpoint: ''
    row_log_interval: 10
    show_progress_bar: False
    terminate_on_nan: False
    test_percent_check: 1.0
    track_grad_norm: -1
    train_percent_check: 1.0
    truncated_bptt_steps: ''
    use_amp: False
    val_check_interval: 1.0
    val_percent_check: 1.0
    weights_save_path: ''
    weights_summary: ''
transforms:
    ct:
        randomaffine:
            degrees: (-10, 10)
            enable: 0
            isotropic: True
            p: 0.5
            scales: (0.5, 0.5)
        randomblur:
            enable: 0
            p: 0.5
            std: (0, 4)
        randomelasticdeformation:
            enable: 0
            locked_borders: 0
            max_displacement: (7, 7, 7)
            num_control_points: (4, 4, 4)
            p: 0.5
        randomflip:
            axes: (0, 1, 2)
            enable: 1
            flip_probability: 0.5
            p: 0.5
        randomnoise:
            enable: 0
            mean: (0, 0.25)
            p: 0.5
            std: (0, 0.25)
        randomswap:
            enable: 0
            num_iterations: 100
            p: 0.5
            patch_size: (16, 16, 16)
    img:
        aug_cifar: False
        aug_imagenet: False
        center_crop:
            enable: 0
        color_jitter:
            brightness: 0.1
            contrast: 0.1
            enable: 0
            hue: 0.1
            saturation: 0.1
        random_crop:
            enable: 1
            padding: 0
        random_horizontal_flip:
            enable: 1
            p: 0.5
        random_resized_crop:
            enable: 0
            ratio: (0.75, 1.3333333333333333)
            scale: (0.5, 1.0)
        random_rotation:
            degrees: 10
            enable: 1
        random_vertical_flip:
            enable: 1
            p: 0.5
        resize:
            enable: 1
    name: 'CTTransforms'
    tensor:
        normalization:
            mean: [0.5, 0.5, 0.5]
            std: [0.5, 0.5, 0.5]
        random_erasing:
            enable: 0
            p: 0.5
            ratio: ((0.3, 3.3),)
            scale: (0.02, 0.3)
GPU available: True, used: True
No environment variable for node rank defined. Set as 0.
CUDA_VISIBLE_DEVICES: [1]
If you use TorchIO for your research, please cite the following paper:
Pérez-García et al., TorchIO: a Python library for efficient loading,
preprocessing, augmentation and patch-based sampling of medical images
in deep learning. Link: https://arxiv.org/abs/2003.04696

Generating validation transform ...
Valid transform=Compose(
)
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Sensitivity is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_ranking.py:951: UndefinedMetricWarning: No positive samples in y_true, true positive value should be meaningless
  UndefinedMetricWarning)
[2021-03-01 15:31:54,720] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000      45.0
          2     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000       0.0

avg / total     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000      45.0

Covid class AUC=nan
ACC=0.0
[2021-03-01 15:32:50,216] default_module.py->log_info line:141 [INFO]lr=1.0000e-03
Generating training transform ...
Train transform=Compose(
    <torchio.transforms.augmentation.spatial.random_flip.RandomFlip object at 0x7fb3d0723550>
)
Generating validation transform ...
Valid transform=Compose(
)
None
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:33:54,843] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 0/355 train_loss 1.3383  train_acc_1 22.2222
[2021-03-01 15:37:00,717] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 100/355 train_loss 0.9776  train_acc_1 54.2354
[2021-03-01 15:40:04,936] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 200/355 train_loss 0.9527  train_acc_1 56.4400
[2021-03-01 15:43:08,917] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 300/355 train_loss 0.9180  train_acc_1 57.8811
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:45:44,472] default_module.py->log_info line:141 [INFO]Valid Epoch 0/100 step 400/89 valid_loss 0.8000  valid_acc_1 66.8845
[2021-03-01 15:46:02,177] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7986    0.7591    0.8828    0.7783    0.8186    0.6618       303
          1     0.6427    0.7384    0.7500    0.6872    0.7442    0.5532       302
          2     0.7117    0.6010    0.9223    0.6517    0.7445    0.5365       193

avg / total     0.7186    0.7130    0.8421    0.7132    0.7725    0.5904       798

Covid class AUC=0.8193762016663106
ACC=0.7130325814536341
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 67.61229391300932 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)

Epoch 00000: valid_acc_1 reached 67.61229 (best 67.61229), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=0-valid_acc_1=67.61.ckpt as top 1
INFO:lightning:
Epoch 00000: valid_acc_1 reached 67.61229 (best 67.61229), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=0-valid_acc_1=67.61.ckpt as top 1
[2021-03-01 15:46:02,686] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.9047  train_acc_1 58.6228
[2021-03-01 15:46:02,687] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7698  valid_acc_1 67.6123
[2021-03-01 15:46:02,687] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:46:02,696] default_module.py->log_info line:141 [INFO]lr=9.9975e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:46:22,200] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 0/355 train_loss 0.8703  train_acc_1 77.7778
[2021-03-01 15:49:27,785] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 100/355 train_loss 0.8096  train_acc_1 64.3564
[2021-03-01 15:52:31,921] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 200/355 train_loss 0.8065  train_acc_1 64.2897
[2021-03-01 15:55:36,411] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 300/355 train_loss 0.7832  train_acc_1 66.0760
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:58:13,123] default_module.py->log_info line:141 [INFO]Valid Epoch 1/100 step 400/89 valid_loss 4.0775  valid_acc_1 23.4300
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:58:43,072] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000       303
          1     0.4211    0.9272    0.2238    0.5791    0.4555    0.2221       302
          2     0.8346    0.5751    0.9636    0.6810    0.7445    0.5327       193

avg / total     0.3612    0.4900    0.6975    0.3839    0.3524    0.2129       798

Covid class AUC=0.7662291711172826
ACC=0.4899749373433584
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 49.12609309292911 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 49.12609309292911 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00001: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00001: valid_acc_1  was not in top 1
[2021-03-01 15:58:43,136] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.7831  train_acc_1 66.0720
[2021-03-01 15:58:43,136] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 2.7110  valid_acc_1 49.1261
[2021-03-01 15:58:43,136] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:58:43,148] default_module.py->log_info line:141 [INFO]lr=9.9901e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:59:08,076] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 0/355 train_loss 0.9380  train_acc_1 66.6667
[2021-03-01 16:02:12,048] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 100/355 train_loss 0.8170  train_acc_1 61.9362
[2021-03-01 16:05:17,045] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 200/355 train_loss 0.7891  train_acc_1 63.9027
[2021-03-01 16:08:22,701] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 300/355 train_loss 0.7858  train_acc_1 65.2270
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:10:47,574] default_module.py->log_info line:141 [INFO]Valid Epoch 2/100 step 400/89 valid_loss 2.3182  valid_acc_1 17.6329
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:11:07,282] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000       303
          1     0.5398    0.6954    0.6391    0.6078    0.6666    0.4469       302
          2     0.3496    0.7409    0.5603    0.4751    0.6443    0.4227       193

avg / total     0.2889    0.4424    0.7571    0.3449    0.4081    0.2714       798

Covid class AUC=0.7217408139286476
ACC=0.4423558897243108
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 44.44444502069709 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 44.44444502069709 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00002: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00002: valid_acc_1  was not in top 1
[2021-03-01 16:11:07,517] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.7813  train_acc_1 65.5086
[2021-03-01 16:11:07,517] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.4626  valid_acc_1 44.4444
[2021-03-01 16:11:07,517] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:11:07,539] default_module.py->log_info line:141 [INFO]lr=9.9778e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:11:40,208] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 0/355 train_loss 1.2046  train_acc_1 44.4444
[2021-03-01 16:14:45,010] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 100/355 train_loss 0.7394  train_acc_1 69.8570
[2021-03-01 16:17:50,658] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 200/355 train_loss 0.7287  train_acc_1 70.3151
[2021-03-01 16:20:54,827] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 300/355 train_loss 0.7281  train_acc_1 69.9151
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:23:43,652] default_module.py->log_info line:141 [INFO]Valid Epoch 3/100 step 400/89 valid_loss 0.5584  valid_acc_1 74.6377
[2021-03-01 16:24:01,235] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.4862    0.9868    0.3616    0.6514    0.5974    0.3792       303
          1     0.9583    0.0762    0.9980    0.1411    0.2757    0.0690       302
          2     0.7107    0.5855    0.9240    0.6420    0.7355    0.5227       193

avg / total     0.7192    0.5451    0.7385    0.4560    0.5090    0.2965       798

Covid class AUC=0.7908499786370433
ACC=0.5451127819548872
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 54.68164830797174 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 54.68164830797174 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00003: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00003: valid_acc_1  was not in top 1
[2021-03-01 16:24:01,295] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.7321  train_acc_1 69.6714
[2021-03-01 16:24:01,296] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.9507  valid_acc_1 54.6816
[2021-03-01 16:24:01,296] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:24:01,308] default_module.py->log_info line:141 [INFO]lr=9.9606e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:24:22,086] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 0/355 train_loss 0.8711  train_acc_1 55.5556
[2021-03-01 16:27:26,887] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 100/355 train_loss 0.7046  train_acc_1 70.4070
[2021-03-01 16:30:31,525] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 200/355 train_loss 0.6964  train_acc_1 71.0337
[2021-03-01 16:33:35,610] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 300/355 train_loss 0.6938  train_acc_1 71.2071
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:35:59,765] default_module.py->log_info line:141 [INFO]Valid Epoch 4/100 step 400/89 valid_loss 0.7411  valid_acc_1 70.0483
[2021-03-01 16:36:18,720] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.4991    0.9373    0.4242    0.6514    0.6306    0.4180       303
          1     0.8462    0.0364    0.9960    0.0698    0.1905    0.0328       302
          2     0.6435    0.7202    0.8727    0.6797    0.7928    0.6190       193

avg / total     0.6654    0.5439    0.7491    0.4381    0.5033    0.3208       798

Covid class AUC=0.7440050202948087
ACC=0.543859649122807
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 54.556804699844186 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 54.556804699844186 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00004: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00004: valid_acc_1  was not in top 1
[2021-03-01 16:36:18,895] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6939  train_acc_1 71.2050
[2021-03-01 16:36:18,895] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.9538  valid_acc_1 54.5568
[2021-03-01 16:36:18,895] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:36:18,943] default_module.py->log_info line:141 [INFO]lr=9.9384e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:36:53,847] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 0/355 train_loss 0.5531  train_acc_1 77.7778
[2021-03-01 16:39:57,700] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 100/355 train_loss 0.7043  train_acc_1 71.0671
[2021-03-01 16:43:02,883] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 200/355 train_loss 0.6742  train_acc_1 72.3604
[2021-03-01 16:46:06,857] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 300/355 train_loss 0.6553  train_acc_1 73.1266
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:48:38,598] default_module.py->log_info line:141 [INFO]Valid Epoch 5/100 step 400/89 valid_loss 5.7833  valid_acc_1 26.8116
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:48:56,594] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000       303
          1     0.3784    1.0000    0.0000    0.5491    0.0000    0.0000       302
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000       193

avg / total     0.1432    0.3784    0.6216    0.2078    0.0000    0.0000       798

Covid class AUC=0.8057573168126468
ACC=0.37844611528822053
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 37.70287140835537 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 37.70287140835537 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00005: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00005: valid_acc_1  was not in top 1
[2021-03-01 16:48:56,990] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6462  train_acc_1 73.3333
[2021-03-01 16:48:56,990] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 4.6425  valid_acc_1 37.7029
[2021-03-01 16:48:56,990] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:48:57,031] default_module.py->log_info line:141 [INFO]lr=9.9114e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:49:55,316] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 0/355 train_loss 0.7737  train_acc_1 77.7778
[2021-03-01 16:53:00,870] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 100/355 train_loss 0.6515  train_acc_1 73.5974
[2021-03-01 16:56:05,727] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 200/355 train_loss 0.6698  train_acc_1 72.7474
[2021-03-01 16:59:10,588] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 300/355 train_loss 0.6692  train_acc_1 72.4622
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:01:51,448] default_module.py->log_info line:141 [INFO]Valid Epoch 6/100 step 400/89 valid_loss 0.4665  valid_acc_1 78.9855
[2021-03-01 17:02:09,302] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7404    0.8284    0.8222    0.7819    0.8253    0.6815       303
          1     0.7542    0.7417    0.8528    0.7479    0.7953    0.6255       302
          2     0.7037    0.5907    0.9207    0.6423    0.7374    0.5259       193

avg / total     0.7368    0.7381    0.8576    0.7353    0.7927    0.6227       798

Covid class AUC=0.9006422238837855
ACC=0.7380952380952381
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 73.90761665815718 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 73.90761665815718 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00006: valid_acc_1 reached 73.90762 (best 73.90762), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=6-valid_acc_1=73.91.ckpt as top 1
INFO:lightning:
Epoch 00006: valid_acc_1 reached 73.90762 (best 73.90762), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=6-valid_acc_1=73.91.ckpt as top 1
[2021-03-01 17:02:09,868] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6681  train_acc_1 72.6448
[2021-03-01 17:02:09,868] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6081  valid_acc_1 73.9076
[2021-03-01 17:02:09,868] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:02:09,878] default_module.py->log_info line:141 [INFO]lr=9.8796e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:02:48,325] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 0/355 train_loss 1.1919  train_acc_1 44.4444
[2021-03-01 17:05:53,227] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 100/355 train_loss 0.6639  train_acc_1 71.6172
[2021-03-01 17:08:57,591] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 200/355 train_loss 0.6546  train_acc_1 72.8027
[2021-03-01 17:12:00,732] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 300/355 train_loss 0.6428  train_acc_1 73.5327
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:14:19,760] default_module.py->log_info line:141 [INFO]Valid Epoch 7/100 step 400/89 valid_loss 1.0585  valid_acc_1 55.0725
[2021-03-01 17:14:37,375] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9108    0.4719    0.9717    0.6217    0.6772    0.4357       303
          1     0.5596    0.8245    0.6048    0.6667    0.7062    0.5096       302
          2     0.6939    0.7047    0.9008    0.6992    0.7967    0.6223       193

avg / total     0.7254    0.6617    0.8157    0.6575    0.7171    0.5088       798

Covid class AUC=0.8562873851741082
ACC=0.6616541353383458
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 66.29213548510262 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 66.29213548510262 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00007: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00007: valid_acc_1  was not in top 1
[2021-03-01 17:14:37,449] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6363  train_acc_1 74.1784
[2021-03-01 17:14:37,449] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8404  valid_acc_1 66.2921
[2021-03-01 17:14:37,449] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:14:37,460] default_module.py->log_info line:141 [INFO]lr=9.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:14:57,500] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 0/355 train_loss 0.6520  train_acc_1 77.7778
[2021-03-01 17:18:02,764] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 100/355 train_loss 0.6129  train_acc_1 74.4774
[2021-03-01 17:21:06,736] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 200/355 train_loss 0.6452  train_acc_1 73.0791
[2021-03-01 17:24:11,002] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 300/355 train_loss 0.6228  train_acc_1 74.6770
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:26:46,722] default_module.py->log_info line:141 [INFO]Valid Epoch 8/100 step 400/89 valid_loss 0.8785  valid_acc_1 73.4300
[2021-03-01 17:27:15,339] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.4632    0.9967    0.2929    0.6325    0.5403    0.3125       303
          1     1.0000    0.0199    1.0000    0.0390    0.1410    0.0179       302
          2     0.7000    0.5078    0.9306    0.5886    0.6874    0.4525       193

avg / total     0.7236    0.5088    0.7147    0.3972    0.4248    0.2349       798

Covid class AUC=0.7551471373638111
ACC=0.5087719298245614
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 50.99875180105145 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 50.99875180105145 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00008: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00008: valid_acc_1  was not in top 1
[2021-03-01 17:27:15,820] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6136  train_acc_1 74.9922
[2021-03-01 17:27:15,820] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.5129  valid_acc_1 50.9988
[2021-03-01 17:27:15,820] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:27:15,836] default_module.py->log_info line:141 [INFO]lr=9.8015e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:28:19,282] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 0/355 train_loss 0.9259  train_acc_1 66.6667
[2021-03-01 17:31:24,713] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 100/355 train_loss 0.6022  train_acc_1 75.5776
[2021-03-01 17:34:28,014] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 200/355 train_loss 0.5684  train_acc_1 77.7778
[2021-03-01 17:37:32,534] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 300/355 train_loss 0.5523  train_acc_1 78.6268
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:40:04,428] default_module.py->log_info line:141 [INFO]Valid Epoch 9/100 step 400/89 valid_loss 0.4284  valid_acc_1 78.9855
[2021-03-01 17:40:25,484] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6554    0.8977    0.7111    0.7577    0.7990    0.6503       303
          1     0.7867    0.5497    0.9093    0.6472    0.7070    0.4818       302
          2     0.7500    0.6684    0.9289    0.7068    0.7880    0.6047       193

avg / total     0.7280    0.7105    0.8388    0.7036    0.7615    0.5755       798

Covid class AUC=0.8874973296304208
ACC=0.7105263157894737
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 71.16104947850945 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 71.16104947850945 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00009: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00009: valid_acc_1  was not in top 1
[2021-03-01 17:40:25,582] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5464  train_acc_1 78.8419
[2021-03-01 17:40:25,582] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6615  valid_acc_1 71.1610
[2021-03-01 17:40:25,582] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:40:25,596] default_module.py->log_info line:141 [INFO]lr=9.7553e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:40:46,636] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 0/355 train_loss 0.3140  train_acc_1 88.8889
[2021-03-01 17:45:01,905] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 100/355 train_loss 0.5484  train_acc_1 78.2178
[2021-03-01 17:49:50,261] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 200/355 train_loss 0.5421  train_acc_1 78.5517
[2021-03-01 17:53:00,682] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 300/355 train_loss 0.5271  train_acc_1 79.9188
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:56:49,204] default_module.py->log_info line:141 [INFO]Valid Epoch 10/100 step 400/89 valid_loss 0.5429  valid_acc_1 76.3285
[2021-03-01 17:57:07,786] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7786    0.6964    0.8788    0.7352    0.7823    0.6008       303
          1     0.6643    0.9371    0.7117    0.7775    0.8167    0.6819       302
          2     0.9406    0.4922    0.9901    0.6463    0.6981    0.4631       193

avg / total     0.7745    0.7381    0.8425    0.7297    0.7749    0.5982       798

Covid class AUC=0.8947540589617603
ACC=0.7380952380952381
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 73.78277249282665 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 73.78277249282665 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00010: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00010: valid_acc_1  was not in top 1
[2021-03-01 17:57:07,933] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5102  train_acc_1 80.6573
[2021-03-01 17:57:07,934] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7930  valid_acc_1 73.7828
[2021-03-01 17:57:07,934] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:57:07,945] default_module.py->log_info line:141 [INFO]lr=9.7044e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:58:03,506] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 0/355 train_loss 0.1427  train_acc_1 100.0000
[2021-03-01 18:01:07,845] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 100/355 train_loss 0.4656  train_acc_1 82.1782
[2021-03-01 18:04:11,204] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 200/355 train_loss 0.4772  train_acc_1 82.4212
[2021-03-01 18:07:15,549] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 300/355 train_loss 0.4828  train_acc_1 81.9491
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:09:53,840] default_module.py->log_info line:141 [INFO]Valid Epoch 11/100 step 400/89 valid_loss 0.3209  valid_acc_1 85.9903
[2021-03-01 18:10:11,644] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.5931    0.9670    0.5939    0.7353    0.7579    0.5958       303
          1     0.8984    0.5563    0.9617    0.6871    0.7314    0.5133       302
          2     0.8718    0.5285    0.9752    0.6581    0.7179    0.4924       193

avg / total     0.7760    0.7055    0.8253    0.6984    0.7382    0.5395       798

Covid class AUC=0.9032458342234564
ACC=0.7055137844611529
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 70.59925191857842 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 70.59925191857842 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00011: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00011: valid_acc_1  was not in top 1
[2021-03-01 18:10:11,711] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4790  train_acc_1 82.1596
[2021-03-01 18:10:11,711] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6990  valid_acc_1 70.5993
[2021-03-01 18:10:11,711] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:10:11,720] default_module.py->log_info line:141 [INFO]lr=9.6489e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:10:50,070] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 0/355 train_loss 0.1337  train_acc_1 100.0000
[2021-03-01 18:13:54,741] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 100/355 train_loss 0.3991  train_acc_1 83.8284
[2021-03-01 18:16:58,440] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 200/355 train_loss 0.4469  train_acc_1 82.3659
[2021-03-01 18:20:01,509] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 300/355 train_loss 0.4451  train_acc_1 82.2444
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:22:19,387] default_module.py->log_info line:141 [INFO]Valid Epoch 12/100 step 400/89 valid_loss 0.5010  valid_acc_1 79.7101
[2021-03-01 18:22:37,003] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8938    0.8053    0.9414    0.8472    0.8707    0.7478       303
          1     0.7898    0.8212    0.8669    0.8052    0.8438    0.7087       302
          2     0.7678    0.8394    0.9190    0.8020    0.8783    0.7653       193

avg / total     0.8240    0.8195    0.9078    0.8204    0.8623    0.7372       798

Covid class AUC=0.9215845973082676
ACC=0.8195488721804511
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 82.02247323882713 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 82.02247323882713 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00012: valid_acc_1 reached 82.02247 (best 82.02247), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=12-valid_acc_1=82.02.ckpt as top 1
INFO:lightning:
Epoch 00012: valid_acc_1 reached 82.02247 (best 82.02247), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=12-valid_acc_1=82.02.ckpt as top 1
[2021-03-01 18:22:37,623] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4511  train_acc_1 82.1283
[2021-03-01 18:22:37,624] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4588  valid_acc_1 82.0225
[2021-03-01 18:22:37,624] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:22:37,633] default_module.py->log_info line:141 [INFO]lr=9.5888e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:23:00,453] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 0/355 train_loss 0.4436  train_acc_1 77.7778
[2021-03-01 18:26:05,600] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 100/355 train_loss 0.4294  train_acc_1 81.8482
[2021-03-01 18:29:09,587] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 200/355 train_loss 0.4044  train_acc_1 83.5821
[2021-03-01 18:32:14,060] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 300/355 train_loss 0.4189  train_acc_1 82.6873
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:35:01,612] default_module.py->log_info line:141 [INFO]Valid Epoch 13/100 step 400/89 valid_loss 0.2646  valid_acc_1 89.8551
[2021-03-01 18:35:19,559] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8247    0.9472    0.8768    0.8817    0.9113    0.8363       303
          1     0.9302    0.7947    0.9637    0.8571    0.8751    0.7529       302
          2     0.8073    0.8031    0.9388    0.8052    0.8683    0.7438       193

avg / total     0.8604    0.8546    0.9247    0.8539    0.8872    0.7824       798

Covid class AUC=0.9613864558854944
ACC=0.8546365914786967
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 85.51810339595495 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 85.51810339595495 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00013: valid_acc_1 reached 85.51810 (best 85.51810), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=13-valid_acc_1=85.52.ckpt as top 1
INFO:lightning:
Epoch 00013: valid_acc_1 reached 85.51810 (best 85.51810), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=13-valid_acc_1=85.52.ckpt as top 1
[2021-03-01 18:35:20,142] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4146  train_acc_1 83.1299
[2021-03-01 18:35:20,143] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3482  valid_acc_1 85.5181
[2021-03-01 18:35:20,143] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:35:20,152] default_module.py->log_info line:141 [INFO]lr=9.5241e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:35:46,033] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 0/355 train_loss 0.2512  train_acc_1 88.8889
[2021-03-01 18:38:49,453] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 100/355 train_loss 0.4280  train_acc_1 83.6084
[2021-03-01 18:41:53,666] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 200/355 train_loss 0.4066  train_acc_1 84.8535
[2021-03-01 18:44:57,637] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 300/355 train_loss 0.3955  train_acc_1 85.3821
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:47:42,661] default_module.py->log_info line:141 [INFO]Valid Epoch 14/100 step 400/89 valid_loss 0.7172  valid_acc_1 60.6280
[2021-03-01 18:48:18,547] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8352    0.5017    0.9394    0.6268    0.6865    0.4506       303
          1     0.5765    0.9106    0.5927    0.7060    0.7347    0.5569       302
          2     0.8417    0.6062    0.9636    0.7048    0.7643    0.5633       193

avg / total     0.7389    0.6817    0.8141    0.6757    0.7235    0.5181       798

Covid class AUC=0.8905148472548601
ACC=0.681704260651629
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 68.28963878717315 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 68.28963878717315 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00014: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00014: valid_acc_1  was not in top 1
[2021-03-01 18:48:18,648] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3961  train_acc_1 85.2895
[2021-03-01 18:48:18,648] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8451  valid_acc_1 68.2896
[2021-03-01 18:48:18,648] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:48:18,665] default_module.py->log_info line:141 [INFO]lr=9.4550e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:48:38,497] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 0/355 train_loss 0.3112  train_acc_1 88.8889
[2021-03-01 18:51:42,690] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 100/355 train_loss 0.3977  train_acc_1 85.6986
[2021-03-01 18:54:45,749] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 200/355 train_loss 0.3740  train_acc_1 86.1802
[2021-03-01 18:57:49,777] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 300/355 train_loss 0.3627  train_acc_1 86.4895
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:00:09,746] default_module.py->log_info line:141 [INFO]Valid Epoch 15/100 step 400/89 valid_loss 0.6689  valid_acc_1 66.1836
[2021-03-01 19:00:27,639] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6762    0.5446    0.8404    0.6033    0.6765    0.4441       303
          1     0.5413    0.9768    0.4960    0.6966    0.6960    0.5078       302
          2     0.6667    0.0311    0.9950    0.0594    0.1759    0.0280       193

avg / total     0.6228    0.5840    0.7475    0.5071    0.5628    0.3675       798

Covid class AUC=0.8523152104251228
ACC=0.5839598997493735
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 58.17727907587973 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 58.17727907587973 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00015: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00015: valid_acc_1  was not in top 1
[2021-03-01 19:00:28,534] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3771  train_acc_1 85.8529
[2021-03-01 19:00:28,534] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.5708  valid_acc_1 58.1773
[2021-03-01 19:00:28,534] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:00:28,551] default_module.py->log_info line:141 [INFO]lr=9.3815e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:01:08,663] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 0/355 train_loss 0.4477  train_acc_1 88.8889
[2021-03-01 19:04:14,876] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 100/355 train_loss 0.3973  train_acc_1 85.5886
[2021-03-01 19:07:19,706] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 200/355 train_loss 0.3750  train_acc_1 86.6777
[2021-03-01 19:10:22,222] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 300/355 train_loss 0.3831  train_acc_1 86.3418
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:12:39,224] default_module.py->log_info line:141 [INFO]Valid Epoch 16/100 step 400/89 valid_loss 0.3722  valid_acc_1 82.1256
[2021-03-01 19:12:57,220] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.5147    0.9802    0.4343    0.6750    0.6525    0.4490       303
          1     0.5182    0.3775    0.7863    0.4368    0.5448    0.2847       302
          2     1.0000    0.0052    1.0000    0.0103    0.0720    0.0047       193

avg / total     0.6334    0.5163    0.7043    0.4241    0.4713    0.2793       798

Covid class AUC=0.8293366801965393
ACC=0.5162907268170426
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 51.4357056671314 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 51.4357056671314 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00016: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00016: valid_acc_1  was not in top 1
[2021-03-01 19:12:57,453] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3830  train_acc_1 86.0094
[2021-03-01 19:12:57,453] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.2180  valid_acc_1 51.4357
[2021-03-01 19:12:57,454] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:12:57,468] default_module.py->log_info line:141 [INFO]lr=9.3037e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:13:22,325] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 0/355 train_loss 0.2117  train_acc_1 88.8889
[2021-03-01 19:16:27,098] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 100/355 train_loss 0.3571  train_acc_1 85.5886
[2021-03-01 19:19:31,358] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 200/355 train_loss 0.3589  train_acc_1 86.0697
[2021-03-01 19:22:35,255] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 300/355 train_loss 0.3608  train_acc_1 86.2680
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:25:16,805] default_module.py->log_info line:141 [INFO]Valid Epoch 17/100 step 400/89 valid_loss 0.5732  valid_acc_1 76.5700
[2021-03-01 19:25:34,864] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9609    0.7294    0.9818    0.8293    0.8462    0.6980       303
          1     0.8636    0.8808    0.9153    0.8721    0.8979    0.8034       302
          2     0.7038    0.9482    0.8727    0.8079    0.9097    0.8338       193

avg / total     0.8619    0.8396    0.9303    0.8403    0.8811    0.7707       798

Covid class AUC=0.9655722602008119
ACC=0.8395989974937343
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.01997617657265 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.01997617657265 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00017: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00017: valid_acc_1  was not in top 1
[2021-03-01 19:25:35,025] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3578  train_acc_1 86.5102
[2021-03-01 19:25:35,026] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4020  valid_acc_1 84.0200
[2021-03-01 19:25:35,026] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:25:35,038] default_module.py->log_info line:141 [INFO]lr=9.2216e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:26:08,936] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 0/355 train_loss 0.2693  train_acc_1 88.8889
[2021-03-01 19:29:12,264] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 100/355 train_loss 0.3525  train_acc_1 86.9087
[2021-03-01 19:32:15,852] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 200/355 train_loss 0.3069  train_acc_1 88.7783
[2021-03-01 19:35:20,449] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 300/355 train_loss 0.3158  train_acc_1 88.4090
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:38:00,886] default_module.py->log_info line:141 [INFO]Valid Epoch 18/100 step 400/89 valid_loss 0.7468  valid_acc_1 69.8068
[2021-03-01 19:38:19,447] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9216    0.6205    0.9677    0.7416    0.7749    0.5796       303
          1     0.6435    0.9205    0.6895    0.7575    0.7967    0.6494       302
          2     0.8580    0.7202    0.9620    0.7831    0.8324    0.6761       193

avg / total     0.8010    0.7581    0.8610    0.7577    0.7970    0.6293       798

Covid class AUC=0.9423133411664174
ACC=0.7581453634085213
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.90511927443944 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.90511927443944 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00018: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00018: valid_acc_1  was not in top 1
[2021-03-01 19:38:19,520] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3273  train_acc_1 87.7621
[2021-03-01 19:38:19,520] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7126  valid_acc_1 75.9051
[2021-03-01 19:38:19,520] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:38:19,531] default_module.py->log_info line:141 [INFO]lr=9.1354e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:38:37,816] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 0/355 train_loss 0.0729  train_acc_1 100.0000
[2021-03-01 19:41:42,051] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 100/355 train_loss 0.3660  train_acc_1 87.1287
[2021-03-01 19:44:45,422] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 200/355 train_loss 0.3641  train_acc_1 86.9541
[2021-03-01 19:47:47,757] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 300/355 train_loss 0.3496  train_acc_1 87.5969
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:50:06,271] default_module.py->log_info line:141 [INFO]Valid Epoch 19/100 step 400/89 valid_loss 0.2748  valid_acc_1 88.6473
[2021-03-01 19:50:24,021] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8930    0.8812    0.9354    0.8870    0.9079    0.8198       303
          1     0.8562    0.8874    0.9093    0.8715    0.8983    0.8051       302
          2     0.8656    0.8342    0.9587    0.8496    0.8943    0.7898       193

avg / total     0.8724    0.8722    0.9311    0.8721    0.9010    0.8070       798

Covid class AUC=0.9558053834650715
ACC=0.8721804511278195
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.26591886027475 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.26591886027475 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00019: valid_acc_1 reached 87.26592 (best 87.26592), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=19-valid_acc_1=87.27.ckpt as top 1
INFO:lightning:
Epoch 00019: valid_acc_1 reached 87.26592 (best 87.26592), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=19-valid_acc_1=87.27.ckpt as top 1
[2021-03-01 19:50:24,566] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3475  train_acc_1 87.6056
[2021-03-01 19:50:24,567] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3322  valid_acc_1 87.2659
[2021-03-01 19:50:24,567] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:50:24,575] default_module.py->log_info line:141 [INFO]lr=9.0451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:51:11,789] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 0/355 train_loss 0.1958  train_acc_1 100.0000
[2021-03-01 19:54:15,882] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 100/355 train_loss 0.3211  train_acc_1 89.6590
[2021-03-01 19:57:19,567] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 200/355 train_loss 0.3371  train_acc_1 88.0044
[2021-03-01 20:00:22,532] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 300/355 train_loss 0.3331  train_acc_1 87.5600
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:02:45,512] default_module.py->log_info line:141 [INFO]Valid Epoch 20/100 step 400/89 valid_loss 0.1435  valid_acc_1 95.4106
[2021-03-01 20:03:03,491] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8154    0.9769    0.8646    0.8889    0.9191    0.8542       303
          1     0.9051    0.8841    0.9435    0.8945    0.9133    0.8292       302
          2     0.9143    0.6632    0.9802    0.7688    0.8063    0.6295       193

avg / total     0.8733    0.8659    0.9224    0.8620    0.8896    0.7904       798

Covid class AUC=0.9686164815210425
ACC=0.8659147869674185
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.64169898729646 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.64169898729646 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00020: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00020: valid_acc_1  was not in top 1
[2021-03-01 20:03:03,583] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3330  train_acc_1 87.5743
[2021-03-01 20:03:03,583] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3714  valid_acc_1 86.6417
[2021-03-01 20:03:03,583] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:03:03,596] default_module.py->log_info line:141 [INFO]lr=8.9508e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:03:35,526] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 0/355 train_loss 0.0464  train_acc_1 100.0000
[2021-03-01 20:06:41,106] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 100/355 train_loss 0.2710  train_acc_1 89.7690
[2021-03-01 20:09:42,122] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 200/355 train_loss 0.3067  train_acc_1 88.1150
[2021-03-01 20:12:43,373] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 300/355 train_loss 0.3150  train_acc_1 87.7446
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:15:02,291] default_module.py->log_info line:141 [INFO]Valid Epoch 21/100 step 400/89 valid_loss 0.6577  valid_acc_1 76.8116
[2021-03-01 20:15:19,897] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9240    0.7624    0.9616    0.8354    0.8562    0.7185       303
          1     0.9836    0.7947    0.9919    0.8791    0.8879    0.7727       302
          2     0.6349    1.0000    0.8165    0.7767    0.9036    0.8315       193

avg / total     0.8766    0.8321    0.9380    0.8378    0.8797    0.7664       798

Covid class AUC=0.9545703375347149
ACC=0.8320802005012531
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 83.27091191323956 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 83.27091191323956 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00021: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00021: valid_acc_1  was not in top 1
[2021-03-01 20:15:19,960] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3175  train_acc_1 87.5743
[2021-03-01 20:15:19,960] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5051  valid_acc_1 83.2709
[2021-03-01 20:15:19,961] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:15:19,972] default_module.py->log_info line:141 [INFO]lr=8.8526e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:15:38,300] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 0/355 train_loss 0.1097  train_acc_1 100.0000
[2021-03-01 20:18:39,449] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 100/355 train_loss 0.2728  train_acc_1 89.1089
[2021-03-01 20:21:40,754] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 200/355 train_loss 0.2854  train_acc_1 89.2758
[2021-03-01 20:24:41,554] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 300/355 train_loss 0.2891  train_acc_1 89.4795
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:26:56,731] default_module.py->log_info line:141 [INFO]Valid Epoch 22/100 step 400/89 valid_loss 0.2076  valid_acc_1 91.7874
[2021-03-01 20:27:14,174] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8723    0.9472    0.9152    0.9082    0.9310    0.8696       303
          1     0.9278    0.8510    0.9597    0.8877    0.9037    0.8078       302
          2     0.8281    0.8238    0.9455    0.8260    0.8826    0.7694       193

avg / total     0.8826    0.8810    0.9393    0.8806    0.9090    0.8220       798

Covid class AUC=0.9665269173253579
ACC=0.8809523809523809
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.07740449369624 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.07740449369624 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00022: valid_acc_1 reached 88.07740 (best 88.07740), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=22-valid_acc_1=88.08.ckpt as top 1
INFO:lightning:
Epoch 00022: valid_acc_1 reached 88.07740 (best 88.07740), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=22-valid_acc_1=88.08.ckpt as top 1
[2021-03-01 20:27:14,717] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2927  train_acc_1 88.8889
[2021-03-01 20:27:14,717] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3199  valid_acc_1 88.0774
[2021-03-01 20:27:14,718] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:27:14,728] default_module.py->log_info line:141 [INFO]lr=8.7506e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:27:41,590] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 0/355 train_loss 0.2274  train_acc_1 88.8889
[2021-03-01 20:30:42,988] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 100/355 train_loss 0.3089  train_acc_1 88.4488
[2021-03-01 20:33:44,380] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 200/355 train_loss 0.3021  train_acc_1 88.5019
[2021-03-01 20:36:45,849] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 300/355 train_loss 0.3040  train_acc_1 88.7043
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:39:21,104] default_module.py->log_info line:141 [INFO]Valid Epoch 23/100 step 400/89 valid_loss 0.4740  valid_acc_1 79.9517
[2021-03-01 20:39:38,843] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9380    0.7492    0.9697    0.8330    0.8523    0.7105       303
          1     0.7661    0.9437    0.8246    0.8457    0.8821    0.7874       302
          2     0.8859    0.8446    0.9653    0.8647    0.9029    0.8054       193

avg / total     0.8604    0.8459    0.9137    0.8455    0.8758    0.7626       798

Covid class AUC=0.9535355693227943
ACC=0.8458646616541353
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.644195856673 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.644195856673 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00023: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00023: valid_acc_1  was not in top 1
[2021-03-01 20:39:38,904] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3047  train_acc_1 88.5133
[2021-03-01 20:39:38,904] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4182  valid_acc_1 84.6442
[2021-03-01 20:39:38,904] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:39:38,916] default_module.py->log_info line:141 [INFO]lr=8.6448e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:39:57,491] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 0/355 train_loss 0.4063  train_acc_1 88.8889
[2021-03-01 20:42:58,834] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 100/355 train_loss 0.2707  train_acc_1 90.5391
[2021-03-01 20:46:00,033] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 200/355 train_loss 0.2527  train_acc_1 91.0448
[2021-03-01 20:49:00,739] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 300/355 train_loss 0.2656  train_acc_1 90.5500
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:51:17,668] default_module.py->log_info line:141 [INFO]Valid Epoch 24/100 step 400/89 valid_loss 0.1849  valid_acc_1 92.7536
[2021-03-01 20:51:35,176] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8116    0.9670    0.8626    0.8825    0.9133    0.8429       303
          1     0.9960    0.8212    0.9980    0.9002    0.9053    0.8050       302
          2     0.8191    0.7979    0.9438    0.8084    0.8678    0.7421       193

avg / total     0.8832    0.8709    0.9335    0.8713    0.8993    0.8042       798

Covid class AUC=0.9661664174321727
ACC=0.8709273182957393
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.14107474852145 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.14107474852145 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00024: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00024: valid_acc_1  was not in top 1
[2021-03-01 20:51:35,246] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2638  train_acc_1 90.5477
[2021-03-01 20:51:35,246] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3375  valid_acc_1 87.1411
[2021-03-01 20:51:35,246] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:51:35,259] default_module.py->log_info line:141 [INFO]lr=8.5355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:51:51,974] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 0/355 train_loss 0.0114  train_acc_1 100.0000
[2021-03-01 20:54:53,495] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 100/355 train_loss 0.2800  train_acc_1 90.0990
[2021-03-01 20:57:54,887] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 200/355 train_loss 0.2660  train_acc_1 90.4920
[2021-03-01 21:00:55,881] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 300/355 train_loss 0.2765  train_acc_1 89.8117
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:03:21,515] default_module.py->log_info line:141 [INFO]Valid Epoch 25/100 step 400/89 valid_loss 0.4115  valid_acc_1 81.4010
[2021-03-01 21:03:39,704] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9289    0.7756    0.9636    0.8453    0.8645    0.7333       303
          1     0.7407    0.9272    0.8024    0.8235    0.8625    0.7532       302
          2     0.8623    0.7461    0.9620    0.8000    0.8472    0.7023       193

avg / total     0.8416    0.8258    0.9022    0.8261    0.8596    0.7333       798

Covid class AUC=0.9546971800897245
ACC=0.8258145363408521
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 82.64669261889512 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 82.64669261889512 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00025: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00025: valid_acc_1  was not in top 1
[2021-03-01 21:03:39,912] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2741  train_acc_1 89.8905
[2021-03-01 21:03:39,912] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5032  valid_acc_1 82.6467
[2021-03-01 21:03:39,912] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:03:39,924] default_module.py->log_info line:141 [INFO]lr=8.4227e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:04:06,099] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 0/355 train_loss 0.3028  train_acc_1 88.8889
[2021-03-01 21:07:07,281] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 100/355 train_loss 0.2581  train_acc_1 90.5391
[2021-03-01 21:10:08,147] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 200/355 train_loss 0.2898  train_acc_1 89.5522
[2021-03-01 21:13:09,292] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 300/355 train_loss 0.2754  train_acc_1 89.9225
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:15:25,730] default_module.py->log_info line:141 [INFO]Valid Epoch 26/100 step 400/89 valid_loss 0.2232  valid_acc_1 91.7874
[2021-03-01 21:15:43,224] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8607    0.9175    0.9091    0.8882    0.9133    0.8348       303
          1     0.8850    0.9172    0.9274    0.9008    0.9223    0.8498       302
          2     0.9012    0.7565    0.9736    0.8225    0.8582    0.7205       193

avg / total     0.8797    0.8784    0.9316    0.8771    0.9034    0.8128       798

Covid class AUC=0.9477475432599872
ACC=0.8784461152882206
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.89013877611482 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.89013877611482 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00026: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00026: valid_acc_1  was not in top 1
[2021-03-01 21:15:43,289] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2779  train_acc_1 89.7340
[2021-03-01 21:15:43,289] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3654  valid_acc_1 87.8901
[2021-03-01 21:15:43,289] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:15:43,297] default_module.py->log_info line:141 [INFO]lr=8.3066e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:15:59,190] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 0/355 train_loss 0.1115  train_acc_1 100.0000
[2021-03-01 21:19:00,878] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 100/355 train_loss 0.2629  train_acc_1 91.5292
[2021-03-01 21:22:02,248] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 200/355 train_loss 0.2835  train_acc_1 90.3261
[2021-03-01 21:25:03,091] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 300/355 train_loss 0.2751  train_acc_1 90.3285
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:27:18,342] default_module.py->log_info line:141 [INFO]Valid Epoch 27/100 step 400/89 valid_loss 0.3568  valid_acc_1 84.0580
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 21:27:36,141] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8039    0.8251    0.8768    0.8143    0.8505    0.7197       303
          1     0.5606    0.9040    0.5685    0.6920    0.7169    0.5312       302
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000       193

avg / total     0.5174    0.6554    0.7899    0.5711    0.5943    0.4743       798

Covid class AUC=0.8754873424481948
ACC=0.6553884711779449
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 65.293384359124 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 65.293384359124 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00027: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00027: valid_acc_1  was not in top 1
[2021-03-01 21:27:36,202] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2755  train_acc_1 90.2973
[2021-03-01 21:27:36,203] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.1770  valid_acc_1 65.2934
[2021-03-01 21:27:36,203] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:27:36,212] default_module.py->log_info line:141 [INFO]lr=8.1871e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:28:03,688] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 0/355 train_loss 0.1276  train_acc_1 100.0000
[2021-03-01 21:31:05,009] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 100/355 train_loss 0.2490  train_acc_1 90.6491
[2021-03-01 21:34:06,009] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 200/355 train_loss 0.2445  train_acc_1 90.8237
[2021-03-01 21:37:07,064] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 300/355 train_loss 0.2589  train_acc_1 90.4762
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:39:28,973] default_module.py->log_info line:141 [INFO]Valid Epoch 28/100 step 400/89 valid_loss 0.1617  valid_acc_1 94.4444
[2021-03-01 21:39:46,492] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8667    0.9439    0.9111    0.9036    0.9274    0.8628       303
          1     0.8438    0.9305    0.8952    0.8850    0.9126    0.8359       302
          2     0.9037    0.6321    0.9785    0.7439    0.7865    0.5971       193

avg / total     0.8670    0.8634    0.9214    0.8580    0.8877    0.7884       798

Covid class AUC=0.956259346293527
ACC=0.8634085213032582
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.32958915796172 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.32958915796172 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00028: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00028: valid_acc_1  was not in top 1
[2021-03-01 21:39:46,565] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2584  train_acc_1 90.5164
[2021-03-01 21:39:46,565] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3172  valid_acc_1 86.3296
[2021-03-01 21:39:46,565] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:39:46,576] default_module.py->log_info line:141 [INFO]lr=8.0645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:40:05,571] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 0/355 train_loss 0.0426  train_acc_1 100.0000
[2021-03-01 21:43:07,318] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 100/355 train_loss 0.2454  train_acc_1 91.1991
[2021-03-01 21:46:08,518] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 200/355 train_loss 0.2654  train_acc_1 90.8237
[2021-03-01 21:49:09,093] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 300/355 train_loss 0.2619  train_acc_1 90.8084
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:51:25,059] default_module.py->log_info line:141 [INFO]Valid Epoch 29/100 step 400/89 valid_loss 0.5489  valid_acc_1 72.7053
[2021-03-01 21:51:42,608] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8435    0.6403    0.9273    0.7280    0.7705    0.5767       303
          1     0.5963    0.9636    0.6028    0.7367    0.7621    0.6018       302
          2     0.9250    0.3834    0.9901    0.5421    0.6161    0.3566       193

avg / total     0.7697    0.7005    0.8197    0.6863    0.7300    0.5330       798

Covid class AUC=0.9200224311044649
ACC=0.7005012531328321
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 70.09987584660563 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 70.09987584660563 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00029: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00029: valid_acc_1  was not in top 1
[2021-03-01 21:51:42,670] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2581  train_acc_1 90.8920
[2021-03-01 21:51:42,671] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6946  valid_acc_1 70.0999
[2021-03-01 21:51:42,671] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:51:42,681] default_module.py->log_info line:141 [INFO]lr=7.9389e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:52:10,574] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 0/355 train_loss 0.0154  train_acc_1 100.0000
[2021-03-01 21:55:11,199] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 100/355 train_loss 0.2415  train_acc_1 90.6491
[2021-03-01 21:58:12,034] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 200/355 train_loss 0.2293  train_acc_1 91.5976
[2021-03-01 22:01:12,598] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 300/355 train_loss 0.2354  train_acc_1 91.7313
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:03:26,472] default_module.py->log_info line:141 [INFO]Valid Epoch 30/100 step 400/89 valid_loss 0.2933  valid_acc_1 88.4058
[2021-03-01 22:03:44,012] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9357    0.8647    0.9636    0.8988    0.9128    0.8250       303
          1     0.8598    0.9139    0.9093    0.8860    0.9116    0.8314       302
          2     0.8731    0.8912    0.9587    0.8821    0.9243    0.8486       193

avg / total     0.8918    0.8897    0.9419    0.8899    0.9151    0.8331       798

Covid class AUC=0.954824022644734
ACC=0.8897243107769424
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.0137341531475 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.0137341531475 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00030: valid_acc_1 reached 89.01373 (best 89.01373), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=30-valid_acc_1=89.01.ckpt as top 1
INFO:lightning:
Epoch 00030: valid_acc_1 reached 89.01373 (best 89.01373), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=30-valid_acc_1=89.01.ckpt as top 1
[2021-03-01 22:03:44,616] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2355  train_acc_1 91.6745
[2021-03-01 22:03:44,616] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2793  valid_acc_1 89.0137
[2021-03-01 22:03:44,617] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:03:44,625] default_module.py->log_info line:141 [INFO]lr=7.8104e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:04:01,448] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 0/355 train_loss 0.5217  train_acc_1 88.8889
[2021-03-01 22:07:02,197] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 100/355 train_loss 0.2330  train_acc_1 92.0792
[2021-03-01 22:10:03,057] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 200/355 train_loss 0.2431  train_acc_1 91.4870
[2021-03-01 22:13:03,491] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 300/355 train_loss 0.2464  train_acc_1 90.9561
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:15:18,288] default_module.py->log_info line:141 [INFO]Valid Epoch 31/100 step 400/89 valid_loss 0.3791  valid_acc_1 89.8551
[2021-03-01 22:15:35,799] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9307    0.9307    0.9576    0.9307    0.9440    0.8888       303
          1     0.9434    0.8278    0.9698    0.8818    0.8960    0.7914       302
          2     0.7739    0.9223    0.9140    0.8416    0.9182    0.8437       193

avg / total     0.8976    0.8897    0.9517    0.8907    0.9196    0.8410       798

Covid class AUC=0.9678754539628284
ACC=0.8897243107769424
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.01373368166806 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.01373368166806 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00031: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00031: valid_acc_1  was not in top 1
[2021-03-01 22:15:35,881] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2404  train_acc_1 91.5180
[2021-03-01 22:15:35,881] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3771  valid_acc_1 89.0137
[2021-03-01 22:15:35,881] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:15:35,893] default_module.py->log_info line:141 [INFO]lr=7.6791e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:15:53,055] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 0/355 train_loss 0.1175  train_acc_1 100.0000
[2021-03-01 22:18:53,502] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 100/355 train_loss 0.2419  train_acc_1 90.9791
[2021-03-01 22:21:54,283] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 200/355 train_loss 0.2476  train_acc_1 90.8237
[2021-03-01 22:24:55,343] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 300/355 train_loss 0.2357  train_acc_1 91.1406
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:27:08,888] default_module.py->log_info line:141 [INFO]Valid Epoch 32/100 step 400/89 valid_loss 0.4624  valid_acc_1 84.2995
[2021-03-01 22:27:26,340] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9283    0.8548    0.9596    0.8900    0.9057    0.8117       303
          1     0.9651    0.8245    0.9819    0.8893    0.8997    0.7968       302
          2     0.7203    0.9741    0.8793    0.8282    0.9255    0.8647       193

avg / total     0.8919    0.8722    0.9486    0.8748    0.9082    0.8189       798

Covid class AUC=0.9706459624011963
ACC=0.8721804511278195
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.26591858167326 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.26591858167326 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00032: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00032: valid_acc_1  was not in top 1
[2021-03-01 22:27:26,420] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2287  train_acc_1 91.2676
[2021-03-01 22:27:26,421] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3920  valid_acc_1 87.2659
[2021-03-01 22:27:26,421] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:27:26,436] default_module.py->log_info line:141 [INFO]lr=7.5452e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:27:43,627] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 0/355 train_loss 0.5194  train_acc_1 88.8889
[2021-03-01 22:30:44,289] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 100/355 train_loss 0.2012  train_acc_1 92.5193
[2021-03-01 22:33:45,098] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 200/355 train_loss 0.2180  train_acc_1 91.9845
[2021-03-01 22:36:45,651] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 300/355 train_loss 0.2195  train_acc_1 91.9528
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:39:02,690] default_module.py->log_info line:141 [INFO]Valid Epoch 33/100 step 400/89 valid_loss 0.2161  valid_acc_1 92.2705
[2021-03-01 22:39:20,241] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8845    0.9604    0.9232    0.9209    0.9416    0.8900       303
          1     0.9879    0.8079    0.9940    0.8889    0.8961    0.7881       302
          2     0.8288    0.9534    0.9372    0.8867    0.9452    0.8949       193

avg / total     0.9101    0.9010    0.9534    0.9005    0.9253    0.8526       798

Covid class AUC=0.9541230506302072
ACC=0.9010025062656641
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.13732893011543 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.13732893011543 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00033: valid_acc_1 reached 90.13733 (best 90.13733), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=33-valid_acc_1=90.14.ckpt as top 1
INFO:lightning:
Epoch 00033: valid_acc_1 reached 90.13733 (best 90.13733), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=33-valid_acc_1=90.14.ckpt as top 1
[2021-03-01 22:39:20,893] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2265  train_acc_1 91.7997
[2021-03-01 22:39:20,893] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2906  valid_acc_1 90.1373
[2021-03-01 22:39:20,893] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:39:20,905] default_module.py->log_info line:141 [INFO]lr=7.4088e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:39:39,298] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 0/355 train_loss 0.0225  train_acc_1 100.0000
[2021-03-01 22:42:40,149] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 100/355 train_loss 0.2049  train_acc_1 93.0693
[2021-03-01 22:45:40,746] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 200/355 train_loss 0.2155  train_acc_1 92.5926
[2021-03-01 22:48:41,171] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 300/355 train_loss 0.2199  train_acc_1 91.9528
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:50:56,316] default_module.py->log_info line:141 [INFO]Valid Epoch 34/100 step 400/89 valid_loss 0.2004  valid_acc_1 91.5459
[2021-03-01 22:51:13,924] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8700    0.9274    0.9152    0.8978    0.9213    0.8497       303
          1     0.9266    0.8775    0.9577    0.9014    0.9167    0.8336       302
          2     0.8942    0.8756    0.9669    0.8848    0.9202    0.8390       193

avg / total     0.8972    0.8960    0.9438    0.8960    0.9193    0.8410       798

Covid class AUC=0.9528012176885281
ACC=0.8959899749373433
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.63795402612578 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.63795402612578 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00034: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00034: valid_acc_1  was not in top 1
[2021-03-01 22:51:14,004] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2295  train_acc_1 91.4867
[2021-03-01 22:51:14,004] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2767  valid_acc_1 89.6380
[2021-03-01 22:51:14,005] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:51:14,016] default_module.py->log_info line:141 [INFO]lr=7.2700e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:51:32,959] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 0/355 train_loss 0.3304  train_acc_1 77.7778
[2021-03-01 22:54:33,399] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 100/355 train_loss 0.2168  train_acc_1 91.5292
[2021-03-01 22:57:33,938] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 200/355 train_loss 0.2207  train_acc_1 91.8187
[2021-03-01 23:00:34,047] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 300/355 train_loss 0.2242  train_acc_1 91.6944
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:02:48,887] default_module.py->log_info line:141 [INFO]Valid Epoch 35/100 step 400/89 valid_loss 0.1712  valid_acc_1 93.7198
[2021-03-01 23:03:06,470] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8534    0.9802    0.8970    0.9124    0.9377    0.8865       303
          1     0.9802    0.8212    0.9899    0.8937    0.9016    0.7992       302
          2     0.8477    0.8653    0.9504    0.8564    0.9069    0.8154       193

avg / total     0.9000    0.8922    0.9451    0.8918    0.9166    0.8363       798

Covid class AUC=0.9747783593249305
ACC=0.8922305764411027
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.26342151941878 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.26342151941878 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00035: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00035: valid_acc_1  was not in top 1
[2021-03-01 23:03:06,540] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2203  train_acc_1 91.8936
[2021-03-01 23:03:06,540] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2911  valid_acc_1 89.2634
[2021-03-01 23:03:06,540] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:03:06,554] default_module.py->log_info line:141 [INFO]lr=7.1289e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:03:25,260] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 0/355 train_loss 0.1822  train_acc_1 88.8889
[2021-03-01 23:06:25,656] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 100/355 train_loss 0.2358  train_acc_1 92.2992
[2021-03-01 23:09:26,020] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 200/355 train_loss 0.2215  train_acc_1 92.7584
[2021-03-01 23:12:26,123] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 300/355 train_loss 0.2128  train_acc_1 92.9494
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:14:39,806] default_module.py->log_info line:141 [INFO]Valid Epoch 36/100 step 400/89 valid_loss 0.1865  valid_acc_1 92.7536
[2021-03-01 23:14:57,271] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8430    0.9571    0.8909    0.8964    0.9234    0.8583       303
          1     0.9884    0.8444    0.9940    0.9107    0.9161    0.8267       302
          2     0.8520    0.8653    0.9521    0.8586    0.9076    0.8167       193

avg / total     0.9002    0.8922    0.9447    0.8927    0.9168    0.8363       798

Covid class AUC=0.9773018585772271
ACC=0.8922305764411027
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.26342139083349 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.26342139083349 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00036: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00036: valid_acc_1  was not in top 1
[2021-03-01 23:14:57,353] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2152  train_acc_1 92.8326
[2021-03-01 23:14:57,354] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2932  valid_acc_1 89.2634
[2021-03-01 23:14:57,354] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:14:57,364] default_module.py->log_info line:141 [INFO]lr=6.9857e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:15:13,748] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 0/355 train_loss 0.1769  train_acc_1 88.8889
[2021-03-01 23:18:14,076] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 100/355 train_loss 0.1964  train_acc_1 92.0792
[2021-03-01 23:21:14,444] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 200/355 train_loss 0.1818  train_acc_1 93.3112
[2021-03-01 23:24:14,394] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 300/355 train_loss 0.1960  train_acc_1 92.6910
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:26:29,001] default_module.py->log_info line:141 [INFO]Valid Epoch 37/100 step 400/89 valid_loss 0.5387  valid_acc_1 85.0242
[2021-03-01 23:26:46,433] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9596    0.8614    0.9778    0.9078    0.9177    0.8324       303
          1     0.9879    0.8113    0.9940    0.8909    0.8980    0.7916       302
          2     0.6942    1.0000    0.8595    0.8195    0.9271    0.8716       193

avg / total     0.9061    0.8759    0.9553    0.8801    0.9125    0.8265       798

Covid class AUC=0.9671277504806666
ACC=0.8759398496240601
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.64045035973024 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.64045035973024 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00037: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00037: valid_acc_1  was not in top 1
[2021-03-01 23:26:46,542] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1997  train_acc_1 92.7074
[2021-03-01 23:26:46,543] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4312  valid_acc_1 87.6405
[2021-03-01 23:26:46,543] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:26:46,555] default_module.py->log_info line:141 [INFO]lr=6.8406e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:27:02,915] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 0/355 train_loss 0.1968  train_acc_1 88.8889
[2021-03-01 23:30:03,086] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 100/355 train_loss 0.1789  train_acc_1 94.7195
[2021-03-01 23:33:03,796] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 200/355 train_loss 0.1992  train_acc_1 93.2559
[2021-03-01 23:36:03,861] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 300/355 train_loss 0.2170  train_acc_1 92.7279
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:38:18,171] default_module.py->log_info line:141 [INFO]Valid Epoch 38/100 step 400/89 valid_loss 0.2086  valid_acc_1 92.7536
[2021-03-01 23:38:35,710] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9314    0.9406    0.9576    0.9360    0.9490    0.8992       303
          1     0.9636    0.8775    0.9798    0.9185    0.9272    0.8510       302
          2     0.8295    0.9326    0.9388    0.8780    0.9357    0.8751       193

avg / total     0.9189    0.9148    0.9615    0.9154    0.9376    0.8751       798

Covid class AUC=0.975759720145268
ACC=0.9147869674185464
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.5106125735165 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.5106125735165 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00038: valid_acc_1 reached 91.51061 (best 91.51061), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=38-valid_acc_1=91.51.ckpt as top 1
INFO:lightning:
Epoch 00038: valid_acc_1 reached 91.51061 (best 91.51061), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=38-valid_acc_1=91.51.ckpt as top 1
[2021-03-01 23:38:36,283] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2146  train_acc_1 92.8639
[2021-03-01 23:38:36,284] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2326  valid_acc_1 91.5106
[2021-03-01 23:38:36,284] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:38:36,295] default_module.py->log_info line:141 [INFO]lr=6.6937e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:38:53,215] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 0/355 train_loss 0.1738  train_acc_1 88.8889
[2021-03-01 23:41:53,581] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 100/355 train_loss 0.2013  train_acc_1 93.6194
[2021-03-01 23:44:53,650] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 200/355 train_loss 0.1932  train_acc_1 93.5323
[2021-03-01 23:47:53,718] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 300/355 train_loss 0.1895  train_acc_1 93.6877
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:50:07,309] default_module.py->log_info line:141 [INFO]Valid Epoch 39/100 step 400/89 valid_loss 0.2368  valid_acc_1 92.7536
[2021-03-01 23:50:24,711] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9379    0.9472    0.9616    0.9425    0.9544    0.9095       303
          1     0.9534    0.8808    0.9738    0.9157    0.9261    0.8497       302
          2     0.8592    0.9482    0.9504    0.9015    0.9493    0.9010       193

avg / total     0.9247    0.9223    0.9635    0.9224    0.9425    0.8848       798

Covid class AUC=0.96545209356975
ACC=0.9223057644110275
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.25967647252457 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.25967647252457 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00039: valid_acc_1 reached 92.25968 (best 92.25968), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=39-valid_acc_1=92.26.ckpt as top 1
INFO:lightning:
Epoch 00039: valid_acc_1 reached 92.25968 (best 92.25968), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=39-valid_acc_1=92.26.ckpt as top 1
[2021-03-01 23:50:25,277] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1854  train_acc_1 93.6463
[2021-03-01 23:50:25,277] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2410  valid_acc_1 92.2597
[2021-03-01 23:50:25,277] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:50:25,286] default_module.py->log_info line:141 [INFO]lr=6.5451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:50:41,026] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 0/355 train_loss 0.3581  train_acc_1 88.8889
[2021-03-01 23:53:40,867] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 100/355 train_loss 0.1994  train_acc_1 92.5193
[2021-03-01 23:56:41,097] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 200/355 train_loss 0.1914  train_acc_1 92.9243
[2021-03-01 23:59:40,548] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 300/355 train_loss 0.1866  train_acc_1 93.3555
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 00:01:56,629] default_module.py->log_info line:141 [INFO]Valid Epoch 40/100 step 400/89 valid_loss 0.3222  valid_acc_1 89.3720
[2021-03-02 00:02:14,086] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9745    0.8845    0.9859    0.9273    0.9338    0.8631       303
          1     0.8825    0.9205    0.9254    0.9011    0.9230    0.8514       302
          2     0.8654    0.9326    0.9537    0.8978    0.9431    0.8876       193

avg / total     0.9133    0.9098    0.9552    0.9103    0.9320    0.8646       798

Covid class AUC=0.9731627857295451
ACC=0.9097744360902256
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.01123711232388 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.01123711232388 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00040: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00040: valid_acc_1  was not in top 1
[2021-03-02 00:02:14,178] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1873  train_acc_1 93.3333
[2021-03-02 00:02:14,178] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2688  valid_acc_1 91.0112
[2021-03-02 00:02:14,178] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 00:02:14,190] default_module.py->log_info line:141 [INFO]lr=6.3950e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 00:02:30,820] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 0/355 train_loss 0.6804  train_acc_1 88.8889
[2021-03-02 00:05:30,968] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 100/355 train_loss 0.1554  train_acc_1 94.7195
[2021-03-02 00:08:31,352] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 200/355 train_loss 0.1694  train_acc_1 93.7535
[2021-03-02 00:11:31,370] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 300/355 train_loss 0.1816  train_acc_1 93.2447
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 00:13:44,575] default_module.py->log_info line:141 [INFO]Valid Epoch 41/100 step 400/89 valid_loss 0.2852  valid_acc_1 90.8213
[2021-03-02 00:14:02,051] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9103    0.9373    0.9434    0.9236    0.9404    0.8837       303
          1     0.9699    0.8543    0.9839    0.9085    0.9168    0.8296       302
          2     0.8409    0.9585    0.9421    0.8959    0.9503    0.9046       193

avg / total     0.9161    0.9110    0.9584    0.9112    0.9339    0.8683       798

Covid class AUC=0.9640635013885922
ACC=0.9110275689223057
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.1360808383213 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.1360808383213 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00041: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00041: valid_acc_1  was not in top 1
[2021-03-02 00:14:02,147] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1879  train_acc_1 92.8326
[2021-03-02 00:14:02,147] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2753  valid_acc_1 91.1361
[2021-03-02 00:14:02,147] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 00:14:02,159] default_module.py->log_info line:141 [INFO]lr=6.2434e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 00:14:17,576] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 0/355 train_loss 0.2881  train_acc_1 88.8889
[2021-03-02 00:17:18,325] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 100/355 train_loss 0.1749  train_acc_1 93.5094
[2021-03-02 00:20:18,256] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 200/355 train_loss 0.1780  train_acc_1 93.8640
[2021-03-02 00:23:17,964] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 300/355 train_loss 0.1841  train_acc_1 93.4662
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 00:25:31,318] default_module.py->log_info line:141 [INFO]Valid Epoch 42/100 step 400/89 valid_loss 0.3155  valid_acc_1 91.0628
[2021-03-02 00:25:48,763] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9386    0.9076    0.9636    0.9228    0.9352    0.8697       303
          1     0.9576    0.8974    0.9758    0.9265    0.9358    0.8688       302
          2     0.8288    0.9534    0.9372    0.8867    0.9452    0.8949       193

avg / total     0.9192    0.9148    0.9618    0.9155    0.9378    0.8754       798

Covid class AUC=0.9625814462721641
ACC=0.9147869674185464
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.51061261637827 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.51061261637827 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00042: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00042: valid_acc_1  was not in top 1
[2021-03-02 00:25:48,847] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1783  train_acc_1 93.7089
[2021-03-02 00:25:48,848] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2851  valid_acc_1 91.5106
[2021-03-02 00:25:48,848] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 00:25:48,860] default_module.py->log_info line:141 [INFO]lr=6.0907e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 00:26:05,666] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 0/355 train_loss 0.4212  train_acc_1 88.8889
[2021-03-02 00:29:05,322] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 100/355 train_loss 0.1734  train_acc_1 93.9494
[2021-03-02 00:32:05,353] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 200/355 train_loss 0.1740  train_acc_1 94.1957
[2021-03-02 00:35:04,981] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 300/355 train_loss 0.1799  train_acc_1 93.7615
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 00:37:19,845] default_module.py->log_info line:141 [INFO]Valid Epoch 43/100 step 400/89 valid_loss 0.2340  valid_acc_1 92.2705
[2021-03-02 00:37:37,336] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9589    0.9241    0.9758    0.9412    0.9496    0.8970       303
          1     0.9509    0.8974    0.9718    0.9233    0.9338    0.8655       302
          2     0.8552    0.9793    0.9471    0.9130    0.9631    0.9305       193

avg / total     0.9308    0.9273    0.9673    0.9276    0.9469    0.8932       798

Covid class AUC=0.9722281563768426
ACC=0.9273182957393483
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.75905206230249 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.75905206230249 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00043: valid_acc_1 reached 92.75905 (best 92.75905), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=43-valid_acc_1=92.76.ckpt as top 1
INFO:lightning:
Epoch 00043: valid_acc_1 reached 92.75905 (best 92.75905), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=43-valid_acc_1=92.76.ckpt as top 1
[2021-03-02 00:37:37,906] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1849  train_acc_1 93.5837
[2021-03-02 00:37:37,906] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2175  valid_acc_1 92.7591
[2021-03-02 00:37:37,906] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 00:37:37,918] default_module.py->log_info line:141 [INFO]lr=5.9369e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 00:37:55,558] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 0/355 train_loss 0.0443  train_acc_1 100.0000
[2021-03-02 00:40:55,430] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 100/355 train_loss 0.1492  train_acc_1 95.0495
[2021-03-02 00:43:55,310] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 200/355 train_loss 0.1605  train_acc_1 94.4721
[2021-03-02 00:46:54,611] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 300/355 train_loss 0.1712  train_acc_1 93.9461
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 00:49:07,749] default_module.py->log_info line:141 [INFO]Valid Epoch 44/100 step 400/89 valid_loss 0.2234  valid_acc_1 92.5121
[2021-03-02 00:49:25,130] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9194    0.9406    0.9495    0.9299    0.9450    0.8923       303
          1     0.9710    0.8874    0.9839    0.9273    0.9344    0.8647       302
          2     0.8538    0.9378    0.9488    0.8938    0.9433    0.8888       193

avg / total     0.9230    0.9198    0.9623    0.9202    0.9406    0.8810       798

Covid class AUC=0.9695778145695364
ACC=0.9197994987468672
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.00998893480623 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.00998893480623 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00044: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00044: valid_acc_1  was not in top 1
[2021-03-02 00:49:25,220] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1662  train_acc_1 94.0845
[2021-03-02 00:49:25,221] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2409  valid_acc_1 92.0100
[2021-03-02 00:49:25,221] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 00:49:25,234] default_module.py->log_info line:141 [INFO]lr=5.7822e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 00:49:41,851] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 0/355 train_loss 0.0412  train_acc_1 100.0000
[2021-03-02 00:52:41,360] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 100/355 train_loss 0.1254  train_acc_1 96.0396
[2021-03-02 00:55:41,196] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 200/355 train_loss 0.1418  train_acc_1 95.0249
[2021-03-02 00:58:40,623] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 300/355 train_loss 0.1600  train_acc_1 94.5736
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 01:00:53,669] default_module.py->log_info line:141 [INFO]Valid Epoch 45/100 step 400/89 valid_loss 0.3144  valid_acc_1 89.8551
[2021-03-02 01:01:11,166] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9450    0.9076    0.9677    0.9259    0.9372    0.8730       303
          1     0.9888    0.8808    0.9940    0.9317    0.9357    0.8656       302
          2     0.8025    0.9896    0.9223    0.8863    0.9554    0.9189       193

avg / total     0.9271    0.9173    0.9666    0.9185    0.9410    0.8813       798

Covid class AUC=0.9744979705191199
ACC=0.9172932330827067
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.76030049699077 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.76030049699077 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00045: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00045: valid_acc_1  was not in top 1
[2021-03-02 01:01:11,256] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1606  train_acc_1 94.5227
[2021-03-02 01:01:11,257] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2550  valid_acc_1 91.7603
[2021-03-02 01:01:11,257] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 01:01:11,272] default_module.py->log_info line:141 [INFO]lr=5.6267e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 01:01:29,646] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 0/355 train_loss 0.0685  train_acc_1 100.0000
[2021-03-02 01:04:29,057] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 100/355 train_loss 0.1816  train_acc_1 93.2893
[2021-03-02 01:07:28,728] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 200/355 train_loss 0.1818  train_acc_1 93.4771
[2021-03-02 01:10:27,872] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 300/355 train_loss 0.1678  train_acc_1 94.0938
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 01:12:40,770] default_module.py->log_info line:141 [INFO]Valid Epoch 46/100 step 400/89 valid_loss 0.2862  valid_acc_1 91.3043
[2021-03-02 01:12:58,173] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9553    0.9175    0.9737    0.9360    0.9452    0.8884       303
          1     0.9483    0.9106    0.9698    0.9291    0.9397    0.8778       302
          2     0.8341    0.9378    0.9405    0.8829    0.9392    0.8818       193

avg / total     0.9233    0.9198    0.9642    0.9205    0.9417    0.8828       798

Covid class AUC=0.9788239692373425
ACC=0.9197994987468672
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.00998872049739 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.00998872049739 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00046: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00046: valid_acc_1  was not in top 1
[2021-03-02 01:12:58,259] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1706  train_acc_1 94.0845
[2021-03-02 01:12:58,260] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2600  valid_acc_1 92.0100
[2021-03-02 01:12:58,260] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 01:12:58,269] default_module.py->log_info line:141 [INFO]lr=5.4705e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 01:13:15,198] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 0/355 train_loss 0.0507  train_acc_1 100.0000
[2021-03-02 01:16:14,680] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 100/355 train_loss 0.1160  train_acc_1 96.1496
[2021-03-02 01:19:14,266] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 200/355 train_loss 0.1460  train_acc_1 94.8038
[2021-03-02 01:22:13,658] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 300/355 train_loss 0.1478  train_acc_1 94.8320
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 01:24:28,047] default_module.py->log_info line:141 [INFO]Valid Epoch 47/100 step 400/89 valid_loss 0.2541  valid_acc_1 91.5459
[2021-03-02 01:24:45,411] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9446    0.9010    0.9677    0.9223    0.9337    0.8661       303
          1     0.8816    0.9371    0.9234    0.9085    0.9302    0.8665       302
          2     0.9096    0.8860    0.9719    0.8976    0.9280    0.8537       193

avg / total     0.9123    0.9110    0.9519    0.9111    0.9310    0.8632       798

Covid class AUC=0.9702721106601153
ACC=0.9110275689223057
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.13608118121543 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.13608118121543 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00047: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00047: valid_acc_1  was not in top 1
[2021-03-02 01:24:45,506] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1626  train_acc_1 94.4914
[2021-03-02 01:24:45,507] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2573  valid_acc_1 91.1361
[2021-03-02 01:24:45,507] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 01:24:45,520] default_module.py->log_info line:141 [INFO]lr=5.3140e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 01:25:01,959] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 0/355 train_loss 0.4144  train_acc_1 77.7778
[2021-03-02 01:28:01,403] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 100/355 train_loss 0.1578  train_acc_1 94.6095
[2021-03-02 01:31:00,671] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 200/355 train_loss 0.1554  train_acc_1 94.8590
[2021-03-02 01:33:59,889] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 300/355 train_loss 0.1509  train_acc_1 94.9797
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 01:36:13,621] default_module.py->log_info line:141 [INFO]Valid Epoch 48/100 step 400/89 valid_loss 0.4278  valid_acc_1 86.7150
[2021-03-02 01:36:31,048] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9772    0.8482    0.9879    0.9081    0.9154    0.8262       303
          1     0.8719    0.9238    0.9173    0.8971    0.9206    0.8480       302
          2     0.8465    0.9430    0.9455    0.8922    0.9442    0.8914       193

avg / total     0.9057    0.8997    0.9509    0.9001    0.9243    0.8502       798

Covid class AUC=0.9732428968169194
ACC=0.899749373433584
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.01248550415039 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.01248550415039 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00048: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00048: valid_acc_1  was not in top 1
[2021-03-02 01:36:31,141] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1521  train_acc_1 94.9296
[2021-03-02 01:36:31,142] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3146  valid_acc_1 90.0125
[2021-03-02 01:36:31,142] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 01:36:31,155] default_module.py->log_info line:141 [INFO]lr=5.1571e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 01:36:47,237] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 0/355 train_loss 0.1320  train_acc_1 100.0000
[2021-03-02 01:39:46,829] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 100/355 train_loss 0.1528  train_acc_1 95.1595
[2021-03-02 01:42:46,466] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 200/355 train_loss 0.1397  train_acc_1 95.2460
[2021-03-02 01:45:45,742] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 300/355 train_loss 0.1317  train_acc_1 95.4965
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 01:47:58,296] default_module.py->log_info line:141 [INFO]Valid Epoch 49/100 step 400/89 valid_loss 0.2195  valid_acc_1 92.7536
[2021-03-02 01:48:15,635] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9371    0.9340    0.9616    0.9355    0.9477    0.8957       303
          1     0.9550    0.9139    0.9738    0.9340    0.9434    0.8846       302
          2     0.8599    0.9223    0.9521    0.8900    0.9371    0.8755       193

avg / total     0.9252    0.9236    0.9639    0.9239    0.9435    0.8866       798

Covid class AUC=0.9760534607989746
ACC=0.9235588972431078
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.38452079858672 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.38452079858672 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00049: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00049: valid_acc_1  was not in top 1
[2021-03-02 01:48:15,715] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1347  train_acc_1 95.3052
[2021-03-02 01:48:15,716] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2312  valid_acc_1 92.3845
[2021-03-02 01:48:15,716] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 01:48:15,725] default_module.py->log_info line:141 [INFO]lr=5.0000e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 01:48:31,424] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 0/355 train_loss 0.2516  train_acc_1 77.7778
[2021-03-02 01:51:30,679] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 100/355 train_loss 0.1542  train_acc_1 95.2695
[2021-03-02 01:54:29,747] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 200/355 train_loss 0.1369  train_acc_1 95.5777
[2021-03-02 01:57:28,619] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 300/355 train_loss 0.1510  train_acc_1 94.9059
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 01:59:41,623] default_module.py->log_info line:141 [INFO]Valid Epoch 50/100 step 400/89 valid_loss 0.2566  valid_acc_1 93.2367
[2021-03-02 01:59:58,899] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9371    0.9340    0.9616    0.9355    0.9477    0.8957       303
          1     0.9719    0.9172    0.9839    0.9438    0.9500    0.8964       302
          2     0.8626    0.9430    0.9521    0.9010    0.9475    0.8970       193

avg / total     0.9322    0.9298    0.9677    0.9303    0.9485    0.8963       798

Covid class AUC=0.9690837961973937
ACC=0.9298245614035088
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.00874028580913 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.00874028580913 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00050: valid_acc_1 reached 93.00874 (best 93.00874), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=50-valid_acc_1=93.01.ckpt as top 1
INFO:lightning:
Epoch 00050: valid_acc_1 reached 93.00874 (best 93.00874), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=50-valid_acc_1=93.01.ckpt as top 1
[2021-03-02 01:59:59,478] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1491  train_acc_1 94.9609
[2021-03-02 01:59:59,479] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2406  valid_acc_1 93.0087
[2021-03-02 01:59:59,479] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 01:59:59,487] default_module.py->log_info line:141 [INFO]lr=4.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 02:00:16,279] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 0/355 train_loss 0.0848  train_acc_1 100.0000
[2021-03-02 02:03:15,688] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 100/355 train_loss 0.1608  train_acc_1 94.2794
[2021-03-02 02:06:15,563] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 200/355 train_loss 0.1444  train_acc_1 94.7485
[2021-03-02 02:09:14,886] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 300/355 train_loss 0.1494  train_acc_1 94.6106
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 02:11:30,798] default_module.py->log_info line:141 [INFO]Valid Epoch 51/100 step 400/89 valid_loss 0.1690  valid_acc_1 94.9275
[2021-03-02 02:11:48,295] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9474    0.9505    0.9677    0.9489    0.9590    0.9182       303
          1     0.9305    0.9305    0.9577    0.9305    0.9440    0.8886       302
          2     0.9062    0.9016    0.9702    0.9039    0.9353    0.8687       193

avg / total     0.9310    0.9311    0.9645    0.9310    0.9476    0.8950       798

Covid class AUC=0.9764807199316385
ACC=0.931077694235589
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.13358392608299 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.13358392608299 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00051: valid_acc_1 reached 93.13358 (best 93.13358), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=51-valid_acc_1=93.13.ckpt as top 1
INFO:lightning:
Epoch 00051: valid_acc_1 reached 93.13358 (best 93.13358), saving model to ./output/ccccii_mc3_18_bs9_s64/version_0/checkpoints/epoch=51-valid_acc_1=93.13.ckpt as top 1
[2021-03-02 02:11:48,883] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1461  train_acc_1 94.6479
[2021-03-02 02:11:48,883] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2329  valid_acc_1 93.1336
[2021-03-02 02:11:48,883] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 02:11:48,894] default_module.py->log_info line:141 [INFO]lr=4.6860e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 02:12:07,589] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 0/355 train_loss 0.2400  train_acc_1 88.8889
[2021-03-02 02:15:07,448] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 100/355 train_loss 0.1448  train_acc_1 95.5996
[2021-03-02 02:18:06,947] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 200/355 train_loss 0.1506  train_acc_1 94.8038
[2021-03-02 02:21:06,193] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 300/355 train_loss 0.1487  train_acc_1 94.7951
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 02:23:20,294] default_module.py->log_info line:141 [INFO]Valid Epoch 52/100 step 400/89 valid_loss 0.2907  valid_acc_1 91.3043
[2021-03-02 02:23:37,724] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9246    0.9307    0.9535    0.9276    0.9420    0.8854       303
          1     0.9850    0.8675    0.9919    0.9225    0.9277    0.8498       302
          2     0.8018    0.9430    0.9256    0.8667    0.9343    0.8744       193

avg / total     0.9177    0.9098    0.9613    0.9110    0.9347    0.8693       798

Covid class AUC=0.9747449797051913
ACC=0.9097744360902256
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.0112373694945 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.0112373694945 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00052: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00052: valid_acc_1  was not in top 1
[2021-03-02 02:23:37,808] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1451  train_acc_1 94.9296
[2021-03-02 02:23:37,808] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3005  valid_acc_1 91.0112
[2021-03-02 02:23:37,809] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 02:23:37,823] default_module.py->log_info line:141 [INFO]lr=4.5295e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 02:23:55,079] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 0/355 train_loss 0.5874  train_acc_1 66.6667
[2021-03-02 02:26:54,720] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 100/355 train_loss 0.1452  train_acc_1 94.3894
[2021-03-02 02:29:54,017] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 200/355 train_loss 0.1438  train_acc_1 94.9696
[2021-03-02 02:32:53,108] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 300/355 train_loss 0.1401  train_acc_1 95.2381
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 02:35:06,612] default_module.py->log_info line:141 [INFO]Valid Epoch 53/100 step 400/89 valid_loss 0.2385  valid_acc_1 92.9952
[2021-03-02 02:35:24,014] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9400    0.9307    0.9636    0.9353    0.9470    0.8939       303
          1     0.9418    0.9106    0.9657    0.9259    0.9378    0.8745       302
          2     0.8835    0.9430    0.9603    0.9123    0.9516    0.9040       193

avg / total     0.9270    0.9261    0.9636    0.9262    0.9446    0.8890       798

Covid class AUC=0.9745580538346507
ACC=0.9260651629072681
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.63420842202862 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.63420842202862 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00053: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00053: valid_acc_1  was not in top 1
[2021-03-02 02:35:24,116] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1368  train_acc_1 95.3991
[2021-03-02 02:35:24,117] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2466  valid_acc_1 92.6342
[2021-03-02 02:35:24,117] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 02:35:24,128] default_module.py->log_info line:141 [INFO]lr=4.3733e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 02:35:40,522] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 0/355 train_loss 0.1408  train_acc_1 100.0000
[2021-03-02 02:38:40,295] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 100/355 train_loss 0.1119  train_acc_1 96.2596
[2021-03-02 02:41:39,966] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 200/355 train_loss 0.1328  train_acc_1 95.1354
[2021-03-02 02:44:39,080] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 300/355 train_loss 0.1353  train_acc_1 95.4227
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 02:46:52,958] default_module.py->log_info line:141 [INFO]Valid Epoch 54/100 step 400/89 valid_loss 0.2060  valid_acc_1 92.5121
[2021-03-02 02:47:10,262] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9367    0.9274    0.9616    0.9320    0.9443    0.8887       303
          1     0.9458    0.9238    0.9677    0.9347    0.9455    0.8901       302
          2     0.8867    0.9326    0.9620    0.9091    0.9472    0.8946       193

avg / total     0.9280    0.9273    0.9640    0.9275    0.9455    0.8907       798

Covid class AUC=0.9777224417859431
ACC=0.9273182957393483
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.75905249092017 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.75905249092017 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00054: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00054: valid_acc_1  was not in top 1
[2021-03-02 02:47:10,356] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1343  train_acc_1 95.3678
[2021-03-02 02:47:10,356] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2021  valid_acc_1 92.7591
[2021-03-02 02:47:10,356] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 02:47:10,368] default_module.py->log_info line:141 [INFO]lr=4.2178e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 02:47:29,059] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 0/355 train_loss 0.0815  train_acc_1 100.0000
[2021-03-02 02:50:28,331] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 100/355 train_loss 0.1329  train_acc_1 95.2695
[2021-03-02 02:53:27,567] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 200/355 train_loss 0.1324  train_acc_1 95.4671
[2021-03-02 02:56:26,617] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 300/355 train_loss 0.1283  train_acc_1 95.6442
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 02:58:39,698] default_module.py->log_info line:141 [INFO]Valid Epoch 55/100 step 400/89 valid_loss 0.2737  valid_acc_1 91.7874
[2021-03-02 02:58:57,123] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9126    0.9307    0.9455    0.9216    0.9380    0.8786       303
          1     0.9636    0.8775    0.9798    0.9185    0.9272    0.8510       302
          2     0.8271    0.9171    0.9388    0.8698    0.9279    0.8591       193

avg / total     0.9112    0.9073    0.9569    0.9079    0.9315    0.8635       798

Covid class AUC=0.9638031403546251
ACC=0.9072681704260651
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.76154918884963 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.76154918884963 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00055: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00055: valid_acc_1  was not in top 1
[2021-03-02 02:58:57,220] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1308  train_acc_1 95.6808
[2021-03-02 02:58:57,220] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2930  valid_acc_1 90.7615
[2021-03-02 02:58:57,220] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 02:58:57,233] default_module.py->log_info line:141 [INFO]lr=4.0631e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 02:59:12,875] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 0/355 train_loss 0.1106  train_acc_1 88.8889
[2021-03-02 03:02:12,761] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 100/355 train_loss 0.1274  train_acc_1 96.3696
[2021-03-02 03:05:12,610] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 200/355 train_loss 0.1285  train_acc_1 96.4069
[2021-03-02 03:08:12,014] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 300/355 train_loss 0.1232  train_acc_1 96.3824
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 03:10:25,014] default_module.py->log_info line:141 [INFO]Valid Epoch 56/100 step 400/89 valid_loss 0.1865  valid_acc_1 93.4783
[2021-03-02 03:10:42,533] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9048    0.9406    0.9394    0.9223    0.9400    0.8837       303
          1     0.9354    0.9106    0.9617    0.9228    0.9358    0.8712       302
          2     0.8942    0.8756    0.9669    0.8848    0.9202    0.8390       193

avg / total     0.9138    0.9135    0.9545    0.9134    0.9336    0.8682       798

Covid class AUC=0.9790843302713095
ACC=0.9135338345864662
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.38576893324263 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.38576893324263 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00056: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00056: valid_acc_1  was not in top 1
[2021-03-02 03:10:42,626] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1207  train_acc_1 96.4006
[2021-03-02 03:10:42,626] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2692  valid_acc_1 91.3858
[2021-03-02 03:10:42,626] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 03:10:42,635] default_module.py->log_info line:141 [INFO]lr=3.9093e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 03:11:00,894] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 0/355 train_loss 0.1700  train_acc_1 88.8889
[2021-03-02 03:14:00,463] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 100/355 train_loss 0.1026  train_acc_1 97.0297
[2021-03-02 03:17:00,301] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 200/355 train_loss 0.1191  train_acc_1 96.1305
[2021-03-02 03:20:00,007] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 300/355 train_loss 0.1142  train_acc_1 96.3824
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 03:22:13,195] default_module.py->log_info line:141 [INFO]Valid Epoch 57/100 step 400/89 valid_loss 0.2329  valid_acc_1 92.0290
[2021-03-02 03:22:30,534] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9360    0.9175    0.9616    0.9267    0.9393    0.8784       303
          1     0.9358    0.9172    0.9617    0.9264    0.9392    0.8782       302
          2     0.8927    0.9482    0.9636    0.9196    0.9559    0.9123       193

avg / total     0.9255    0.9248    0.9621    0.9249    0.9433    0.8865       798

Covid class AUC=0.9708595919675282
ACC=0.924812030075188
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.50936452458414 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.50936452458414 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00057: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00057: valid_acc_1  was not in top 1
[2021-03-02 03:22:30,620] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1195  train_acc_1 96.2441
[2021-03-02 03:22:30,621] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2271  valid_acc_1 92.5094
[2021-03-02 03:22:30,621] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 03:22:30,633] default_module.py->log_info line:141 [INFO]lr=3.7566e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 03:22:46,989] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 0/355 train_loss 0.0791  train_acc_1 100.0000
[2021-03-02 03:25:46,741] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 100/355 train_loss 0.1275  train_acc_1 95.9296
[2021-03-02 03:28:46,756] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 200/355 train_loss 0.1126  train_acc_1 96.4069
[2021-03-02 03:31:46,199] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 300/355 train_loss 0.1095  train_acc_1 96.4932
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 03:34:01,212] default_module.py->log_info line:141 [INFO]Valid Epoch 58/100 step 400/89 valid_loss 0.2429  valid_acc_1 93.9614
[2021-03-02 03:34:18,614] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9037    0.9604    0.9374    0.9312    0.9488    0.9023       303
          1     0.9852    0.8841    0.9919    0.9319    0.9365    0.8675       302
          2     0.8585    0.9119    0.9521    0.8844    0.9318    0.8647       193

avg / total     0.9236    0.9198    0.9616    0.9202    0.9400    0.8801       798

Covid class AUC=0.9761869792779321
ACC=0.9197994987468672
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.00998850618855 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.00998850618855 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00058: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00058: valid_acc_1  was not in top 1
[2021-03-02 03:34:18,719] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1095  train_acc_1 96.5258
[2021-03-02 03:34:18,719] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2912  valid_acc_1 92.0100
[2021-03-02 03:34:18,719] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 03:34:18,733] default_module.py->log_info line:141 [INFO]lr=3.6050e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 03:34:36,911] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 0/355 train_loss 0.0110  train_acc_1 100.0000
[2021-03-02 03:37:36,557] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 100/355 train_loss 0.0950  train_acc_1 96.8097
[2021-03-02 03:40:36,583] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 200/355 train_loss 0.1017  train_acc_1 96.3516
[2021-03-02 03:43:36,531] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 300/355 train_loss 0.0992  train_acc_1 96.6777
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 03:45:51,729] default_module.py->log_info line:141 [INFO]Valid Epoch 59/100 step 400/89 valid_loss 0.2715  valid_acc_1 90.5797
[2021-03-02 03:46:09,204] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9485    0.9109    0.9697    0.9293    0.9398    0.8781       303
          1     0.9016    0.9106    0.9395    0.9061    0.9249    0.8530       302
          2     0.8564    0.8964    0.9521    0.8759    0.9238    0.8487       193

avg / total     0.9085    0.9073    0.9540    0.9076    0.9303    0.8615       798

Covid class AUC=0.9750120166631062
ACC=0.9072681704260651
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.76154940315847 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.76154940315847 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00059: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00059: valid_acc_1  was not in top 1
[2021-03-02 03:46:09,307] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1086  train_acc_1 96.4632
[2021-03-02 03:46:09,308] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2817  valid_acc_1 90.7615
[2021-03-02 03:46:09,308] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 03:46:09,319] default_module.py->log_info line:141 [INFO]lr=3.4549e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 03:46:26,241] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 0/355 train_loss 0.2493  train_acc_1 88.8889
[2021-03-02 03:49:25,959] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 100/355 train_loss 0.1129  train_acc_1 96.6997
[2021-03-02 03:52:25,821] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 200/355 train_loss 0.1020  train_acc_1 96.6833
[2021-03-02 03:55:25,482] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 300/355 train_loss 0.1072  train_acc_1 96.4563
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 03:57:38,935] default_module.py->log_info line:141 [INFO]Valid Epoch 60/100 step 400/89 valid_loss 0.3013  valid_acc_1 91.7874
[2021-03-02 03:57:56,332] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9465    0.9340    0.9677    0.9402    0.9507    0.9008       303
          1     0.9851    0.8775    0.9919    0.9282    0.9330    0.8604       302
          2     0.8261    0.9845    0.9339    0.8983    0.9588    0.9240       193

avg / total     0.9320    0.9248    0.9687    0.9255    0.9459    0.8911       798

Covid class AUC=0.97619365520188
ACC=0.924812030075188
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.50936426741353 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.50936426741353 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00060: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00060: valid_acc_1  was not in top 1
[2021-03-02 03:57:56,435] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1047  train_acc_1 96.5258
[2021-03-02 03:57:56,435] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2596  valid_acc_1 92.5094
[2021-03-02 03:57:56,436] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 03:57:56,450] default_module.py->log_info line:141 [INFO]lr=3.3063e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 03:58:16,337] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 0/355 train_loss 0.1659  train_acc_1 88.8889
[2021-03-02 04:01:15,769] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 100/355 train_loss 0.1030  train_acc_1 95.7096
[2021-03-02 04:04:15,814] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 200/355 train_loss 0.0973  train_acc_1 96.3516
[2021-03-02 04:07:15,502] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 300/355 train_loss 0.0957  train_acc_1 96.5301
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 04:09:29,340] default_module.py->log_info line:141 [INFO]Valid Epoch 61/100 step 400/89 valid_loss 0.2269  valid_acc_1 92.0290
[2021-03-02 04:09:46,789] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9648    0.9043    0.9798    0.9336    0.9413    0.8793       303
          1     0.8705    0.9570    0.9133    0.9117    0.9349    0.8778       302
          2     0.9066    0.8549    0.9719    0.8800    0.9115    0.8212       193

avg / total     0.9150    0.9123    0.9527    0.9123    0.9317    0.8647       798

Covid class AUC=0.9777958769493698
ACC=0.9122807017543859
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.26092512152168 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.26092512152168 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00061: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00061: valid_acc_1  was not in top 1
[2021-03-02 04:09:46,891] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0932  train_acc_1 96.7762
[2021-03-02 04:09:46,892] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2463  valid_acc_1 91.2609
[2021-03-02 04:09:46,892] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 04:09:46,902] default_module.py->log_info line:141 [INFO]lr=3.1594e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 04:10:04,798] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 0/355 train_loss 0.1902  train_acc_1 88.8889
[2021-03-02 04:13:04,786] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 100/355 train_loss 0.0706  train_acc_1 97.1397
[2021-03-02 04:16:04,565] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 200/355 train_loss 0.0914  train_acc_1 96.6280
[2021-03-02 04:19:04,311] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 300/355 train_loss 0.0958  train_acc_1 96.5670
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 04:21:17,574] default_module.py->log_info line:141 [INFO]Valid Epoch 62/100 step 400/89 valid_loss 0.2022  valid_acc_1 92.9952
[2021-03-02 04:21:34,914] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9172    0.9142    0.9495    0.9157    0.9317    0.8650       303
          1     0.8854    0.9470    0.9254    0.9152    0.9361    0.8783       302
          2     0.9364    0.8394    0.9818    0.8852    0.9078    0.8124       193

avg / total     0.9098    0.9085    0.9482    0.9081    0.9276    0.8573       798

Covid class AUC=0.9672479171117282
ACC=0.9085213032581454
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.88639330060295 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.88639330060295 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00062: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00062: valid_acc_1  was not in top 1
[2021-03-02 04:21:35,006] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0952  train_acc_1 96.6510
[2021-03-02 04:21:35,007] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2877  valid_acc_1 90.8864
[2021-03-02 04:21:35,007] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 04:21:35,021] default_module.py->log_info line:141 [INFO]lr=3.0143e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 04:21:52,090] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 0/355 train_loss 0.0145  train_acc_1 100.0000
[2021-03-02 04:24:51,678] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 100/355 train_loss 0.1180  train_acc_1 95.7096
[2021-03-02 04:27:51,607] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 200/355 train_loss 0.1009  train_acc_1 96.2963
[2021-03-02 04:30:51,281] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 300/355 train_loss 0.1023  train_acc_1 96.4193
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 04:33:05,544] default_module.py->log_info line:141 [INFO]Valid Epoch 63/100 step 400/89 valid_loss 0.2780  valid_acc_1 91.7874
[2021-03-02 04:33:23,005] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9396    0.9241    0.9636    0.9318    0.9437    0.8870       303
          1     0.9615    0.9106    0.9778    0.9354    0.9436    0.8844       302
          2     0.8551    0.9482    0.9488    0.8993    0.9485    0.8996       193

avg / total     0.9275    0.9248    0.9654    0.9253    0.9448    0.8890       798

Covid class AUC=0.9775955992309335
ACC=0.924812030075188
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.50936461030767 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.50936461030767 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00063: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00063: valid_acc_1  was not in top 1
[2021-03-02 04:33:23,099] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1012  train_acc_1 96.3380
[2021-03-02 04:33:23,099] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2422  valid_acc_1 92.5094
[2021-03-02 04:33:23,099] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 04:33:23,112] default_module.py->log_info line:141 [INFO]lr=2.8711e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 04:33:41,228] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 0/355 train_loss 0.0168  train_acc_1 100.0000
[2021-03-02 04:36:40,800] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 100/355 train_loss 0.0916  train_acc_1 97.3597
[2021-03-02 04:39:41,116] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 200/355 train_loss 0.0878  train_acc_1 97.3466
[2021-03-02 04:42:41,659] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 300/355 train_loss 0.0816  train_acc_1 97.5637
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 04:44:57,739] default_module.py->log_info line:141 [INFO]Valid Epoch 64/100 step 400/89 valid_loss 0.2351  valid_acc_1 93.2367
[2021-03-02 04:45:15,208] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9342    0.9373    0.9596    0.9357    0.9484    0.8974       303
          1     0.9456    0.9205    0.9677    0.9329    0.9438    0.8866       302
          2     0.8850    0.9171    0.9620    0.9008    0.9393    0.8783       193

avg / total     0.9266    0.9261    0.9633    0.9262    0.9445    0.8887       798

Covid class AUC=0.9739705725272377
ACC=0.9260651629072681
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.63420867919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.63420867919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00064: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00064: valid_acc_1  was not in top 1
[2021-03-02 04:45:15,289] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0830  train_acc_1 97.4961
[2021-03-02 04:45:15,289] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2441  valid_acc_1 92.6342
[2021-03-02 04:45:15,289] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 04:45:15,297] default_module.py->log_info line:141 [INFO]lr=2.7300e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 04:45:31,873] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 0/355 train_loss 0.0219  train_acc_1 100.0000
[2021-03-02 04:48:31,679] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 100/355 train_loss 0.0771  train_acc_1 98.0198
[2021-03-02 04:51:31,724] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 200/355 train_loss 0.0902  train_acc_1 97.3466
[2021-03-02 04:54:31,633] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 300/355 train_loss 0.0929  train_acc_1 97.1207
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 04:56:44,573] default_module.py->log_info line:141 [INFO]Valid Epoch 65/100 step 400/89 valid_loss 0.2109  valid_acc_1 93.2367
[2021-03-02 04:57:01,975] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9260    0.9505    0.9535    0.9381    0.9520    0.9061       303
          1     0.9644    0.8974    0.9798    0.9297    0.9377    0.8720       302
          2     0.8835    0.9430    0.9603    0.9123    0.9516    0.9040       193

avg / total     0.9303    0.9286    0.9651    0.9287    0.9465    0.8927       798

Covid class AUC=0.9763271736808374
ACC=0.9285714285714286
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.88389638836465 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.88389638836465 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00065: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00065: valid_acc_1  was not in top 1
[2021-03-02 04:57:02,067] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0940  train_acc_1 97.0579
[2021-03-02 04:57:02,067] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2216  valid_acc_1 92.8839
[2021-03-02 04:57:02,067] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 04:57:02,077] default_module.py->log_info line:141 [INFO]lr=2.5912e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 04:57:18,319] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 0/355 train_loss 0.3221  train_acc_1 88.8889
[2021-03-02 05:00:17,951] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 100/355 train_loss 0.0951  train_acc_1 97.1397
[2021-03-02 05:03:17,709] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 200/355 train_loss 0.0978  train_acc_1 96.4621
[2021-03-02 05:06:17,230] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 300/355 train_loss 0.0950  train_acc_1 96.6039
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 05:08:30,437] default_module.py->log_info line:141 [INFO]Valid Epoch 66/100 step 400/89 valid_loss 0.2470  valid_acc_1 90.8213
[2021-03-02 05:08:47,801] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9205    0.9175    0.9515    0.9190    0.9343    0.8700       303
          1     0.9643    0.8940    0.9798    0.9278    0.9360    0.8685       302
          2     0.8148    0.9119    0.9339    0.8606    0.9228    0.8498       193

avg / total     0.9115    0.9073    0.9580    0.9082    0.9322    0.8645       798

Covid class AUC=0.9752523499252297
ACC=0.9072681704260651
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.7615492317114 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.7615492317114 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00066: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00066: valid_acc_1  was not in top 1
[2021-03-02 05:08:47,908] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0893  train_acc_1 96.8701
[2021-03-02 05:08:47,909] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2628  valid_acc_1 90.7615
[2021-03-02 05:08:47,909] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 05:08:47,920] default_module.py->log_info line:141 [INFO]lr=2.4548e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 05:09:05,218] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 0/355 train_loss 0.0113  train_acc_1 100.0000
[2021-03-02 05:12:05,155] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 100/355 train_loss 0.0829  train_acc_1 97.2497
[2021-03-02 05:15:05,217] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 200/355 train_loss 0.0745  train_acc_1 97.5124
[2021-03-02 05:18:05,747] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 300/355 train_loss 0.0796  train_acc_1 97.3422
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 05:21:47,063] default_module.py->log_info line:141 [INFO]Valid Epoch 67/100 step 400/89 valid_loss 0.1756  valid_acc_1 94.6860
[2021-03-02 05:22:08,876] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9182    0.9637    0.9475    0.9404    0.9556    0.9146       303
          1     0.9582    0.9106    0.9758    0.9338    0.9426    0.8828       302
          2     0.8964    0.8964    0.9669    0.8964    0.9310    0.8606       193

avg / total     0.9281    0.9273    0.9629    0.9273    0.9447    0.8895       798

Covid class AUC=0.97788933988464
ACC=0.9273182957393483
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.75905240519663 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.75905240519663 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00067: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00067: valid_acc_1  was not in top 1
[2021-03-02 05:22:08,975] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0857  train_acc_1 97.1205
[2021-03-02 05:22:08,976] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2652  valid_acc_1 92.7591
[2021-03-02 05:22:08,976] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 05:22:08,985] default_module.py->log_info line:141 [INFO]lr=2.3209e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 05:23:09,032] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 0/355 train_loss 0.0432  train_acc_1 100.0000
[2021-03-02 05:26:13,465] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 100/355 train_loss 0.0790  train_acc_1 97.3597
[2021-03-02 05:29:13,476] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 200/355 train_loss 0.0759  train_acc_1 97.5124
[2021-03-02 05:32:13,039] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 300/355 train_loss 0.0717  train_acc_1 97.7113
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 05:34:25,599] default_module.py->log_info line:141 [INFO]Valid Epoch 68/100 step 400/89 valid_loss 0.1974  valid_acc_1 93.7198
[2021-03-02 05:34:42,967] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9233    0.9538    0.9515    0.9383    0.9527    0.9078       303
          1     0.9819    0.8974    0.9899    0.9377    0.9425    0.8801       302
          2     0.8660    0.9378    0.9537    0.9005    0.9457    0.8930       193

avg / total     0.9316    0.9286    0.9666    0.9289    0.9471    0.8937       798

Covid class AUC=0.9771616641743217
ACC=0.9285714285714286
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.88389613119404 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.88389613119404 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00068: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00068: valid_acc_1  was not in top 1
[2021-03-02 05:34:43,046] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0716  train_acc_1 97.6839
[2021-03-02 05:34:43,046] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2305  valid_acc_1 92.8839
[2021-03-02 05:34:43,047] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 05:34:43,055] default_module.py->log_info line:141 [INFO]lr=2.1896e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 05:35:00,165] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 0/355 train_loss 0.0281  train_acc_1 100.0000
[2021-03-02 05:37:59,760] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 100/355 train_loss 0.0816  train_acc_1 97.1397
[2021-03-02 05:40:59,426] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 200/355 train_loss 0.0755  train_acc_1 97.4019
[2021-03-02 05:43:58,846] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 300/355 train_loss 0.0797  train_acc_1 97.2684
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 05:46:13,905] default_module.py->log_info line:141 [INFO]Valid Epoch 69/100 step 400/89 valid_loss 0.2882  valid_acc_1 90.5797
[2021-03-02 05:46:31,309] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9420    0.9109    0.9657    0.9262    0.9379    0.8748       303
          1     0.9857    0.9106    0.9919    0.9466    0.9504    0.8959       302
          2     0.8186    0.9585    0.9322    0.8831    0.9453    0.8959       193

avg / total     0.9287    0.9223    0.9675    0.9235    0.9444    0.8879       798

Covid class AUC=0.9798987929929502
ACC=0.9223057644110275
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.19725460952587 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.19725460952587 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00069: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00069: valid_acc_1  was not in top 1
[2021-03-02 05:46:31,408] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0807  train_acc_1 97.2144
[2021-03-02 05:46:31,408] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2500  valid_acc_1 92.1973
[2021-03-02 05:46:31,409] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 05:46:31,419] default_module.py->log_info line:141 [INFO]lr=2.0611e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 05:46:47,678] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 0/355 train_loss 0.0123  train_acc_1 100.0000
[2021-03-02 05:49:47,359] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 100/355 train_loss 0.0762  train_acc_1 97.4697
[2021-03-02 05:52:46,899] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 200/355 train_loss 0.0696  train_acc_1 97.9547
[2021-03-02 05:55:46,443] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 300/355 train_loss 0.0683  train_acc_1 97.8590
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 05:57:59,506] default_module.py->log_info line:141 [INFO]Valid Epoch 70/100 step 400/89 valid_loss 0.2221  valid_acc_1 92.9952
[2021-03-02 05:58:16,848] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9498    0.9373    0.9697    0.9435    0.9534    0.9059       303
          1     0.9422    0.9172    0.9657    0.9295    0.9412    0.8815       302
          2     0.8732    0.9275    0.9570    0.8995    0.9421    0.8850       193

avg / total     0.9284    0.9273    0.9651    0.9276    0.9460    0.8916       798

Covid class AUC=0.9789107562486647
ACC=0.9273182957393483
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.75905223374956 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.75905223374956 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00070: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00070: valid_acc_1  was not in top 1
[2021-03-02 05:58:16,946] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0688  train_acc_1 97.9030
[2021-03-02 05:58:16,946] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2330  valid_acc_1 92.7591
[2021-03-02 05:58:16,947] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 05:58:16,960] default_module.py->log_info line:141 [INFO]lr=1.9355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 05:58:36,186] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 0/355 train_loss 0.0106  train_acc_1 100.0000
[2021-03-02 06:01:35,701] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 100/355 train_loss 0.0857  train_acc_1 97.0297
[2021-03-02 06:04:35,250] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 200/355 train_loss 0.0844  train_acc_1 97.4572
[2021-03-02 06:07:34,864] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 300/355 train_loss 0.0808  train_acc_1 97.6375
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 06:09:48,932] default_module.py->log_info line:141 [INFO]Valid Epoch 71/100 step 400/89 valid_loss 0.2432  valid_acc_1 92.9952
[2021-03-02 06:10:06,439] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9223    0.9406    0.9515    0.9314    0.9460    0.8940       303
          1     0.9926    0.8907    0.9960    0.9389    0.9419    0.8778       302
          2     0.8486    0.9585    0.9455    0.9002    0.9520    0.9075       193

avg / total     0.9311    0.9261    0.9669    0.9267    0.9459    0.8911       798

Covid class AUC=0.9707928327280496
ACC=0.9260651629072681
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.63420816485801 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.63420816485801 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00071: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00071: valid_acc_1  was not in top 1
Epoch 00072: early stopping
INFO:lightning:Epoch 00072: early stopping
[2021-03-02 06:10:06,548] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0799  train_acc_1 97.5587
[2021-03-02 06:10:06,548] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2541  valid_acc_1 92.6342
[2021-03-02 06:10:06,548] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 06:10:06,561] default_module.py->log_info line:141 [INFO]lr=1.8129e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 06:10:24,411] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 0/355 train_loss 0.2300  train_acc_1 88.8889
[2021-03-02 06:13:24,040] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 100/355 train_loss 0.0877  train_acc_1 97.4697
[2021-03-02 06:16:24,189] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 200/355 train_loss 0.0706  train_acc_1 97.8441
[2021-03-02 06:19:23,730] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 300/355 train_loss 0.0747  train_acc_1 97.7852
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 06:21:39,438] default_module.py->log_info line:141 [INFO]Valid Epoch 72/100 step 400/89 valid_loss 0.1798  valid_acc_1 94.6860
[2021-03-02 06:21:56,795] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9065    0.9604    0.9394    0.9327    0.9498    0.9041       303
          1     0.9714    0.9007    0.9839    0.9347    0.9413    0.8788       302
          2     0.8934    0.9119    0.9653    0.9026    0.9382    0.8756       193

avg / total     0.9279    0.9261    0.9625    0.9262    0.9438    0.8876       798

Covid class AUC=0.9766743217261269
ACC=0.9260651629072681
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.63420833630508 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.63420833630508 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00072: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00072: valid_acc_1  was not in top 1
Epoch 00073: early stopping
INFO:lightning:Epoch 00073: early stopping
[2021-03-02 06:21:56,887] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0727  train_acc_1 97.8091
[2021-03-02 06:21:56,887] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2432  valid_acc_1 92.6342
[2021-03-02 06:21:56,887] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 06:21:56,898] default_module.py->log_info line:141 [INFO]lr=1.6934e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 06:22:13,843] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 0/355 train_loss 0.0062  train_acc_1 100.0000
[2021-03-02 06:25:13,582] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 100/355 train_loss 0.0596  train_acc_1 98.2398
[2021-03-02 06:28:13,278] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 200/355 train_loss 0.0578  train_acc_1 98.3416
[2021-03-02 06:31:12,968] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 300/355 train_loss 0.0670  train_acc_1 98.0805
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 06:33:26,524] default_module.py->log_info line:141 [INFO]Valid Epoch 73/100 step 400/89 valid_loss 0.2490  valid_acc_1 92.7536
[2021-03-02 06:33:43,926] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9406    0.9406    0.9636    0.9406    0.9520    0.9043       303
          1     0.9786    0.9073    0.9879    0.9416    0.9467    0.8891       302
          2     0.8419    0.9378    0.9438    0.8873    0.9408    0.8846       193

avg / total     0.9311    0.9273    0.9680    0.9281    0.9473    0.8938       798

Covid class AUC=0.9783566545609913
ACC=0.9273182957393483
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.7590523194731 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.7590523194731 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00073: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00073: valid_acc_1  was not in top 1
Epoch 00074: early stopping
INFO:lightning:Epoch 00074: early stopping
[2021-03-02 06:33:44,023] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0674  train_acc_1 97.9969
[2021-03-02 06:33:44,023] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2446  valid_acc_1 92.7591
[2021-03-02 06:33:44,023] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 06:33:44,035] default_module.py->log_info line:141 [INFO]lr=1.5773e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 06:33:59,379] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 0/355 train_loss 0.0157  train_acc_1 100.0000
[2021-03-02 06:36:59,049] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 100/355 train_loss 0.0508  train_acc_1 98.1298
[2021-03-02 06:39:58,577] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 200/355 train_loss 0.0596  train_acc_1 97.9547
[2021-03-02 06:42:57,992] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 300/355 train_loss 0.0592  train_acc_1 98.1174
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 06:45:12,940] default_module.py->log_info line:141 [INFO]Valid Epoch 74/100 step 400/89 valid_loss 0.4242  valid_acc_1 89.1304
[2021-03-02 06:45:30,362] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9573    0.8878    0.9758    0.9212    0.9307    0.8586       303
          1     0.9517    0.9139    0.9718    0.9324    0.9424    0.8830       302
          2     0.8062    0.9482    0.9273    0.8714    0.9377    0.8811       193

avg / total     0.9186    0.9123    0.9625    0.9134    0.9368    0.8733       798

Covid class AUC=0.9760067293313395
ACC=0.9122807017543859
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.26092512152168 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.26092512152168 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00074: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00074: valid_acc_1  was not in top 1
Epoch 00075: early stopping
INFO:lightning:Epoch 00075: early stopping
[2021-03-02 06:45:30,469] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0634  train_acc_1 97.8717
[2021-03-02 06:45:30,470] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3331  valid_acc_1 91.2609
[2021-03-02 06:45:30,470] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 06:45:30,479] default_module.py->log_info line:141 [INFO]lr=1.4645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 06:45:46,262] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 0/355 train_loss 0.0939  train_acc_1 100.0000
[2021-03-02 06:48:46,184] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 100/355 train_loss 0.0655  train_acc_1 97.5798
[2021-03-02 06:51:46,027] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 200/355 train_loss 0.0613  train_acc_1 98.0100
[2021-03-02 06:54:45,603] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 300/355 train_loss 0.0674  train_acc_1 97.6375
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 06:56:59,195] default_module.py->log_info line:141 [INFO]Valid Epoch 75/100 step 400/89 valid_loss 0.1969  valid_acc_1 94.6860
[2021-03-02 06:57:16,577] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9408    0.9439    0.9636    0.9423    0.9537    0.9078       303
          1     0.9493    0.9305    0.9698    0.9398    0.9499    0.8988       302
          2     0.8889    0.9119    0.9636    0.9003    0.9374    0.8742       193

avg / total     0.9315    0.9311    0.9660    0.9312    0.9483    0.8963       798

Covid class AUC=0.979918820764794
ACC=0.931077694235589
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.13358409753006 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.13358409753006 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00075: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00075: valid_acc_1  was not in top 1
Epoch 00076: early stopping
INFO:lightning:Epoch 00076: early stopping
[2021-03-02 06:57:16,680] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0711  train_acc_1 97.5587
[2021-03-02 06:57:16,680] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2273  valid_acc_1 93.1336
[2021-03-02 06:57:16,680] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 06:57:16,691] default_module.py->log_info line:141 [INFO]lr=1.3552e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 06:57:32,523] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 0/355 train_loss 0.0179  train_acc_1 100.0000
[2021-03-02 07:00:32,317] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 100/355 train_loss 0.0573  train_acc_1 98.5699
[2021-03-02 07:03:32,153] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 200/355 train_loss 0.0610  train_acc_1 98.3969
[2021-03-02 07:06:31,779] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 300/355 train_loss 0.0554  train_acc_1 98.4865
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 07:08:46,155] default_module.py->log_info line:141 [INFO]Valid Epoch 76/100 step 400/89 valid_loss 0.2831  valid_acc_1 91.0628
[2021-03-02 07:09:03,574] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9452    0.9109    0.9677    0.9277    0.9389    0.8764       303
          1     0.9272    0.9272    0.9556    0.9272    0.9413    0.8835       302
          2     0.8676    0.9171    0.9554    0.8917    0.9360    0.8728       193

avg / total     0.9196    0.9185    0.9601    0.9188    0.9391    0.8782       798

Covid class AUC=0.9744178594317454
ACC=0.918546365914787
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.88514478019114 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.88514478019114 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00076: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00076: valid_acc_1  was not in top 1
Epoch 00077: early stopping
INFO:lightning:Epoch 00077: early stopping
[2021-03-02 07:09:03,673] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0572  train_acc_1 98.3099
[2021-03-02 07:09:03,673] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2716  valid_acc_1 91.8851
[2021-03-02 07:09:03,673] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 07:09:03,685] default_module.py->log_info line:141 [INFO]lr=1.2494e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 07:09:20,755] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 0/355 train_loss 0.3042  train_acc_1 77.7778
[2021-03-02 07:12:20,453] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 100/355 train_loss 0.0587  train_acc_1 98.4598
[2021-03-02 07:15:20,620] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 200/355 train_loss 0.0654  train_acc_1 98.0100
[2021-03-02 07:18:20,452] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 300/355 train_loss 0.0583  train_acc_1 98.3389
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 07:20:34,705] default_module.py->log_info line:141 [INFO]Valid Epoch 77/100 step 400/89 valid_loss 0.2425  valid_acc_1 91.7874
[2021-03-02 07:20:52,131] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9272    0.9241    0.9556    0.9256    0.9397    0.8802       303
          1     0.9719    0.9172    0.9839    0.9438    0.9500    0.8964       302
          2     0.8341    0.9119    0.9421    0.8713    0.9269    0.8566       193

avg / total     0.9216    0.9185    0.9630    0.9194    0.9405    0.8806       798

Covid class AUC=0.9766943494979704
ACC=0.918546365914787
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.88514478019114 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.88514478019114 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00077: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00077: valid_acc_1  was not in top 1
Epoch 00078: early stopping
INFO:lightning:Epoch 00078: early stopping
[2021-03-02 07:20:52,235] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0590  train_acc_1 98.3099
[2021-03-02 07:20:52,236] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2643  valid_acc_1 91.8851
[2021-03-02 07:20:52,236] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 07:20:52,248] default_module.py->log_info line:141 [INFO]lr=1.1474e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 07:21:07,148] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 0/355 train_loss 0.0111  train_acc_1 100.0000
[2021-03-02 07:24:06,966] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 100/355 train_loss 0.0489  train_acc_1 98.6799
[2021-03-02 07:27:06,521] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 200/355 train_loss 0.0499  train_acc_1 98.6180
[2021-03-02 07:30:06,080] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 300/355 train_loss 0.0483  train_acc_1 98.6342
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 07:32:19,115] default_module.py->log_info line:141 [INFO]Valid Epoch 78/100 step 400/89 valid_loss 0.1719  valid_acc_1 95.1691
[2021-03-02 07:32:36,603] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9206    0.9571    0.9495    0.9385    0.9533    0.9094       303
          1     0.9655    0.9272    0.9798    0.9459    0.9531    0.9037       302
          2     0.8964    0.8964    0.9669    0.8964    0.9310    0.8606       193

avg / total     0.9318    0.9311    0.9652    0.9311    0.9478    0.8955       798

Covid class AUC=0.979484885708182
ACC=0.931077694235589
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.13358401180653 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.13358401180653 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00078: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00078: valid_acc_1  was not in top 1
Epoch 00079: early stopping
INFO:lightning:Epoch 00079: early stopping
[2021-03-02 07:32:36,703] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0494  train_acc_1 98.6228
[2021-03-02 07:32:36,703] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2346  valid_acc_1 93.1336
[2021-03-02 07:32:36,703] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 07:32:36,717] default_module.py->log_info line:141 [INFO]lr=1.0492e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 07:32:53,664] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 0/355 train_loss 0.0100  train_acc_1 100.0000
[2021-03-02 07:35:53,765] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 100/355 train_loss 0.0624  train_acc_1 97.9098
[2021-03-02 07:38:53,506] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 200/355 train_loss 0.0733  train_acc_1 97.5677
[2021-03-02 07:41:53,286] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 300/355 train_loss 0.0644  train_acc_1 97.9697
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 07:44:08,809] default_module.py->log_info line:141 [INFO]Valid Epoch 79/100 step 400/89 valid_loss 0.1917  valid_acc_1 93.4783
[2021-03-02 07:44:26,381] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9194    0.9406    0.9495    0.9299    0.9450    0.8923       303
          1     0.9618    0.9172    0.9778    0.9390    0.9470    0.8914       302
          2     0.8850    0.9171    0.9620    0.9008    0.9393    0.8783       193

avg / total     0.9271    0.9261    0.9632    0.9263    0.9444    0.8886       798

Covid class AUC=0.9800456633198034
ACC=0.9260651629072681
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.63420842202862 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.63420842202862 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00079: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00079: valid_acc_1  was not in top 1
Epoch 00080: early stopping
INFO:lightning:Epoch 00080: early stopping
[2021-03-02 07:44:26,486] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0603  train_acc_1 98.1221
[2021-03-02 07:44:26,486] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2268  valid_acc_1 92.6342
[2021-03-02 07:44:26,486] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 07:44:26,498] default_module.py->log_info line:141 [INFO]lr=9.5492e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 07:44:45,408] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 0/355 train_loss 0.3885  train_acc_1 88.8889
[2021-03-02 07:47:45,347] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 100/355 train_loss 0.0710  train_acc_1 97.6898
[2021-03-02 07:50:45,225] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 200/355 train_loss 0.0642  train_acc_1 97.8994
[2021-03-02 07:53:44,967] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 300/355 train_loss 0.0646  train_acc_1 97.8590
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 07:55:58,371] default_module.py->log_info line:141 [INFO]Valid Epoch 80/100 step 400/89 valid_loss 0.2494  valid_acc_1 92.2705
[2021-03-02 07:56:15,802] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9186    0.9307    0.9495    0.9246    0.9400    0.8820       303
          1     0.9613    0.9040    0.9778    0.9317    0.9402    0.8774       302
          2     0.8647    0.9275    0.9537    0.8950    0.9405    0.8822       193

avg / total     0.9217    0.9198    0.9612    0.9201    0.9402    0.8803       798

Covid class AUC=0.9776690343943601
ACC=0.9197994987468672
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.00998893480623 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.00998893480623 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00080: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00080: valid_acc_1  was not in top 1
Epoch 00081: early stopping
INFO:lightning:Epoch 00081: early stopping
[2021-03-02 07:56:15,895] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0647  train_acc_1 97.8717
[2021-03-02 07:56:15,896] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2593  valid_acc_1 92.0100
[2021-03-02 07:56:15,896] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 07:56:15,908] default_module.py->log_info line:141 [INFO]lr=8.6460e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 07:56:32,537] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 0/355 train_loss 0.0593  train_acc_1 100.0000
[2021-03-02 07:59:32,283] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 100/355 train_loss 0.0422  train_acc_1 99.0099
[2021-03-02 08:02:32,263] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 200/355 train_loss 0.0451  train_acc_1 98.6733
[2021-03-02 08:05:32,304] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 300/355 train_loss 0.0485  train_acc_1 98.5604
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 08:07:45,820] default_module.py->log_info line:141 [INFO]Valid Epoch 81/100 step 400/89 valid_loss 0.2231  valid_acc_1 93.2367
[2021-03-02 08:08:03,236] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9251    0.9373    0.9535    0.9311    0.9454    0.8923       303
          1     0.9550    0.9139    0.9738    0.9340    0.9434    0.8846       302
          2     0.8861    0.9275    0.9620    0.9063    0.9446    0.8891       193

avg / total     0.9270    0.9261    0.9632    0.9262    0.9444    0.8886       798

Covid class AUC=0.9783566545609912
ACC=0.9260651629072681
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.63420850775215 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.63420850775215 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00081: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00081: valid_acc_1  was not in top 1
Epoch 00082: early stopping
INFO:lightning:Epoch 00082: early stopping
[2021-03-02 08:08:03,331] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0482  train_acc_1 98.5915
[2021-03-02 08:08:03,331] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2369  valid_acc_1 92.6342
[2021-03-02 08:08:03,331] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 08:08:03,340] default_module.py->log_info line:141 [INFO]lr=7.7836e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 08:08:21,464] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 0/355 train_loss 0.0015  train_acc_1 100.0000
[2021-03-02 08:11:21,109] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 100/355 train_loss 0.0605  train_acc_1 98.2398
[2021-03-02 08:14:21,184] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 200/355 train_loss 0.0562  train_acc_1 98.2863
[2021-03-02 08:17:20,925] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 300/355 train_loss 0.0553  train_acc_1 98.3020
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 08:19:34,322] default_module.py->log_info line:141 [INFO]Valid Epoch 82/100 step 400/89 valid_loss 0.2971  valid_acc_1 91.0628
[2021-03-02 08:19:51,757] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9300    0.9208    0.9576    0.9254    0.9390    0.8785       303
          1     0.9677    0.8940    0.9819    0.9294    0.9369    0.8701       302
          2     0.8447    0.9585    0.9438    0.8981    0.9511    0.9060       193

avg / total     0.9237    0.9198    0.9634    0.9203    0.9412    0.8820       798

Covid class AUC=0.9771616641743218
ACC=0.9197994987468672
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.00998850618855 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.00998850618855 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00082: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00082: valid_acc_1  was not in top 1
Epoch 00083: early stopping
INFO:lightning:Epoch 00083: early stopping
[2021-03-02 08:19:51,855] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0583  train_acc_1 98.1847
[2021-03-02 08:19:51,856] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2794  valid_acc_1 92.0100
[2021-03-02 08:19:51,856] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 08:19:51,870] default_module.py->log_info line:141 [INFO]lr=6.9629e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 08:20:08,920] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 0/355 train_loss 0.0165  train_acc_1 100.0000
[2021-03-02 08:23:08,724] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 100/355 train_loss 0.0545  train_acc_1 98.0198
[2021-03-02 08:26:08,836] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 200/355 train_loss 0.0506  train_acc_1 98.4522
[2021-03-02 08:29:08,396] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 300/355 train_loss 0.0548  train_acc_1 98.3020
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 08:31:21,577] default_module.py->log_info line:141 [INFO]Valid Epoch 83/100 step 400/89 valid_loss 0.2554  valid_acc_1 92.5121
[2021-03-02 08:31:38,993] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9164    0.9406    0.9475    0.9283    0.9440    0.8906       303
          1     0.9640    0.8874    0.9798    0.9241    0.9325    0.8615       302
          2     0.8517    0.9223    0.9488    0.8856    0.9354    0.8727       193

avg / total     0.9188    0.9160    0.9600    0.9164    0.9376    0.8752       798

Covid class AUC=0.9758798867763299
ACC=0.9160401002506265
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.63545698530218 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.63545698530218 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00083: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00083: valid_acc_1  was not in top 1
Epoch 00084: early stopping
INFO:lightning:Epoch 00084: early stopping
[2021-03-02 08:31:39,100] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0513  train_acc_1 98.4664
[2021-03-02 08:31:39,101] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2770  valid_acc_1 91.6355
[2021-03-02 08:31:39,101] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 08:31:39,115] default_module.py->log_info line:141 [INFO]lr=6.1847e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 08:31:56,152] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 0/355 train_loss 0.0046  train_acc_1 100.0000
[2021-03-02 08:34:56,112] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 100/355 train_loss 0.0652  train_acc_1 98.0198
[2021-03-02 08:37:56,210] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 200/355 train_loss 0.0570  train_acc_1 98.4522
[2021-03-02 08:40:55,911] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 300/355 train_loss 0.0523  train_acc_1 98.4865
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 08:43:09,095] default_module.py->log_info line:141 [INFO]Valid Epoch 84/100 step 400/89 valid_loss 0.2534  valid_acc_1 92.5121
[2021-03-02 08:43:26,482] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9360    0.9175    0.9616    0.9267    0.9393    0.8784       303
          1     0.9369    0.9338    0.9617    0.9353    0.9476    0.8955       302
          2     0.8800    0.9119    0.9603    0.8957    0.9358    0.8715       193

avg / total     0.9228    0.9223    0.9613    0.9224    0.9416    0.8832       798

Covid class AUC=0.9784234138004699
ACC=0.9223057644110275
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.25967664397164 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.25967664397164 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00084: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00084: valid_acc_1  was not in top 1
Epoch 00085: early stopping
INFO:lightning:Epoch 00085: early stopping
[2021-03-02 08:43:26,589] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0501  train_acc_1 98.5290
[2021-03-02 08:43:26,589] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2524  valid_acc_1 92.2597
[2021-03-02 08:43:26,589] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 08:43:26,602] default_module.py->log_info line:141 [INFO]lr=5.4497e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 08:43:42,944] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 0/355 train_loss 0.0263  train_acc_1 100.0000
[2021-03-02 08:46:42,615] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 100/355 train_loss 0.0451  train_acc_1 98.5699
[2021-03-02 08:49:42,638] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 200/355 train_loss 0.0445  train_acc_1 98.5627
[2021-03-02 08:52:42,431] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 300/355 train_loss 0.0451  train_acc_1 98.4865
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 08:54:55,979] default_module.py->log_info line:141 [INFO]Valid Epoch 85/100 step 400/89 valid_loss 0.2781  valid_acc_1 91.5459
[2021-03-02 08:55:13,331] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9456    0.9175    0.9677    0.9313    0.9423    0.8834       303
          1     0.9652    0.9172    0.9798    0.9406    0.9480    0.8931       302
          2     0.8433    0.9482    0.9438    0.8927    0.9460    0.8953       193

avg / total     0.9283    0.9248    0.9665    0.9255    0.9453    0.8899       798

Covid class AUC=0.9781964323862422
ACC=0.924812030075188
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.5093644388606 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.5093644388606 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00085: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00085: valid_acc_1  was not in top 1
Epoch 00086: early stopping
INFO:lightning:Epoch 00086: early stopping
[2021-03-02 08:55:13,440] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0430  train_acc_1 98.5915
[2021-03-02 08:55:13,441] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2556  valid_acc_1 92.5094
[2021-03-02 08:55:13,441] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 08:55:13,455] default_module.py->log_info line:141 [INFO]lr=4.7586e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 08:55:31,191] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 0/355 train_loss 0.0438  train_acc_1 100.0000
[2021-03-02 08:58:30,833] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 100/355 train_loss 0.0413  train_acc_1 99.0099
[2021-03-02 09:01:30,892] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 200/355 train_loss 0.0464  train_acc_1 98.8944
[2021-03-02 09:04:30,461] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 300/355 train_loss 0.0435  train_acc_1 98.8926
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 09:06:44,055] default_module.py->log_info line:141 [INFO]Valid Epoch 86/100 step 400/89 valid_loss 0.2681  valid_acc_1 92.2705
[2021-03-02 09:07:01,477] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9458    0.9208    0.9677    0.9331    0.9439    0.8869       303
          1     0.9586    0.9205    0.9758    0.9392    0.9478    0.8933       302
          2     0.8685    0.9585    0.9537    0.9113    0.9561    0.9146       193

avg / total     0.9320    0.9298    0.9674    0.9301    0.9483    0.8960       798

Covid class AUC=0.9787171544541764
ACC=0.9298245614035088
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.00874037153265 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.00874037153265 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00086: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00086: valid_acc_1  was not in top 1
Epoch 00087: early stopping
INFO:lightning:Epoch 00087: early stopping
[2021-03-02 09:07:01,587] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0416  train_acc_1 98.8732
[2021-03-02 09:07:01,587] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2519  valid_acc_1 93.0087
[2021-03-02 09:07:01,588] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 09:07:01,601] default_module.py->log_info line:141 [INFO]lr=4.1123e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 09:07:19,266] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 0/355 train_loss 0.0034  train_acc_1 100.0000
[2021-03-02 09:10:19,015] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 100/355 train_loss 0.0343  train_acc_1 98.7899
[2021-03-02 09:13:18,640] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 200/355 train_loss 0.0346  train_acc_1 98.8944
[2021-03-02 09:16:17,991] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 300/355 train_loss 0.0361  train_acc_1 98.9295
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 09:18:31,747] default_module.py->log_info line:141 [INFO]Valid Epoch 87/100 step 400/89 valid_loss 0.2281  valid_acc_1 92.7536
[2021-03-02 09:18:49,193] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9276    0.9307    0.9556    0.9292    0.9430    0.8871       303
          1     0.9517    0.9139    0.9718    0.9324    0.9424    0.8830       302
          2     0.8824    0.9326    0.9603    0.9068    0.9464    0.8932       193

avg / total     0.9258    0.9248    0.9628    0.9250    0.9436    0.8870       798

Covid class AUC=0.9779227195043794
ACC=0.924812030075188
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.5093644388606 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.5093644388606 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00087: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00087: valid_acc_1  was not in top 1
Epoch 00088: early stopping
INFO:lightning:Epoch 00088: early stopping
[2021-03-02 09:18:49,302] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0373  train_acc_1 98.9045
[2021-03-02 09:18:49,302] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2579  valid_acc_1 92.5094
[2021-03-02 09:18:49,303] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 09:18:49,314] default_module.py->log_info line:141 [INFO]lr=3.5112e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 09:19:07,291] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 0/355 train_loss 0.0147  train_acc_1 100.0000
[2021-03-02 09:22:06,782] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 100/355 train_loss 0.0307  train_acc_1 99.0099
[2021-03-02 09:25:06,769] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 200/355 train_loss 0.0374  train_acc_1 98.8391
[2021-03-02 09:28:06,412] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 300/355 train_loss 0.0385  train_acc_1 98.8188
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 09:30:20,668] default_module.py->log_info line:141 [INFO]Valid Epoch 88/100 step 400/89 valid_loss 0.2283  valid_acc_1 92.9952
[2021-03-02 09:30:38,060] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9188    0.9340    0.9495    0.9264    0.9417    0.8854       303
          1     0.9522    0.9238    0.9718    0.9378    0.9475    0.8935       302
          2     0.8629    0.8808    0.9554    0.8718    0.9173    0.8352       193

avg / total     0.9179    0.9173    0.9593    0.9175    0.9380    0.8763       798

Covid class AUC=0.9797986541337321
ACC=0.9172932330827067
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.76030079702313 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.76030079702313 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00088: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00088: valid_acc_1  was not in top 1
Epoch 00089: early stopping
INFO:lightning:Epoch 00089: early stopping
[2021-03-02 09:30:38,170] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0392  train_acc_1 98.7480
[2021-03-02 09:30:38,170] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2660  valid_acc_1 91.7603
[2021-03-02 09:30:38,171] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 09:30:38,181] default_module.py->log_info line:141 [INFO]lr=2.9560e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 09:30:54,764] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 0/355 train_loss 0.0045  train_acc_1 100.0000
[2021-03-02 09:33:54,214] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 100/355 train_loss 0.0490  train_acc_1 98.4598
[2021-03-02 09:36:53,756] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 200/355 train_loss 0.0447  train_acc_1 98.6733
[2021-03-02 09:39:52,955] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 300/355 train_loss 0.0445  train_acc_1 98.7818
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 09:42:06,029] default_module.py->log_info line:141 [INFO]Valid Epoch 89/100 step 400/89 valid_loss 0.3038  valid_acc_1 91.3043
[2021-03-02 09:42:23,443] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9485    0.9109    0.9697    0.9293    0.9398    0.8781       303
          1     0.9333    0.9272    0.9597    0.9302    0.9433    0.8869       302
          2     0.8696    0.9326    0.9554    0.9000    0.9439    0.8890       193

avg / total     0.9237    0.9223    0.9624    0.9226    0.9421    0.8841       798

Covid class AUC=0.9796584597308268
ACC=0.9223057644110275
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.25967681541871 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.25967681541871 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00089: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00089: valid_acc_1  was not in top 1
Epoch 00090: early stopping
INFO:lightning:Epoch 00090: early stopping
[2021-03-02 09:42:23,544] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0439  train_acc_1 98.7480
[2021-03-02 09:42:23,544] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2619  valid_acc_1 92.2597
[2021-03-02 09:42:23,545] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 09:42:23,554] default_module.py->log_info line:141 [INFO]lr=2.4472e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 09:42:39,599] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 0/355 train_loss 0.0105  train_acc_1 100.0000
[2021-03-02 09:45:39,245] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 100/355 train_loss 0.0369  train_acc_1 98.7899
[2021-03-02 09:48:39,152] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 200/355 train_loss 0.0380  train_acc_1 98.8391
[2021-03-02 09:51:38,472] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 300/355 train_loss 0.0476  train_acc_1 98.5234
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 09:53:51,827] default_module.py->log_info line:141 [INFO]Valid Epoch 90/100 step 400/89 valid_loss 0.2408  valid_acc_1 92.5121
[2021-03-02 09:54:09,342] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9430    0.9274    0.9657    0.9351    0.9463    0.8921       303
          1     0.9586    0.9205    0.9758    0.9392    0.9478    0.8933       302
          2     0.8619    0.9378    0.9521    0.8983    0.9449    0.8916       193

avg / total     0.9293    0.9273    0.9662    0.9277    0.9465    0.8924       798

Covid class AUC=0.9788640247810296
ACC=0.9273182957393483
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.75905214802603 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.75905214802603 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00090: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00090: valid_acc_1  was not in top 1
Epoch 00091: early stopping
INFO:lightning:Epoch 00091: early stopping
[2021-03-02 09:54:09,467] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0468  train_acc_1 98.5290
[2021-03-02 09:54:09,467] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2446  valid_acc_1 92.7591
[2021-03-02 09:54:09,467] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 09:54:09,480] default_module.py->log_info line:141 [INFO]lr=1.9853e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 09:54:27,987] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 0/355 train_loss 0.0258  train_acc_1 100.0000
[2021-03-02 09:57:28,074] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 100/355 train_loss 0.0491  train_acc_1 98.6799
[2021-03-02 10:00:27,857] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 200/355 train_loss 0.0583  train_acc_1 98.0652
[2021-03-02 10:03:29,274] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 300/355 train_loss 0.0501  train_acc_1 98.4127
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 10:05:48,685] default_module.py->log_info line:141 [INFO]Valid Epoch 91/100 step 400/89 valid_loss 0.2239  valid_acc_1 93.4783
[2021-03-02 10:06:06,240] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9288    0.9472    0.9556    0.9379    0.9514    0.9043       303
          1     0.9752    0.9106    0.9859    0.9418    0.9475    0.8910       302
          2     0.8696    0.9326    0.9554    0.9000    0.9439    0.8890       193

avg / total     0.9320    0.9298    0.9670    0.9302    0.9481    0.8956       798

Covid class AUC=0.9787438581499679
ACC=0.9298245614035088
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.00874020008558 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.00874020008558 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00091: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00091: valid_acc_1  was not in top 1
Epoch 00092: early stopping
INFO:lightning:Epoch 00092: early stopping
[2021-03-02 10:06:06,440] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0475  train_acc_1 98.4977
[2021-03-02 10:06:06,440] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2488  valid_acc_1 93.0087
[2021-03-02 10:06:06,441] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 10:06:06,454] default_module.py->log_info line:141 [INFO]lr=1.5708e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 10:06:26,742] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 0/355 train_loss 0.0027  train_acc_1 100.0000
[2021-03-02 10:09:26,881] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 100/355 train_loss 0.0376  train_acc_1 98.6799
[2021-03-02 10:12:26,570] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 200/355 train_loss 0.0373  train_acc_1 98.9497
[2021-03-02 10:15:26,156] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 300/355 train_loss 0.0400  train_acc_1 98.7449
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 10:17:41,446] default_module.py->log_info line:141 [INFO]Valid Epoch 92/100 step 400/89 valid_loss 0.2659  valid_acc_1 91.3043
[2021-03-02 10:17:58,833] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9356    0.9109    0.9616    0.9231    0.9359    0.8715       303
          1     0.9458    0.9238    0.9677    0.9347    0.9455    0.8901       302
          2     0.8558    0.9223    0.9504    0.8878    0.9362    0.8741       193

avg / total     0.9201    0.9185    0.9612    0.9189    0.9396    0.8792       798

Covid class AUC=0.97788933988464
ACC=0.918546365914787
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.88514478019114 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.88514478019114 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00092: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00092: valid_acc_1  was not in top 1
Epoch 00093: early stopping
INFO:lightning:Epoch 00093: early stopping
[2021-03-02 10:17:58,948] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0428  train_acc_1 98.6541
[2021-03-02 10:17:58,948] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2570  valid_acc_1 91.8851
[2021-03-02 10:17:58,949] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 10:17:58,960] default_module.py->log_info line:141 [INFO]lr=1.2042e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 10:18:18,274] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 0/355 train_loss 0.0109  train_acc_1 100.0000
[2021-03-02 10:21:17,881] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 100/355 train_loss 0.0375  train_acc_1 99.0099
[2021-03-02 10:24:17,600] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 200/355 train_loss 0.0341  train_acc_1 99.1155
[2021-03-02 10:27:16,914] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 300/355 train_loss 0.0339  train_acc_1 99.1510
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 10:29:30,620] default_module.py->log_info line:141 [INFO]Valid Epoch 93/100 step 400/89 valid_loss 0.2531  valid_acc_1 92.2705
[2021-03-02 10:29:47,982] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9362    0.9208    0.9616    0.9285    0.9410    0.8818       303
          1     0.9492    0.9272    0.9698    0.9380    0.9482    0.8953       302
          2     0.8634    0.9171    0.9537    0.8894    0.9352    0.8715       193

avg / total     0.9235    0.9223    0.9628    0.9226    0.9423    0.8844       798

Covid class AUC=0.9793847468489638
ACC=0.9223057644110275
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.25967655824812 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.25967655824812 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00093: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00093: valid_acc_1  was not in top 1
Epoch 00094: early stopping
INFO:lightning:Epoch 00094: early stopping
[2021-03-02 10:29:48,097] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0338  train_acc_1 99.0610
[2021-03-02 10:29:48,098] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2476  valid_acc_1 92.2597
[2021-03-02 10:29:48,098] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 10:29:48,112] default_module.py->log_info line:141 [INFO]lr=8.8564e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 10:30:04,654] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 0/355 train_loss 0.0372  train_acc_1 100.0000
[2021-03-02 10:33:04,098] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 100/355 train_loss 0.0361  train_acc_1 99.0099
[2021-03-02 10:36:03,463] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 200/355 train_loss 0.0318  train_acc_1 99.2814
[2021-03-02 10:39:03,043] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 300/355 train_loss 0.0333  train_acc_1 99.2617
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 10:41:16,441] default_module.py->log_info line:141 [INFO]Valid Epoch 94/100 step 400/89 valid_loss 0.2268  valid_acc_1 92.9952
[2021-03-02 10:41:33,804] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9279    0.9340    0.9556    0.9309    0.9447    0.8906       303
          1     0.9586    0.9205    0.9758    0.9392    0.9478    0.8933       302
          2     0.8719    0.9171    0.9570    0.8939    0.9368    0.8742       193

avg / total     0.9260    0.9248    0.9636    0.9251    0.9440    0.8876       798

Covid class AUC=0.9791911450544756
ACC=0.924812030075188
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.50936452458414 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.50936452458414 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00094: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00094: valid_acc_1  was not in top 1
Epoch 00095: early stopping
INFO:lightning:Epoch 00095: early stopping
[2021-03-02 10:41:33,921] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0330  train_acc_1 99.3114
[2021-03-02 10:41:33,921] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2464  valid_acc_1 92.5094
[2021-03-02 10:41:33,921] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 10:41:33,934] default_module.py->log_info line:141 [INFO]lr=6.1558e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 10:41:50,682] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 0/355 train_loss 0.2067  train_acc_1 88.8889
[2021-03-02 10:44:50,199] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 100/355 train_loss 0.0257  train_acc_1 99.5600
[2021-03-02 10:47:50,191] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 200/355 train_loss 0.0354  train_acc_1 99.1155
[2021-03-02 10:50:49,757] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 300/355 train_loss 0.0342  train_acc_1 99.1510
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 10:53:03,622] default_module.py->log_info line:141 [INFO]Valid Epoch 95/100 step 400/89 valid_loss 0.2310  valid_acc_1 92.7536
[2021-03-02 10:53:20,974] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9305    0.9274    0.9576    0.9289    0.9424    0.8854       303
          1     0.9621    0.9238    0.9778    0.9426    0.9504    0.8985       302
          2     0.8738    0.9326    0.9570    0.9023    0.9448    0.8904       193

avg / total     0.9287    0.9273    0.9651    0.9276    0.9460    0.8915       798

Covid class AUC=0.979057626575518
ACC=0.9273182957393483
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.7590523194731 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.7590523194731 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00095: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00095: valid_acc_1  was not in top 1
Epoch 00096: early stopping
INFO:lightning:Epoch 00096: early stopping
[2021-03-02 10:53:21,080] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0346  train_acc_1 99.1236
[2021-03-02 10:53:21,081] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2488  valid_acc_1 92.7591
[2021-03-02 10:53:21,081] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 10:53:21,092] default_module.py->log_info line:141 [INFO]lr=3.9426e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 10:53:37,166] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 0/355 train_loss 0.0085  train_acc_1 100.0000
[2021-03-02 10:56:36,864] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 100/355 train_loss 0.0338  train_acc_1 98.7899
[2021-03-02 10:59:36,362] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 200/355 train_loss 0.0439  train_acc_1 98.5075
[2021-03-02 11:02:35,426] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 300/355 train_loss 0.0437  train_acc_1 98.5234
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 11:04:50,417] default_module.py->log_info line:141 [INFO]Valid Epoch 96/100 step 400/89 valid_loss 0.2116  valid_acc_1 94.2029
[2021-03-02 11:05:07,736] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9314    0.9406    0.9576    0.9360    0.9490    0.8992       303
          1     0.9559    0.9338    0.9738    0.9447    0.9536    0.9057       302
          2     0.8883    0.9067    0.9636    0.8974    0.9348    0.8688       193

avg / total     0.9303    0.9298    0.9652    0.9300    0.9473    0.8943       798

Covid class AUC=0.979751922666097
ACC=0.9298245614035088
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.00874020008558 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.00874020008558 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00096: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00096: valid_acc_1  was not in top 1
Epoch 00097: early stopping
INFO:lightning:Epoch 00097: early stopping
[2021-03-02 11:05:07,847] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0421  train_acc_1 98.5915
[2021-03-02 11:05:07,847] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2427  valid_acc_1 93.0087
[2021-03-02 11:05:07,847] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 11:05:07,860] default_module.py->log_info line:141 [INFO]lr=2.2190e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 11:05:24,993] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 0/355 train_loss 0.0223  train_acc_1 100.0000
[2021-03-02 11:08:24,228] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 100/355 train_loss 0.0371  train_acc_1 98.5699
[2021-03-02 11:11:23,808] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 200/355 train_loss 0.0373  train_acc_1 98.9497
[2021-03-02 11:14:23,028] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 300/355 train_loss 0.0399  train_acc_1 98.8557
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 11:16:36,262] default_module.py->log_info line:141 [INFO]Valid Epoch 97/100 step 400/89 valid_loss 0.2538  valid_acc_1 92.2705
[2021-03-02 11:16:53,686] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9424    0.9175    0.9657    0.9298    0.9413    0.8817       303
          1     0.9525    0.9305    0.9718    0.9414    0.9509    0.9005       302
          2     0.8654    0.9326    0.9537    0.8978    0.9431    0.8876       193

avg / total     0.9276    0.9261    0.9651    0.9264    0.9454    0.8902       798

Covid class AUC=0.9798186819055758
ACC=0.9260651629072681
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.63420825058155 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.63420825058155 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00097: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00097: valid_acc_1  was not in top 1
Epoch 00098: early stopping
INFO:lightning:Epoch 00098: early stopping
[2021-03-02 11:16:53,810] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0396  train_acc_1 98.8419
[2021-03-02 11:16:53,810] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2516  valid_acc_1 92.6342
[2021-03-02 11:16:53,811] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 11:16:53,822] default_module.py->log_info line:141 [INFO]lr=9.8664e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 11:17:10,686] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 0/355 train_loss 0.0028  train_acc_1 100.0000
[2021-03-02 11:20:10,447] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 100/355 train_loss 0.0395  train_acc_1 98.5699
[2021-03-02 11:23:09,614] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 200/355 train_loss 0.0337  train_acc_1 98.9497
[2021-03-02 11:26:08,604] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 300/355 train_loss 0.0328  train_acc_1 99.0402
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 11:28:23,213] default_module.py->log_info line:141 [INFO]Valid Epoch 98/100 step 400/89 valid_loss 0.2103  valid_acc_1 93.7198
[2021-03-02 11:28:40,643] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9311    0.9373    0.9576    0.9342    0.9474    0.8957       303
          1     0.9622    0.9272    0.9778    0.9444    0.9522    0.9020       302
          2     0.8812    0.9223    0.9603    0.9013    0.9411    0.8823       193

avg / total     0.9308    0.9298    0.9659    0.9301    0.9477    0.8949       798

Covid class AUC=0.9797385708182011
ACC=0.9298245614035088
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.00874011436206 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.00874011436206 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00098: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00098: valid_acc_1  was not in top 1
Epoch 00099: early stopping
INFO:lightning:Epoch 00099: early stopping
[2021-03-02 11:28:40,746] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0327  train_acc_1 99.0297
[2021-03-02 11:28:40,747] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2430  valid_acc_1 93.0087
[2021-03-02 11:28:40,747] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 11:28:40,758] default_module.py->log_info line:141 [INFO]lr=2.4672e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 11:28:58,641] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 0/355 train_loss 0.0150  train_acc_1 100.0000
[2021-03-02 11:31:58,144] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 100/355 train_loss 0.0355  train_acc_1 98.6799
[2021-03-02 11:34:57,764] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 200/355 train_loss 0.0410  train_acc_1 98.7286
[2021-03-02 11:37:57,004] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 300/355 train_loss 0.0365  train_acc_1 98.8926
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 11:40:10,042] default_module.py->log_info line:141 [INFO]Valid Epoch 99/100 step 400/89 valid_loss 0.2085  valid_acc_1 93.7198
[2021-03-02 11:40:27,363] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9251    0.9373    0.9535    0.9311    0.9454    0.8923       303
          1     0.9556    0.9272    0.9738    0.9412    0.9502    0.8986       302
          2     0.8788    0.9016    0.9603    0.8900    0.9305    0.8607       193

avg / total     0.9254    0.9248    0.9628    0.9250    0.9436    0.8871       798

Covid class AUC=0.9797919782097843
ACC=0.924812030075188
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.50936452458414 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.50936452458414 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00099: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00099: valid_acc_1  was not in top 1
Epoch 00100: early stopping
INFO:lightning:Epoch 00100: early stopping
[2021-03-02 11:40:27,471] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0341  train_acc_1 99.0297
[2021-03-02 11:40:27,472] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2453  valid_acc_1 92.5094
[2021-03-02 11:40:27,472] default_module.py->log_info line:141 [INFO]===========================

