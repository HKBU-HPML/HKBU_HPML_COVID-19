[2021-03-01 17:59:43,220] config.py->setup_cfg_with_hparams line:84 [INFO]Running with full config:
DEFAULT_CUDNN_BENCHMARK: True
SEED: 4966
VERSION: 1
abtfs:
    blur:
        blur_limit: 3
        enable: 0
    bright:
        clip_limit: 1
        enable: 1
    channel_dropout:
        drop_range: (1, 1)
        enable: 0
        fill_value: 127
    channel_shuffle:
        enable: 0
    cutout:
        enable: 1
        fill_value: 127
        num_holes: 10
        size: 20
    distortion:
        enable: 0
    hue:
        enable: 0
    noise:
        enable: 1
    random_grid_shuffle:
        enable: 0
        grid: 2
    rotate:
        enable: 1
        p: 1
        rotate_limit: 45
        scale_limit: 0.2
        shift_limit: 0.0625
cam:
    debug: False
    featmaps_module_name: 'glob_avgpool'
    label: -1
    model_path: ''
    save_path: './cam_results'
    scan_path: ''
    weights_module_name: 'fc'
dataloader:
    num_workers: 40
    sample_test: 'default'
    sample_train: 'default'
    sampler:
        replacement: True
        weights_cls: [0, 0.23, 0.77]
dataset:
    batch_size: 9
    dir: '/home/datasets/COVID-19_CTs/CCCCI_cleaned/dataset_cleaned'
    is_3d: True
    is_color: False
    is_train: False
    name: 'CTDataset'
    slice_num: 64
    subset_train: 1.0
    subset_valid: 1.0
    test_list: '/home/datasets/COVID-19_CTs/ccccii/ct_test.json'
    train_list: '/home/datasets/COVID-19_CTs/ccccii/ct_train.json'
    valid_list: '/home/datasets/COVID-19_CTs/ccccii/ct_test.json'
hooks:
    early_stopping:
        min_delta: 0.0
        mode: 'max'
        monitor: 'valid_acc_1'
        patience: 20
        setting: 2
        verbose: 1
    model_checkpoint:
        filepath: ''
        mode: 'max'
        monitor: 'valid_acc_1'
        period: 1
        prefix: ''
        save_top_k: 1
        save_weights_only: False
        setting: 2
        verbose: 1
hparams: Namespace(cam_only=False, config_file='./config/ccccii_config.yml', opts=['trainer.gpus', '[1]', 'model.name', 'resnet3d', 'model.model_depth', '18', 'dataset.slice_num', '64', 'dataset.batch_size', '9', 'trainer.logger.test_tube.name', 'ccccii_r3d_18_bs9_s64'], predict_only=False, test_only=False)
input:
    size: (128, 128)
label_transforms:
    name: 'default'
log:
    name: './output/ccccii_r3d_18_bs9_s64/version_3/log.txt'
    path: './output/ccccii_r3d_18_bs9_s64/version_3'
loss:
    class_weight: []
    focal_loss:
        alpha: []
        gamma: 2
        size_average: True
    label_smoothing: 0.1
    name: 'CrossEntropy'
mixup:
    alpha: 0.4
    enable: 0
model:
    classes: 3
    dropout: 0
    finetune: False
    model_depth: 18
    n_input_channels: 1
    name: 'resnet3d'
    pretrained: False
module:
    analyze_result: True
    name: 'CTModule'
optim:
    base_lr: 0.001
    momentum: 0.9
    name: 'adam'
    scheduler:
        gamma: 0.1
        milestones: [10, 25, 35, 50]
        mode: 'min'
        name: 'CosineAnnealingLR'
        patience: 10
        step_size: 10
        t_0: 5
        t_max: 100
        t_mul: 20
        verbose: True
    weight_decay: 0.0005
predict_only:
    load_ckpt:
        checkpoint_path: ''
    load_metric:
        map_location: 'cuda:0'
        on_gpu: True
        tags_csv: ''
        weights_path: ''
    to_pred_file_path: ''
    type: 'ckpt'
topk: [1, 1]
trainer:
    accumulate_grad_batches: 1
    amp_level: 'O1'
    auto_lr_find: False
    auto_scale_batch_size: False
    auto_select_gpus: False
    benchmark: False
    check_val_every_n_epoch: 1
    default_root_dir: './output'
    default_save_path: './output'
    distributed_backend: 'dp'
    fast_dev_run: False
    gpus: [1]
    gradient_clip_val: 0
    log_gpu_memory: ''
    log_save_interval: 100
    logger:
        mlflow:
            experiment_name: 'torchline_logs'
            tracking_uri: './output'
        setting: 2
        test_tube:
            name: 'ccccii_r3d_18_bs9_s64'
            save_dir: './output'
            version: -1
        type: 'test_tube'
    max_epochs: 100
    max_steps: 99999999
    min_epochs: 99
    min_steps: 99999999
    name: 'DefaultTrainer'
    num_nodes: 1
    num_sanity_val_steps: 5
    num_tpu_cores: ''
    overfit_pct: 0.0
    precision: 32
    print_nan_grads: True
    process_position: 0
    progress_bar_refresh_rate: 0
    reload_dataloaders_every_epoch: False
    replace_sampler_ddp: True
    resume_from_checkpoint: ''
    row_log_interval: 10
    show_progress_bar: False
    terminate_on_nan: False
    test_percent_check: 1.0
    track_grad_norm: -1
    train_percent_check: 1.0
    truncated_bptt_steps: ''
    use_amp: False
    val_check_interval: 1.0
    val_percent_check: 1.0
    weights_save_path: ''
    weights_summary: ''
transforms:
    ct:
        randomaffine:
            degrees: (-10, 10)
            enable: 0
            isotropic: True
            p: 0.5
            scales: (0.5, 0.5)
        randomblur:
            enable: 0
            p: 0.5
            std: (0, 4)
        randomelasticdeformation:
            enable: 0
            locked_borders: 0
            max_displacement: (7, 7, 7)
            num_control_points: (4, 4, 4)
            p: 0.5
        randomflip:
            axes: (0, 1, 2)
            enable: 1
            flip_probability: 0.5
            p: 0.5
        randomnoise:
            enable: 0
            mean: (0, 0.25)
            p: 0.5
            std: (0, 0.25)
        randomswap:
            enable: 0
            num_iterations: 100
            p: 0.5
            patch_size: (16, 16, 16)
    img:
        aug_cifar: False
        aug_imagenet: False
        center_crop:
            enable: 0
        color_jitter:
            brightness: 0.1
            contrast: 0.1
            enable: 0
            hue: 0.1
            saturation: 0.1
        random_crop:
            enable: 1
            padding: 0
        random_horizontal_flip:
            enable: 1
            p: 0.5
        random_resized_crop:
            enable: 0
            ratio: (0.75, 1.3333333333333333)
            scale: (0.5, 1.0)
        random_rotation:
            degrees: 10
            enable: 1
        random_vertical_flip:
            enable: 1
            p: 0.5
        resize:
            enable: 1
    name: 'CTTransforms'
    tensor:
        normalization:
            mean: [0.5, 0.5, 0.5]
            std: [0.5, 0.5, 0.5]
        random_erasing:
            enable: 0
            p: 0.5
            ratio: ((0.3, 3.3),)
            scale: (0.02, 0.3)
GPU available: True, used: True
No environment variable for node rank defined. Set as 0.
CUDA_VISIBLE_DEVICES: [1]
If you use TorchIO for your research, please cite the following paper:
Pérez-García et al., TorchIO: a Python library for efficient loading,
preprocessing, augmentation and patch-based sampling of medical images
in deep learning. Link: https://arxiv.org/abs/2003.04696

Generating validation transform ...
Valid transform=Compose(
)
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Sensitivity is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_ranking.py:951: UndefinedMetricWarning: No positive samples in y_true, true positive value should be meaningless
  UndefinedMetricWarning)
[2021-03-01 18:01:25,799] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000      45.0
          1     0.0000    0.0000    0.0667    0.0000    0.0000    0.0000       0.0
          2     0.0000    0.0000    0.9333    0.0000    0.0000    0.0000       0.0

avg / total     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000      45.0

Covid class AUC=nan
ACC=0.0
[2021-03-01 18:01:29,840] default_module.py->log_info line:141 [INFO]lr=1.0000e-03
Generating training transform ...
Train transform=Compose(
    <torchio.transforms.augmentation.spatial.random_flip.RandomFlip object at 0x7ffaef9886a0>
)
Generating validation transform ...
Valid transform=Compose(
)
None
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:02:38,289] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 0/355 train_loss 1.1418  train_acc_1 22.2222
[2021-03-01 18:04:32,343] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 100/355 train_loss 1.0898  train_acc_1 51.0451
[2021-03-01 18:07:11,343] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 200/355 train_loss 0.9977  train_acc_1 54.0077
[2021-03-01 18:09:07,143] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 300/355 train_loss 0.9373  train_acc_1 57.7704
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:11:57,531] default_module.py->log_info line:141 [INFO]Valid Epoch 0/100 step 400/89 valid_loss 0.6321  valid_acc_1 70.1525
[2021-03-01 18:12:07,289] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6111    0.8713    0.6606    0.7184    0.7587    0.5877       303
          1     0.7406    0.5199    0.8891    0.6109    0.6799    0.4452       302
          2     0.7208    0.5751    0.9289    0.6398    0.7309    0.5154       193

avg / total     0.6866    0.6667    0.8120    0.6587    0.7221    0.5163       798

Covid class AUC=0.6670115894039734
ACC=0.6666666666666666
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 63.179669410624406 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)

Epoch 00000: valid_acc_1 reached 63.17967 (best 63.17967), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=0-valid_acc_1=63.18.ckpt as top 1
INFO:lightning:
Epoch 00000: valid_acc_1 reached 63.17967 (best 63.17967), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=0-valid_acc_1=63.18.ckpt as top 1
[2021-03-01 18:12:08,845] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.9233  train_acc_1 58.6541
[2021-03-01 18:12:08,845] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8199  valid_acc_1 63.1797
[2021-03-01 18:12:08,845] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:12:08,859] default_module.py->log_info line:141 [INFO]lr=9.9975e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:13:17,492] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 0/355 train_loss 0.7307  train_acc_1 66.6667
[2021-03-01 18:15:03,403] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 100/355 train_loss 0.8209  train_acc_1 64.5765
[2021-03-01 18:17:35,288] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 200/355 train_loss 0.8193  train_acc_1 64.0685
[2021-03-01 18:19:32,989] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 300/355 train_loss 0.8187  train_acc_1 63.3444
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:22:25,994] default_module.py->log_info line:141 [INFO]Valid Epoch 1/100 step 400/89 valid_loss 0.8009  valid_acc_1 75.8454
[2021-03-01 18:22:37,533] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6093    0.8647    0.6606    0.7149    0.7558    0.5829       303
          1     0.6986    0.4834    0.8730    0.5714    0.6496    0.4056       302
          2     0.7170    0.5907    0.9256    0.6477    0.7394    0.5284       193

avg / total     0.6691    0.6541    0.8051    0.6443    0.7117    0.5026       798

Covid class AUC=0.7926190984832301
ACC=0.6541353383458647
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 65.54307178968794 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 65.54307178968794 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00001: valid_acc_1 reached 65.54307 (best 65.54307), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=1-valid_acc_1=65.54.ckpt as top 1
INFO:lightning:
Epoch 00001: valid_acc_1 reached 65.54307 (best 65.54307), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=1-valid_acc_1=65.54.ckpt as top 1
[2021-03-01 18:22:38,939] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.8298  train_acc_1 62.5352
[2021-03-01 18:22:38,939] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8968  valid_acc_1 65.5431
[2021-03-01 18:22:38,939] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:22:38,947] default_module.py->log_info line:141 [INFO]lr=9.9901e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:23:39,504] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 0/355 train_loss 0.6565  train_acc_1 77.7778
[2021-03-01 18:25:29,502] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 100/355 train_loss 0.8205  train_acc_1 64.1364
[2021-03-01 18:27:54,651] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 200/355 train_loss 0.8149  train_acc_1 64.0685
[2021-03-01 18:29:45,065] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 300/355 train_loss 0.8117  train_acc_1 64.4518
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:32:26,234] default_module.py->log_info line:141 [INFO]Valid Epoch 2/100 step 400/89 valid_loss 2.0094  valid_acc_1 26.5700
[2021-03-01 18:32:59,761] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6667    0.0858    0.9737    0.1520    0.2891    0.0761       303
          1     0.4361    0.8477    0.3327    0.5759    0.5310    0.2965       302
          2     0.6860    0.6114    0.9107    0.6466    0.7462    0.5402       193

avg / total     0.5841    0.5013    0.7159    0.4321    0.4912    0.2718       798

Covid class AUC=0.6291591006195258
ACC=0.5012531328320802
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 50.31211060084654 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 50.31211060084654 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00002: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00002: valid_acc_1  was not in top 1
[2021-03-01 18:32:59,932] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.8046  train_acc_1 64.9452
[2021-03-01 18:32:59,933] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.3099  valid_acc_1 50.3121
[2021-03-01 18:32:59,933] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:32:59,952] default_module.py->log_info line:141 [INFO]lr=9.9778e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:33:43,053] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 0/355 train_loss 0.6903  train_acc_1 66.6667
[2021-03-01 18:35:48,902] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 100/355 train_loss 0.7897  train_acc_1 65.2365
[2021-03-01 18:38:17,524] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 200/355 train_loss 0.8162  train_acc_1 63.7922
[2021-03-01 18:39:46,803] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 300/355 train_loss 0.8073  train_acc_1 64.2303
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:42:53,888] default_module.py->log_info line:141 [INFO]Valid Epoch 3/100 step 400/89 valid_loss 0.8154  valid_acc_1 62.3188
[2021-03-01 18:43:29,847] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7462    0.6403    0.8667    0.6892    0.7449    0.5423       303
          1     0.6572    0.6159    0.8044    0.6359    0.7039    0.4861       302
          2     0.6000    0.7927    0.8314    0.6830    0.8118    0.6565       193

avg / total     0.6772    0.6679    0.8346    0.6675    0.7456    0.5487       798

Covid class AUC=0.7437913907284769
ACC=0.6679197994987469
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 66.91635518663385 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 66.91635518663385 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00003: valid_acc_1 reached 66.91636 (best 66.91636), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=3-valid_acc_1=66.92.ckpt as top 1
INFO:lightning:
Epoch 00003: valid_acc_1 reached 66.91636 (best 66.91636), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=3-valid_acc_1=66.92.ckpt as top 1
[2021-03-01 18:43:31,841] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.7986  train_acc_1 64.8513
[2021-03-01 18:43:31,841] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7599  valid_acc_1 66.9164
[2021-03-01 18:43:31,841] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:43:31,854] default_module.py->log_info line:141 [INFO]lr=9.9606e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:44:23,838] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 0/355 train_loss 0.5821  train_acc_1 88.8889
[2021-03-01 18:46:22,661] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 100/355 train_loss 0.8008  train_acc_1 65.5666
[2021-03-01 18:48:53,839] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 200/355 train_loss 0.7843  train_acc_1 66.6667
[2021-03-01 18:50:15,792] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 300/355 train_loss 0.7745  train_acc_1 66.4821
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:52:50,472] default_module.py->log_info line:141 [INFO]Valid Epoch 4/100 step 400/89 valid_loss 0.7875  valid_acc_1 67.1498
[2021-03-01 18:53:35,025] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8537    0.5776    0.9394    0.6890    0.7366    0.5229       303
          1     0.5933    0.8841    0.6310    0.7101    0.7469    0.5720       302
          2     0.8252    0.6114    0.9587    0.7024    0.7656    0.5658       193

avg / total     0.7483    0.7018    0.8274    0.7002    0.7475    0.5519       798

Covid class AUC=0.8195297479171119
ACC=0.7017543859649122
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 70.22471993692805 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 70.22471993692805 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00004: valid_acc_1 reached 70.22472 (best 70.22472), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=4-valid_acc_1=70.22.ckpt as top 1
INFO:lightning:
Epoch 00004: valid_acc_1 reached 70.22472 (best 70.22472), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=4-valid_acc_1=70.22.ckpt as top 1
[2021-03-01 18:53:38,753] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.7774  train_acc_1 66.3537
[2021-03-01 18:53:38,753] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7133  valid_acc_1 70.2247
[2021-03-01 18:53:38,753] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:53:38,763] default_module.py->log_info line:141 [INFO]lr=9.9384e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:54:28,559] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 0/355 train_loss 1.1751  train_acc_1 33.3333
[2021-03-01 18:56:41,036] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 100/355 train_loss 0.7515  train_acc_1 66.3366
[2021-03-01 18:59:02,125] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 200/355 train_loss 0.7487  train_acc_1 66.8878
[2021-03-01 19:00:12,485] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 300/355 train_loss 0.7519  train_acc_1 67.1096
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:03:08,617] default_module.py->log_info line:141 [INFO]Valid Epoch 5/100 step 400/89 valid_loss 0.7985  valid_acc_1 53.6232
[2021-03-01 19:03:40,041] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8844    0.4290    0.9657    0.5778    0.6437    0.3921       303
          1     0.5039    0.8609    0.4839    0.6357    0.6454    0.4323       302
          2     0.7630    0.5337    0.9471    0.6280    0.7110    0.4846       193

avg / total     0.7110    0.6178    0.7788    0.6119    0.6606    0.4297       798

Covid class AUC=0.6546611301004059
ACC=0.6177944862155389
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 61.92259755295314 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 61.92259755295314 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00005: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00005: valid_acc_1  was not in top 1
[2021-03-01 19:03:41,107] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.7545  train_acc_1 66.6980
[2021-03-01 19:03:41,107] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8641  valid_acc_1 61.9226
[2021-03-01 19:03:41,108] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:03:41,119] default_module.py->log_info line:141 [INFO]lr=9.9114e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:04:31,619] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 0/355 train_loss 0.8515  train_acc_1 55.5556
[2021-03-01 19:06:47,107] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 100/355 train_loss 0.7412  train_acc_1 66.9967
[2021-03-01 19:08:29,244] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 200/355 train_loss 0.7442  train_acc_1 66.5561
[2021-03-01 19:10:22,282] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 300/355 train_loss 0.7541  train_acc_1 66.9989
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:13:22,942] default_module.py->log_info line:141 [INFO]Valid Epoch 6/100 step 400/89 valid_loss 0.7038  valid_acc_1 63.0435
[2021-03-01 19:13:50,190] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8606    0.5908    0.9414    0.7006    0.7458    0.5366       303
          1     0.5450    0.7815    0.6028    0.6422    0.6864    0.4795       302
          2     0.7261    0.5907    0.9289    0.6514    0.7407    0.5301       193

avg / total     0.7086    0.6629    0.8103    0.6666    0.7221    0.5134       798

Covid class AUC=0.7724244285409101
ACC=0.6629072681704261
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 66.4169795111324 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 66.4169795111324 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00006: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00006: valid_acc_1  was not in top 1
[2021-03-01 19:13:50,263] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.7478  train_acc_1 67.1049
[2021-03-01 19:13:50,263] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7569  valid_acc_1 66.4170
[2021-03-01 19:13:50,263] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:13:50,274] default_module.py->log_info line:141 [INFO]lr=9.8796e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:14:46,402] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 0/355 train_loss 0.3653  train_acc_1 88.8889
[2021-03-01 19:16:46,646] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 100/355 train_loss 0.7158  train_acc_1 68.9769
[2021-03-01 19:18:12,479] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 200/355 train_loss 0.7021  train_acc_1 70.0387
[2021-03-01 19:20:46,688] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 300/355 train_loss 0.6999  train_acc_1 69.6936
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:23:03,342] default_module.py->log_info line:141 [INFO]Valid Epoch 7/100 step 400/89 valid_loss 0.6758  valid_acc_1 68.3575
[2021-03-01 19:23:36,139] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7143    0.6436    0.8424    0.6771    0.7363    0.5314       303
          1     0.6314    0.8113    0.7117    0.7101    0.7598    0.5831       302
          2     0.8029    0.5699    0.9554    0.6667    0.7379    0.5235       193

avg / total     0.7044    0.6892    0.8203    0.6871    0.7456    0.5491       798

Covid class AUC=0.7602742469557787
ACC=0.6892230576441103
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 68.97628052315015 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 68.97628052315015 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00007: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00007: valid_acc_1  was not in top 1
[2021-03-01 19:23:36,324] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6981  train_acc_1 69.7340
[2021-03-01 19:23:36,324] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7063  valid_acc_1 68.9763
[2021-03-01 19:23:36,324] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:23:36,335] default_module.py->log_info line:141 [INFO]lr=9.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:23:57,778] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 0/355 train_loss 0.6007  train_acc_1 77.7778
[2021-03-01 19:24:59,417] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 100/355 train_loss 0.6858  train_acc_1 69.8570
[2021-03-01 19:26:21,774] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 200/355 train_loss 0.6738  train_acc_1 71.5312
[2021-03-01 19:27:30,739] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 300/355 train_loss 0.6603  train_acc_1 72.3145
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:29:01,284] default_module.py->log_info line:141 [INFO]Valid Epoch 8/100 step 400/89 valid_loss 1.0881  valid_acc_1 41.3043
[2021-03-01 19:29:12,983] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6523    0.5512    0.8202    0.5975    0.6724    0.4399       303
          1     0.9231    0.0397    0.9980    0.0762    0.1991    0.0359       302
          2     0.3629    0.9948    0.4430    0.5319    0.6638    0.4650       193

avg / total     0.6848    0.4649    0.7962    0.3843    0.4912    0.2931       798

Covid class AUC=0.6616842020935698
ACC=0.4649122807017544
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 46.69163581762421 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 46.69163581762421 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00008: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00008: valid_acc_1  was not in top 1
[2021-03-01 19:29:13,054] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6645  train_acc_1 71.9249
[2021-03-01 19:29:13,054] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.9953  valid_acc_1 46.6916
[2021-03-01 19:29:13,054] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:29:13,065] default_module.py->log_info line:141 [INFO]lr=9.8015e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:30:01,235] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 0/355 train_loss 0.6185  train_acc_1 88.8889
[2021-03-01 19:30:59,056] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 100/355 train_loss 0.6781  train_acc_1 72.0572
[2021-03-01 19:32:29,078] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 200/355 train_loss 0.6561  train_acc_1 72.9685
[2021-03-01 19:33:24,337] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 300/355 train_loss 0.6397  train_acc_1 73.7172
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:35:13,121] default_module.py->log_info line:141 [INFO]Valid Epoch 9/100 step 400/89 valid_loss 0.7234  valid_acc_1 64.7343
[2021-03-01 19:35:19,770] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.5586    0.8020    0.6121    0.6585    0.7006    0.5002       303
          1     0.9808    0.1689    0.9980    0.2881    0.4105    0.1546       302
          2     0.5691    0.9171    0.7785    0.7024    0.8450    0.7239       193

avg / total     0.7209    0.5902    0.7984    0.5290    0.6258    0.4235       798

Covid class AUC=0.8101901303140355
ACC=0.5902255639097744
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 59.176030726914995 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 59.176030726914995 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00009: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00009: valid_acc_1  was not in top 1
[2021-03-01 19:35:19,829] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6354  train_acc_1 73.9593
[2021-03-01 19:35:19,830] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8525  valid_acc_1 59.1760
[2021-03-01 19:35:19,830] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:35:19,841] default_module.py->log_info line:141 [INFO]lr=9.7553e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:35:48,997] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 0/355 train_loss 0.5310  train_acc_1 77.7778
[2021-03-01 19:37:11,225] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 100/355 train_loss 0.6179  train_acc_1 75.1375
[2021-03-01 19:38:17,722] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 200/355 train_loss 0.6333  train_acc_1 73.2449
[2021-03-01 19:39:40,327] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 300/355 train_loss 0.6151  train_acc_1 74.3817
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:41:20,508] default_module.py->log_info line:141 [INFO]Valid Epoch 10/100 step 400/89 valid_loss 0.9491  valid_acc_1 52.6570
[2021-03-01 19:41:45,664] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9203    0.4191    0.9778    0.5760    0.6402    0.3869       303
          1     0.5078    0.8675    0.4879    0.6406    0.6506    0.4393       302
          2     0.7778    0.5803    0.9471    0.6647    0.7414    0.5295       193

avg / total     0.7297    0.6278    0.7850    0.6219    0.6686    0.4412       798

Covid class AUC=0.81579790643025
ACC=0.6278195488721805
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 62.85892748029045 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 62.85892748029045 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00010: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00010: valid_acc_1  was not in top 1
[2021-03-01 19:41:45,870] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6143  train_acc_1 74.6479
[2021-03-01 19:41:45,870] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8632  valid_acc_1 62.8589
[2021-03-01 19:41:45,870] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:41:45,885] default_module.py->log_info line:141 [INFO]lr=9.7044e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:42:10,132] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 0/355 train_loss 0.2543  train_acc_1 100.0000
[2021-03-01 19:43:24,457] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 100/355 train_loss 0.5903  train_acc_1 73.8174
[2021-03-01 19:44:41,248] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 200/355 train_loss 0.5875  train_acc_1 74.7374
[2021-03-01 19:45:58,415] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 300/355 train_loss 0.5774  train_acc_1 75.2676
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:47:25,312] default_module.py->log_info line:141 [INFO]Valid Epoch 11/100 step 400/89 valid_loss 1.3750  valid_acc_1 35.7488
[2021-03-01 19:48:02,235] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7656    0.1617    0.9697    0.2670    0.3960    0.1441       303
          1     0.4649    0.9205    0.3548    0.6178    0.5715    0.3451       302
          2     0.8309    0.5855    0.9620    0.6869    0.7505    0.5420       193

avg / total     0.6676    0.5514    0.7351    0.5013    0.5482    0.3164       798

Covid class AUC=0.8316265221106602
ACC=0.5513784461152882
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 55.243446757284445 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 55.243446757284445 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00011: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00011: valid_acc_1  was not in top 1
[2021-03-01 19:48:02,789] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5694  train_acc_1 75.8685
[2021-03-01 19:48:02,790] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.1627  valid_acc_1 55.2434
[2021-03-01 19:48:02,790] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:48:02,817] default_module.py->log_info line:141 [INFO]lr=9.6489e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:48:33,332] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 0/355 train_loss 0.3607  train_acc_1 88.8889
[2021-03-01 19:49:26,912] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 100/355 train_loss 0.5532  train_acc_1 77.5578
[2021-03-01 19:50:58,545] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 200/355 train_loss 0.5477  train_acc_1 77.9989
[2021-03-01 19:51:54,877] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 300/355 train_loss 0.5456  train_acc_1 77.3717
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:53:24,082] default_module.py->log_info line:141 [INFO]Valid Epoch 12/100 step 400/89 valid_loss 1.0565  valid_acc_1 54.8309
[2021-03-01 19:53:33,894] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9058    0.4125    0.9737    0.5669    0.6338    0.3792       303
          1     0.5215    0.9238    0.4839    0.6667    0.6686    0.4667       302
          2     0.8640    0.5596    0.9719    0.6792    0.7375    0.5214       193

avg / total     0.7503    0.6416    0.7879    0.6318    0.6720    0.4467       798

Covid class AUC=0.8733243430890836
ACC=0.6416040100250626
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 64.23221093081357 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 64.23221093081357 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00012: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00012: valid_acc_1  was not in top 1
[2021-03-01 19:53:34,196] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5424  train_acc_1 77.3083
[2021-03-01 19:53:34,196] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8975  valid_acc_1 64.2322
[2021-03-01 19:53:34,196] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:53:34,207] default_module.py->log_info line:141 [INFO]lr=9.5888e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:54:02,893] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 0/355 train_loss 0.2608  train_acc_1 88.8889
[2021-03-01 19:55:29,001] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 100/355 train_loss 0.5024  train_acc_1 80.0880
[2021-03-01 19:56:28,211] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 200/355 train_loss 0.5168  train_acc_1 78.8834
[2021-03-01 19:57:55,418] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 300/355 train_loss 0.5152  train_acc_1 79.2543
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:59:24,757] default_module.py->log_info line:141 [INFO]Valid Epoch 13/100 step 400/89 valid_loss 0.3642  valid_acc_1 89.8551
[2021-03-01 19:59:49,561] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7906    0.9472    0.8465    0.8619    0.8954    0.8098       303
          1     0.9209    0.7715    0.9597    0.8396    0.8605    0.7265       302
          2     0.7857    0.7409    0.9355    0.7627    0.8326    0.6797       193

avg / total     0.8388    0.8308    0.9109    0.8295    0.8670    0.7468       798

Covid class AUC=0.9250827814569537
ACC=0.8308270676691729
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 83.0836463671052 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 83.0836463671052 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00013: valid_acc_1 reached 83.08365 (best 83.08365), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=13-valid_acc_1=83.08.ckpt as top 1
INFO:lightning:
Epoch 00013: valid_acc_1 reached 83.08365 (best 83.08365), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=13-valid_acc_1=83.08.ckpt as top 1
[2021-03-01 19:59:50,994] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5125  train_acc_1 79.3740
[2021-03-01 19:59:50,994] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4318  valid_acc_1 83.0836
[2021-03-01 19:59:50,994] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:59:51,002] default_module.py->log_info line:141 [INFO]lr=9.5241e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:00:13,134] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 0/355 train_loss 0.6139  train_acc_1 66.6667
[2021-03-01 20:01:28,683] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 100/355 train_loss 0.4980  train_acc_1 80.0880
[2021-03-01 20:02:41,983] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 200/355 train_loss 0.4757  train_acc_1 81.3156
[2021-03-01 20:03:54,650] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 300/355 train_loss 0.4902  train_acc_1 80.2879
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:05:25,878] default_module.py->log_info line:141 [INFO]Valid Epoch 14/100 step 400/89 valid_loss 0.7160  valid_acc_1 68.3575
[2021-03-01 20:06:01,451] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.5727    0.8581    0.6081    0.6869    0.7223    0.5348       303
          1     0.9833    0.1954    0.9980    0.3260    0.4416    0.1793       302
          2     0.6127    0.9016    0.8182    0.7296    0.8589    0.7438       193

avg / total     0.7378    0.6178    0.8065    0.5606    0.6491    0.4508       798

Covid class AUC=0.819516396069216
ACC=0.6177944862155389
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 61.92259736007519 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 61.92259736007519 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00014: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00014: valid_acc_1  was not in top 1
[2021-03-01 20:06:02,021] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4902  train_acc_1 79.8748
[2021-03-01 20:06:02,021] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8417  valid_acc_1 61.9226
[2021-03-01 20:06:02,021] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:06:02,043] default_module.py->log_info line:141 [INFO]lr=9.4550e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:06:34,666] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 0/355 train_loss 0.6137  train_acc_1 66.6667
[2021-03-01 20:07:29,238] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 100/355 train_loss 0.4704  train_acc_1 82.0682
[2021-03-01 20:09:00,868] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 200/355 train_loss 0.4605  train_acc_1 81.7026
[2021-03-01 20:09:56,249] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 300/355 train_loss 0.4712  train_acc_1 81.4323
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:11:25,005] default_module.py->log_info line:141 [INFO]Valid Epoch 15/100 step 400/89 valid_loss 1.9322  valid_acc_1 33.0918
[2021-03-01 20:11:38,281] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6256    0.4356    0.8404    0.5136    0.6051    0.3513       303
          1     1.0000    0.0397    1.0000    0.0764    0.1993    0.0359       302
          2     0.3339    0.9948    0.3669    0.5000    0.6042    0.3880       193

avg / total     0.6967    0.4211    0.7863    0.3449    0.4513    0.2408       798

Covid class AUC=0.6194856868190558
ACC=0.42105263157894735
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 42.32209769259678 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 42.32209769259678 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00015: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00015: valid_acc_1  was not in top 1
[2021-03-01 20:11:38,593] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4743  train_acc_1 80.9703
[2021-03-01 20:11:38,594] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.8488  valid_acc_1 42.3221
[2021-03-01 20:11:38,594] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:11:38,605] default_module.py->log_info line:141 [INFO]lr=9.3815e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:12:08,496] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 0/355 train_loss 0.2617  train_acc_1 100.0000
[2021-03-01 20:13:30,905] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 100/355 train_loss 0.4846  train_acc_1 80.6381
[2021-03-01 20:14:36,491] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 200/355 train_loss 0.4655  train_acc_1 80.8181
[2021-03-01 20:15:56,256] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 300/355 train_loss 0.4567  train_acc_1 81.2846
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:17:27,739] default_module.py->log_info line:141 [INFO]Valid Epoch 16/100 step 400/89 valid_loss 0.2492  valid_acc_1 91.5459
[2021-03-01 20:17:50,369] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7847    0.9505    0.8404    0.8597    0.8938    0.8076       303
          1     0.8697    0.8179    0.9254    0.8430    0.8700    0.7487       302
          2     0.8844    0.6736    0.9719    0.7647    0.8091    0.6351       193

avg / total     0.8410    0.8333    0.9044    0.8304    0.8643    0.7436       798

Covid class AUC=0.928627697073275
ACC=0.8333333333333334
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 83.2709125133043 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 83.2709125133043 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00016: valid_acc_1 reached 83.27091 (best 83.27091), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=16-valid_acc_1=83.27.ckpt as top 1
INFO:lightning:
Epoch 00016: valid_acc_1 reached 83.27091 (best 83.27091), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=16-valid_acc_1=83.27.ckpt as top 1
[2021-03-01 20:17:51,928] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4533  train_acc_1 81.6901
[2021-03-01 20:17:51,928] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4069  valid_acc_1 83.2709
[2021-03-01 20:17:51,928] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:17:51,940] default_module.py->log_info line:141 [INFO]lr=9.3037e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:18:12,121] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 0/355 train_loss 0.1514  train_acc_1 100.0000
[2021-03-01 20:19:13,155] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 100/355 train_loss 0.4975  train_acc_1 80.0880
[2021-03-01 20:20:04,660] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 200/355 train_loss 0.4559  train_acc_1 81.8132
[2021-03-01 20:20:59,079] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 300/355 train_loss 0.4540  train_acc_1 82.0229
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:22:03,430] default_module.py->log_info line:141 [INFO]Valid Epoch 17/100 step 400/89 valid_loss 0.4079  valid_acc_1 84.2995
[2021-03-01 20:22:08,599] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8339    0.8614    0.8949    0.8474    0.8780    0.7683       303
          1     0.9057    0.7947    0.9496    0.8466    0.8687    0.7430       302
          2     0.7682    0.8756    0.9157    0.8184    0.8955    0.7986       193

avg / total     0.8452    0.8396    0.9206    0.8401    0.8787    0.7660       798

Covid class AUC=0.9034461119418928
ACC=0.8395989974937343
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 83.95755392781804 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 83.95755392781804 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00017: valid_acc_1 reached 83.95755 (best 83.95755), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=17-valid_acc_1=83.96.ckpt as top 1
INFO:lightning:
Epoch 00017: valid_acc_1 reached 83.95755 (best 83.95755), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=17-valid_acc_1=83.96.ckpt as top 1
[2021-03-01 20:22:09,924] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4520  train_acc_1 82.2848
[2021-03-01 20:22:09,925] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4590  valid_acc_1 83.9576
[2021-03-01 20:22:09,925] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:22:09,934] default_module.py->log_info line:141 [INFO]lr=9.2216e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:22:27,676] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 0/355 train_loss 0.2434  train_acc_1 88.8889
[2021-03-01 20:23:01,065] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 100/355 train_loss 0.4553  train_acc_1 81.4081
[2021-03-01 20:23:34,147] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 200/355 train_loss 0.4379  train_acc_1 82.5871
[2021-03-01 20:24:06,822] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 300/355 train_loss 0.4167  train_acc_1 83.4256
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:24:50,997] default_module.py->log_info line:141 [INFO]Valid Epoch 18/100 step 400/89 valid_loss 0.6981  valid_acc_1 70.7729
[2021-03-01 20:24:56,064] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8366    0.7096    0.9152    0.7679    0.8058    0.6360       303
          1     0.9343    0.6589    0.9718    0.7728    0.8002    0.6203       302
          2     0.5671    0.9637    0.7653    0.7140    0.8588    0.7522       193

avg / total     0.8084    0.7519    0.9003    0.7567    0.8165    0.6582       798

Covid class AUC=0.8757877590258492
ACC=0.7518796992481203
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.28089995866411 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.28089995866411 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00018: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00018: valid_acc_1  was not in top 1
[2021-03-01 20:24:56,139] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4179  train_acc_1 83.4742
[2021-03-01 20:24:56,140] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5955  valid_acc_1 75.2809
[2021-03-01 20:24:56,140] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:24:56,152] default_module.py->log_info line:141 [INFO]lr=9.1354e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:25:10,478] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 0/355 train_loss 0.2694  train_acc_1 100.0000
[2021-03-01 20:25:43,855] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 100/355 train_loss 0.3809  train_acc_1 85.4785
[2021-03-01 20:26:18,073] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 200/355 train_loss 0.3804  train_acc_1 85.7933
[2021-03-01 20:26:51,528] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 300/355 train_loss 0.3872  train_acc_1 85.1606
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:27:36,839] default_module.py->log_info line:141 [INFO]Valid Epoch 19/100 step 400/89 valid_loss 1.0229  valid_acc_1 61.8357
[2021-03-01 20:27:41,908] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8255    0.5776    0.9253    0.6796    0.7310    0.5158       303
          1     0.9432    0.7152    0.9738    0.8136    0.8346    0.6785       302
          2     0.5126    0.9482    0.7124    0.6655    0.8219    0.6914       193

avg / total     0.7944    0.7193    0.8921    0.7269    0.7922    0.6198       798

Covid class AUC=0.9096747489852597
ACC=0.7192982456140351
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 72.03495716780759 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 72.03495716780759 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00019: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00019: valid_acc_1  was not in top 1
[2021-03-01 20:27:41,966] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3863  train_acc_1 85.5086
[2021-03-01 20:27:41,966] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7539  valid_acc_1 72.0350
[2021-03-01 20:27:41,966] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:27:41,979] default_module.py->log_info line:141 [INFO]lr=9.0451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:27:57,578] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 0/355 train_loss 0.2748  train_acc_1 77.7778
[2021-03-01 20:28:31,004] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 100/355 train_loss 0.3994  train_acc_1 84.4885
[2021-03-01 20:29:04,079] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 200/355 train_loss 0.3769  train_acc_1 85.0746
[2021-03-01 20:29:36,786] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 300/355 train_loss 0.3941  train_acc_1 84.3854
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:30:21,616] default_module.py->log_info line:141 [INFO]Valid Epoch 20/100 step 400/89 valid_loss 1.4493  valid_acc_1 39.6135
[2021-03-01 20:30:26,662] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8000    0.2244    0.9657    0.3505    0.4655    0.2007       303
          1     0.4936    0.9007    0.4375    0.6377    0.6277    0.4123       302
          2     0.8704    0.7306    0.9653    0.7944    0.8398    0.6887       193

avg / total     0.7011    0.6028    0.7657    0.5666    0.6174    0.3988       798

Covid class AUC=0.8702400662251656
ACC=0.6027568922305765
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 60.36204836341772 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 60.36204836341772 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00020: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00020: valid_acc_1  was not in top 1
[2021-03-01 20:30:26,742] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3958  train_acc_1 84.3818
[2021-03-01 20:30:26,743] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.9948  valid_acc_1 60.3620
[2021-03-01 20:30:26,743] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:30:26,755] default_module.py->log_info line:141 [INFO]lr=8.9508e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:30:41,131] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 0/355 train_loss 0.3664  train_acc_1 77.7778
[2021-03-01 20:31:16,503] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 100/355 train_loss 0.3757  train_acc_1 84.5985
[2021-03-01 20:31:49,340] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 200/355 train_loss 0.3692  train_acc_1 84.9088
[2021-03-01 20:32:22,314] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 300/355 train_loss 0.3622  train_acc_1 85.2713
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:33:06,517] default_module.py->log_info line:141 [INFO]Valid Epoch 21/100 step 400/89 valid_loss 2.9427  valid_acc_1 29.2271
[2021-03-01 20:33:11,542] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     1.0000    0.0561    1.0000    0.1063    0.2369    0.0508       303
          1     0.4387    0.9470    0.2621    0.5996    0.4982    0.2652       302
          2     0.8450    0.5648    0.9669    0.6770    0.7390    0.5241       193

avg / total     0.7501    0.5163    0.7127    0.4310    0.4572    0.2464       798

Covid class AUC=0.8573755607776117
ACC=0.5162907268170426
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 51.747816107246315 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 51.747816107246315 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00021: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00021: valid_acc_1  was not in top 1
[2021-03-01 20:33:11,618] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3720  train_acc_1 84.8826
[2021-03-01 20:33:11,618] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 2.1309  valid_acc_1 51.7478
[2021-03-01 20:33:11,618] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:33:11,631] default_module.py->log_info line:141 [INFO]lr=8.8526e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:33:25,683] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 0/355 train_loss 0.1207  train_acc_1 100.0000
[2021-03-01 20:34:00,783] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 100/355 train_loss 0.3454  train_acc_1 88.5589
[2021-03-01 20:34:33,718] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 200/355 train_loss 0.3485  train_acc_1 87.8386
[2021-03-01 20:35:07,035] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 300/355 train_loss 0.3440  train_acc_1 87.9660
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:35:51,471] default_module.py->log_info line:141 [INFO]Valid Epoch 22/100 step 400/89 valid_loss 0.4262  valid_acc_1 83.5749
[2021-03-01 20:35:56,502] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6828    0.9307    0.7354    0.7877    0.8273    0.6978       303
          1     0.9368    0.5397    0.9778    0.6849    0.7265    0.5046       302
          2     0.7867    0.8601    0.9256    0.8218    0.8923    0.7909       193

avg / total     0.8041    0.7657    0.8731    0.7570    0.8048    0.6472       798

Covid class AUC=0.8554795983764154
ACC=0.7656641604010025
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.59176102113187 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.59176102113187 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00022: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00022: valid_acc_1  was not in top 1
[2021-03-01 20:35:56,572] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3607  train_acc_1 87.0423
[2021-03-01 20:35:56,572] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5907  valid_acc_1 76.5918
[2021-03-01 20:35:56,572] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:35:56,584] default_module.py->log_info line:141 [INFO]lr=8.7506e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:36:13,873] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 0/355 train_loss 0.7793  train_acc_1 55.5556
[2021-03-01 20:36:46,882] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 100/355 train_loss 0.3499  train_acc_1 87.8988
[2021-03-01 20:37:20,695] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 200/355 train_loss 0.3564  train_acc_1 86.8988
[2021-03-01 20:37:53,406] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 300/355 train_loss 0.3443  train_acc_1 86.7479
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:38:38,203] default_module.py->log_info line:141 [INFO]Valid Epoch 23/100 step 400/89 valid_loss 1.4349  valid_acc_1 50.0000
[2021-03-01 20:38:43,258] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8450    0.3597    0.9596    0.5046    0.5875    0.3245       303
          1     0.5180    0.9073    0.4859    0.6594    0.6640    0.4594       302
          2     0.8286    0.6010    0.9603    0.6967    0.7597    0.5565       193

avg / total     0.7172    0.6253    0.7805    0.6097    0.6581    0.4317       798

Covid class AUC=0.8790522858363599
ACC=0.62531328320802
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 62.671661366237686 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 62.671661366237686 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00023: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00023: valid_acc_1  was not in top 1
[2021-03-01 20:38:43,316] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3450  train_acc_1 86.6667
[2021-03-01 20:38:43,316] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.2065  valid_acc_1 62.6717
[2021-03-01 20:38:43,316] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:38:43,325] default_module.py->log_info line:141 [INFO]lr=8.6448e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:38:59,168] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 0/355 train_loss 0.1760  train_acc_1 100.0000
[2021-03-01 20:39:32,148] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 100/355 train_loss 0.2918  train_acc_1 89.9890
[2021-03-01 20:40:05,495] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 200/355 train_loss 0.2893  train_acc_1 89.6075
[2021-03-01 20:40:38,610] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 300/355 train_loss 0.3036  train_acc_1 88.7781
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:41:23,166] default_module.py->log_info line:141 [INFO]Valid Epoch 24/100 step 400/89 valid_loss 2.4480  valid_acc_1 28.7440
[2021-03-01 20:41:28,226] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7073    0.0957    0.9758    0.1686    0.3056    0.0852       303
          1     0.4330    0.8775    0.3004    0.5799    0.5134    0.2788       302
          2     0.7793    0.5855    0.9471    0.6686    0.7447    0.5345       193

avg / total     0.6209    0.5100    0.7132    0.4452    0.4904    0.2671       798

Covid class AUC=0.8427753151036103
ACC=0.5100250626566416
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 51.18601820442114 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 51.18601820442114 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00024: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00024: valid_acc_1  was not in top 1
[2021-03-01 20:41:28,315] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3144  train_acc_1 88.0751
[2021-03-01 20:41:28,316] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.7986  valid_acc_1 51.1860
[2021-03-01 20:41:28,316] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:41:28,330] default_module.py->log_info line:141 [INFO]lr=8.5355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:41:42,483] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 0/355 train_loss 0.7148  train_acc_1 77.7778
[2021-03-01 20:42:16,572] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 100/355 train_loss 0.3354  train_acc_1 86.3586
[2021-03-01 20:42:49,388] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 200/355 train_loss 0.3303  train_acc_1 87.0647
[2021-03-01 20:43:22,303] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 300/355 train_loss 0.3264  train_acc_1 87.3385
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:44:06,258] default_module.py->log_info line:141 [INFO]Valid Epoch 25/100 step 400/89 valid_loss 0.2341  valid_acc_1 92.0290
[2021-03-01 20:44:11,301] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8305    0.9703    0.8788    0.8950    0.9234    0.8605       303
          1     0.9718    0.7980    0.9859    0.8764    0.8870    0.7720       302
          2     0.8418    0.8549    0.9488    0.8483    0.9006    0.8035       193

avg / total     0.8867    0.8772    0.9362    0.8767    0.9041    0.8132       798

Covid class AUC=0.9585892437513353
ACC=0.8771929824561403
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.76529445005266 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.76529445005266 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00025: valid_acc_1 reached 87.76529 (best 87.76529), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=25-valid_acc_1=87.77.ckpt as top 1
INFO:lightning:
Epoch 00025: valid_acc_1 reached 87.76529 (best 87.76529), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=25-valid_acc_1=87.77.ckpt as top 1
[2021-03-01 20:44:12,678] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3189  train_acc_1 87.7308
[2021-03-01 20:44:12,679] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3426  valid_acc_1 87.7653
[2021-03-01 20:44:12,679] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:44:12,686] default_module.py->log_info line:141 [INFO]lr=8.4227e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:44:25,960] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 0/355 train_loss 0.2136  train_acc_1 88.8889
[2021-03-01 20:45:02,343] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 100/355 train_loss 0.3382  train_acc_1 87.6788
[2021-03-01 20:45:35,349] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 200/355 train_loss 0.3206  train_acc_1 88.0597
[2021-03-01 20:46:08,396] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 300/355 train_loss 0.3138  train_acc_1 88.4459
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:46:52,418] default_module.py->log_info line:141 [INFO]Valid Epoch 26/100 step 400/89 valid_loss 2.1126  valid_acc_1 36.4734
[2021-03-01 20:46:57,463] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9057    0.1584    0.9899    0.2697    0.3960    0.1438       303
          1     0.4559    0.9404    0.3165    0.6141    0.5456    0.3162       302
          2     0.8607    0.5440    0.9719    0.6667    0.7272    0.5061       193

avg / total     0.7246    0.5476    0.7307    0.4960    0.5327    0.2967       798

Covid class AUC=0.8544648579363383
ACC=0.5476190476190477
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 54.868914647048776 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 54.868914647048776 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00026: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00026: valid_acc_1  was not in top 1
[2021-03-01 20:46:57,546] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3170  train_acc_1 88.2629
[2021-03-01 20:46:57,546] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.7005  valid_acc_1 54.8689
[2021-03-01 20:46:57,546] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:46:57,558] default_module.py->log_info line:141 [INFO]lr=8.3066e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:47:12,383] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 0/355 train_loss 0.3427  train_acc_1 77.7778
[2021-03-01 20:47:46,080] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 100/355 train_loss 0.3015  train_acc_1 88.1188
[2021-03-01 20:48:19,662] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 200/355 train_loss 0.3086  train_acc_1 88.2808
[2021-03-01 20:48:53,428] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 300/355 train_loss 0.3123  train_acc_1 88.1137
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:49:36,890] default_module.py->log_info line:141 [INFO]Valid Epoch 27/100 step 400/89 valid_loss 0.6931  valid_acc_1 69.0821
[2021-03-01 20:49:41,945] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7064    0.7624    0.8061    0.7333    0.7839    0.6118       303
          1     0.8083    0.5166    0.9254    0.6303    0.6914    0.4585       302
          2     0.6403    0.9223    0.8347    0.7558    0.8774    0.7766       193

avg / total     0.7290    0.7080    0.8582    0.6998    0.7715    0.5936       798

Covid class AUC=0.8030735953856014
ACC=0.7080200501253133
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 70.91136137287269 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 70.91136137287269 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00027: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00027: valid_acc_1  was not in top 1
[2021-03-01 20:49:42,019] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3068  train_acc_1 88.5133
[2021-03-01 20:49:42,019] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6679  valid_acc_1 70.9114
[2021-03-01 20:49:42,019] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:49:42,032] default_module.py->log_info line:141 [INFO]lr=8.1871e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:49:57,057] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 0/355 train_loss 0.2586  train_acc_1 88.8889
[2021-03-01 20:50:31,338] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 100/355 train_loss 0.2754  train_acc_1 89.1089
[2021-03-01 20:51:05,277] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 200/355 train_loss 0.2836  train_acc_1 89.2206
[2021-03-01 20:51:39,637] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 300/355 train_loss 0.2982  train_acc_1 88.7043
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:52:22,633] default_module.py->log_info line:141 [INFO]Valid Epoch 28/100 step 400/89 valid_loss 1.0371  valid_acc_1 60.3865
[2021-03-01 20:52:27,629] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8916    0.4884    0.9636    0.6311    0.6861    0.4483       303
          1     0.4938    0.9305    0.4194    0.6452    0.6247    0.4101       302
          2     0.8254    0.2694    0.9818    0.4062    0.5143    0.2457       193

avg / total     0.7250    0.6028    0.7621    0.5821    0.6213    0.3849       798

Covid class AUC=0.8631969664601582
ACC=0.6027568922305765
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 60.17478258154365 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 60.17478258154365 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00028: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00028: valid_acc_1  was not in top 1
[2021-03-01 20:52:27,713] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2973  train_acc_1 88.5446
[2021-03-01 20:52:27,713] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.2514  valid_acc_1 60.1748
[2021-03-01 20:52:27,714] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:52:27,726] default_module.py->log_info line:141 [INFO]lr=8.0645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:52:42,479] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 0/355 train_loss 0.0868  train_acc_1 100.0000
[2021-03-01 20:53:17,319] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 100/355 train_loss 0.2564  train_acc_1 90.3190
[2021-03-01 20:53:52,584] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 200/355 train_loss 0.2826  train_acc_1 89.4417
[2021-03-01 20:54:25,354] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 300/355 train_loss 0.2870  train_acc_1 89.3688
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:55:08,705] default_module.py->log_info line:141 [INFO]Valid Epoch 29/100 step 400/89 valid_loss 0.5433  valid_acc_1 76.5700
[2021-03-01 20:55:13,761] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8185    0.7294    0.9010    0.7714    0.8107    0.6459       303
          1     0.7305    0.8974    0.7984    0.8053    0.8464    0.7235       302
          2     0.9108    0.7409    0.9769    0.8171    0.8508    0.7067       193

avg / total     0.8075    0.7957    0.8805    0.7953    0.8339    0.6900       798

Covid class AUC=0.9010093997009186
ACC=0.7957393483709273
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 79.65043790152903 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 79.65043790152903 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00029: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00029: valid_acc_1  was not in top 1
[2021-03-01 20:55:13,843] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2809  train_acc_1 89.2332
[2021-03-01 20:55:13,843] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5804  valid_acc_1 79.6504
[2021-03-01 20:55:13,843] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:55:13,852] default_module.py->log_info line:141 [INFO]lr=7.9389e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:55:31,262] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 0/355 train_loss 0.3935  train_acc_1 66.6667
[2021-03-01 20:56:04,191] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 100/355 train_loss 0.2555  train_acc_1 89.8790
[2021-03-01 20:56:38,526] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 200/355 train_loss 0.2794  train_acc_1 89.8839
[2021-03-01 20:57:14,070] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 300/355 train_loss 0.2931  train_acc_1 89.3319
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:57:58,010] default_module.py->log_info line:141 [INFO]Valid Epoch 30/100 step 400/89 valid_loss 0.2879  valid_acc_1 90.5797
[2021-03-01 20:58:03,032] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8956    0.9340    0.9333    0.9144    0.9337    0.8718       303
          1     0.9176    0.8477    0.9536    0.8812    0.8991    0.7998       302
          2     0.8374    0.8808    0.9455    0.8586    0.9126    0.8274       193

avg / total     0.8898    0.8885    0.9439    0.8883    0.9155    0.8338       798

Covid class AUC=0.9392424161503953
ACC=0.8884711779448622
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.88888978422358 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.88888978422358 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00030: valid_acc_1 reached 88.88889 (best 88.88889), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=30-valid_acc_1=88.89.ckpt as top 1
INFO:lightning:
Epoch 00030: valid_acc_1 reached 88.88889 (best 88.88889), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=30-valid_acc_1=88.89.ckpt as top 1
[2021-03-01 20:58:04,444] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2807  train_acc_1 89.9218
[2021-03-01 20:58:04,444] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3253  valid_acc_1 88.8889
[2021-03-01 20:58:04,444] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:58:04,452] default_module.py->log_info line:141 [INFO]lr=7.8104e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:58:19,409] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 0/355 train_loss 0.1223  train_acc_1 100.0000
[2021-03-01 20:58:54,489] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 100/355 train_loss 0.2506  train_acc_1 90.4290
[2021-03-01 20:59:27,176] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 200/355 train_loss 0.2740  train_acc_1 89.7734
[2021-03-01 21:00:01,269] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 300/355 train_loss 0.2641  train_acc_1 90.4393
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:00:45,072] default_module.py->log_info line:141 [INFO]Valid Epoch 31/100 step 400/89 valid_loss 0.4120  valid_acc_1 84.5411
[2021-03-01 21:00:50,099] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.5917    0.9901    0.5818    0.7407    0.7590    0.5996       303
          1     0.9559    0.4305    0.9879    0.5936    0.6521    0.4016       302
          2     0.8645    0.6943    0.9653    0.7701    0.8187    0.6520       193

avg / total     0.7955    0.7068    0.8282    0.6922    0.7330    0.5373       798

Covid class AUC=0.8528359324930571
ACC=0.706766917293233
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 70.78651748614365 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 70.78651748614365 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00031: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00031: valid_acc_1  was not in top 1
[2021-03-01 21:00:50,180] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2713  train_acc_1 90.2973
[2021-03-01 21:00:50,180] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7797  valid_acc_1 70.7865
[2021-03-01 21:00:50,180] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:00:50,192] default_module.py->log_info line:141 [INFO]lr=7.6791e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:01:03,983] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 0/355 train_loss 0.6905  train_acc_1 77.7778
[2021-03-01 21:01:39,452] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 100/355 train_loss 0.2631  train_acc_1 90.3190
[2021-03-01 21:02:12,367] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 200/355 train_loss 0.2590  train_acc_1 90.5473
[2021-03-01 21:02:45,438] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 300/355 train_loss 0.2669  train_acc_1 90.1440
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:03:29,731] default_module.py->log_info line:141 [INFO]Valid Epoch 32/100 step 400/89 valid_loss 2.0853  valid_acc_1 40.5797
[2021-03-01 21:03:34,755] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8026    0.2013    0.9697    0.3219    0.4418    0.1802       303
          1     0.4175    0.9801    0.1673    0.5856    0.4050    0.1773       302
          2     0.6923    0.0466    0.9934    0.0874    0.2152    0.0419       193

avg / total     0.6302    0.4586    0.6718    0.3650    0.3731    0.1457       798

Covid class AUC=0.8216326639606922
ACC=0.45864661654135336
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 45.755306415343554 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 45.755306415343554 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00032: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00032: valid_acc_1  was not in top 1
[2021-03-01 21:03:34,835] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2657  train_acc_1 90.0782
[2021-03-01 21:03:34,835] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 2.1424  valid_acc_1 45.7553
[2021-03-01 21:03:34,836] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:03:34,847] default_module.py->log_info line:141 [INFO]lr=7.5452e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:03:52,234] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 0/355 train_loss 0.4519  train_acc_1 77.7778
[2021-03-01 21:04:27,651] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 100/355 train_loss 0.2680  train_acc_1 90.4290
[2021-03-01 21:05:00,444] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 200/355 train_loss 0.2536  train_acc_1 90.7131
[2021-03-01 21:05:32,998] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 300/355 train_loss 0.2585  train_acc_1 90.5869
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:06:16,873] default_module.py->log_info line:141 [INFO]Valid Epoch 33/100 step 400/89 valid_loss 1.0175  valid_acc_1 57.7295
[2021-03-01 21:06:21,888] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8868    0.4653    0.9636    0.6104    0.6696    0.4261       303
          1     0.5217    0.9172    0.4879    0.6651    0.6690    0.4667       302
          2     0.8611    0.4819    0.9752    0.6179    0.6855    0.4467       193

avg / total     0.7424    0.6404    0.7864    0.6329    0.6732    0.4465       798

Covid class AUC=0.8759012497329631
ACC=0.6403508771929824
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 64.10736658332053 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 64.10736658332053 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00033: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00033: valid_acc_1  was not in top 1
[2021-03-01 21:06:21,985] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2569  train_acc_1 90.6729
[2021-03-01 21:06:21,985] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.1051  valid_acc_1 64.1074
[2021-03-01 21:06:21,985] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:06:21,995] default_module.py->log_info line:141 [INFO]lr=7.4088e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:06:37,092] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 0/355 train_loss 0.0968  train_acc_1 100.0000
[2021-03-01 21:07:10,980] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 100/355 train_loss 0.2460  train_acc_1 91.1991
[2021-03-01 21:07:44,466] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 200/355 train_loss 0.2247  train_acc_1 92.4820
[2021-03-01 21:08:17,835] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 300/355 train_loss 0.2356  train_acc_1 92.0266
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:09:04,001] default_module.py->log_info line:141 [INFO]Valid Epoch 34/100 step 400/89 valid_loss 0.6142  valid_acc_1 71.9807
[2021-03-01 21:09:09,043] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8996    0.6799    0.9535    0.7744    0.8052    0.6305       303
          1     0.7089    0.8709    0.7823    0.7816    0.8254    0.6873       302
          2     0.8333    0.8549    0.9455    0.8440    0.8990    0.8010       193

avg / total     0.8114    0.7945    0.8868    0.7940    0.8355    0.6932       798

Covid class AUC=0.9232469023712883
ACC=0.7944862155388471
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 79.52559402551543 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 79.52559402551543 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00034: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00034: valid_acc_1  was not in top 1
[2021-03-01 21:09:09,130] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2329  train_acc_1 92.0188
[2021-03-01 21:09:09,130] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5057  valid_acc_1 79.5256
[2021-03-01 21:09:09,130] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:09:09,142] default_module.py->log_info line:141 [INFO]lr=7.2700e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:09:25,122] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 0/355 train_loss 0.1591  train_acc_1 88.8889
[2021-03-01 21:09:59,464] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 100/355 train_loss 0.2065  train_acc_1 92.5193
[2021-03-01 21:10:32,540] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 200/355 train_loss 0.2114  train_acc_1 92.0951
[2021-03-01 21:11:05,927] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 300/355 train_loss 0.2233  train_acc_1 91.4729
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:11:49,969] default_module.py->log_info line:141 [INFO]Valid Epoch 35/100 step 400/89 valid_loss 0.2631  valid_acc_1 90.8213
[2021-03-01 21:11:54,986] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8789    0.9340    0.9212    0.9056    0.9276    0.8615       303
          1     0.9695    0.8411    0.9839    0.9007    0.9097    0.8157       302
          2     0.8271    0.9171    0.9388    0.8698    0.9279    0.8591       193

avg / total     0.9006    0.8947    0.9492    0.8951    0.9209    0.8436       798

Covid class AUC=0.9546571245460372
ACC=0.8947368421052632
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.51310970006364 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.51310970006364 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00035: valid_acc_1 reached 89.51311 (best 89.51311), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=35-valid_acc_1=89.51.ckpt as top 1
INFO:lightning:
Epoch 00035: valid_acc_1 reached 89.51311 (best 89.51311), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=35-valid_acc_1=89.51.ckpt as top 1
[2021-03-01 21:11:56,365] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2325  train_acc_1 91.1424
[2021-03-01 21:11:56,365] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3113  valid_acc_1 89.5131
[2021-03-01 21:11:56,365] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:11:56,372] default_module.py->log_info line:141 [INFO]lr=7.1289e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:12:10,990] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 0/355 train_loss 0.1124  train_acc_1 100.0000
[2021-03-01 21:12:46,850] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 100/355 train_loss 0.1977  train_acc_1 93.5094
[2021-03-01 21:13:20,002] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 200/355 train_loss 0.2132  train_acc_1 92.0951
[2021-03-01 21:13:52,721] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 300/355 train_loss 0.2148  train_acc_1 91.7682
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:14:36,402] default_module.py->log_info line:141 [INFO]Valid Epoch 36/100 step 400/89 valid_loss 0.3395  valid_acc_1 88.6473
[2021-03-01 21:14:41,449] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7202    0.9769    0.7677    0.8291    0.8660    0.7656       303
          1     0.9786    0.6060    0.9919    0.7485    0.7753    0.5779       302
          2     0.8100    0.8394    0.9372    0.8244    0.8869    0.7790       193

avg / total     0.8397    0.8033    0.8935    0.7975    0.8367    0.6978       798

Covid class AUC=0.9461186178167059
ACC=0.8032581453634086
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 80.39950133977311 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 80.39950133977311 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00036: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00036: valid_acc_1  was not in top 1
[2021-03-01 21:14:41,538] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2140  train_acc_1 91.9249
[2021-03-01 21:14:41,538] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5399  valid_acc_1 80.3995
[2021-03-01 21:14:41,538] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:14:41,550] default_module.py->log_info line:141 [INFO]lr=6.9857e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:14:56,957] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 0/355 train_loss 0.1429  train_acc_1 100.0000
[2021-03-01 21:15:30,730] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 100/355 train_loss 0.2168  train_acc_1 92.8493
[2021-03-01 21:16:05,506] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 200/355 train_loss 0.2191  train_acc_1 92.2609
[2021-03-01 21:16:38,238] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 300/355 train_loss 0.2175  train_acc_1 92.2850
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:17:22,288] default_module.py->log_info line:141 [INFO]Valid Epoch 37/100 step 400/89 valid_loss 0.7270  valid_acc_1 74.1546
[2021-03-01 21:17:27,335] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7460    0.7756    0.8384    0.7605    0.8064    0.6461       303
          1     0.8878    0.6026    0.9536    0.7179    0.7581    0.5545       302
          2     0.6547    0.9430    0.8413    0.7728    0.8907    0.8014       193

avg / total     0.7776    0.7506    0.8827    0.7474    0.8085    0.6490       798

Covid class AUC=0.8864892651142918
ACC=0.7506265664160401
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.15605560045564 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.15605560045564 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00037: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00037: valid_acc_1  was not in top 1
[2021-03-01 21:17:27,421] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2157  train_acc_1 92.3318
[2021-03-01 21:17:27,421] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6885  valid_acc_1 75.1561
[2021-03-01 21:17:27,421] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:17:27,434] default_module.py->log_info line:141 [INFO]lr=6.8406e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:17:43,748] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 0/355 train_loss 0.4366  train_acc_1 77.7778
[2021-03-01 21:18:17,728] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 100/355 train_loss 0.2351  train_acc_1 91.4191
[2021-03-01 21:18:50,654] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 200/355 train_loss 0.2193  train_acc_1 92.3715
[2021-03-01 21:19:24,180] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 300/355 train_loss 0.2159  train_acc_1 92.5803
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:20:08,817] default_module.py->log_info line:141 [INFO]Valid Epoch 38/100 step 400/89 valid_loss 0.2288  valid_acc_1 92.5121
[2021-03-01 21:20:13,857] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8984    0.9340    0.9354    0.9159    0.9347    0.8735       303
          1     0.9247    0.8940    0.9556    0.9091    0.9243    0.8491       302
          2     0.8691    0.8601    0.9587    0.8646    0.9081    0.8164       193

avg / total     0.9013    0.9010    0.9487    0.9009    0.9243    0.8505       798

Covid class AUC=0.9698381756035035
ACC=0.9010025062656641
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.13732953018017 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.13732953018017 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00038: valid_acc_1 reached 90.13733 (best 90.13733), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=38-valid_acc_1=90.14.ckpt as top 1
INFO:lightning:
Epoch 00038: valid_acc_1 reached 90.13733 (best 90.13733), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=38-valid_acc_1=90.14.ckpt as top 1
[2021-03-01 21:20:15,184] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2101  train_acc_1 92.7700
[2021-03-01 21:20:15,185] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2993  valid_acc_1 90.1373
[2021-03-01 21:20:15,185] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:20:15,192] default_module.py->log_info line:141 [INFO]lr=6.6937e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:20:28,925] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 0/355 train_loss 0.1261  train_acc_1 100.0000
[2021-03-01 21:21:02,903] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 100/355 train_loss 0.2334  train_acc_1 91.5292
[2021-03-01 21:21:37,522] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 200/355 train_loss 0.2187  train_acc_1 92.4268
[2021-03-01 21:22:12,877] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 300/355 train_loss 0.2196  train_acc_1 92.0266
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:22:55,691] default_module.py->log_info line:141 [INFO]Valid Epoch 39/100 step 400/89 valid_loss 0.4889  valid_acc_1 83.0918
[2021-03-01 21:23:00,713] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6079    0.9670    0.6182    0.7465    0.7732    0.6186       303
          1     0.9600    0.3974    0.9899    0.5621    0.6272    0.3700       302
          2     0.8429    0.8342    0.9504    0.8385    0.8904    0.7836       193

avg / total     0.7980    0.7193    0.8392    0.6990    0.7463    0.5645       798

Covid class AUC=0.8025862529374066
ACC=0.7192982456140351
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 72.03495704993773 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 72.03495704993773 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00039: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00039: valid_acc_1  was not in top 1
[2021-03-01 21:23:00,788] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2222  train_acc_1 91.8936
[2021-03-01 21:23:00,788] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8296  valid_acc_1 72.0350
[2021-03-01 21:23:00,789] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:23:00,801] default_module.py->log_info line:141 [INFO]lr=6.5451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:23:15,344] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 0/355 train_loss 0.0833  train_acc_1 100.0000
[2021-03-01 21:23:50,624] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 100/355 train_loss 0.2121  train_acc_1 91.7492
[2021-03-01 21:24:23,804] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 200/355 train_loss 0.2013  train_acc_1 92.4820
[2021-03-01 21:24:56,605] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 300/355 train_loss 0.1953  train_acc_1 92.8387
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:25:39,420] default_module.py->log_info line:141 [INFO]Valid Epoch 40/100 step 400/89 valid_loss 0.6690  valid_acc_1 72.4638
[2021-03-01 21:25:44,453] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8361    0.6568    0.9212    0.7357    0.7778    0.5890       303
          1     0.6757    0.9106    0.7339    0.7757    0.8175    0.6801       302
          2     0.8758    0.6943    0.9686    0.7746    0.8201    0.6540       193

avg / total     0.7850    0.7619    0.8618    0.7602    0.8030    0.6392       798

Covid class AUC=0.9105960264900662
ACC=0.7619047619047619
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.15480794799461 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.15480794799461 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00040: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00040: valid_acc_1  was not in top 1
[2021-03-01 21:25:44,542] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1927  train_acc_1 92.9577
[2021-03-01 21:25:44,542] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7031  valid_acc_1 76.1548
[2021-03-01 21:25:44,542] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:25:44,551] default_module.py->log_info line:141 [INFO]lr=6.3950e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:26:00,453] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 0/355 train_loss 0.0963  train_acc_1 100.0000
[2021-03-01 21:26:38,820] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 100/355 train_loss 0.1832  train_acc_1 93.2893
[2021-03-01 21:27:11,632] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 200/355 train_loss 0.1852  train_acc_1 93.3112
[2021-03-01 21:27:44,158] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 300/355 train_loss 0.1884  train_acc_1 93.1340
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:28:27,811] default_module.py->log_info line:141 [INFO]Valid Epoch 41/100 step 400/89 valid_loss 0.5369  valid_acc_1 81.1594
[2021-03-01 21:28:32,880] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.6620    0.9373    0.7071    0.7760    0.8141    0.6780       303
          1     0.9485    0.4272    0.9859    0.5890    0.6489    0.3976       302
          2     0.7639    0.9223    0.9091    0.8357    0.9157    0.8395       193

avg / total     0.7951    0.7406    0.8614    0.7197    0.7762    0.6109       798

Covid class AUC=0.8519280068361462
ACC=0.7406015037593985
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 74.15730426016819 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 74.15730426016819 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00041: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00041: valid_acc_1  was not in top 1
[2021-03-01 21:28:32,965] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1867  train_acc_1 93.1455
[2021-03-01 21:28:32,966] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7874  valid_acc_1 74.1573
[2021-03-01 21:28:32,966] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:28:32,980] default_module.py->log_info line:141 [INFO]lr=6.2434e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:28:47,666] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 0/355 train_loss 0.0604  train_acc_1 100.0000
[2021-03-01 21:29:22,888] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 100/355 train_loss 0.2395  train_acc_1 91.6392
[2021-03-01 21:29:55,916] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 200/355 train_loss 0.2100  train_acc_1 92.8137
[2021-03-01 21:30:28,757] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 300/355 train_loss 0.2014  train_acc_1 92.9863
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:31:13,056] default_module.py->log_info line:141 [INFO]Valid Epoch 42/100 step 400/89 valid_loss 0.5528  valid_acc_1 79.9517
[2021-03-01 21:31:18,113] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7637    0.8746    0.8343    0.8154    0.8542    0.7326       303
          1     0.9218    0.5464    0.9718    0.6861    0.7287    0.5083       302
          2     0.6618    0.9326    0.8479    0.7742    0.8893    0.7975       193

avg / total     0.7989    0.7644    0.8896    0.7565    0.8152    0.6635       798

Covid class AUC=0.8589243751335185
ACC=0.7644110275689223
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.52933923314127 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.52933923314127 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00042: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00042: valid_acc_1  was not in top 1
[2021-03-01 21:31:18,209] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1945  train_acc_1 93.0203
[2021-03-01 21:31:18,209] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6399  valid_acc_1 76.5293
[2021-03-01 21:31:18,209] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:31:18,219] default_module.py->log_info line:141 [INFO]lr=6.0907e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:31:33,637] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 0/355 train_loss 0.0916  train_acc_1 100.0000
[2021-03-01 21:32:07,476] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 100/355 train_loss 0.1875  train_acc_1 93.3993
[2021-03-01 21:32:40,455] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 200/355 train_loss 0.1741  train_acc_1 93.8087
[2021-03-01 21:33:13,137] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 300/355 train_loss 0.1764  train_acc_1 93.7615
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:33:57,470] default_module.py->log_info line:141 [INFO]Valid Epoch 43/100 step 400/89 valid_loss 0.5328  valid_acc_1 80.9179
[2021-03-01 21:34:02,515] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8650    0.7822    0.9253    0.8215    0.8507    0.7134       303
          1     0.7330    0.8907    0.8024    0.8042    0.8454    0.7210       302
          2     0.8790    0.7150    0.9686    0.7886    0.8322    0.6750       193

avg / total     0.8184    0.8070    0.8892    0.8070    0.8442    0.7070       798

Covid class AUC=0.9238877910702842
ACC=0.8070175438596491
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 80.71161173702626 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 80.71161173702626 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00043: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00043: valid_acc_1  was not in top 1
[2021-03-01 21:34:02,613] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1806  train_acc_1 93.5524
[2021-03-01 21:34:02,613] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5605  valid_acc_1 80.7116
[2021-03-01 21:34:02,613] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:34:02,626] default_module.py->log_info line:141 [INFO]lr=5.9369e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:34:18,304] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 0/355 train_loss 0.0776  train_acc_1 100.0000
[2021-03-01 21:34:51,456] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 100/355 train_loss 0.1730  train_acc_1 94.4995
[2021-03-01 21:35:27,057] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 200/355 train_loss 0.1911  train_acc_1 93.0348
[2021-03-01 21:36:00,760] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 300/355 train_loss 0.2030  train_acc_1 92.6541
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:36:44,194] default_module.py->log_info line:141 [INFO]Valid Epoch 44/100 step 400/89 valid_loss 0.3638  valid_acc_1 89.1304
[2021-03-01 21:36:49,227] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9333    0.9241    0.9596    0.9287    0.9417    0.8836       303
          1     0.9841    0.8179    0.9919    0.8933    0.9007    0.7972       302
          2     0.7611    0.9741    0.9025    0.8545    0.9376    0.8854       193

avg / total     0.9109    0.8960    0.9580    0.8974    0.9252    0.8513       798

Covid class AUC=0.965191732535783
ACC=0.8959899749373433
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.63795338319929 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.63795338319929 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00044: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00044: valid_acc_1  was not in top 1
[2021-03-01 21:36:49,307] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2006  train_acc_1 92.7074
[2021-03-01 21:36:49,308] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3540  valid_acc_1 89.6380
[2021-03-01 21:36:49,308] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:36:49,318] default_module.py->log_info line:141 [INFO]lr=5.7822e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:37:04,927] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 0/355 train_loss 0.0732  train_acc_1 100.0000
[2021-03-01 21:37:38,733] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 100/355 train_loss 0.1837  train_acc_1 93.9494
[2021-03-01 21:38:11,997] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 200/355 train_loss 0.1668  train_acc_1 94.8038
[2021-03-01 21:38:44,733] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 300/355 train_loss 0.1766  train_acc_1 94.1676
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:39:28,791] default_module.py->log_info line:141 [INFO]Valid Epoch 45/100 step 400/89 valid_loss 0.7783  valid_acc_1 68.5990
[2021-03-01 21:39:33,823] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9109    0.6073    0.9636    0.7287    0.7650    0.5643       303
          1     0.6619    0.9205    0.7137    0.7701    0.8105    0.6706       302
          2     0.8864    0.8083    0.9669    0.8455    0.8841    0.7692       193

avg / total     0.8107    0.7744    0.8699    0.7726    0.8110    0.6541       798

Covid class AUC=0.9281537064729758
ACC=0.7744360902255639
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.46566880686899 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.46566880686899 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00045: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00045: valid_acc_1  was not in top 1
[2021-03-01 21:39:33,919] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1747  train_acc_1 94.1784
[2021-03-01 21:39:33,919] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6093  valid_acc_1 77.4657
[2021-03-01 21:39:33,919] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:39:33,935] default_module.py->log_info line:141 [INFO]lr=5.6267e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:39:51,187] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 0/355 train_loss 0.2076  train_acc_1 100.0000
[2021-03-01 21:40:24,679] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 100/355 train_loss 0.1582  train_acc_1 95.1595
[2021-03-01 21:40:57,722] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 200/355 train_loss 0.1541  train_acc_1 94.5826
[2021-03-01 21:41:30,419] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 300/355 train_loss 0.1556  train_acc_1 94.4260
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:42:14,308] default_module.py->log_info line:141 [INFO]Valid Epoch 46/100 step 400/89 valid_loss 0.2206  valid_acc_1 91.5459
[2021-03-01 21:42:19,312] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8861    0.9241    0.9273    0.9047    0.9257    0.8566       303
          1     0.9064    0.8974    0.9435    0.9018    0.9202    0.8428       302
          2     0.8852    0.8394    0.9653    0.8617    0.9001    0.8000       193

avg / total     0.8935    0.8935    0.9426    0.8932    0.9174    0.8377       798

Covid class AUC=0.9647244178594317
ACC=0.893483709273183
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.3882658883427 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.3882658883427 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00046: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00046: valid_acc_1  was not in top 1
[2021-03-01 21:42:19,412] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1568  train_acc_1 94.3036
[2021-03-01 21:42:19,412] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2868  valid_acc_1 89.3883
[2021-03-01 21:42:19,413] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:42:19,424] default_module.py->log_info line:141 [INFO]lr=5.4705e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:42:34,915] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 0/355 train_loss 0.1037  train_acc_1 100.0000
[2021-03-01 21:43:07,947] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 100/355 train_loss 0.1243  train_acc_1 95.8196
[2021-03-01 21:43:40,973] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 200/355 train_loss 0.1572  train_acc_1 94.3062
[2021-03-01 21:44:15,227] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 300/355 train_loss 0.1652  train_acc_1 93.7615
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:45:00,167] default_module.py->log_info line:141 [INFO]Valid Epoch 47/100 step 400/89 valid_loss 0.2662  valid_acc_1 88.4058
[2021-03-01 21:45:05,224] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8384    0.9076    0.8929    0.8716    0.9002    0.8116       303
          1     0.8924    0.8510    0.9375    0.8712    0.8932    0.7909       302
          2     0.8297    0.7824    0.9488    0.8053    0.8616    0.7299       193

avg / total     0.8567    0.8559    0.9233    0.8554    0.8882    0.7840       798

Covid class AUC=0.9459316919461654
ACC=0.8558897243107769
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 85.64294748627738 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 85.64294748627738 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00047: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00047: valid_acc_1  was not in top 1
[2021-03-01 21:45:05,308] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1685  train_acc_1 93.3646
[2021-03-01 21:45:05,308] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4075  valid_acc_1 85.6429
[2021-03-01 21:45:05,308] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:45:05,321] default_module.py->log_info line:141 [INFO]lr=5.3140e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:45:20,702] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 0/355 train_loss 0.1706  train_acc_1 88.8889
[2021-03-01 21:45:54,612] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 100/355 train_loss 0.1518  train_acc_1 94.9395
[2021-03-01 21:46:27,578] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 200/355 train_loss 0.1626  train_acc_1 94.4721
[2021-03-01 21:47:00,462] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 300/355 train_loss 0.1635  train_acc_1 94.3152
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:47:45,489] default_module.py->log_info line:141 [INFO]Valid Epoch 48/100 step 400/89 valid_loss 0.2035  valid_acc_1 92.5121
[2021-03-01 21:47:50,533] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9164    0.9406    0.9475    0.9283    0.9440    0.8906       303
          1     0.9603    0.8808    0.9778    0.9188    0.9280    0.8529       302
          2     0.8524    0.9275    0.9488    0.8883    0.9381    0.8781       193

avg / total     0.9175    0.9148    0.9593    0.9151    0.9365    0.8733       798

Covid class AUC=0.9729825357829524
ACC=0.9147869674185464
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.51061300213418 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.51061300213418 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00048: valid_acc_1 reached 91.51061 (best 91.51061), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=48-valid_acc_1=91.51.ckpt as top 1
INFO:lightning:
Epoch 00048: valid_acc_1 reached 91.51061 (best 91.51061), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=48-valid_acc_1=91.51.ckpt as top 1
[2021-03-01 21:47:51,885] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1657  train_acc_1 93.8341
[2021-03-01 21:47:51,885] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2317  valid_acc_1 91.5106
[2021-03-01 21:47:51,885] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:47:51,893] default_module.py->log_info line:141 [INFO]lr=5.1571e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:48:07,628] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 0/355 train_loss 0.1868  train_acc_1 88.8889
[2021-03-01 21:48:42,014] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 100/355 train_loss 0.1401  train_acc_1 94.9395
[2021-03-01 21:49:15,010] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 200/355 train_loss 0.1628  train_acc_1 93.8640
[2021-03-01 21:49:47,995] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 300/355 train_loss 0.1611  train_acc_1 93.9092
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:50:32,871] default_module.py->log_info line:141 [INFO]Valid Epoch 49/100 step 400/89 valid_loss 0.3425  valid_acc_1 88.4058
[2021-03-01 21:50:37,881] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8593    0.9274    0.9071    0.8921    0.9172    0.8429       303
          1     0.9582    0.7583    0.9798    0.8466    0.8620    0.7265       302
          2     0.7759    0.9326    0.9140    0.8471    0.9233    0.8541       193

avg / total     0.8765    0.8647    0.9363    0.8640    0.8978    0.8016       798

Covid class AUC=0.9335278252510147
ACC=0.8646616541353384
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.51685502555932 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.51685502555932 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00049: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00049: valid_acc_1  was not in top 1
[2021-03-01 21:50:37,951] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1598  train_acc_1 93.9906
[2021-03-01 21:50:37,951] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3943  valid_acc_1 86.5169
[2021-03-01 21:50:37,952] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:50:37,964] default_module.py->log_info line:141 [INFO]lr=5.0000e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:50:52,412] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 0/355 train_loss 0.0689  train_acc_1 100.0000
[2021-03-01 21:51:26,427] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 100/355 train_loss 0.1489  train_acc_1 94.8295
[2021-03-01 21:51:59,538] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 200/355 train_loss 0.1442  train_acc_1 94.6932
[2021-03-01 21:52:34,182] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 300/355 train_loss 0.1514  train_acc_1 94.6844
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:53:18,328] default_module.py->log_info line:141 [INFO]Valid Epoch 50/100 step 400/89 valid_loss 0.2352  valid_acc_1 92.0290
[2021-03-01 21:53:23,346] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8959    0.9373    0.9333    0.9161    0.9353    0.8752       303
          1     0.9431    0.8775    0.9677    0.9091    0.9215    0.8415       302
          2     0.8600    0.8912    0.9537    0.8753    0.9219    0.8446       193

avg / total     0.9051    0.9035    0.9513    0.9036    0.9269    0.8550       798

Covid class AUC=0.9584690771202734
ACC=0.9035087719298246
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.32459537634689 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.32459537634689 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00050: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00050: valid_acc_1  was not in top 1
[2021-03-01 21:53:23,443] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1553  train_acc_1 94.6166
[2021-03-01 21:53:23,443] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2770  valid_acc_1 90.3246
[2021-03-01 21:53:23,443] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:53:23,456] default_module.py->log_info line:141 [INFO]lr=4.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:53:37,786] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 0/355 train_loss 0.0098  train_acc_1 100.0000
[2021-03-01 21:54:11,219] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 100/355 train_loss 0.1654  train_acc_1 93.6194
[2021-03-01 21:54:44,966] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 200/355 train_loss 0.1574  train_acc_1 93.7535
[2021-03-01 21:55:18,025] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 300/355 train_loss 0.1516  train_acc_1 94.0568
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:56:01,809] default_module.py->log_info line:141 [INFO]Valid Epoch 51/100 step 400/89 valid_loss 0.2880  valid_acc_1 90.5797
[2021-03-01 21:56:06,840] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7796    0.9571    0.8343    0.8593    0.8936    0.8083       303
          1     0.8446    0.7020    0.9214    0.7667    0.8042    0.6326       302
          2     0.8629    0.7824    0.9603    0.8207    0.8668    0.7380       193

avg / total     0.8243    0.8183    0.8977    0.8149    0.8533    0.7248       798

Covid class AUC=0.8792392117069002
ACC=0.818295739348371
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 81.77278492959698 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 81.77278492959698 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00051: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00051: valid_acc_1  was not in top 1
[2021-03-01 21:56:06,931] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1535  train_acc_1 94.0219
[2021-03-01 21:56:06,931] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5285  valid_acc_1 81.7728
[2021-03-01 21:56:06,932] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:56:06,944] default_module.py->log_info line:141 [INFO]lr=4.6860e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:56:22,720] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 0/355 train_loss 0.7361  train_acc_1 77.7778
[2021-03-01 21:56:58,754] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 100/355 train_loss 0.1320  train_acc_1 95.4896
[2021-03-01 21:57:31,758] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 200/355 train_loss 0.1442  train_acc_1 94.9696
[2021-03-01 21:58:04,563] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 300/355 train_loss 0.1461  train_acc_1 94.7582
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:58:48,852] default_module.py->log_info line:141 [INFO]Valid Epoch 52/100 step 400/89 valid_loss 0.8100  valid_acc_1 71.9807
[2021-03-01 21:58:53,879] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9187    0.6337    0.9657    0.7500    0.7822    0.5916       303
          1     0.5983    0.9470    0.6129    0.7333    0.7619    0.5998       302
          2     0.9099    0.5233    0.9835    0.6645    0.7174    0.4910       193

avg / total     0.7953    0.7256    0.8365    0.7230    0.7588    0.5704       798

Covid class AUC=0.9072246848963897
ACC=0.7255639097744361
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 72.53433271472373 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 72.53433271472373 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00052: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00052: valid_acc_1  was not in top 1
[2021-03-01 21:58:53,961] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1503  train_acc_1 94.6792
[2021-03-01 21:58:53,961] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7896  valid_acc_1 72.5343
[2021-03-01 21:58:53,961] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:58:53,969] default_module.py->log_info line:141 [INFO]lr=4.5295e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:59:09,292] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 0/355 train_loss 0.0474  train_acc_1 100.0000
[2021-03-01 21:59:42,442] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 100/355 train_loss 0.1275  train_acc_1 96.1496
[2021-03-01 22:00:15,918] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 200/355 train_loss 0.1493  train_acc_1 95.0249
[2021-03-01 22:00:49,408] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 300/355 train_loss 0.1469  train_acc_1 95.0535
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:01:33,336] default_module.py->log_info line:141 [INFO]Valid Epoch 53/100 step 400/89 valid_loss 0.2144  valid_acc_1 92.0290
[2021-03-01 22:01:38,350] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9394    0.9208    0.9636    0.9300    0.9420    0.8835       303
          1     0.9049    0.9139    0.9415    0.9094    0.9276    0.8581       302
          2     0.8622    0.8756    0.9554    0.8689    0.9146    0.8299       193

avg / total     0.9077    0.9073    0.9533    0.9074    0.9299    0.8609       798

Covid class AUC=0.9657525101474044
ACC=0.9072681704260651
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.63670537712869 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.63670537712869 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00053: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00053: valid_acc_1  was not in top 1
[2021-03-01 22:01:38,445] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1441  train_acc_1 95.3052
[2021-03-01 22:01:38,445] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2649  valid_acc_1 90.6367
[2021-03-01 22:01:38,445] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:01:38,457] default_module.py->log_info line:141 [INFO]lr=4.3733e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:01:54,156] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 0/355 train_loss 0.0257  train_acc_1 100.0000
[2021-03-01 22:02:28,737] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 100/355 train_loss 0.1400  train_acc_1 94.7195
[2021-03-01 22:03:01,920] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 200/355 train_loss 0.1393  train_acc_1 94.8038
[2021-03-01 22:03:36,251] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 300/355 train_loss 0.1390  train_acc_1 94.8320
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:04:19,226] default_module.py->log_info line:141 [INFO]Valid Epoch 54/100 step 400/89 valid_loss 0.2556  valid_acc_1 88.4058
[2021-03-01 22:04:24,242] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8693    0.8779    0.9192    0.8736    0.8983    0.8036       303
          1     0.8348    0.9205    0.8891    0.8756    0.9047    0.8210       302
          2     0.9182    0.7565    0.9785    0.8295    0.8604    0.7238       193

avg / total     0.8681    0.8647    0.9222    0.8637    0.8915    0.7909       798

Covid class AUC=0.9519867549668874
ACC=0.8646616541353384
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.39201129956191 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.39201129956191 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00054: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00054: valid_acc_1  was not in top 1
[2021-03-01 22:04:24,339] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1367  train_acc_1 94.9296
[2021-03-01 22:04:24,340] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4047  valid_acc_1 86.3920
[2021-03-01 22:04:24,340] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:04:24,354] default_module.py->log_info line:141 [INFO]lr=4.2178e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:04:40,550] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 0/355 train_loss 0.0825  train_acc_1 100.0000
[2021-03-01 22:05:16,111] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 100/355 train_loss 0.1239  train_acc_1 96.0396
[2021-03-01 22:05:51,685] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 200/355 train_loss 0.1296  train_acc_1 95.9093
[2021-03-01 22:06:24,495] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 300/355 train_loss 0.1363  train_acc_1 95.4596
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:07:09,221] default_module.py->log_info line:141 [INFO]Valid Epoch 55/100 step 400/89 valid_loss 0.6130  valid_acc_1 78.5024
[2021-03-01 22:07:14,236] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8814    0.7360    0.9394    0.8022    0.8315    0.6773       303
          1     0.7147    0.9205    0.7762    0.8046    0.8453    0.7248       302
          2     0.8974    0.7254    0.9736    0.8023    0.8404    0.6887       193

avg / total     0.8222    0.8033    0.8859    0.8031    0.8389    0.6980       798

Covid class AUC=0.9311779000213629
ACC=0.8032581453634086
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 80.33707968036781 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 80.33707968036781 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00055: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00055: valid_acc_1  was not in top 1
[2021-03-01 22:07:14,321] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1404  train_acc_1 95.3052
[2021-03-01 22:07:14,322] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5928  valid_acc_1 80.3371
[2021-03-01 22:07:14,322] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:07:14,334] default_module.py->log_info line:141 [INFO]lr=4.0631e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:07:30,364] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 0/355 train_loss 0.0925  train_acc_1 100.0000
[2021-03-01 22:08:04,564] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 100/355 train_loss 0.1120  train_acc_1 96.1496
[2021-03-01 22:08:37,684] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 200/355 train_loss 0.1101  train_acc_1 96.1857
[2021-03-01 22:09:10,810] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 300/355 train_loss 0.1176  train_acc_1 95.7918
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:09:55,243] default_module.py->log_info line:141 [INFO]Valid Epoch 56/100 step 400/89 valid_loss 0.3960  valid_acc_1 87.6812
[2021-03-01 22:10:00,263] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9257    0.9043    0.9556    0.9149    0.9296    0.8597       303
          1     0.9727    0.8245    0.9859    0.8925    0.9016    0.7997       302
          2     0.7642    0.9741    0.9041    0.8565    0.9385    0.8869       193

avg / total     0.9044    0.8910    0.9546    0.8923    0.9211    0.8436       798

Covid class AUC=0.9692707220679343
ACC=0.8909774436090225
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.0761558875609 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.0761558875609 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00056: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00056: valid_acc_1  was not in top 1
[2021-03-01 22:10:00,378] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1235  train_acc_1 95.5869
[2021-03-01 22:10:00,378] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3625  valid_acc_1 89.0762
[2021-03-01 22:10:00,378] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:10:00,391] default_module.py->log_info line:141 [INFO]lr=3.9093e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:10:16,239] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 0/355 train_loss 0.0287  train_acc_1 100.0000
[2021-03-01 22:10:50,045] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 100/355 train_loss 0.1193  train_acc_1 95.7096
[2021-03-01 22:11:23,147] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 200/355 train_loss 0.1173  train_acc_1 95.5777
[2021-03-01 22:11:56,117] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 300/355 train_loss 0.1299  train_acc_1 95.1643
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:12:40,064] default_module.py->log_info line:141 [INFO]Valid Epoch 57/100 step 400/89 valid_loss 0.3427  valid_acc_1 87.4396
[2021-03-01 22:12:45,104] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8006    0.9142    0.8606    0.8536    0.8870    0.7910       303
          1     0.9095    0.7318    0.9556    0.8110    0.8363    0.6837       302
          2     0.8086    0.8756    0.9339    0.8408    0.9043    0.8130       193

avg / total     0.8437    0.8358    0.9143    0.8344    0.8720    0.7557       798

Covid class AUC=0.9143545716727196
ACC=0.8358395989974937
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 83.58302255694785 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 83.58302255694785 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00057: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00057: valid_acc_1  was not in top 1
[2021-03-01 22:12:45,179] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1319  train_acc_1 95.1800
[2021-03-01 22:12:45,179] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4476  valid_acc_1 83.5830
[2021-03-01 22:12:45,179] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:12:45,189] default_module.py->log_info line:141 [INFO]lr=3.7566e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:13:00,103] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 0/355 train_loss 0.3069  train_acc_1 88.8889
[2021-03-01 22:13:36,655] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 100/355 train_loss 0.1256  train_acc_1 95.1595
[2021-03-01 22:14:09,709] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 200/355 train_loss 0.1153  train_acc_1 95.9093
[2021-03-01 22:14:42,354] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 300/355 train_loss 0.1133  train_acc_1 95.9395
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:15:25,958] default_module.py->log_info line:141 [INFO]Valid Epoch 58/100 step 400/89 valid_loss 0.1952  valid_acc_1 93.4783
[2021-03-01 22:15:30,980] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8885    0.9472    0.9273    0.9169    0.9372    0.8801       303
          1     0.9161    0.9040    0.9496    0.9100    0.9265    0.8545       302
          2     0.8870    0.8135    0.9669    0.8486    0.8869    0.7745       193

avg / total     0.8986    0.8985    0.9453    0.8978    0.9210    0.8449       798

Covid class AUC=0.9685430463576159
ACC=0.8984962406015038
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.82521944367484 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.82521944367484 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00058: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00058: valid_acc_1  was not in top 1
[2021-03-01 22:15:31,079] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1146  train_acc_1 96.0876
[2021-03-01 22:15:31,079] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3095  valid_acc_1 89.8252
[2021-03-01 22:15:31,079] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:15:31,090] default_module.py->log_info line:141 [INFO]lr=3.6050e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:15:46,804] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 0/355 train_loss 0.1215  train_acc_1 88.8889
[2021-03-01 22:16:21,327] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 100/355 train_loss 0.1184  train_acc_1 95.5996
[2021-03-01 22:16:55,445] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 200/355 train_loss 0.0982  train_acc_1 96.4621
[2021-03-01 22:17:28,335] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 300/355 train_loss 0.1188  train_acc_1 95.7549
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:18:12,215] default_module.py->log_info line:141 [INFO]Valid Epoch 59/100 step 400/89 valid_loss 0.1974  valid_acc_1 93.2367
[2021-03-01 22:18:17,262] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9231    0.9505    0.9515    0.9366    0.9510    0.9043       303
          1     0.9705    0.8709    0.9839    0.9180    0.9256    0.8471       302
          2     0.8419    0.9378    0.9438    0.8873    0.9408    0.8846       193

avg / total     0.9214    0.9173    0.9619    0.9176    0.9389    0.8779       798

Covid class AUC=0.9769480346079897
ACC=0.9172932330827067
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.76030053985252 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.76030053985252 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00059: valid_acc_1 reached 91.76030 (best 91.76030), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=59-valid_acc_1=91.76.ckpt as top 1
INFO:lightning:
Epoch 00059: valid_acc_1 reached 91.76030 (best 91.76030), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=59-valid_acc_1=91.76.ckpt as top 1
[2021-03-01 22:18:18,609] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1224  train_acc_1 95.5243
[2021-03-01 22:18:18,609] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2485  valid_acc_1 91.7603
[2021-03-01 22:18:18,609] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:18:18,617] default_module.py->log_info line:141 [INFO]lr=3.4549e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:18:32,337] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 0/355 train_loss 0.0154  train_acc_1 100.0000
[2021-03-01 22:19:08,164] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 100/355 train_loss 0.0960  train_acc_1 96.9197
[2021-03-01 22:19:41,208] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 200/355 train_loss 0.0934  train_acc_1 97.0149
[2021-03-01 22:20:14,905] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 300/355 train_loss 0.1108  train_acc_1 96.1240
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:21:01,943] default_module.py->log_info line:141 [INFO]Valid Epoch 60/100 step 400/89 valid_loss 0.4086  valid_acc_1 84.7826
[2021-03-01 22:21:06,995] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.7158    0.9142    0.7778    0.8029    0.8432    0.7207       303
          1     0.8863    0.6192    0.9516    0.7290    0.7676    0.5697       302
          2     0.8250    0.8549    0.9421    0.8397    0.8975    0.7984       193

avg / total     0.8067    0.7882    0.8833    0.7838    0.8277    0.6824       798

Covid class AUC=0.8754005554368725
ACC=0.7882205513784462
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.7765304694015 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.7765304694015 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00060: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00060: valid_acc_1  was not in top 1
[2021-03-01 22:21:07,096] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1152  train_acc_1 95.9624
[2021-03-01 22:21:07,096] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5740  valid_acc_1 78.7765
[2021-03-01 22:21:07,096] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:21:07,109] default_module.py->log_info line:141 [INFO]lr=3.3063e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:21:22,786] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 0/355 train_loss 0.1174  train_acc_1 88.8889
[2021-03-01 22:21:58,832] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 100/355 train_loss 0.1179  train_acc_1 95.5996
[2021-03-01 22:22:32,126] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 200/355 train_loss 0.1112  train_acc_1 96.0752
[2021-03-01 22:23:04,951] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 300/355 train_loss 0.1067  train_acc_1 96.3824
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:23:49,775] default_module.py->log_info line:141 [INFO]Valid Epoch 61/100 step 400/89 valid_loss 0.2419  valid_acc_1 91.7874
[2021-03-01 22:23:54,810] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9205    0.9175    0.9515    0.9190    0.9343    0.8700       303
          1     0.9164    0.9073    0.9496    0.9118    0.9282    0.8579       302
          2     0.8579    0.8756    0.9537    0.8667    0.9139    0.8286       193

avg / total     0.9038    0.9035    0.9513    0.9036    0.9271    0.8554       798

Covid class AUC=0.9711800363170263
ACC=0.9035087719298246
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.32459576210279 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.32459576210279 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00061: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00061: valid_acc_1  was not in top 1
[2021-03-01 22:23:54,902] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1079  train_acc_1 96.2754
[2021-03-01 22:23:54,903] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2843  valid_acc_1 90.3246
[2021-03-01 22:23:54,903] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:23:54,915] default_module.py->log_info line:141 [INFO]lr=3.1594e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:24:11,628] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 0/355 train_loss 0.0306  train_acc_1 100.0000
[2021-03-01 22:24:46,530] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 100/355 train_loss 0.0992  train_acc_1 96.5897
[2021-03-01 22:25:19,504] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 200/355 train_loss 0.1019  train_acc_1 96.3516
[2021-03-01 22:25:52,388] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 300/355 train_loss 0.1034  train_acc_1 96.3455
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:26:35,663] default_module.py->log_info line:141 [INFO]Valid Epoch 62/100 step 400/89 valid_loss 0.3280  valid_acc_1 91.0628
[2021-03-01 22:26:40,703] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9514    0.9043    0.9717    0.9272    0.9374    0.8728       303
          1     0.9349    0.9040    0.9617    0.9192    0.9324    0.8643       302
          2     0.8440    0.9534    0.9438    0.8954    0.9486    0.9007       193

avg / total     0.9192    0.9160    0.9612    0.9165    0.9382    0.8763       798

Covid class AUC=0.9773152104251229
ACC=0.9160401002506265
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.63545672813159 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.63545672813159 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00062: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00062: valid_acc_1  was not in top 1
[2021-03-01 22:26:40,805] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1011  train_acc_1 96.5571
[2021-03-01 22:26:40,805] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3090  valid_acc_1 91.6355
[2021-03-01 22:26:40,805] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:26:40,817] default_module.py->log_info line:141 [INFO]lr=3.0143e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:26:55,785] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 0/355 train_loss 0.1861  train_acc_1 88.8889
[2021-03-01 22:27:29,958] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 100/355 train_loss 0.1103  train_acc_1 96.5897
[2021-03-01 22:28:03,116] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 200/355 train_loss 0.1026  train_acc_1 96.5174
[2021-03-01 22:28:36,171] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 300/355 train_loss 0.0985  train_acc_1 96.6777
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:29:19,789] default_module.py->log_info line:141 [INFO]Valid Epoch 63/100 step 400/89 valid_loss 0.3887  valid_acc_1 85.9903
[2021-03-01 22:29:24,829] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9513    0.8383    0.9737    0.8912    0.9035    0.8052       303
          1     0.8471    0.9172    0.8992    0.8808    0.9082    0.8262       302
          2     0.8382    0.8860    0.9455    0.8615    0.9152    0.8327       193

avg / total     0.8845    0.8797    0.9387    0.8801    0.9081    0.8198       798

Covid class AUC=0.965345278786584
ACC=0.8796992481203008
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.95256076769883 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.95256076769883 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00063: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00063: valid_acc_1  was not in top 1
[2021-03-01 22:29:24,921] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1021  train_acc_1 96.5884
[2021-03-01 22:29:24,922] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3504  valid_acc_1 87.9526
[2021-03-01 22:29:24,922] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:29:24,934] default_module.py->log_info line:141 [INFO]lr=2.8711e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:29:40,434] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 0/355 train_loss 0.0107  train_acc_1 100.0000
[2021-03-01 22:30:13,757] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 100/355 train_loss 0.0999  train_acc_1 95.8196
[2021-03-01 22:30:46,872] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 200/355 train_loss 0.0981  train_acc_1 96.2410
[2021-03-01 22:31:19,942] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 300/355 train_loss 0.1024  train_acc_1 96.3086
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:32:05,990] default_module.py->log_info line:141 [INFO]Valid Epoch 64/100 step 400/89 valid_loss 0.2407  valid_acc_1 91.5459
[2021-03-01 22:32:11,015] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9392    0.9175    0.9636    0.9282    0.9403    0.8800       303
          1     0.8806    0.9040    0.9254    0.8922    0.9146    0.8347       302
          2     0.8542    0.8497    0.9537    0.8519    0.9002    0.8020       193

avg / total     0.8965    0.8960    0.9468    0.8961    0.9209    0.8440       798

Covid class AUC=0.966360019226661
ACC=0.8959899749373433
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.57553194881825 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.57553194881825 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00064: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00064: valid_acc_1  was not in top 1
[2021-03-01 22:32:11,120] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0992  train_acc_1 96.4006
[2021-03-01 22:32:11,120] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3055  valid_acc_1 89.5755
[2021-03-01 22:32:11,120] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:32:11,133] default_module.py->log_info line:141 [INFO]lr=2.7300e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:32:26,261] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 0/355 train_loss 0.0139  train_acc_1 100.0000
[2021-03-01 22:32:59,249] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 100/355 train_loss 0.0896  train_acc_1 96.9197
[2021-03-01 22:33:32,622] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 200/355 train_loss 0.0880  train_acc_1 97.1808
[2021-03-01 22:34:06,014] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 300/355 train_loss 0.0875  train_acc_1 97.1945
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:34:49,912] default_module.py->log_info line:141 [INFO]Valid Epoch 65/100 step 400/89 valid_loss 0.3961  valid_acc_1 85.9903
[2021-03-01 22:34:54,933] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9236    0.8383    0.9576    0.8789    0.8959    0.7931       303
          1     0.8379    0.9073    0.8931    0.8712    0.9002    0.8115       302
          2     0.8673    0.8808    0.9570    0.8740    0.9181    0.8366       193

avg / total     0.8776    0.8747    0.9331    0.8748    0.9029    0.8106       798

Covid class AUC=0.9537425229651784
ACC=0.87468671679198
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.45318470644148 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.45318470644148 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00065: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00065: valid_acc_1  was not in top 1
[2021-03-01 22:34:55,024] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0917  train_acc_1 96.9640
[2021-03-01 22:34:55,024] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3884  valid_acc_1 87.4532
[2021-03-01 22:34:55,024] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:34:55,036] default_module.py->log_info line:141 [INFO]lr=2.5912e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:35:10,255] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 0/355 train_loss 0.0042  train_acc_1 100.0000
[2021-03-01 22:35:43,627] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 100/355 train_loss 0.0969  train_acc_1 96.6997
[2021-03-01 22:36:17,402] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 200/355 train_loss 0.0879  train_acc_1 97.3466
[2021-03-01 22:36:50,225] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 300/355 train_loss 0.0885  train_acc_1 97.2315
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:37:33,756] default_module.py->log_info line:141 [INFO]Valid Epoch 66/100 step 400/89 valid_loss 0.2723  valid_acc_1 90.3382
[2021-03-01 22:37:38,806] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9510    0.8977    0.9717    0.9236    0.9340    0.8658       303
          1     0.8875    0.9139    0.9294    0.9005    0.9216    0.8481       302
          2     0.8607    0.8964    0.9537    0.8782    0.9246    0.8500       193

avg / total     0.9051    0.9035    0.9514    0.9039    0.9270    0.8553       798

Covid class AUC=0.9745113223670155
ACC=0.9035087719298246
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.32459567637926 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.32459567637926 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00066: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00066: valid_acc_1  was not in top 1
[2021-03-01 22:37:38,899] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0903  train_acc_1 97.1518
[2021-03-01 22:37:38,899] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2929  valid_acc_1 90.3246
[2021-03-01 22:37:38,900] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:37:38,915] default_module.py->log_info line:141 [INFO]lr=2.4548e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:37:55,785] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 0/355 train_loss 0.1891  train_acc_1 88.8889
[2021-03-01 22:38:28,851] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 100/355 train_loss 0.1041  train_acc_1 96.2596
[2021-03-01 22:39:01,965] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 200/355 train_loss 0.0924  train_acc_1 96.7385
[2021-03-01 22:39:35,765] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 300/355 train_loss 0.0882  train_acc_1 96.9361
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:40:18,686] default_module.py->log_info line:141 [INFO]Valid Epoch 67/100 step 400/89 valid_loss 0.1881  valid_acc_1 92.2705
[2021-03-01 22:40:23,682] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8840    0.9307    0.9253    0.9068    0.9280    0.8616       303
          1     0.8730    0.9106    0.9194    0.8914    0.9150    0.8364       302
          2     0.8963    0.7617    0.9719    0.8235    0.8604    0.7247       193

avg / total     0.8828    0.8822    0.9343    0.8808    0.9067    0.8190       798

Covid class AUC=0.9693775368511002
ACC=0.8822055137844611
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.20224813397012 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.20224813397012 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00067: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00067: valid_acc_1  was not in top 1
[2021-03-01 22:40:23,778] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0920  train_acc_1 96.9014
[2021-03-01 22:40:23,779] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3334  valid_acc_1 88.2022
[2021-03-01 22:40:23,779] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:40:23,792] default_module.py->log_info line:141 [INFO]lr=2.3209e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:40:38,868] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 0/355 train_loss 0.0425  train_acc_1 100.0000
[2021-03-01 22:41:15,231] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 100/355 train_loss 0.0729  train_acc_1 98.0198
[2021-03-01 22:41:49,500] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 200/355 train_loss 0.0791  train_acc_1 97.6230
[2021-03-01 22:42:22,923] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 300/355 train_loss 0.0807  train_acc_1 97.4898
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:43:06,578] default_module.py->log_info line:141 [INFO]Valid Epoch 68/100 step 400/89 valid_loss 0.2627  valid_acc_1 91.5459
[2021-03-01 22:43:11,589] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9241    0.9241    0.9535    0.9241    0.9387    0.8786       303
          1     0.9158    0.9007    0.9496    0.9082    0.9248    0.8511       302
          2     0.8586    0.8808    0.9537    0.8696    0.9165    0.8339       193

avg / total     0.9051    0.9048    0.9521    0.9049    0.9281    0.8574       798

Covid class AUC=0.9710264900662252
ACC=0.9047619047619048
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.3870174965162 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.3870174965162 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00068: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00068: valid_acc_1  was not in top 1
[2021-03-01 22:43:11,679] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0791  train_acc_1 97.5274
[2021-03-01 22:43:11,679] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2970  valid_acc_1 90.3870
[2021-03-01 22:43:11,680] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:43:11,690] default_module.py->log_info line:141 [INFO]lr=2.1896e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:43:28,356] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 0/355 train_loss 0.0158  train_acc_1 100.0000
[2021-03-01 22:44:02,171] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 100/355 train_loss 0.0931  train_acc_1 96.3696
[2021-03-01 22:44:35,804] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 200/355 train_loss 0.0797  train_acc_1 97.3466
[2021-03-01 22:45:08,727] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 300/355 train_loss 0.0862  train_acc_1 97.4160
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:45:51,914] default_module.py->log_info line:141 [INFO]Valid Epoch 69/100 step 400/89 valid_loss 0.2293  valid_acc_1 92.0290
[2021-03-01 22:45:56,951] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9300    0.9208    0.9576    0.9254    0.9390    0.8785       303
          1     0.9281    0.8974    0.9577    0.9125    0.9270    0.8542       302
          2     0.8447    0.9016    0.9471    0.8722    0.9241    0.8500       193

avg / total     0.9086    0.9073    0.9551    0.9076    0.9309    0.8624       798

Covid class AUC=0.9750453962828456
ACC=0.9072681704260651
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.69912732585092 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.69912732585092 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00069: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00069: valid_acc_1  was not in top 1
[2021-03-01 22:45:57,055] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0880  train_acc_1 97.3709
[2021-03-01 22:45:57,055] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2708  valid_acc_1 90.6991
[2021-03-01 22:45:57,055] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:45:57,069] default_module.py->log_info line:141 [INFO]lr=2.0611e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:46:11,318] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 0/355 train_loss 0.0225  train_acc_1 100.0000
[2021-03-01 22:46:47,614] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 100/355 train_loss 0.0717  train_acc_1 97.6898
[2021-03-01 22:47:21,014] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 200/355 train_loss 0.0709  train_acc_1 97.7888
[2021-03-01 22:47:53,996] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 300/355 train_loss 0.0710  train_acc_1 97.7482
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:48:38,091] default_module.py->log_info line:141 [INFO]Valid Epoch 70/100 step 400/89 valid_loss 0.3580  valid_acc_1 87.4396
[2021-03-01 22:48:43,130] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9355    0.8614    0.9636    0.8969    0.9111    0.8216       303
          1     0.8492    0.9139    0.9012    0.8804    0.9075    0.8247       302
          2     0.8454    0.8497    0.9504    0.8475    0.8987    0.7995       193

avg / total     0.8810    0.8784    0.9368    0.8787    0.9067    0.8174       798

Covid class AUC=0.9636162144840846
ACC=0.8784461152882206
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.82771695597788 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.82771695597788 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00070: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00070: valid_acc_1  was not in top 1
[2021-03-01 22:48:43,223] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0705  train_acc_1 97.8091
[2021-03-01 22:48:43,223] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3524  valid_acc_1 87.8277
[2021-03-01 22:48:43,223] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:48:43,233] default_module.py->log_info line:141 [INFO]lr=1.9355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:48:57,531] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 0/355 train_loss 0.0106  train_acc_1 100.0000
[2021-03-01 22:49:32,687] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 100/355 train_loss 0.0572  train_acc_1 98.4598
[2021-03-01 22:50:05,989] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 200/355 train_loss 0.0668  train_acc_1 97.8994
[2021-03-01 22:50:38,973] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 300/355 train_loss 0.0737  train_acc_1 97.5637
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:51:22,720] default_module.py->log_info line:141 [INFO]Valid Epoch 71/100 step 400/89 valid_loss 0.2414  valid_acc_1 91.5459
[2021-03-01 22:51:27,743] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9362    0.9208    0.9616    0.9285    0.9410    0.8818       303
          1     0.9283    0.9007    0.9577    0.9143    0.9287    0.8576       302
          2     0.8454    0.9067    0.9471    0.8750    0.9267    0.8553       193

avg / total     0.9113    0.9098    0.9566    0.9102    0.9329    0.8663       798

Covid class AUC=0.977996154667806
ACC=0.9097744360902256
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.01123715518565 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.01123715518565 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00071: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00071: valid_acc_1  was not in top 1
[2021-03-01 22:51:27,835] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0718  train_acc_1 97.6526
[2021-03-01 22:51:27,835] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2735  valid_acc_1 91.0112
[2021-03-01 22:51:27,835] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:51:27,845] default_module.py->log_info line:141 [INFO]lr=1.8129e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:51:44,449] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 0/355 train_loss 0.0442  train_acc_1 100.0000
[2021-03-01 22:52:17,705] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 100/355 train_loss 0.0748  train_acc_1 97.5798
[2021-03-01 22:52:50,907] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 200/355 train_loss 0.0730  train_acc_1 97.4019
[2021-03-01 22:53:23,928] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 300/355 train_loss 0.0714  train_acc_1 97.4160
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:54:10,264] default_module.py->log_info line:141 [INFO]Valid Epoch 72/100 step 400/89 valid_loss 0.2767  valid_acc_1 91.5459
[2021-03-01 22:54:15,271] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9269    0.9208    0.9556    0.9238    0.9380    0.8768       303
          1     0.9091    0.8940    0.9456    0.9015    0.9194    0.8410       302
          2     0.8450    0.8756    0.9488    0.8601    0.9115    0.8247       193

avg / total     0.9004    0.8997    0.9501    0.9000    0.9246    0.8507       798

Covid class AUC=0.9630087054048281
ACC=0.899749373433584
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.95006381259876 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.95006381259876 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00072: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00072: valid_acc_1  was not in top 1
[2021-03-01 22:54:15,363] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0720  train_acc_1 97.4335
[2021-03-01 22:54:15,363] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3123  valid_acc_1 89.9501
[2021-03-01 22:54:15,363] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:54:15,372] default_module.py->log_info line:141 [INFO]lr=1.6934e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:54:29,941] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 0/355 train_loss 0.0265  train_acc_1 100.0000
[2021-03-01 22:55:03,221] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 100/355 train_loss 0.0723  train_acc_1 97.4697
[2021-03-01 22:55:36,411] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 200/355 train_loss 0.0746  train_acc_1 97.5124
[2021-03-01 22:56:10,347] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 300/355 train_loss 0.0674  train_acc_1 97.6744
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:56:55,149] default_module.py->log_info line:141 [INFO]Valid Epoch 73/100 step 400/89 valid_loss 0.1801  valid_acc_1 92.5121
[2021-03-01 22:57:00,160] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.8987    0.9373    0.9354    0.9176    0.9363    0.8769       303
          1     0.9094    0.8974    0.9456    0.9033    0.9211    0.8444       302
          2     0.8696    0.8290    0.9603    0.8488    0.8923    0.7857       193

avg / total     0.8957    0.8960    0.9453    0.8956    0.9199    0.8425       798

Covid class AUC=0.9731561098055971
ACC=0.8959899749373433
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.57553207740355 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.57553207740355 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00073: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00073: valid_acc_1  was not in top 1
[2021-03-01 22:57:00,248] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0708  train_acc_1 97.6213
[2021-03-01 22:57:00,248] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2969  valid_acc_1 89.5755
[2021-03-01 22:57:00,248] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:57:00,256] default_module.py->log_info line:141 [INFO]lr=1.5773e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 22:57:16,237] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 0/355 train_loss 0.0066  train_acc_1 100.0000
[2021-03-01 22:57:49,667] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 100/355 train_loss 0.0572  train_acc_1 98.0198
[2021-03-01 22:58:23,795] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 200/355 train_loss 0.0624  train_acc_1 97.8994
[2021-03-01 22:58:56,820] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 300/355 train_loss 0.0679  train_acc_1 97.9328
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 22:59:41,789] default_module.py->log_info line:141 [INFO]Valid Epoch 74/100 step 400/89 valid_loss 0.3229  valid_acc_1 89.8551
[2021-03-01 22:59:46,817] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9313    0.8944    0.9596    0.9125    0.9264    0.8527       303
          1     0.9003    0.8974    0.9395    0.8988    0.9182    0.8395       302
          2     0.8350    0.8912    0.9438    0.8622    0.9171    0.8367       193

avg / total     0.8963    0.8947    0.9482    0.8951    0.9211    0.8438       798

Covid class AUC=0.9533553193762017
ACC=0.8947368421052632
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.45068805137377 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.45068805137377 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00074: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00074: valid_acc_1  was not in top 1
[2021-03-01 22:59:46,916] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0676  train_acc_1 97.8717
[2021-03-01 22:59:46,916] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3284  valid_acc_1 89.4507
[2021-03-01 22:59:46,917] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 22:59:46,928] default_module.py->log_info line:141 [INFO]lr=1.4645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:00:01,273] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 0/355 train_loss 0.0131  train_acc_1 100.0000
[2021-03-01 23:00:35,369] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 100/355 train_loss 0.0746  train_acc_1 97.5798
[2021-03-01 23:01:08,616] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 200/355 train_loss 0.0702  train_acc_1 97.8441
[2021-03-01 23:01:41,661] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 300/355 train_loss 0.0719  train_acc_1 97.7113
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:02:26,501] default_module.py->log_info line:141 [INFO]Valid Epoch 75/100 step 400/89 valid_loss 0.1872  valid_acc_1 92.7536
[2021-03-01 23:02:31,557] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9191    0.9373    0.9495    0.9281    0.9434    0.8889       303
          1     0.9408    0.8940    0.9657    0.9168    0.9292    0.8572       302
          2     0.8465    0.8860    0.9488    0.8658    0.9168    0.8353       193

avg / total     0.9097    0.9085    0.9555    0.9088    0.9316    0.8639       798

Covid class AUC=0.9755260628070925
ACC=0.9085213032581454
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.82397126615717 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.82397126615717 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00075: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00075: valid_acc_1  was not in top 1
[2021-03-01 23:02:31,652] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0738  train_acc_1 97.7465
[2021-03-01 23:02:31,652] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2574  valid_acc_1 90.8240
[2021-03-01 23:02:31,652] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:02:31,664] default_module.py->log_info line:141 [INFO]lr=1.3552e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:02:45,814] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 0/355 train_loss 0.0301  train_acc_1 100.0000
[2021-03-01 23:03:19,679] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 100/355 train_loss 0.0496  train_acc_1 98.4598
[2021-03-01 23:03:52,985] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 200/355 train_loss 0.0640  train_acc_1 98.0652
[2021-03-01 23:04:26,167] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 300/355 train_loss 0.0667  train_acc_1 98.0436
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:05:10,896] default_module.py->log_info line:141 [INFO]Valid Epoch 76/100 step 400/89 valid_loss 0.2423  valid_acc_1 92.0290
[2021-03-01 23:05:15,915] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9305    0.9274    0.9576    0.9289    0.9424    0.8854       303
          1     0.9474    0.8940    0.9698    0.9199    0.9311    0.8604       302
          2     0.8389    0.9171    0.9438    0.8762    0.9304    0.8632       193

avg / total     0.9147    0.9123    0.9589    0.9128    0.9352    0.8706       798

Covid class AUC=0.9786570711386455
ACC=0.9122807017543859
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.19850312993768 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.19850312993768 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00076: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00076: valid_acc_1  was not in top 1
[2021-03-01 23:05:16,008] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0653  train_acc_1 98.0595
[2021-03-01 23:05:16,008] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2640  valid_acc_1 91.1985
[2021-03-01 23:05:16,008] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:05:16,020] default_module.py->log_info line:141 [INFO]lr=1.2494e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:05:30,368] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 0/355 train_loss 0.0257  train_acc_1 100.0000
[2021-03-01 23:06:04,886] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 100/355 train_loss 0.0460  train_acc_1 98.6799
[2021-03-01 23:06:38,330] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 200/355 train_loss 0.0586  train_acc_1 98.2311
[2021-03-01 23:07:11,915] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 300/355 train_loss 0.0562  train_acc_1 98.1543
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:07:55,683] default_module.py->log_info line:141 [INFO]Valid Epoch 77/100 step 400/89 valid_loss 0.2441  valid_acc_1 92.7536
[2021-03-01 23:08:00,741] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9402    0.9340    0.9636    0.9371    0.9487    0.8974       303
          1     0.9164    0.9073    0.9496    0.9118    0.9282    0.8579       302
          2     0.8535    0.8756    0.9521    0.8645    0.9131    0.8273       193

avg / total     0.9102    0.9098    0.9555    0.9100    0.9323    0.8655       798

Covid class AUC=0.9778225806451613
ACC=0.9097744360902256
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.94881516360165 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.94881516360165 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00077: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00077: valid_acc_1  was not in top 1
[2021-03-01 23:08:00,837] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0565  train_acc_1 98.0908
[2021-03-01 23:08:00,837] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2895  valid_acc_1 90.9488
[2021-03-01 23:08:00,837] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:08:00,846] default_module.py->log_info line:141 [INFO]lr=1.1474e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:08:16,993] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 0/355 train_loss 0.0874  train_acc_1 88.8889
[2021-03-01 23:08:51,822] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 100/355 train_loss 0.0824  train_acc_1 97.2497
[2021-03-01 23:09:25,325] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 200/355 train_loss 0.0702  train_acc_1 97.2913
[2021-03-01 23:09:58,405] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 300/355 train_loss 0.0696  train_acc_1 97.4529
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:10:43,525] default_module.py->log_info line:141 [INFO]Valid Epoch 78/100 step 400/89 valid_loss 0.3180  valid_acc_1 90.8213
[2021-03-01 23:10:48,589] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9550    0.9109    0.9737    0.9324    0.9418    0.8814       303
          1     0.9215    0.8940    0.9536    0.9076    0.9234    0.8475       302
          2     0.8333    0.9326    0.9405    0.8802    0.9366    0.8765       193

avg / total     0.9129    0.9098    0.9581    0.9104    0.9335    0.8674       798

Covid class AUC=0.9720479064302499
ACC=0.9097744360902256
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.94881524932518 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.94881524932518 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00078: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00078: valid_acc_1  was not in top 1
[2021-03-01 23:10:48,709] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0676  train_acc_1 97.5274
[2021-03-01 23:10:48,709] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2960  valid_acc_1 90.9488
[2021-03-01 23:10:48,709] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:10:48,720] default_module.py->log_info line:141 [INFO]lr=1.0492e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:11:04,802] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 0/355 train_loss 0.0913  train_acc_1 88.8889
[2021-03-01 23:11:38,174] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 100/355 train_loss 0.0614  train_acc_1 98.0198
[2021-03-01 23:12:12,499] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 200/355 train_loss 0.0633  train_acc_1 97.8441
[2021-03-01 23:12:45,604] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 300/355 train_loss 0.0595  train_acc_1 98.1174
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:13:30,983] default_module.py->log_info line:141 [INFO]Valid Epoch 79/100 step 400/89 valid_loss 0.2404  valid_acc_1 92.7536
[2021-03-01 23:13:36,043] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9281    0.9373    0.9556    0.9327    0.9464    0.8940       303
          1     0.9125    0.8974    0.9476    0.9048    0.9221    0.8460       302
          2     0.8564    0.8653    0.9537    0.8608    0.9084    0.8179       193

avg / total     0.9048    0.9048    0.9521    0.9048    0.9280    0.8575       798

Covid class AUC=0.9754726554155094
ACC=0.9047619047619048
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.44943931665313 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.44943931665313 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00079: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00079: valid_acc_1  was not in top 1
Epoch 00080: early stopping
INFO:lightning:Epoch 00080: early stopping
[2021-03-01 23:13:36,133] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0567  train_acc_1 98.3099
[2021-03-01 23:13:36,133] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2927  valid_acc_1 90.4494
[2021-03-01 23:13:36,133] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:13:36,144] default_module.py->log_info line:141 [INFO]lr=9.5492e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:13:51,850] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 0/355 train_loss 0.0152  train_acc_1 100.0000
[2021-03-01 23:14:25,679] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 100/355 train_loss 0.0436  train_acc_1 98.6799
[2021-03-01 23:15:02,036] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 200/355 train_loss 0.0505  train_acc_1 98.3969
[2021-03-01 23:15:34,952] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 300/355 train_loss 0.0577  train_acc_1 98.0805
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:16:18,511] default_module.py->log_info line:141 [INFO]Valid Epoch 80/100 step 400/89 valid_loss 0.2157  valid_acc_1 92.9952
[2021-03-01 23:16:23,543] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9373    0.9373    0.9616    0.9373    0.9494    0.8991       303
          1     0.9542    0.8974    0.9738    0.9249    0.9348    0.8672       302
          2     0.8531    0.9326    0.9488    0.8911    0.9407    0.8834       193

avg / total     0.9233    0.9211    0.9631    0.9214    0.9417    0.8832       798

Covid class AUC=0.9802058854945525
ACC=0.9210526315789473
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.07241092639023 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.07241092639023 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00080: valid_acc_1 reached 92.07241 (best 92.07241), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=80-valid_acc_1=92.07.ckpt as top 1
INFO:lightning:
Epoch 00080: valid_acc_1 reached 92.07241 (best 92.07241), saving model to ./output/ccccii_r3d_18_bs9_s64/version_3/checkpoints/epoch=80-valid_acc_1=92.07.ckpt as top 1
[2021-03-01 23:16:24,905] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0597  train_acc_1 98.0908
[2021-03-01 23:16:24,905] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2484  valid_acc_1 92.0724
[2021-03-01 23:16:24,905] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:16:24,913] default_module.py->log_info line:141 [INFO]lr=8.6460e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:16:39,585] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 0/355 train_loss 0.1177  train_acc_1 88.8889
[2021-03-01 23:17:13,493] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 100/355 train_loss 0.0580  train_acc_1 98.0198
[2021-03-01 23:17:46,996] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 200/355 train_loss 0.0556  train_acc_1 98.1758
[2021-03-01 23:18:20,268] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 300/355 train_loss 0.0549  train_acc_1 98.1543
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:19:04,249] default_module.py->log_info line:141 [INFO]Valid Epoch 81/100 step 400/89 valid_loss 0.2021  valid_acc_1 93.2367
[2021-03-01 23:19:09,258] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9369    0.9307    0.9616    0.9338    0.9460    0.8922       303
          1     0.9420    0.9139    0.9657    0.9277    0.9395    0.8780       302
          2     0.8578    0.9067    0.9521    0.8816    0.9291    0.8594       193

avg / total     0.9197    0.9185    0.9609    0.9189    0.9395    0.8789       798

Covid class AUC=0.9820484405041657
ACC=0.918546365914787
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.82272313150128 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.82272313150128 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00081: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00081: valid_acc_1  was not in top 1
[2021-03-01 23:19:09,355] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0520  train_acc_1 98.3412
[2021-03-01 23:19:09,355] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2479  valid_acc_1 91.8227
[2021-03-01 23:19:09,356] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:19:09,368] default_module.py->log_info line:141 [INFO]lr=7.7836e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:19:24,125] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 0/355 train_loss 0.0176  train_acc_1 100.0000
[2021-03-01 23:19:58,335] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 100/355 train_loss 0.0530  train_acc_1 98.4598
[2021-03-01 23:20:31,885] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 200/355 train_loss 0.0554  train_acc_1 98.2863
[2021-03-01 23:21:05,875] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 300/355 train_loss 0.0526  train_acc_1 98.4496
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:21:49,596] default_module.py->log_info line:141 [INFO]Valid Epoch 82/100 step 400/89 valid_loss 0.1854  valid_acc_1 94.2029
[2021-03-01 23:21:54,633] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9148    0.9571    0.9455    0.9355    0.9513    0.9059       303
          1     0.9197    0.9106    0.9516    0.9151    0.9309    0.8630       302
          2     0.8846    0.8342    0.9653    0.8587    0.8974    0.7947       193

avg / total     0.9094    0.9098    0.9526    0.9092    0.9305    0.8628       798

Covid class AUC=0.9787171544541765
ACC=0.9097744360902256
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.94881499215458 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.94881499215458 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00082: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00082: valid_acc_1  was not in top 1
[2021-03-01 23:21:54,732] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0511  train_acc_1 98.4351
[2021-03-01 23:21:54,732] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2961  valid_acc_1 90.9488
[2021-03-01 23:21:54,733] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:21:54,742] default_module.py->log_info line:141 [INFO]lr=6.9629e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:22:10,693] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 0/355 train_loss 0.0021  train_acc_1 100.0000
[2021-03-01 23:22:46,083] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 100/355 train_loss 0.0578  train_acc_1 98.1298
[2021-03-01 23:23:19,510] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 200/355 train_loss 0.0631  train_acc_1 97.8994
[2021-03-01 23:23:53,988] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 300/355 train_loss 0.0586  train_acc_1 97.9328
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:24:38,359] default_module.py->log_info line:141 [INFO]Valid Epoch 83/100 step 400/89 valid_loss 0.1928  valid_acc_1 93.7198
[2021-03-01 23:24:43,377] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9226    0.9439    0.9515    0.9331    0.9477    0.8974       303
          1     0.9545    0.9040    0.9738    0.9286    0.9382    0.8741       302
          2     0.8663    0.9067    0.9554    0.8861    0.9307    0.8621       193

avg / total     0.9211    0.9198    0.9609    0.9200    0.9400    0.8801       798

Covid class AUC=0.9805330057679983
ACC=0.9197994987468672
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.94756668605162 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.94756668605162 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00083: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00083: valid_acc_1  was not in top 1
[2021-03-01 23:24:43,493] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0568  train_acc_1 98.0282
[2021-03-01 23:24:43,493] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2600  valid_acc_1 91.9476
[2021-03-01 23:24:43,493] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:24:43,506] default_module.py->log_info line:141 [INFO]lr=6.1847e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:25:00,475] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 0/355 train_loss 0.0191  train_acc_1 100.0000
[2021-03-01 23:25:33,795] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 100/355 train_loss 0.0498  train_acc_1 98.3498
[2021-03-01 23:26:07,134] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 200/355 train_loss 0.0419  train_acc_1 98.7839
[2021-03-01 23:26:40,178] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 300/355 train_loss 0.0431  train_acc_1 98.7080
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:27:24,342] default_module.py->log_info line:141 [INFO]Valid Epoch 84/100 step 400/89 valid_loss 0.2610  valid_acc_1 91.5459
[2021-03-01 23:27:29,393] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9203    0.9142    0.9515    0.9172    0.9327    0.8666       303
          1     0.8707    0.9139    0.9173    0.8918    0.9156    0.8381       302
          2     0.8833    0.8238    0.9653    0.8525    0.8918    0.7840       193

avg / total     0.8926    0.8922    0.9419    0.8919    0.9163    0.8358       798

Covid class AUC=0.9689903332621235
ACC=0.8922305764411027
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.20100008503775 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.20100008503775 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00084: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00084: valid_acc_1  was not in top 1
[2021-03-01 23:27:29,483] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0440  train_acc_1 98.6854
[2021-03-01 23:27:29,484] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3600  valid_acc_1 89.2010
[2021-03-01 23:27:29,484] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:27:29,497] default_module.py->log_info line:141 [INFO]lr=5.4497e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:27:43,652] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 0/355 train_loss 0.0058  train_acc_1 100.0000
[2021-03-01 23:28:18,084] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 100/355 train_loss 0.0458  train_acc_1 98.6799
[2021-03-01 23:28:51,351] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 200/355 train_loss 0.0456  train_acc_1 98.6733
[2021-03-01 23:29:24,867] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 300/355 train_loss 0.0418  train_acc_1 98.7449
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:30:08,522] default_module.py->log_info line:141 [INFO]Valid Epoch 85/100 step 400/89 valid_loss 0.1959  valid_acc_1 93.2367
[2021-03-01 23:30:13,610] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9223    0.9406    0.9515    0.9314    0.9460    0.8940       303
          1     0.9381    0.9040    0.9637    0.9207    0.9334    0.8660       302
          2     0.8687    0.8912    0.9570    0.8798    0.9235    0.8473       193

avg / total     0.9153    0.9148    0.9575    0.9149    0.9358    0.8721       798

Covid class AUC=0.9803794595171972
ACC=0.9147869674185464
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.4481910962737 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.4481910962737 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00085: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00085: valid_acc_1  was not in top 1
[2021-03-01 23:30:13,722] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0460  train_acc_1 98.5603
[2021-03-01 23:30:13,723] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2613  valid_acc_1 91.4482
[2021-03-01 23:30:13,723] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:30:13,735] default_module.py->log_info line:141 [INFO]lr=4.7586e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:30:30,658] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 0/355 train_loss 0.0931  train_acc_1 100.0000
[2021-03-01 23:31:04,597] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 100/355 train_loss 0.0640  train_acc_1 97.5798
[2021-03-01 23:31:38,584] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 200/355 train_loss 0.0459  train_acc_1 98.3969
[2021-03-01 23:32:11,662] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 300/355 train_loss 0.0443  train_acc_1 98.5234
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:32:56,244] default_module.py->log_info line:141 [INFO]Valid Epoch 86/100 step 400/89 valid_loss 0.2262  valid_acc_1 92.2705
[2021-03-01 23:33:01,275] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9428    0.9241    0.9657    0.9333    0.9446    0.8886       303
          1     0.9322    0.9106    0.9597    0.9213    0.9348    0.8696       302
          2     0.8544    0.9119    0.9504    0.8822    0.9310    0.8634       193

avg / total     0.9174    0.9160    0.9597    0.9164    0.9376    0.8753       798

Covid class AUC=0.9831232642597736
ACC=0.9160401002506265
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.57303490799464 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.57303490799464 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00086: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00086: valid_acc_1  was not in top 1
[2021-03-01 23:33:01,384] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0441  train_acc_1 98.5603
[2021-03-01 23:33:01,384] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2536  valid_acc_1 91.5730
[2021-03-01 23:33:01,384] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:33:01,393] default_module.py->log_info line:141 [INFO]lr=4.1123e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:33:16,961] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 0/355 train_loss 0.0468  train_acc_1 100.0000
[2021-03-01 23:33:51,787] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 100/355 train_loss 0.0457  train_acc_1 98.6799
[2021-03-01 23:34:25,829] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 200/355 train_loss 0.0428  train_acc_1 98.7839
[2021-03-01 23:34:58,817] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 300/355 train_loss 0.0460  train_acc_1 98.6711
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:35:42,449] default_module.py->log_info line:141 [INFO]Valid Epoch 87/100 step 400/89 valid_loss 0.2316  valid_acc_1 92.0290
[2021-03-01 23:35:47,479] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9272    0.9241    0.9556    0.9256    0.9397    0.8802       303
          1     0.9200    0.9139    0.9516    0.9169    0.9326    0.8664       302
          2     0.8622    0.8756    0.9554    0.8689    0.9146    0.8299       193

avg / total     0.9087    0.9085    0.9540    0.9086    0.9309    0.8628       798

Covid class AUC=0.9792779320657979
ACC=0.9085213032581454
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.82397126615717 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.82397126615717 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00087: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00087: valid_acc_1  was not in top 1
[2021-03-01 23:35:47,595] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0432  train_acc_1 98.7480
[2021-03-01 23:35:47,595] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2902  valid_acc_1 90.8240
[2021-03-01 23:35:47,595] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:35:47,609] default_module.py->log_info line:141 [INFO]lr=3.5112e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:36:02,832] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 0/355 train_loss 0.1271  train_acc_1 88.8889
[2021-03-01 23:36:38,463] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 100/355 train_loss 0.0353  train_acc_1 99.1199
[2021-03-01 23:37:14,146] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 200/355 train_loss 0.0394  train_acc_1 98.8391
[2021-03-01 23:37:46,851] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 300/355 train_loss 0.0421  train_acc_1 98.7080
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:38:30,842] default_module.py->log_info line:141 [INFO]Valid Epoch 88/100 step 400/89 valid_loss 0.2716  valid_acc_1 91.0628
[2021-03-01 23:38:35,882] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9450    0.9076    0.9677    0.9259    0.9372    0.8730       303
          1     0.9115    0.9205    0.9456    0.9160    0.9330    0.8682       302
          2     0.8515    0.8912    0.9504    0.8709    0.9203    0.8420       193

avg / total     0.9097    0.9085    0.9551    0.9089    0.9315    0.8637       798

Covid class AUC=0.9797719504379406
ACC=0.9085213032581454
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.82397152332777 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.82397152332777 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00088: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00088: valid_acc_1  was not in top 1
[2021-03-01 23:38:35,976] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0415  train_acc_1 98.5915
[2021-03-01 23:38:35,976] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2953  valid_acc_1 90.8240
[2021-03-01 23:38:35,976] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:38:35,988] default_module.py->log_info line:141 [INFO]lr=2.9560e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:38:51,472] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 0/355 train_loss 0.0020  train_acc_1 100.0000
[2021-03-01 23:39:26,098] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 100/355 train_loss 0.0347  train_acc_1 98.6799
[2021-03-01 23:39:59,566] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 200/355 train_loss 0.0443  train_acc_1 98.7839
[2021-03-01 23:40:32,641] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 300/355 train_loss 0.0414  train_acc_1 98.8188
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:41:16,792] default_module.py->log_info line:141 [INFO]Valid Epoch 89/100 step 400/89 valid_loss 0.2542  valid_acc_1 92.0290
[2021-03-01 23:41:21,826] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9333    0.9241    0.9596    0.9287    0.9417    0.8836       303
          1     0.9203    0.9172    0.9516    0.9187    0.9343    0.8698       302
          2     0.8629    0.8808    0.9554    0.8718    0.9173    0.8352       193

avg / total     0.9114    0.9110    0.9556    0.9112    0.9330    0.8667       798

Covid class AUC=0.9800122837000641
ACC=0.9110275689223057
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.07365931821673 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.07365931821673 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00089: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00089: valid_acc_1  was not in top 1
[2021-03-01 23:41:21,924] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0429  train_acc_1 98.8106
[2021-03-01 23:41:21,924] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2957  valid_acc_1 91.0737
[2021-03-01 23:41:21,924] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:41:21,936] default_module.py->log_info line:141 [INFO]lr=2.4472e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:41:36,568] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 0/355 train_loss 0.0466  train_acc_1 100.0000
[2021-03-01 23:42:09,966] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 100/355 train_loss 0.0358  train_acc_1 99.1199
[2021-03-01 23:42:43,413] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 200/355 train_loss 0.0365  train_acc_1 99.0603
[2021-03-01 23:43:16,662] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 300/355 train_loss 0.0410  train_acc_1 98.8926
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:44:00,537] default_module.py->log_info line:141 [INFO]Valid Epoch 90/100 step 400/89 valid_loss 0.2434  valid_acc_1 91.3043
[2021-03-01 23:44:05,594] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9324    0.9109    0.9596    0.9215    0.9349    0.8698       303
          1     0.9139    0.9139    0.9476    0.9139    0.9306    0.8631       302
          2     0.8650    0.8964    0.9554    0.8804    0.9254    0.8513       193

avg / total     0.9091    0.9085    0.9540    0.9087    0.9310    0.8628       798

Covid class AUC=0.980759987182226
ACC=0.9085213032581454
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.82397143760424 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.82397143760424 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00090: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00090: valid_acc_1  was not in top 1
[2021-03-01 23:44:05,704] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0419  train_acc_1 98.8106
[2021-03-01 23:44:05,705] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2817  valid_acc_1 90.8240
[2021-03-01 23:44:05,705] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:44:05,717] default_module.py->log_info line:141 [INFO]lr=1.9853e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:44:20,012] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 0/355 train_loss 0.0381  train_acc_1 100.0000
[2021-03-01 23:44:53,660] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 100/355 train_loss 0.0512  train_acc_1 98.7899
[2021-03-01 23:45:27,089] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 200/355 train_loss 0.0439  train_acc_1 98.8944
[2021-03-01 23:46:00,347] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 300/355 train_loss 0.0426  train_acc_1 98.7818
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:46:46,398] default_module.py->log_info line:141 [INFO]Valid Epoch 91/100 step 400/89 valid_loss 0.2271  valid_acc_1 92.0290
[2021-03-01 23:46:51,450] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9302    0.9241    0.9576    0.9272    0.9407    0.8819       303
          1     0.9223    0.9040    0.9536    0.9130    0.9285    0.8578       302
          2     0.8557    0.8912    0.9521    0.8731    0.9211    0.8433       193

avg / total     0.9092    0.9085    0.9547    0.9087    0.9313    0.8634       798

Covid class AUC=0.9811071352275155
ACC=0.9085213032581454
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.82397152332777 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.82397152332777 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00091: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00091: valid_acc_1  was not in top 1
[2021-03-01 23:46:51,548] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0409  train_acc_1 98.8106
[2021-03-01 23:46:51,549] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2805  valid_acc_1 90.8240
[2021-03-01 23:46:51,549] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:46:51,558] default_module.py->log_info line:141 [INFO]lr=1.5708e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:47:07,407] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 0/355 train_loss 0.0074  train_acc_1 100.0000
[2021-03-01 23:47:40,808] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 100/355 train_loss 0.0539  train_acc_1 98.8999
[2021-03-01 23:48:14,250] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 200/355 train_loss 0.0496  train_acc_1 98.6733
[2021-03-01 23:48:47,520] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 300/355 train_loss 0.0440  train_acc_1 98.6711
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:49:31,321] default_module.py->log_info line:141 [INFO]Valid Epoch 92/100 step 400/89 valid_loss 0.2283  valid_acc_1 91.7874
[2021-03-01 23:49:36,352] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9295    0.9142    0.9576    0.9218    0.9356    0.8716       303
          1     0.9118    0.9238    0.9456    0.9178    0.9346    0.8717       302
          2     0.8660    0.8705    0.9570    0.8682    0.9127    0.8258       193

avg / total     0.9074    0.9073    0.9529    0.9073    0.9297    0.8606       798

Covid class AUC=0.9795716727195044
ACC=0.9072681704260651
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.69912762588329 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.69912762588329 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00092: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00092: valid_acc_1  was not in top 1
[2021-03-01 23:49:36,465] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0438  train_acc_1 98.6854
[2021-03-01 23:49:36,465] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2954  valid_acc_1 90.6991
[2021-03-01 23:49:36,465] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:49:36,477] default_module.py->log_info line:141 [INFO]lr=1.2042e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:49:50,198] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 0/355 train_loss 0.0507  train_acc_1 100.0000
[2021-03-01 23:50:24,398] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 100/355 train_loss 0.0415  train_acc_1 98.7899
[2021-03-01 23:50:58,066] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 200/355 train_loss 0.0430  train_acc_1 98.7286
[2021-03-01 23:51:31,717] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 300/355 train_loss 0.0472  train_acc_1 98.5973
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:52:15,142] default_module.py->log_info line:141 [INFO]Valid Epoch 93/100 step 400/89 valid_loss 0.2744  valid_acc_1 91.3043
[2021-03-01 23:52:20,173] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9452    0.9109    0.9677    0.9277    0.9389    0.8764       303
          1     0.9208    0.9238    0.9516    0.9223    0.9376    0.8767       302
          2     0.8670    0.9119    0.9554    0.8889    0.9334    0.8674       193

avg / total     0.9171    0.9160    0.9586    0.9163    0.9371    0.8744       798

Covid class AUC=0.9794448301644948
ACC=0.9160401002506265
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.57303525088878 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.57303525088878 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00093: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00093: valid_acc_1  was not in top 1
[2021-03-01 23:52:20,274] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0468  train_acc_1 98.5603
[2021-03-01 23:52:20,275] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2876  valid_acc_1 91.5730
[2021-03-01 23:52:20,275] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:52:20,286] default_module.py->log_info line:141 [INFO]lr=8.8564e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:52:35,662] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 0/355 train_loss 0.0088  train_acc_1 100.0000
[2021-03-01 23:53:10,523] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 100/355 train_loss 0.0430  train_acc_1 98.5699
[2021-03-01 23:53:44,679] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 200/355 train_loss 0.0417  train_acc_1 98.6180
[2021-03-01 23:54:18,405] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 300/355 train_loss 0.0433  train_acc_1 98.4865
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:55:02,240] default_module.py->log_info line:141 [INFO]Valid Epoch 94/100 step 400/89 valid_loss 0.2380  valid_acc_1 91.3043
[2021-03-01 23:55:07,275] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9356    0.9109    0.9616    0.9231    0.9359    0.8715       303
          1     0.9167    0.9106    0.9496    0.9136    0.9299    0.8613       302
          2     0.8522    0.8964    0.9504    0.8737    0.9230    0.8473       193

avg / total     0.9083    0.9073    0.9544    0.9076    0.9305    0.8618       798

Covid class AUC=0.9810003204443495
ACC=0.9072681704260651
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.69912762588329 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.69912762588329 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00094: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00094: valid_acc_1  was not in top 1
[2021-03-01 23:55:07,382] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0422  train_acc_1 98.5915
[2021-03-01 23:55:07,382] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2728  valid_acc_1 90.6991
[2021-03-01 23:55:07,382] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:55:07,394] default_module.py->log_info line:141 [INFO]lr=6.1558e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:55:24,253] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 0/355 train_loss 0.0009  train_acc_1 100.0000
[2021-03-01 23:55:59,645] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 100/355 train_loss 0.0410  train_acc_1 98.8999
[2021-03-01 23:56:33,107] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 200/355 train_loss 0.0516  train_acc_1 98.3969
[2021-03-01 23:57:06,167] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 300/355 train_loss 0.0484  train_acc_1 98.5604
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 23:57:50,506] default_module.py->log_info line:141 [INFO]Valid Epoch 95/100 step 400/89 valid_loss 0.2441  valid_acc_1 90.8213
[2021-03-01 23:57:55,552] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9322    0.9076    0.9596    0.9197    0.9332    0.8664       303
          1     0.9136    0.9106    0.9476    0.9121    0.9289    0.8597       302
          2     0.8564    0.8964    0.9521    0.8759    0.9238    0.8487       193

avg / total     0.9068    0.9060    0.9532    0.9063    0.9293    0.8596       798

Covid class AUC=0.9812873851741081
ACC=0.9060150375939849
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.57428372843881 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.57428372843881 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00095: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00095: valid_acc_1  was not in top 1
[2021-03-01 23:57:55,653] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0453  train_acc_1 98.6854
[2021-03-01 23:57:55,653] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2756  valid_acc_1 90.5743
[2021-03-01 23:57:55,653] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 23:57:55,666] default_module.py->log_info line:141 [INFO]lr=3.9426e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 23:58:09,788] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 0/355 train_loss 0.1682  train_acc_1 100.0000
[2021-03-01 23:58:45,280] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 100/355 train_loss 0.0499  train_acc_1 99.0099
[2021-03-01 23:59:18,731] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 200/355 train_loss 0.0463  train_acc_1 99.0050
[2021-03-01 23:59:51,893] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 300/355 train_loss 0.0390  train_acc_1 99.2248
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 00:00:36,257] default_module.py->log_info line:141 [INFO]Valid Epoch 96/100 step 400/89 valid_loss 0.2180  valid_acc_1 91.5459
[2021-03-02 00:00:41,481] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9267    0.9175    0.9556    0.9221    0.9363    0.8734       303
          1     0.9259    0.9106    0.9556    0.9182    0.9328    0.8663       302
          2     0.8607    0.8964    0.9537    0.8782    0.9246    0.8500       193

avg / total     0.9104    0.9098    0.9551    0.9100    0.9322    0.8650       798

Covid class AUC=0.9811605426190985
ACC=0.9097744360902256
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.94881550649579 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.94881550649579 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00096: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00096: valid_acc_1  was not in top 1
[2021-03-02 00:00:41,583] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0383  train_acc_1 99.1549
[2021-03-02 00:00:41,583] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2691  valid_acc_1 90.9488
[2021-03-02 00:00:41,583] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 00:00:41,593] default_module.py->log_info line:141 [INFO]lr=2.2190e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 00:00:58,359] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 0/355 train_loss 0.0395  train_acc_1 100.0000
[2021-03-02 00:01:31,831] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 100/355 train_loss 0.0325  train_acc_1 98.6799
[2021-03-02 00:02:05,213] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 200/355 train_loss 0.0374  train_acc_1 98.6733
[2021-03-02 00:02:38,609] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 300/355 train_loss 0.0380  train_acc_1 98.7080
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 00:03:22,641] default_module.py->log_info line:141 [INFO]Valid Epoch 97/100 step 400/89 valid_loss 0.2218  valid_acc_1 92.2705
[2021-03-02 00:03:27,682] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9302    0.9241    0.9576    0.9272    0.9407    0.8819       303
          1     0.9172    0.9172    0.9496    0.9172    0.9333    0.8682       302
          2     0.8769    0.8860    0.9603    0.8814    0.9224    0.8445       193

avg / total     0.9124    0.9123    0.9552    0.9123    0.9335    0.8677       798

Covid class AUC=0.9809001815851314
ACC=0.9122807017543859
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.19850338710827 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.19850338710827 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00097: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00097: valid_acc_1  was not in top 1
[2021-03-02 00:03:27,777] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0399  train_acc_1 98.6854
[2021-03-02 00:03:27,777] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2738  valid_acc_1 91.1985
[2021-03-02 00:03:27,777] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 00:03:27,789] default_module.py->log_info line:141 [INFO]lr=9.8664e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 00:03:43,665] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 0/355 train_loss 0.0140  train_acc_1 100.0000
[2021-03-02 00:04:18,088] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 100/355 train_loss 0.0446  train_acc_1 98.4598
[2021-03-02 00:04:51,629] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 200/355 train_loss 0.0379  train_acc_1 98.7839
[2021-03-02 00:05:24,786] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 300/355 train_loss 0.0370  train_acc_1 98.8557
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 00:06:09,263] default_module.py->log_info line:141 [INFO]Valid Epoch 98/100 step 400/89 valid_loss 0.2046  valid_acc_1 92.2705
[2021-03-02 00:06:14,316] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9305    0.9274    0.9576    0.9289    0.9424    0.8854       303
          1     0.9197    0.9106    0.9516    0.9151    0.9309    0.8630       302
          2     0.8629    0.8808    0.9554    0.8718    0.9173    0.8352       193

avg / total     0.9101    0.9098    0.9548    0.9099    0.9320    0.8648       798

Covid class AUC=0.981507690664388
ACC=0.9097744360902256
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.94881567794286 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.94881567794286 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00098: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00098: valid_acc_1  was not in top 1
[2021-03-02 00:06:14,449] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0375  train_acc_1 98.8106
[2021-03-02 00:06:14,450] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2667  valid_acc_1 90.9488
[2021-03-02 00:06:14,450] default_module.py->log_info line:141 [INFO]===========================

[2021-03-02 00:06:14,461] default_module.py->log_info line:141 [INFO]lr=2.4672e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-02 00:06:29,454] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 0/355 train_loss 0.0206  train_acc_1 100.0000
[2021-03-02 00:07:03,094] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 100/355 train_loss 0.0435  train_acc_1 98.7899
[2021-03-02 00:07:36,658] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 200/355 train_loss 0.0401  train_acc_1 98.7286
[2021-03-02 00:08:10,023] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 300/355 train_loss 0.0393  train_acc_1 98.8557
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-02 00:08:54,410] default_module.py->log_info line:141 [INFO]Valid Epoch 99/100 step 400/89 valid_loss 0.2418  valid_acc_1 91.3043
[2021-03-02 00:08:59,453] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.9386    0.9076    0.9636    0.9228    0.9352    0.8697       303
          1     0.9088    0.9238    0.9435    0.9163    0.9336    0.8700       302
          2     0.8636    0.8860    0.9554    0.8747    0.9200    0.8406       193

avg / total     0.9092    0.9085    0.9540    0.9087    0.9309    0.8628       798

Covid class AUC=0.9810737556077761
ACC=0.9085213032581454
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.82397160905131 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.82397160905131 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00099: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00099: valid_acc_1  was not in top 1
[2021-03-02 00:08:59,564] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0390  train_acc_1 98.8419
[2021-03-02 00:08:59,565] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2806  valid_acc_1 90.8240
[2021-03-02 00:08:59,565] default_module.py->log_info line:141 [INFO]===========================

