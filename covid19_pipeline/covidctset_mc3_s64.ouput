[2021-03-01 15:32:02,632] config.py->setup_cfg_with_hparams line:84 [INFO]Running with full config:
DEFAULT_CUDNN_BENCHMARK: True
SEED: 228
VERSION: 1
abtfs:
    blur:
        blur_limit: 3
        enable: 0
    bright:
        clip_limit: 1
        enable: 1
    channel_dropout:
        drop_range: (1, 1)
        enable: 0
        fill_value: 127
    channel_shuffle:
        enable: 0
    cutout:
        enable: 1
        fill_value: 127
        num_holes: 10
        size: 20
    distortion:
        enable: 0
    hue:
        enable: 0
    noise:
        enable: 1
    random_grid_shuffle:
        enable: 0
        grid: 2
    rotate:
        enable: 1
        p: 1
        rotate_limit: 45
        scale_limit: 0.2
        shift_limit: 0.0625
cam:
    debug: False
    featmaps_module_name: 'glob_avgpool'
    label: -1
    model_path: ''
    save_path: './cam_results'
    scan_path: ''
    weights_module_name: 'fc'
dataloader:
    num_workers: 40
    sample_test: 'default'
    sample_train: 'default'
    sampler:
        replacement: True
        weights_cls: [0, 0.23, 0.77]
dataset:
    batch_size: 9
    dir: '/home/datasets/COVID-19_CTs/COVID-CTset/COVID-CTset'
    is_3d: True
    is_color: False
    is_train: False
    name: 'CTDataset'
    slice_num: 64
    subset_train: 1.0
    subset_valid: 1.0
    test_list: '/home/datasets/COVID-19_CTs/covid_ctset/test_balance.json'
    train_list: '/home/datasets/COVID-19_CTs/covid_ctset/train_balance.json'
    valid_list: '/home/datasets/COVID-19_CTs/covid_ctset/test_balance.json'
hooks:
    early_stopping:
        min_delta: 0.0
        mode: 'max'
        monitor: 'valid_acc_1'
        patience: 20
        setting: 2
        verbose: 1
    model_checkpoint:
        filepath: ''
        mode: 'max'
        monitor: 'valid_acc_1'
        period: 1
        prefix: ''
        save_top_k: 1
        save_weights_only: False
        setting: 2
        verbose: 1
hparams: Namespace(cam_only=False, config_file='./config/covidctset_config.yml', opts=['trainer.gpus', '[3]', 'model.name', 'mc3_18', 'dataset.slice_num', '64', 'dataset.batch_size', '9', 'trainer.logger.test_tube.name', 'covidctset_mc3_18_bs9_s64'], predict_only=False, test_only=False)
input:
    size: (128, 128)
label_transforms:
    name: 'default'
log:
    name: './output/covidctset_mc3_18_bs9_s64/version_0/log.txt'
    path: './output/covidctset_mc3_18_bs9_s64/version_0'
loss:
    class_weight: []
    focal_loss:
        alpha: []
        gamma: 2
        size_average: True
    label_smoothing: 0.1
    name: 'CrossEntropy'
mixup:
    alpha: 0.4
    enable: 0
model:
    classes: 3
    dropout: 0
    finetune: False
    model_depth: 101
    n_input_channels: 1
    name: 'mc3_18'
    pretrained: False
module:
    analyze_result: True
    name: 'CTModule'
optim:
    base_lr: 0.001
    momentum: 0.9
    name: 'adam'
    scheduler:
        gamma: 0.1
        milestones: [10, 25, 35, 50]
        mode: 'min'
        name: 'CosineAnnealingLR'
        patience: 10
        step_size: 10
        t_0: 5
        t_max: 100
        t_mul: 20
        verbose: True
    weight_decay: 0.0005
predict_only:
    load_ckpt:
        checkpoint_path: ''
    load_metric:
        map_location: 'cuda:0'
        on_gpu: True
        tags_csv: ''
        weights_path: ''
    to_pred_file_path: ''
    type: 'ckpt'
topk: [1, 1]
trainer:
    accumulate_grad_batches: 1
    amp_level: 'O1'
    auto_lr_find: False
    auto_scale_batch_size: False
    auto_select_gpus: False
    benchmark: False
    check_val_every_n_epoch: 1
    default_root_dir: './output'
    default_save_path: './output'
    distributed_backend: 'dp'
    fast_dev_run: False
    gpus: [3]
    gradient_clip_val: 0
    log_gpu_memory: ''
    log_save_interval: 100
    logger:
        mlflow:
            experiment_name: 'torchline_logs'
            tracking_uri: './output'
        setting: 2
        test_tube:
            name: 'covidctset_mc3_18_bs9_s64'
            save_dir: './output'
            version: -1
        type: 'test_tube'
    max_epochs: 100
    max_steps: 99999999
    min_epochs: 99
    min_steps: 99999999
    name: 'DefaultTrainer'
    num_nodes: 1
    num_sanity_val_steps: 5
    num_tpu_cores: ''
    overfit_pct: 0.0
    precision: 32
    print_nan_grads: True
    process_position: 0
    progress_bar_refresh_rate: 0
    reload_dataloaders_every_epoch: False
    replace_sampler_ddp: True
    resume_from_checkpoint: ''
    row_log_interval: 10
    show_progress_bar: False
    terminate_on_nan: False
    test_percent_check: 1.0
    track_grad_norm: -1
    train_percent_check: 1.0
    truncated_bptt_steps: ''
    use_amp: False
    val_check_interval: 1.0
    val_percent_check: 1.0
    weights_save_path: ''
    weights_summary: ''
transforms:
    ct:
        randomaffine:
            degrees: (-10, 10)
            enable: 0
            isotropic: True
            p: 0.5
            scales: (0.5, 0.5)
        randomblur:
            enable: 0
            p: 0.5
            std: (0, 4)
        randomelasticdeformation:
            enable: 0
            locked_borders: 0
            max_displacement: (7, 7, 7)
            num_control_points: (4, 4, 4)
            p: 0.5
        randomflip:
            axes: (0, 1, 2)
            enable: 1
            flip_probability: 0.5
            p: 0.5
        randomnoise:
            enable: 0
            mean: (0, 0.25)
            p: 0.5
            std: (0, 0.25)
        randomswap:
            enable: 0
            num_iterations: 100
            p: 0.5
            patch_size: (16, 16, 16)
    img:
        aug_cifar: False
        aug_imagenet: False
        center_crop:
            enable: 0
        color_jitter:
            brightness: 0.1
            contrast: 0.1
            enable: 0
            hue: 0.1
            saturation: 0.1
        random_crop:
            enable: 1
            padding: 0
        random_horizontal_flip:
            enable: 1
            p: 0.5
        random_resized_crop:
            enable: 0
            ratio: (0.75, 1.3333333333333333)
            scale: (0.5, 1.0)
        random_rotation:
            degrees: 10
            enable: 1
        random_vertical_flip:
            enable: 1
            p: 0.5
        resize:
            enable: 1
    name: 'CTTransforms'
    tensor:
        normalization:
            mean: [0.5, 0.5, 0.5]
            std: [0.5, 0.5, 0.5]
        random_erasing:
            enable: 0
            p: 0.5
            ratio: ((0.3, 3.3),)
            scale: (0.02, 0.3)
GPU available: True, used: True
No environment variable for node rank defined. Set as 0.
CUDA_VISIBLE_DEVICES: [3]
If you use TorchIO for your research, please cite the following paper:
Pérez-García et al., TorchIO: a Python library for efficient loading,
preprocessing, augmentation and patch-based sampling of medical images
in deep learning. Link: https://arxiv.org/abs/2003.04696

Generating validation transform ...
Valid transform=Compose(
)
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Sensitivity is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:32:55,925] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000       0.0
          1     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000      42.0
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000       3.0

avg / total     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000      45.0

Covid class AUC=0.5873015873015873
ACC=0.0
[2021-03-01 15:33:33,288] default_module.py->log_info line:141 [INFO]lr=1.0000e-03
Generating training transform ...
Train transform=Compose(
    <torchio.transforms.augmentation.spatial.random_flip.RandomFlip object at 0x7f52e5892390>
)
Generating validation transform ...
Valid transform=Compose(
)
None
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:34:38,130] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 0/45 train_loss 1.0653  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:36:49,348] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.4409    0.9762    0.3659    0.6074    0.5976    0.3789        42
          2     0.9677    0.3659    0.9762    0.5310    0.5976    0.3353        82

avg / total     0.7893    0.5726    0.7695    0.5569    0.5976    0.3501       124

Covid class AUC=0.8751451800232288
ACC=0.5725806451612904
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 41.687552753247715 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)

Epoch 00000: valid_acc_1 reached 41.68755 (best 41.68755), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=0-valid_acc_1=41.69.ckpt as top 1
INFO:lightning:
Epoch 00000: valid_acc_1 reached 41.68755 (best 41.68755), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=0-valid_acc_1=41.69.ckpt as top 1
[2021-03-01 15:36:49,897] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6933  train_acc_1 66.6667
[2021-03-01 15:36:49,898] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 2.1921  valid_acc_1 41.6876
[2021-03-01 15:36:49,898] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:36:49,905] default_module.py->log_info line:141 [INFO]lr=9.9975e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:37:34,687] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 0/45 train_loss 0.2954  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:39:30,317] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.0238    1.0000    0.0465    0.1543    0.0215        42
          2     0.6667    1.0000    0.0238    0.8000    0.1543    0.0261        82

avg / total     0.7796    0.6694    0.3545    0.5448    0.1543    0.0246       124

Covid class AUC=0.7453542392566783
ACC=0.6693548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 67.4603179522923 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 67.4603179522923 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00001: valid_acc_1 reached 67.46032 (best 67.46032), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=1-valid_acc_1=67.46.ckpt as top 1
INFO:lightning:
Epoch 00001: valid_acc_1 reached 67.46032 (best 67.46032), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=1-valid_acc_1=67.46.ckpt as top 1
[2021-03-01 15:39:30,848] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3939  train_acc_1 83.5802
[2021-03-01 15:39:30,848] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.1474  valid_acc_1 67.4603
[2021-03-01 15:39:30,849] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:39:30,856] default_module.py->log_info line:141 [INFO]lr=9.9901e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:40:26,888] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 0/45 train_loss 0.1767  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:42:11,294] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.3387    1.0000    0.0000    0.5060    0.0000    0.0000        42
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        82

avg / total     0.1147    0.3387    0.6613    0.1714    0.0000    0.0000       124

Covid class AUC=0.6173054587688734
ACC=0.3387096774193548
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 33.33333315168108 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 33.33333315168108 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00002: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00002: valid_acc_1  was not in top 1
[2021-03-01 15:42:11,345] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2831  train_acc_1 87.4074
[2021-03-01 15:42:11,345] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 2.7198  valid_acc_1 33.3333
[2021-03-01 15:42:11,345] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:42:11,353] default_module.py->log_info line:141 [INFO]lr=9.9778e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:42:48,289] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 0/45 train_loss 0.4654  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:44:31,003] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        42
          2     0.6613    1.0000    0.0000    0.7961    0.0000    0.0000        82

avg / total     0.4373    0.6613    0.3387    0.5265    0.0000    0.0000       124

Covid class AUC=0.8774680603948897
ACC=0.6612903225806451
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 66.6666671207973 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 66.6666671207973 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00003: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00003: valid_acc_1  was not in top 1
[2021-03-01 15:44:31,057] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3640  train_acc_1 82.8395
[2021-03-01 15:44:31,058] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.4838  valid_acc_1 66.6667
[2021-03-01 15:44:31,058] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:44:31,067] default_module.py->log_info line:141 [INFO]lr=9.9606e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:45:16,431] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 0/45 train_loss 0.2234  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:47:15,128] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.5952    1.0000    0.7463    0.7715    0.5711        42
          2     0.8283    1.0000    0.5952    0.9061    0.7715    0.6193        82

avg / total     0.8864    0.8629    0.7323    0.8519    0.7715    0.6030       124

Covid class AUC=0.93931475029036
ACC=0.8629032258064516
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.5079368863787 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.5079368863787 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00004: valid_acc_1 reached 86.50794 (best 86.50794), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=4-valid_acc_1=86.51.ckpt as top 1
INFO:lightning:
Epoch 00004: valid_acc_1 reached 86.50794 (best 86.50794), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=4-valid_acc_1=86.51.ckpt as top 1
[2021-03-01 15:47:15,686] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3400  train_acc_1 85.4321
[2021-03-01 15:47:15,687] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4236  valid_acc_1 86.5079
[2021-03-01 15:47:15,687] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:47:15,693] default_module.py->log_info line:141 [INFO]lr=9.9384e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:48:14,635] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 0/45 train_loss 0.3228  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:49:57,699] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5062    0.9762    0.5122    0.6667    0.7071    0.5232        42
          2     0.9767    0.5122    0.9762    0.6720    0.7071    0.4768        82

avg / total     0.8174    0.6694    0.8190    0.6702    0.7071    0.4925       124

Covid class AUC=0.8914053426248548
ACC=0.6693548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 66.55328791482108 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 66.55328791482108 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00005: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00005: valid_acc_1  was not in top 1
[2021-03-01 15:49:57,759] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3147  train_acc_1 84.4444
[2021-03-01 15:49:57,760] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5858  valid_acc_1 66.5533
[2021-03-01 15:49:57,760] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:49:57,768] default_module.py->log_info line:141 [INFO]lr=9.9114e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:50:39,185] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 0/45 train_loss 0.0646  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:52:24,534] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.1190    1.0000    0.2128    0.3450    0.1086        42
          2     0.6891    1.0000    0.1190    0.8159    0.3450    0.1295        82

avg / total     0.7944    0.7016    0.4174    0.6116    0.3450    0.1224       124

Covid class AUC=0.9378629500580721
ACC=0.7016129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 70.63492148263114 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 70.63492148263114 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00006: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00006: valid_acc_1  was not in top 1
[2021-03-01 15:52:24,598] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3341  train_acc_1 85.3086
[2021-03-01 15:52:24,599] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5282  valid_acc_1 70.6349
[2021-03-01 15:52:24,599] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:52:24,607] default_module.py->log_info line:141 [INFO]lr=9.8796e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:53:05,742] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 0/45 train_loss 0.1226  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:54:53,909] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5352    0.9048    0.5976    0.6726    0.7353    0.5573        42
          2     0.9245    0.5976    0.9048    0.7259    0.7353    0.5240        82

avg / total     0.7927    0.7016    0.8007    0.7079    0.7353    0.5353       124

Covid class AUC=0.9102787456445993
ACC=0.7016129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 69.7278916495187 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 69.7278916495187 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00007: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00007: valid_acc_1  was not in top 1
[2021-03-01 15:54:54,078] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2882  train_acc_1 87.0370
[2021-03-01 15:54:54,079] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4912  valid_acc_1 69.7279
[2021-03-01 15:54:54,079] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:54:54,087] default_module.py->log_info line:141 [INFO]lr=9.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:55:51,098] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 0/45 train_loss 0.2270  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:57:41,472] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8205    0.7619    0.9146    0.7901    0.8348    0.6862        42
          2     0.8824    0.9146    0.7619    0.8982    0.8348    0.7075        82

avg / total     0.8614    0.8629    0.8136    0.8616    0.8348    0.7003       124

Covid class AUC=0.923054587688734
ACC=0.8629032258064516
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.50793784005302 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.50793784005302 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00008: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00008: valid_acc_1  was not in top 1
[2021-03-01 15:57:41,702] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1987  train_acc_1 90.9877
[2021-03-01 15:57:41,702] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3006  valid_acc_1 86.5079
[2021-03-01 15:57:41,702] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:57:41,711] default_module.py->log_info line:141 [INFO]lr=9.8015e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:58:37,994] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 0/45 train_loss 0.1615  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:00:26,561] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7917    0.9048    0.8780    0.8444    0.8913    0.7965        42
          2     0.9474    0.8780    0.9048    0.9114    0.8913    0.7923        82

avg / total     0.8946    0.8871    0.8957    0.8887    0.8913    0.7937       124

Covid class AUC=0.9422183507549362
ACC=0.8870967741935484
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.8888909476144 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.8888909476144 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00009: valid_acc_1 reached 88.88889 (best 88.88889), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=9-valid_acc_1=88.89.ckpt as top 1
INFO:lightning:
Epoch 00009: valid_acc_1 reached 88.88889 (best 88.88889), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=9-valid_acc_1=88.89.ckpt as top 1
[2021-03-01 16:00:27,123] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3048  train_acc_1 85.9259
[2021-03-01 16:00:27,123] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3938  valid_acc_1 88.8889
[2021-03-01 16:00:27,123] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:00:27,129] default_module.py->log_info line:141 [INFO]lr=9.7553e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:01:14,799] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 0/45 train_loss 0.0698  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:03:09,463] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.3571    1.0000    0.5263    0.5976    0.3342        42
          2     0.7523    1.0000    0.3571    0.8586    0.5976    0.3801        82

avg / total     0.8362    0.7823    0.5749    0.7461    0.5976    0.3645       124

Covid class AUC=0.9503484320557491
ACC=0.782258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.5714293207441 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.5714293207441 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00010: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00010: valid_acc_1  was not in top 1
[2021-03-01 16:03:09,700] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2534  train_acc_1 88.2716
[2021-03-01 16:03:09,700] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4383  valid_acc_1 78.5714
[2021-03-01 16:03:09,700] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:03:09,710] default_module.py->log_info line:141 [INFO]lr=9.7044e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:04:18,149] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 0/45 train_loss 1.2560  train_acc_1 44.4444
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:06:09,004] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.4615    1.0000    0.4024    0.6316    0.6344    0.4265        42
          2     1.0000    0.4024    1.0000    0.5739    0.6344    0.3784        82

avg / total     0.8176    0.6048    0.7976    0.5934    0.6344    0.3947       124

Covid class AUC=0.9538327526132404
ACC=0.6048387096774194
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 59.75056723185948 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 59.75056723185948 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00011: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00011: valid_acc_1  was not in top 1
[2021-03-01 16:06:09,231] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2391  train_acc_1 88.8889
[2021-03-01 16:06:09,231] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7492  valid_acc_1 59.7506
[2021-03-01 16:06:09,231] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:06:09,238] default_module.py->log_info line:141 [INFO]lr=9.6489e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:07:09,046] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 0/45 train_loss 0.1063  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:08:51,240] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8182    0.8571    0.9024    0.8372    0.8795    0.7700        42
          2     0.9250    0.9024    0.8571    0.9136    0.8795    0.7770        82

avg / total     0.8888    0.8871    0.8725    0.8877    0.8795    0.7746       124

Covid class AUC=0.9427990708478513
ACC=0.8870967741935484
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.8888909476144 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.8888909476144 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00012: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00012: valid_acc_1  was not in top 1
[2021-03-01 16:08:51,363] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2149  train_acc_1 91.2346
[2021-03-01 16:08:51,364] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2750  valid_acc_1 88.8889
[2021-03-01 16:08:51,364] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:08:51,374] default_module.py->log_info line:141 [INFO]lr=9.5888e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:09:30,559] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 0/45 train_loss 0.1282  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:11:41,427] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.3095    1.0000    0.4727    0.5563    0.2882        42
          2     0.7387    1.0000    0.3095    0.8497    0.5563    0.3309        82

avg / total     0.8272    0.7661    0.5434    0.7220    0.5563    0.3164       124

Covid class AUC=0.9657375145180023
ACC=0.7661290322580645
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.98412779399327 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.98412779399327 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00013: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00013: valid_acc_1  was not in top 1
[2021-03-01 16:11:41,709] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2120  train_acc_1 91.6049
[2021-03-01 16:11:41,709] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5788  valid_acc_1 76.9841
[2021-03-01 16:11:41,709] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:11:41,716] default_module.py->log_info line:141 [INFO]lr=9.5241e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:12:35,166] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 0/45 train_loss 0.4197  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:14:26,731] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.3571    1.0000    0.5263    0.5976    0.3342        42
          2     0.7523    1.0000    0.3571    0.8586    0.5976    0.3801        82

avg / total     0.8362    0.7823    0.5749    0.7461    0.5976    0.3645       124

Covid class AUC=0.9578977932636469
ACC=0.782258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.57142918450492 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.57142918450492 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00014: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00014: valid_acc_1  was not in top 1
[2021-03-01 16:14:26,960] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2167  train_acc_1 90.6173
[2021-03-01 16:14:26,960] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5036  valid_acc_1 78.5714
[2021-03-01 16:14:26,960] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:14:26,971] default_module.py->log_info line:141 [INFO]lr=9.4550e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:15:40,152] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 0/45 train_loss 0.1082  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:17:23,123] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6212    0.9762    0.6951    0.7593    0.8238    0.6976        42
          2     0.9828    0.6951    0.9762    0.8143    0.8238    0.6595        82

avg / total     0.8603    0.7903    0.8810    0.7956    0.8238    0.6724       124

Covid class AUC=0.9613821138211383
ACC=0.7903225806451613
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.68480859483991 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.68480859483991 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00015: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00015: valid_acc_1  was not in top 1
[2021-03-01 16:17:23,235] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2491  train_acc_1 88.3951
[2021-03-01 16:17:23,235] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4155  valid_acc_1 78.6848
[2021-03-01 16:17:23,236] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:17:23,244] default_module.py->log_info line:141 [INFO]lr=9.3815e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:18:12,187] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 0/45 train_loss 0.3206  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:19:55,083] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.7381    1.0000    0.8493    0.8591    0.7188        42
          2     0.8817    1.0000    0.7381    0.9371    0.8591    0.7574        82

avg / total     0.9218    0.9113    0.8268    0.9074    0.8591    0.7443       124

Covid class AUC=0.9413472706155633
ACC=0.9112903225806451
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.26984187534877 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.26984187534877 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00016: valid_acc_1 reached 91.26984 (best 91.26984), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=16-valid_acc_1=91.27.ckpt as top 1
INFO:lightning:
Epoch 00016: valid_acc_1 reached 91.26984 (best 91.26984), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=16-valid_acc_1=91.27.ckpt as top 1
[2021-03-01 16:19:55,723] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2257  train_acc_1 90.2469
[2021-03-01 16:19:55,724] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3315  valid_acc_1 91.2698
[2021-03-01 16:19:55,724] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:19:55,731] default_module.py->log_info line:141 [INFO]lr=9.3037e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:20:34,173] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 0/45 train_loss 0.1074  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:22:21,813] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.3387    1.0000    0.0000    0.5060    0.0000    0.0000        42
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        82

avg / total     0.1147    0.3387    0.6613    0.1714    0.0000    0.0000       124

Covid class AUC=0.968931475029036
ACC=0.3387096774193548
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 33.33333315168108 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 33.33333315168108 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00017: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00017: valid_acc_1  was not in top 1
[2021-03-01 16:22:22,036] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2458  train_acc_1 90.8642
[2021-03-01 16:22:22,036] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 5.8170  valid_acc_1 33.3333
[2021-03-01 16:22:22,036] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:22:22,044] default_module.py->log_info line:141 [INFO]lr=9.2216e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:23:23,567] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 0/45 train_loss 0.4371  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:25:05,820] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7018    0.9524    0.7927    0.8081    0.8689    0.7670        42
          2     0.9701    0.7927    0.9524    0.8725    0.8689    0.7429        82

avg / total     0.8792    0.8468    0.8983    0.8507    0.8689    0.7510       124

Covid class AUC=0.898664343786295
ACC=0.8467741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.92063685825893 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.92063685825893 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00018: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00018: valid_acc_1  was not in top 1
[2021-03-01 16:25:05,897] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2272  train_acc_1 91.2346
[2021-03-01 16:25:05,897] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4343  valid_acc_1 84.9206
[2021-03-01 16:25:05,897] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:25:05,907] default_module.py->log_info line:141 [INFO]lr=9.1354e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:25:58,003] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 0/45 train_loss 0.5092  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:27:41,860] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8333    0.9524    0.9024    0.8889    0.9271    0.8638        42
          2     0.9737    0.9024    0.9524    0.9367    0.9271    0.8552        82

avg / total     0.9261    0.9194    0.9355    0.9205    0.9271    0.8581       124

Covid class AUC=0.9863530778164924
ACC=0.9193548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.06349291120257 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.06349291120257 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00019: valid_acc_1 reached 92.06349 (best 92.06349), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=19-valid_acc_1=92.06.ckpt as top 1
INFO:lightning:
Epoch 00019: valid_acc_1 reached 92.06349 (best 92.06349), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=19-valid_acc_1=92.06.ckpt as top 1
[2021-03-01 16:27:42,439] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2632  train_acc_1 90.1235
[2021-03-01 16:27:42,439] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1962  valid_acc_1 92.0635
[2021-03-01 16:27:42,439] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:27:42,444] default_module.py->log_info line:141 [INFO]lr=9.0451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:28:24,223] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 0/45 train_loss 0.3929  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:30:31,466] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9250    0.8810    0.9634    0.9024    0.9213    0.8417        42
          2     0.9405    0.9634    0.8810    0.9518    0.9213    0.8557        82

avg / total     0.9352    0.9355    0.9089    0.9351    0.9213    0.8510       124

Covid class AUC=0.981416957026713
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079498291016 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079498291016 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00020: valid_acc_1 reached 93.65079 (best 93.65079), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=20-valid_acc_1=93.65.ckpt as top 1
INFO:lightning:
Epoch 00020: valid_acc_1 reached 93.65079 (best 93.65079), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=20-valid_acc_1=93.65.ckpt as top 1
[2021-03-01 16:30:32,058] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1976  train_acc_1 92.8395
[2021-03-01 16:30:32,058] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2256  valid_acc_1 93.6508
[2021-03-01 16:30:32,059] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:30:32,067] default_module.py->log_info line:141 [INFO]lr=8.9508e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:31:13,862] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 0/45 train_loss 0.1347  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:33:07,132] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.3471    1.0000    0.0366    0.5153    0.1913    0.0401        42
          2     1.0000    0.0366    1.0000    0.0706    0.1913    0.0331        82

avg / total     0.7789    0.3629    0.6737    0.2212    0.1913    0.0354       124

Covid class AUC=0.9802555168408827
ACC=0.3629032258064516
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 35.7142858505249 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 35.7142858505249 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00021: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00021: valid_acc_1  was not in top 1
[2021-03-01 16:33:07,201] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2263  train_acc_1 90.6173
[2021-03-01 16:33:07,201] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 3.4657  valid_acc_1 35.7143
[2021-03-01 16:33:07,201] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:33:07,211] default_module.py->log_info line:141 [INFO]lr=8.8526e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:33:54,499] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 0/45 train_loss 0.0957  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:35:52,365] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.6905    1.0000    0.8169    0.8309    0.6691        42
          2     0.8632    1.0000    0.6905    0.9266    0.8309    0.7118        82

avg / total     0.9095    0.8952    0.7953    0.8894    0.8309    0.6974       124

Covid class AUC=0.95267131242741
ACC=0.8951612903225806
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.68253980364118 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.68253980364118 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00022: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00022: valid_acc_1  was not in top 1
[2021-03-01 16:35:52,609] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1785  train_acc_1 92.3457
[2021-03-01 16:35:52,610] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2759  valid_acc_1 89.6825
[2021-03-01 16:35:52,610] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:35:52,617] default_module.py->log_info line:141 [INFO]lr=8.7506e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:36:36,817] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 0/45 train_loss 0.3628  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:38:30,587] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.3652    1.0000    0.1098    0.5350    0.3313    0.1195        42
          2     1.0000    0.1098    1.0000    0.1978    0.3313    0.1000        82

avg / total     0.7850    0.4113    0.6985    0.3120    0.3313    0.1066       124

Covid class AUC=0.9634146341463414
ACC=0.4112903225806452
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 40.476190839494976 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 40.476190839494976 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00023: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00023: valid_acc_1  was not in top 1
[2021-03-01 16:38:30,666] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1912  train_acc_1 92.4691
[2021-03-01 16:38:30,666] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 2.9346  valid_acc_1 40.4762
[2021-03-01 16:38:30,666] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:38:30,672] default_module.py->log_info line:141 [INFO]lr=8.6448e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:39:12,684] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 0/45 train_loss 0.0553  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:41:04,828] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9487    0.8810    0.9756    0.9136    0.9271    0.8513        42
          2     0.9412    0.9756    0.8810    0.9581    0.9271    0.8676        82

avg / total     0.9437    0.9435    0.9130    0.9430    0.9271    0.8621       124

Covid class AUC=0.9660278745644599
ACC=0.9435483870967742
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 94.44444547380719 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 94.44444547380719 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00024: valid_acc_1 reached 94.44445 (best 94.44445), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=24-valid_acc_1=94.44.ckpt as top 1
INFO:lightning:
Epoch 00024: valid_acc_1 reached 94.44445 (best 94.44445), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=24-valid_acc_1=94.44.ckpt as top 1
[2021-03-01 16:41:05,518] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2378  train_acc_1 89.8765
[2021-03-01 16:41:05,518] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2738  valid_acc_1 94.4444
[2021-03-01 16:41:05,518] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:41:05,524] default_module.py->log_info line:141 [INFO]lr=8.5355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:42:05,130] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 0/45 train_loss 0.0678  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:43:48,218] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8864    0.9286    0.9390    0.9070    0.9338    0.8710        42
          2     0.9625    0.9390    0.9286    0.9506    0.9338    0.8729        82

avg / total     0.9367    0.9355    0.9321    0.9358    0.9338    0.8722       124

Covid class AUC=0.9863530778164924
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.6507955278669 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.6507955278669 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00025: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00025: valid_acc_1  was not in top 1
[2021-03-01 16:43:48,294] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1663  train_acc_1 92.8395
[2021-03-01 16:43:48,295] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1856  valid_acc_1 93.6508
[2021-03-01 16:43:48,295] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:43:48,304] default_module.py->log_info line:141 [INFO]lr=8.4227e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:44:29,012] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 0/45 train_loss 0.1654  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:46:10,690] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.5952    1.0000    0.7463    0.7715    0.5711        42
          2     0.8283    1.0000    0.5952    0.9061    0.7715    0.6193        82

avg / total     0.8864    0.8629    0.7323    0.8519    0.7715    0.6030       124

Covid class AUC=0.990418118466899
ACC=0.8629032258064516
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.50793715885708 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.50793715885708 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00026: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00026: valid_acc_1  was not in top 1
[2021-03-01 16:46:10,767] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1565  train_acc_1 93.5802
[2021-03-01 16:46:10,768] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3000  valid_acc_1 86.5079
[2021-03-01 16:46:10,768] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:46:10,778] default_module.py->log_info line:141 [INFO]lr=8.3066e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:46:45,933] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 0/45 train_loss 0.0779  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:48:53,039] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8696    0.9524    0.9268    0.9091    0.9395    0.8849        42
          2     0.9744    0.9268    0.9524    0.9500    0.9395    0.8804        82

avg / total     0.9389    0.9355    0.9437    0.9361    0.9395    0.8820       124

Covid class AUC=0.9880952380952381
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079498291016 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079498291016 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00027: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00027: valid_acc_1  was not in top 1
[2021-03-01 16:48:53,123] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1299  train_acc_1 95.8025
[2021-03-01 16:48:53,123] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1698  valid_acc_1 93.6508
[2021-03-01 16:48:53,123] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:48:53,141] default_module.py->log_info line:141 [INFO]lr=8.1871e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:50:02,001] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 0/45 train_loss 0.0700  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:51:49,012] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9111    0.9762    0.9512    0.9425    0.9636    0.9309        42
          2     0.9873    0.9512    0.9762    0.9689    0.9636    0.9263        82

avg / total     0.9615    0.9597    0.9677    0.9600    0.9636    0.9278       124

Covid class AUC=0.9831591173054588
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174754551479 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174754551479 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00028: valid_acc_1 reached 96.03175 (best 96.03175), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=28-valid_acc_1=96.03.ckpt as top 1
INFO:lightning:
Epoch 00028: valid_acc_1 reached 96.03175 (best 96.03175), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=28-valid_acc_1=96.03.ckpt as top 1
[2021-03-01 16:51:49,589] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1588  train_acc_1 93.5802
[2021-03-01 16:51:49,589] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1774  valid_acc_1 96.0317
[2021-03-01 16:51:49,589] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:51:49,595] default_module.py->log_info line:141 [INFO]lr=8.0645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:52:36,400] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 0/45 train_loss 0.0133  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:54:28,233] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8125    0.9286    0.8902    0.8667    0.9092    0.8298        42
          2     0.9605    0.8902    0.9286    0.9241    0.9092    0.8235        82

avg / total     0.9104    0.9032    0.9156    0.9046    0.9092    0.8256       124

Covid class AUC=0.9834494773519163
ACC=0.9032258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.24943433489118 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.24943433489118 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00029: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00029: valid_acc_1  was not in top 1
[2021-03-01 16:54:28,316] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1912  train_acc_1 93.2099
[2021-03-01 16:54:28,316] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2189  valid_acc_1 90.2494
[2021-03-01 16:54:28,316] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:54:28,329] default_module.py->log_info line:141 [INFO]lr=7.9389e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:55:14,881] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 0/45 train_loss 0.1634  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:56:58,548] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.3750    1.0000    0.1463    0.5455    0.3825    0.1588        42
          2     1.0000    0.1463    1.0000    0.2553    0.3825    0.1338        82

avg / total     0.7883    0.4355    0.7109    0.3536    0.3825    0.1423       124

Covid class AUC=0.9732868757259001
ACC=0.43548387096774194
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 43.08390031542097 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 43.08390031542097 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00030: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00030: valid_acc_1  was not in top 1
[2021-03-01 16:56:58,744] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2102  train_acc_1 91.7284
[2021-03-01 16:56:58,745] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.9339  valid_acc_1 43.0839
[2021-03-01 16:56:58,745] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:56:58,754] default_module.py->log_info line:141 [INFO]lr=7.8104e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:58:00,119] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 0/45 train_loss 0.1318  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:59:41,295] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9750    0.9286    0.9878    0.9512    0.9577    0.9118        42
          2     0.9643    0.9878    0.9286    0.9759    0.9577    0.9227        82

avg / total     0.9679    0.9677    0.9486    0.9675    0.9577    0.9190       124

Covid class AUC=0.9970963995354238
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539803641183 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539803641183 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00031: valid_acc_1 reached 96.82540 (best 96.82540), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=31-valid_acc_1=96.83.ckpt as top 1
INFO:lightning:
Epoch 00031: valid_acc_1 reached 96.82540 (best 96.82540), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=31-valid_acc_1=96.83.ckpt as top 1
[2021-03-01 16:59:41,864] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1118  train_acc_1 95.5556
[2021-03-01 16:59:41,865] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1037  valid_acc_1 96.8254
[2021-03-01 16:59:41,865] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:59:41,870] default_module.py->log_info line:141 [INFO]lr=7.6791e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:00:23,436] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 0/45 train_loss 0.0205  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:02:09,968] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8511    0.9524    0.9146    0.8989    0.9333    0.8744        42
          2     0.9740    0.9146    0.9524    0.9434    0.9333    0.8678        82

avg / total     0.9324    0.9274    0.9396    0.9283    0.9333    0.8700       124

Covid class AUC=0.9692218350754935
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714394705636 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714394705636 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00032: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00032: valid_acc_1  was not in top 1
[2021-03-01 17:02:10,055] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1793  train_acc_1 92.4691
[2021-03-01 17:02:10,056] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2550  valid_acc_1 92.8571
[2021-03-01 17:02:10,056] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:02:10,067] default_module.py->log_info line:141 [INFO]lr=7.5452e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:03:02,273] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 0/45 train_loss 0.1750  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:05:03,487] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6885    1.0000    0.7683    0.8155    0.8765    0.7861        42
          2     1.0000    0.7683    1.0000    0.8690    0.8765    0.7505        82

avg / total     0.8945    0.8468    0.9215    0.8509    0.8765    0.7626       124

Covid class AUC=0.9944831591173053
ACC=0.8467741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.4671208517892 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.4671208517892 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00033: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00033: valid_acc_1  was not in top 1
[2021-03-01 17:05:03,781] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1418  train_acc_1 93.7037
[2021-03-01 17:05:03,781] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4112  valid_acc_1 84.4671
[2021-03-01 17:05:03,781] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:05:03,788] default_module.py->log_info line:141 [INFO]lr=7.4088e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:05:56,326] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 0/45 train_loss 0.0718  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:07:39,158] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.1190    1.0000    0.2128    0.3450    0.1086        42
          2     0.6891    1.0000    0.1190    0.8159    0.3450    0.1295        82

avg / total     0.7944    0.7016    0.4174    0.6116    0.3450    0.1224       124

Covid class AUC=0.9819976771196284
ACC=0.7016129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 70.63492127827236 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 70.63492127827236 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00034: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00034: valid_acc_1  was not in top 1
[2021-03-01 17:07:39,345] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1050  train_acc_1 96.5432
[2021-03-01 17:07:39,346] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7814  valid_acc_1 70.6349
[2021-03-01 17:07:39,346] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:07:39,352] default_module.py->log_info line:141 [INFO]lr=7.2700e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:08:29,958] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 0/45 train_loss 0.0042  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:10:13,642] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9512    0.9286    0.9756    0.9398    0.9518    0.9017        42
          2     0.9639    0.9756    0.9286    0.9697    0.9518    0.9102        82

avg / total     0.9596    0.9597    0.9445    0.9596    0.9518    0.9073       124

Covid class AUC=0.9921602787456446
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174700055804 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174700055804 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00035: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00035: valid_acc_1  was not in top 1
[2021-03-01 17:10:13,708] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1793  train_acc_1 92.5926
[2021-03-01 17:10:13,709] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1077  valid_acc_1 96.0317
[2021-03-01 17:10:13,709] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:10:13,715] default_module.py->log_info line:141 [INFO]lr=7.1289e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:11:00,228] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 0/45 train_loss 0.2953  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:12:53,578] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9524    0.9524    0.9756    0.9524    0.9639    0.9270        42
          2     0.9756    0.9756    0.9524    0.9756    0.9639    0.9313        82

avg / total     0.9677    0.9677    0.9602    0.9677    0.9639    0.9298       124

Covid class AUC=0.9895470383275261
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00036: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00036: valid_acc_1  was not in top 1
[2021-03-01 17:12:53,653] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1488  train_acc_1 94.5679
[2021-03-01 17:12:53,653] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1110  valid_acc_1 96.8254
[2021-03-01 17:12:53,653] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:12:53,663] default_module.py->log_info line:141 [INFO]lr=6.9857e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:13:29,373] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 0/45 train_loss 0.1036  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:15:39,991] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9286    0.9286    0.9634    0.9286    0.9458    0.8915        42
          2     0.9634    0.9634    0.9286    0.9634    0.9458    0.8977        82

avg / total     0.9516    0.9516    0.9404    0.9516    0.9458    0.8956       124

Covid class AUC=0.9857723577235772
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00037: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00037: valid_acc_1  was not in top 1
[2021-03-01 17:15:40,066] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1227  train_acc_1 95.3086
[2021-03-01 17:15:40,067] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1288  valid_acc_1 95.2381
[2021-03-01 17:15:40,067] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:15:40,079] default_module.py->log_info line:141 [INFO]lr=6.8406e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:16:32,319] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 0/45 train_loss 0.0365  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:18:15,011] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8667    0.9286    0.9268    0.8966    0.9277    0.8608        42
          2     0.9620    0.9268    0.9286    0.9441    0.9277    0.8605        82

avg / total     0.9297    0.9274    0.9280    0.9280    0.9277    0.8606       124

Covid class AUC=0.9831591173054588
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714503696987 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714503696987 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00038: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00038: valid_acc_1  was not in top 1
[2021-03-01 17:18:15,089] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1084  train_acc_1 96.5432
[2021-03-01 17:18:15,089] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1768  valid_acc_1 92.8571
[2021-03-01 17:18:15,089] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:18:15,100] default_module.py->log_info line:141 [INFO]lr=6.6937e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:18:56,087] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 0/45 train_loss 0.0103  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:20:52,230] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.3443    1.0000    0.0244    0.5122    0.1562    0.0268        42
          2     1.0000    0.0244    1.0000    0.0476    0.1562    0.0220        82

avg / total     0.7779    0.3548    0.6696    0.2050    0.1562    0.0236       124

Covid class AUC=0.9457026713124275
ACC=0.3548387096774194
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 34.92063481467111 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 34.92063481467111 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00039: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00039: valid_acc_1  was not in top 1
[2021-03-01 17:20:52,304] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1687  train_acc_1 94.3210
[2021-03-01 17:20:52,305] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 2.3068  valid_acc_1 34.9206
[2021-03-01 17:20:52,305] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:20:52,313] default_module.py->log_info line:141 [INFO]lr=6.5451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:21:40,787] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 0/45 train_loss 0.9749  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:23:31,420] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        42
          2     0.6613    1.0000    0.0000    0.7961    0.0000    0.0000        82

avg / total     0.4373    0.6613    0.3387    0.5265    0.0000    0.0000       124

Covid class AUC=0.9695121951219512
ACC=0.6612903225806451
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 66.6666671207973 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 66.6666671207973 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00040: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00040: valid_acc_1  was not in top 1
[2021-03-01 17:23:31,659] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2136  train_acc_1 90.3704
[2021-03-01 17:23:31,659] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.0548  valid_acc_1 66.6667
[2021-03-01 17:23:31,659] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:23:31,667] default_module.py->log_info line:141 [INFO]lr=6.3950e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:24:48,404] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 0/45 train_loss 0.0320  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:27:01,542] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6885    1.0000    0.7683    0.8155    0.8765    0.7861        42
          2     1.0000    0.7683    1.0000    0.8690    0.8765    0.7505        82

avg / total     0.8945    0.8468    0.9215    0.8509    0.8765    0.7626       124

Covid class AUC=0.9941927990708478
ACC=0.8467741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.46712057931083 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.46712057931083 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00041: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00041: valid_acc_1  was not in top 1
[2021-03-01 17:27:02,351] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1231  train_acc_1 94.6914
[2021-03-01 17:27:02,352] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5093  valid_acc_1 84.4671
[2021-03-01 17:27:02,352] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:27:02,365] default_module.py->log_info line:141 [INFO]lr=6.2434e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:28:19,479] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 0/45 train_loss 0.0233  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:30:13,413] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.2143    1.0000    0.3529    0.4629    0.1974        42
          2     0.7130    1.0000    0.2143    0.8325    0.4629    0.2311        82

avg / total     0.8102    0.7339    0.4804    0.6701    0.4629    0.2197       124

Covid class AUC=0.991869918699187
ACC=0.7338709677419355
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 73.80952439989362 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 73.80952439989362 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00042: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00042: valid_acc_1  was not in top 1
[2021-03-01 17:30:13,585] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2099  train_acc_1 92.4691
[2021-03-01 17:30:13,585] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4879  valid_acc_1 73.8095
[2021-03-01 17:30:13,585] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:30:13,594] default_module.py->log_info line:141 [INFO]lr=6.0907e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:31:05,820] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 0/45 train_loss 0.0130  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:32:56,759] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9130    1.0000    0.9512    0.9545    0.9753    0.9559        42
          2     1.0000    0.9512    1.0000    0.9750    0.9753    0.9466        82

avg / total     0.9705    0.9677    0.9835    0.9681    0.9753    0.9497       124

Covid class AUC=0.9843205574912892
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00043: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00043: valid_acc_1  was not in top 1
[2021-03-01 17:32:56,835] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0978  train_acc_1 97.0370
[2021-03-01 17:32:56,836] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1861  valid_acc_1 96.8254
[2021-03-01 17:32:56,836] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:32:56,847] default_module.py->log_info line:141 [INFO]lr=5.9369e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:33:39,395] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 0/45 train_loss 0.0378  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:35:30,363] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8367    0.9762    0.9024    0.9011    0.9386    0.8874        42
          2     0.9867    0.9024    0.9762    0.9427    0.9386    0.8745        82

avg / total     0.9359    0.9274    0.9512    0.9286    0.9386    0.8789       124

Covid class AUC=0.9773519163763067
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714449201312 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714449201312 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00044: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00044: valid_acc_1  was not in top 1
[2021-03-01 17:35:30,440] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0988  train_acc_1 96.0494
[2021-03-01 17:35:30,441] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2468  valid_acc_1 92.8571
[2021-03-01 17:35:30,441] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:35:30,449] default_module.py->log_info line:141 [INFO]lr=5.7822e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:36:28,883] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 0/45 train_loss 0.0148  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:38:10,209] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8077    1.0000    0.8780    0.8936    0.9370    0.8888        42
          2     1.0000    0.8780    1.0000    0.9351    0.9370    0.8673        82

avg / total     0.9349    0.9194    0.9587    0.9210    0.9370    0.8746       124

Covid class AUC=0.9831591173054588
ACC=0.9193548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.83673586164203 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.83673586164203 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00045: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00045: valid_acc_1  was not in top 1
[2021-03-01 17:38:10,273] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1249  train_acc_1 95.1852
[2021-03-01 17:38:10,274] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3917  valid_acc_1 91.8367
[2021-03-01 17:38:10,274] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:38:10,284] default_module.py->log_info line:141 [INFO]lr=5.6267e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:38:46,307] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 0/45 train_loss 0.5618  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:40:42,403] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9111    0.9762    0.9512    0.9425    0.9636    0.9309        42
          2     0.9873    0.9512    0.9762    0.9689    0.9636    0.9263        82

avg / total     0.9615    0.9597    0.9677    0.9600    0.9636    0.9278       124

Covid class AUC=0.9869337979094076
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174754551479 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174754551479 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00046: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00046: valid_acc_1  was not in top 1
[2021-03-01 17:40:42,607] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1581  train_acc_1 93.3333
[2021-03-01 17:40:42,607] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1684  valid_acc_1 96.0317
[2021-03-01 17:40:42,607] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:40:42,617] default_module.py->log_info line:141 [INFO]lr=5.4705e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:42:29,228] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 0/45 train_loss 0.0376  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:46:40,430] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7925    1.0000    0.8659    0.8842    0.9305    0.8775        42
          2     1.0000    0.8659    1.0000    0.9281    0.9305    0.8542        82

avg / total     0.9297    0.9113    0.9546    0.9132    0.9305    0.8621       124

Covid class AUC=0.9912891986062718
ACC=0.9112903225806451
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.04308537074498 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.04308537074498 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00047: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00047: valid_acc_1  was not in top 1
[2021-03-01 17:46:41,877] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1273  train_acc_1 96.5432
[2021-03-01 17:46:41,877] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2878  valid_acc_1 91.0431
[2021-03-01 17:46:41,877] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:46:41,885] default_module.py->log_info line:141 [INFO]lr=5.3140e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:48:39,783] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 0/45 train_loss 0.0693  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:51:24,042] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9737    0.8810    0.9878    0.9250    0.9328    0.8609        42
          2     0.9419    0.9878    0.8810    0.9643    0.9328    0.8795        82

avg / total     0.9526    0.9516    0.9171    0.9510    0.9328    0.8732       124

Covid class AUC=0.9927409988385598
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00048: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00048: valid_acc_1  was not in top 1
[2021-03-01 17:51:25,143] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0858  train_acc_1 97.1605
[2021-03-01 17:51:25,144] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1217  valid_acc_1 95.2381
[2021-03-01 17:51:25,144] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:51:25,154] default_module.py->log_info line:141 [INFO]lr=5.1571e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:52:43,243] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 0/45 train_loss 0.0127  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:54:26,975] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.8571    1.0000    0.9231    0.9258    0.8449        42
          2     0.9318    1.0000    0.8571    0.9647    0.9258    0.8694        82

avg / total     0.9549    0.9516    0.9055    0.9506    0.9258    0.8611       124

Covid class AUC=0.9944831591173054
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00049: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00049: valid_acc_1  was not in top 1
[2021-03-01 17:54:27,036] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1540  train_acc_1 94.3210
[2021-03-01 17:54:27,036] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1457  valid_acc_1 95.2381
[2021-03-01 17:54:27,036] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:54:27,045] default_module.py->log_info line:141 [INFO]lr=5.0000e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:55:16,909] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 0/45 train_loss 0.0428  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:57:10,104] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9487    0.8810    0.9756    0.9136    0.9271    0.8513        42
          2     0.9412    0.9756    0.8810    0.9581    0.9271    0.8676        82

avg / total     0.9437    0.9435    0.9130    0.9430    0.9271    0.8621       124

Covid class AUC=0.9846109175377469
ACC=0.9435483870967742
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 94.44444601876395 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 94.44444601876395 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00050: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00050: valid_acc_1  was not in top 1
[2021-03-01 17:57:10,285] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1344  train_acc_1 95.3086
[2021-03-01 17:57:10,285] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1625  valid_acc_1 94.4444
[2021-03-01 17:57:10,285] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:57:10,295] default_module.py->log_info line:141 [INFO]lr=4.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:58:17,074] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 0/45 train_loss 0.0783  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:00:01,009] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8913    0.9762    0.9390    0.9318    0.9574    0.9201        42
          2     0.9872    0.9390    0.9762    0.9625    0.9574    0.9133        82

avg / total     0.9547    0.9516    0.9636    0.9521    0.9574    0.9156       124

Covid class AUC=0.9828687572590012
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809705461774 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809705461774 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00051: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00051: valid_acc_1  was not in top 1
Epoch 00052: early stopping
INFO:lightning:Epoch 00052: early stopping
[2021-03-01 18:00:01,101] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1668  train_acc_1 94.8148
[2021-03-01 18:00:01,101] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2140  valid_acc_1 95.2381
[2021-03-01 18:00:01,102] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:00:01,111] default_module.py->log_info line:141 [INFO]lr=4.6860e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:00:45,217] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 0/45 train_loss 0.1136  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:02:29,109] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9512    0.9286    0.9756    0.9398    0.9518    0.9017        42
          2     0.9639    0.9756    0.9286    0.9697    0.9518    0.9102        82

avg / total     0.9596    0.9597    0.9445    0.9596    0.9518    0.9073       124

Covid class AUC=0.9869337979094076
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174700055804 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174700055804 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00052: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00052: valid_acc_1  was not in top 1
Epoch 00053: early stopping
INFO:lightning:Epoch 00053: early stopping
[2021-03-01 18:02:29,179] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0892  train_acc_1 97.6543
[2021-03-01 18:02:29,180] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1055  valid_acc_1 96.0317
[2021-03-01 18:02:29,180] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:02:29,188] default_module.py->log_info line:141 [INFO]lr=4.5295e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:03:10,692] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 0/45 train_loss 0.0159  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:04:56,578] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7119    1.0000    0.7927    0.8317    0.8903    0.8091        42
          2     1.0000    0.7927    1.0000    0.8844    0.8903    0.7762        82

avg / total     0.9024    0.8629    0.9298    0.8665    0.8903    0.7874       124

Covid class AUC=0.975609756097561
ACC=0.8629032258064516
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.28117970057896 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.28117970057896 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00053: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00053: valid_acc_1  was not in top 1
Epoch 00054: early stopping
INFO:lightning:Epoch 00054: early stopping
[2021-03-01 18:04:56,819] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1317  train_acc_1 94.5679
[2021-03-01 18:04:56,820] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4270  valid_acc_1 86.2812
[2021-03-01 18:04:56,820] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:04:56,829] default_module.py->log_info line:141 [INFO]lr=4.3733e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:05:57,730] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 0/45 train_loss 0.1491  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:07:39,629] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.3095    1.0000    0.4727    0.5563    0.2882        42
          2     0.7387    1.0000    0.3095    0.8497    0.5563    0.3309        82

avg / total     0.8272    0.7661    0.5434    0.7220    0.5563    0.3164       124

Covid class AUC=0.9857723577235772
ACC=0.7661290322580645
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.98412786211286 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.98412786211286 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00054: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00054: valid_acc_1  was not in top 1
Epoch 00055: early stopping
INFO:lightning:Epoch 00055: early stopping
[2021-03-01 18:07:39,713] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0818  train_acc_1 96.2963
[2021-03-01 18:07:39,713] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4372  valid_acc_1 76.9841
[2021-03-01 18:07:39,713] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:07:39,722] default_module.py->log_info line:141 [INFO]lr=4.2178e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:08:19,643] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 0/45 train_loss 0.0281  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:10:10,396] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9512    0.9286    0.9756    0.9398    0.9518    0.9017        42
          2     0.9639    0.9756    0.9286    0.9697    0.9518    0.9102        82

avg / total     0.9596    0.9597    0.9445    0.9596    0.9518    0.9073       124

Covid class AUC=0.9843205574912892
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174700055804 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174700055804 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00055: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00055: valid_acc_1  was not in top 1
Epoch 00056: early stopping
INFO:lightning:Epoch 00056: early stopping
[2021-03-01 18:10:10,472] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0582  train_acc_1 98.0247
[2021-03-01 18:10:10,472] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1265  valid_acc_1 96.0317
[2021-03-01 18:10:10,472] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:10:10,480] default_module.py->log_info line:141 [INFO]lr=4.0631e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:11:04,953] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 0/45 train_loss 0.0436  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:13:13,728] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.4773    1.0000    0.4390    0.6462    0.6626    0.4637        42
          2     1.0000    0.4390    1.0000    0.6102    0.6626    0.4144        82

avg / total     0.8229    0.6290    0.8100    0.6224    0.6626    0.4311       124

Covid class AUC=0.9875145180023228
ACC=0.6290322580645161
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 62.58503457478115 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 62.58503457478115 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00056: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00056: valid_acc_1  was not in top 1
Epoch 00057: early stopping
INFO:lightning:Epoch 00057: early stopping
[2021-03-01 18:13:13,846] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0759  train_acc_1 96.7901
[2021-03-01 18:13:13,846] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.6979  valid_acc_1 62.5850
[2021-03-01 18:13:13,846] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:13:13,854] default_module.py->log_info line:141 [INFO]lr=3.9093e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:13:55,756] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 0/45 train_loss 0.0327  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:15:44,901] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.6190    1.0000    0.7647    0.7868    0.5955        42
          2     0.8367    1.0000    0.6190    0.9111    0.7868    0.6426        82

avg / total     0.8920    0.8710    0.7481    0.8615    0.7868    0.6267       124

Covid class AUC=0.9878048780487805
ACC=0.8709677419354839
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.3015877859933 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.3015877859933 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00057: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00057: valid_acc_1  was not in top 1
Epoch 00058: early stopping
INFO:lightning:Epoch 00058: early stopping
[2021-03-01 18:15:45,086] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1412  train_acc_1 95.5556
[2021-03-01 18:15:45,087] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2334  valid_acc_1 87.3016
[2021-03-01 18:15:45,087] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:15:45,095] default_module.py->log_info line:141 [INFO]lr=3.7566e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:16:36,008] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 0/45 train_loss 0.1746  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:18:18,882] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.0714    1.0000    0.1333    0.2673    0.0648        42
          2     0.6777    1.0000    0.0714    0.8079    0.2673    0.0781        82

avg / total     0.7869    0.6855    0.3859    0.5794    0.2673    0.0736       124

Covid class AUC=0.993321718931475
ACC=0.6854838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 69.04761941092355 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 69.04761941092355 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00058: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00058: valid_acc_1  was not in top 1
Epoch 00059: early stopping
INFO:lightning:Epoch 00059: early stopping
[2021-03-01 18:18:19,007] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0897  train_acc_1 96.6667
[2021-03-01 18:18:19,008] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8982  valid_acc_1 69.0476
[2021-03-01 18:18:19,008] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:18:19,016] default_module.py->log_info line:141 [INFO]lr=3.6050e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:19:01,277] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 0/45 train_loss 0.0112  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:20:48,000] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8913    0.9762    0.9390    0.9318    0.9574    0.9201        42
          2     0.9872    0.9390    0.9762    0.9625    0.9574    0.9133        82

avg / total     0.9547    0.9516    0.9636    0.9521    0.9574    0.9156       124

Covid class AUC=0.9819976771196284
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.01133946010044 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.01133946010044 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00059: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00059: valid_acc_1  was not in top 1
Epoch 00060: early stopping
INFO:lightning:Epoch 00060: early stopping
[2021-03-01 18:20:48,129] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1182  train_acc_1 94.4444
[2021-03-01 18:20:48,129] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2011  valid_acc_1 95.0113
[2021-03-01 18:20:48,129] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:20:48,137] default_module.py->log_info line:141 [INFO]lr=3.4549e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:21:25,130] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 0/45 train_loss 0.1027  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:23:36,813] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9512    0.9286    0.9756    0.9398    0.9518    0.9017        42
          2     0.9639    0.9756    0.9286    0.9697    0.9518    0.9102        82

avg / total     0.9596    0.9597    0.9445    0.9596    0.9518    0.9073       124

Covid class AUC=0.9866434378629501
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174809047154 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174809047154 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00060: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00060: valid_acc_1  was not in top 1
Epoch 00061: early stopping
INFO:lightning:Epoch 00061: early stopping
[2021-03-01 18:23:36,980] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1261  train_acc_1 96.5432
[2021-03-01 18:23:36,980] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1281  valid_acc_1 96.0317
[2021-03-01 18:23:36,980] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:23:36,988] default_module.py->log_info line:141 [INFO]lr=3.3063e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:24:32,019] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 0/45 train_loss 0.0168  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:26:15,614] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9355    0.6905    0.9756    0.7945    0.8208    0.6544        42
          2     0.8602    0.9756    0.6905    0.9143    0.8208    0.6928        82

avg / total     0.8857    0.8790    0.7871    0.8737    0.8208    0.6798       124

Covid class AUC=0.9799651567944251
ACC=0.8790322580645161
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.09523963928223 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.09523963928223 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00061: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00061: valid_acc_1  was not in top 1
Epoch 00062: early stopping
INFO:lightning:Epoch 00062: early stopping
[2021-03-01 18:26:15,733] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1158  train_acc_1 96.5432
[2021-03-01 18:26:15,733] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2271  valid_acc_1 88.0952
[2021-03-01 18:26:15,733] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:26:15,743] default_module.py->log_info line:141 [INFO]lr=3.1594e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:26:56,323] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 0/45 train_loss 0.0761  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:28:48,875] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9318    0.9762    0.9634    0.9535    0.9698    0.9417        42
          2     0.9875    0.9634    0.9762    0.9753    0.9698    0.9393        82

avg / total     0.9686    0.9677    0.9719    0.9679    0.9698    0.9401       124

Covid class AUC=0.9857723577235772
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00062: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00062: valid_acc_1  was not in top 1
Epoch 00063: early stopping
INFO:lightning:Epoch 00063: early stopping
[2021-03-01 18:28:49,000] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0747  train_acc_1 98.0247
[2021-03-01 18:28:49,001] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1204  valid_acc_1 96.8254
[2021-03-01 18:28:49,001] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:28:49,010] default_module.py->log_info line:141 [INFO]lr=3.0143e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:29:31,123] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 0/45 train_loss 0.0081  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:31:22,922] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9318    0.9762    0.9634    0.9535    0.9698    0.9417        42
          2     0.9875    0.9634    0.9762    0.9753    0.9698    0.9393        82

avg / total     0.9686    0.9677    0.9719    0.9679    0.9698    0.9401       124

Covid class AUC=0.9828687572590011
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00063: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00063: valid_acc_1  was not in top 1
Epoch 00064: early stopping
INFO:lightning:Epoch 00064: early stopping
[2021-03-01 18:31:23,048] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0359  train_acc_1 98.7654
[2021-03-01 18:31:23,048] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1362  valid_acc_1 96.8254
[2021-03-01 18:31:23,048] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:31:23,059] default_module.py->log_info line:141 [INFO]lr=2.8711e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:32:17,010] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 0/45 train_loss 0.2485  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:33:58,614] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9500    0.9048    0.9756    0.9268    0.9395    0.8764        42
          2     0.9524    0.9756    0.9048    0.9639    0.9395    0.8889        82

avg / total     0.9516    0.9516    0.9288    0.9513    0.9395    0.8847       124

Covid class AUC=0.9811265969802555
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00064: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00064: valid_acc_1  was not in top 1
Epoch 00065: early stopping
INFO:lightning:Epoch 00065: early stopping
[2021-03-01 18:33:58,869] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0580  train_acc_1 97.7778
[2021-03-01 18:33:58,869] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1716  valid_acc_1 95.2381
[2021-03-01 18:33:58,870] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:33:58,877] default_module.py->log_info line:141 [INFO]lr=2.7300e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:34:54,093] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 0/45 train_loss 0.0768  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:36:53,993] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9412    0.7619    0.9756    0.8421    0.8622    0.7274        42
          2     0.8889    0.9756    0.7619    0.9302    0.8622    0.7592        82

avg / total     0.9066    0.9032    0.8343    0.9004    0.8622    0.7484       124

Covid class AUC=0.9869337979094076
ACC=0.9032258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.47619138445172 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.47619138445172 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00065: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00065: valid_acc_1  was not in top 1
Epoch 00066: early stopping
INFO:lightning:Epoch 00066: early stopping
[2021-03-01 18:36:54,116] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1381  train_acc_1 96.2963
[2021-03-01 18:36:54,117] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1678  valid_acc_1 90.4762
[2021-03-01 18:36:54,117] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:36:54,126] default_module.py->log_info line:141 [INFO]lr=2.5912e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:37:35,811] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 0/45 train_loss 0.0092  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:39:22,416] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9318    0.9762    0.9634    0.9535    0.9698    0.9417        42
          2     0.9875    0.9634    0.9762    0.9753    0.9698    0.9393        82

avg / total     0.9686    0.9677    0.9719    0.9679    0.9698    0.9401       124

Covid class AUC=0.9883855981416957
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00066: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00066: valid_acc_1  was not in top 1
Epoch 00067: early stopping
INFO:lightning:Epoch 00067: early stopping
[2021-03-01 18:39:22,716] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0597  train_acc_1 98.3951
[2021-03-01 18:39:22,717] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.0867  valid_acc_1 96.8254
[2021-03-01 18:39:22,717] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:39:22,725] default_module.py->log_info line:141 [INFO]lr=2.4548e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:40:25,307] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 0/45 train_loss 0.1348  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:42:08,998] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9310    0.6429    0.9756    0.7606    0.7919    0.6063        42
          2     0.8421    0.9756    0.6429    0.9040    0.7919    0.6480        82

avg / total     0.8722    0.8629    0.7556    0.8554    0.7919    0.6339       124

Covid class AUC=0.9837398373983739
ACC=0.8629032258064516
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.50793784005302 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.50793784005302 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00067: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00067: valid_acc_1  was not in top 1
Epoch 00068: early stopping
INFO:lightning:Epoch 00068: early stopping
[2021-03-01 18:42:09,117] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0603  train_acc_1 98.5185
[2021-03-01 18:42:09,117] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2481  valid_acc_1 86.5079
[2021-03-01 18:42:09,117] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:42:09,124] default_module.py->log_info line:141 [INFO]lr=2.3209e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:42:59,290] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 0/45 train_loss 0.0242  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:44:40,406] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9444    0.8095    0.9756    0.8718    0.8887    0.7767        42
          2     0.9091    0.9756    0.8095    0.9412    0.8887    0.8029        82

avg / total     0.9211    0.9194    0.8658    0.9177    0.8887    0.7940       124

Covid class AUC=0.9869337979094076
ACC=0.9193548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.06349291120257 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.06349291120257 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00068: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00068: valid_acc_1  was not in top 1
Epoch 00069: early stopping
INFO:lightning:Epoch 00069: early stopping
[2021-03-01 18:44:40,527] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0857  train_acc_1 96.7901
[2021-03-01 18:44:40,527] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1410  valid_acc_1 92.0635
[2021-03-01 18:44:40,527] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:44:40,535] default_module.py->log_info line:141 [INFO]lr=2.1896e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:45:16,017] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 0/45 train_loss 0.0168  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:47:21,312] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9130    1.0000    0.9512    0.9545    0.9753    0.9559        42
          2     1.0000    0.9512    1.0000    0.9750    0.9753    0.9466        82

avg / total     0.9705    0.9677    0.9835    0.9681    0.9753    0.9497       124

Covid class AUC=0.985191637630662
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00069: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00069: valid_acc_1  was not in top 1
Epoch 00070: early stopping
INFO:lightning:Epoch 00070: early stopping
[2021-03-01 18:47:21,825] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0791  train_acc_1 97.5309
[2021-03-01 18:47:21,825] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1368  valid_acc_1 96.8254
[2021-03-01 18:47:21,826] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:47:21,837] default_module.py->log_info line:141 [INFO]lr=2.0611e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:48:18,892] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 0/45 train_loss 0.0079  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:50:01,049] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9487    0.8810    0.9756    0.9136    0.9271    0.8513        42
          2     0.9412    0.9756    0.8810    0.9581    0.9271    0.8676        82

avg / total     0.9437    0.9435    0.9130    0.9430    0.9271    0.8621       124

Covid class AUC=0.9863530778164924
ACC=0.9435483870967742
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 94.44444547380719 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 94.44444547380719 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00070: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00070: valid_acc_1  was not in top 1
Epoch 00071: early stopping
INFO:lightning:Epoch 00071: early stopping
[2021-03-01 18:50:01,177] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0419  train_acc_1 98.2716
[2021-03-01 18:50:01,177] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1513  valid_acc_1 94.4444
[2021-03-01 18:50:01,177] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:50:01,186] default_module.py->log_info line:141 [INFO]lr=1.9355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:50:52,328] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 0/45 train_loss 0.0164  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:52:35,365] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9524    0.9524    0.9756    0.9524    0.9639    0.9270        42
          2     0.9756    0.9756    0.9524    0.9756    0.9639    0.9313        82

avg / total     0.9677    0.9677    0.9602    0.9677    0.9639    0.9298       124

Covid class AUC=0.9831591173054587
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00071: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00071: valid_acc_1  was not in top 1
Epoch 00072: early stopping
INFO:lightning:Epoch 00072: early stopping
[2021-03-01 18:52:35,481] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0277  train_acc_1 99.2593
[2021-03-01 18:52:35,481] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1291  valid_acc_1 96.8254
[2021-03-01 18:52:35,481] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:52:35,489] default_module.py->log_info line:141 [INFO]lr=1.8129e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:53:16,887] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 0/45 train_loss 0.0173  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:55:22,807] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8750    1.0000    0.9268    0.9333    0.9627    0.9336        42
          2     1.0000    0.9268    1.0000    0.9620    0.9627    0.9200        82

avg / total     0.9577    0.9516    0.9752    0.9523    0.9627    0.9246       124

Covid class AUC=0.9788037166085946
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.01133946010044 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.01133946010044 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00072: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00072: valid_acc_1  was not in top 1
Epoch 00073: early stopping
INFO:lightning:Epoch 00073: early stopping
[2021-03-01 18:55:23,051] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0640  train_acc_1 97.7778
[2021-03-01 18:55:23,052] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3042  valid_acc_1 95.0113
[2021-03-01 18:55:23,052] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:55:23,064] default_module.py->log_info line:141 [INFO]lr=1.6934e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:56:09,125] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 0/45 train_loss 0.0093  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:57:50,344] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9333    1.0000    0.9634    0.9655    0.9815    0.9669        42
          2     1.0000    0.9634    1.0000    0.9814    0.9815    0.9599        82

avg / total     0.9774    0.9758    0.9876    0.9760    0.9815    0.9623       124

Covid class AUC=0.9849012775842044
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00073: valid_acc_1 reached 97.61905 (best 97.61905), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=73-valid_acc_1=97.62.ckpt as top 1
INFO:lightning:
Epoch 00073: valid_acc_1 reached 97.61905 (best 97.61905), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=73-valid_acc_1=97.62.ckpt as top 1
[2021-03-01 18:57:51,256] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0879  train_acc_1 97.0370
[2021-03-01 18:57:51,256] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.0988  valid_acc_1 97.6190
[2021-03-01 18:57:51,257] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:57:51,264] default_module.py->log_info line:141 [INFO]lr=1.5773e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:58:35,087] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 0/45 train_loss 0.1607  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:00:23,462] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9825783972125435
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00074: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00074: valid_acc_1  was not in top 1
[2021-03-01 19:00:23,588] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0394  train_acc_1 98.2716
[2021-03-01 19:00:23,589] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1330  valid_acc_1 97.6190
[2021-03-01 19:00:23,589] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:00:23,597] default_module.py->log_info line:141 [INFO]lr=1.4645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:01:15,041] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 0/45 train_loss 0.0052  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:03:11,370] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9318    0.9762    0.9634    0.9535    0.9698    0.9417        42
          2     0.9875    0.9634    0.9762    0.9753    0.9698    0.9393        82

avg / total     0.9686    0.9677    0.9719    0.9679    0.9698    0.9401       124

Covid class AUC=0.9779326364692219
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00075: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00075: valid_acc_1  was not in top 1
[2021-03-01 19:03:11,493] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0478  train_acc_1 99.0123
[2021-03-01 19:03:11,493] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1917  valid_acc_1 96.8254
[2021-03-01 19:03:11,494] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:03:11,503] default_module.py->log_info line:141 [INFO]lr=1.3552e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:03:53,351] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 0/45 train_loss 0.0066  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:05:46,457] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9524    0.9524    0.9756    0.9524    0.9639    0.9270        42
          2     0.9756    0.9756    0.9524    0.9756    0.9639    0.9313        82

avg / total     0.9677    0.9677    0.9602    0.9677    0.9639    0.9298       124

Covid class AUC=0.9866434378629501
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00076: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00076: valid_acc_1  was not in top 1
[2021-03-01 19:05:46,580] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0585  train_acc_1 97.5309
[2021-03-01 19:05:46,580] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1064  valid_acc_1 96.8254
[2021-03-01 19:05:46,581] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:05:46,588] default_module.py->log_info line:141 [INFO]lr=1.2494e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:06:43,863] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 0/45 train_loss 0.0033  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:08:26,519] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9333    1.0000    0.9634    0.9655    0.9815    0.9669        42
          2     1.0000    0.9634    1.0000    0.9814    0.9815    0.9599        82

avg / total     0.9774    0.9758    0.9876    0.9760    0.9815    0.9623       124

Covid class AUC=0.9863530778164924
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00077: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00077: valid_acc_1  was not in top 1
[2021-03-01 19:08:26,646] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0716  train_acc_1 97.2840
[2021-03-01 19:08:26,647] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1133  valid_acc_1 97.6190
[2021-03-01 19:08:26,647] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:08:26,655] default_module.py->log_info line:141 [INFO]lr=1.1474e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:09:08,701] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 0/45 train_loss 0.0048  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:10:49,941] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9318    0.9762    0.9634    0.9535    0.9698    0.9417        42
          2     0.9875    0.9634    0.9762    0.9753    0.9698    0.9393        82

avg / total     0.9686    0.9677    0.9719    0.9679    0.9698    0.9401       124

Covid class AUC=0.9819976771196283
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00078: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00078: valid_acc_1  was not in top 1
[2021-03-01 19:10:50,070] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0428  train_acc_1 98.2716
[2021-03-01 19:10:50,070] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1555  valid_acc_1 96.8254
[2021-03-01 19:10:50,071] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:10:50,080] default_module.py->log_info line:141 [INFO]lr=1.0492e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:11:25,293] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 0/45 train_loss 0.0073  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:13:27,175] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9828687572590011
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00079: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00079: valid_acc_1  was not in top 1
[2021-03-01 19:13:27,533] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0215  train_acc_1 99.5062
[2021-03-01 19:13:27,533] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1422  valid_acc_1 97.6190
[2021-03-01 19:13:27,533] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:13:27,559] default_module.py->log_info line:141 [INFO]lr=9.5492e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:14:35,773] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 0/45 train_loss 0.0030  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:16:20,207] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9524    0.9524    0.9756    0.9524    0.9639    0.9270        42
          2     0.9756    0.9756    0.9524    0.9756    0.9639    0.9313        82

avg / total     0.9677    0.9677    0.9602    0.9677    0.9639    0.9298       124

Covid class AUC=0.983739837398374
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00080: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00080: valid_acc_1  was not in top 1
[2021-03-01 19:16:20,337] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0307  train_acc_1 99.2593
[2021-03-01 19:16:20,337] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1182  valid_acc_1 96.8254
[2021-03-01 19:16:20,337] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:16:20,344] default_module.py->log_info line:141 [INFO]lr=8.6460e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:17:02,976] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 0/45 train_loss 0.0018  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:18:48,065] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9811265969802555
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00081: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00081: valid_acc_1  was not in top 1
[2021-03-01 19:18:48,183] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0327  train_acc_1 98.7654
[2021-03-01 19:18:48,183] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1594  valid_acc_1 97.6190
[2021-03-01 19:18:48,183] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:18:48,193] default_module.py->log_info line:141 [INFO]lr=7.7836e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:19:30,386] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 0/45 train_loss 0.1380  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:21:16,647] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9802555168408826
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00082: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00082: valid_acc_1  was not in top 1
[2021-03-01 19:21:16,890] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0664  train_acc_1 97.5309
[2021-03-01 19:21:16,890] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1615  valid_acc_1 97.6190
[2021-03-01 19:21:16,891] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:21:16,899] default_module.py->log_info line:141 [INFO]lr=6.9629e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:22:16,974] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 0/45 train_loss 0.0053  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:23:57,765] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9333    1.0000    0.9634    0.9655    0.9815    0.9669        42
          2     1.0000    0.9634    1.0000    0.9814    0.9815    0.9599        82

avg / total     0.9774    0.9758    0.9876    0.9760    0.9815    0.9623       124

Covid class AUC=0.981416957026713
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00083: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00083: valid_acc_1  was not in top 1
[2021-03-01 19:23:57,895] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0381  train_acc_1 98.7654
[2021-03-01 19:23:57,895] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1320  valid_acc_1 97.6190
[2021-03-01 19:23:57,895] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:23:57,904] default_module.py->log_info line:141 [INFO]lr=6.1847e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:24:42,652] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 0/45 train_loss 0.0823  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:26:44,960] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9524    0.9524    0.9756    0.9524    0.9639    0.9270        42
          2     0.9756    0.9756    0.9524    0.9756    0.9639    0.9313        82

avg / total     0.9677    0.9677    0.9602    0.9677    0.9639    0.9298       124

Covid class AUC=0.9825783972125435
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539803641183 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539803641183 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00084: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00084: valid_acc_1  was not in top 1
[2021-03-01 19:26:45,079] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0254  train_acc_1 99.5062
[2021-03-01 19:26:45,080] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1226  valid_acc_1 96.8254
[2021-03-01 19:26:45,080] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:26:45,088] default_module.py->log_info line:141 [INFO]lr=5.4497e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:27:27,226] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 0/45 train_loss 0.0039  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:29:27,852] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9333    1.0000    0.9634    0.9655    0.9815    0.9669        42
          2     1.0000    0.9634    1.0000    0.9814    0.9815    0.9599        82

avg / total     0.9774    0.9758    0.9876    0.9760    0.9815    0.9623       124

Covid class AUC=0.9822880371660859
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00085: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00085: valid_acc_1  was not in top 1
[2021-03-01 19:29:28,174] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0101  train_acc_1 99.7531
[2021-03-01 19:29:28,174] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1529  valid_acc_1 97.6190
[2021-03-01 19:29:28,174] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:29:28,182] default_module.py->log_info line:141 [INFO]lr=4.7586e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:30:22,668] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 0/45 train_loss 0.0026  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:32:06,238] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9545    1.0000    0.9756    0.9767    0.9877    0.9780        42
          2     1.0000    0.9756    1.0000    0.9877    0.9877    0.9732        82

avg / total     0.9846    0.9839    0.9917    0.9840    0.9877    0.9748       124

Covid class AUC=0.9819976771196283
ACC=0.9838709677419355
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 98.41269956316266 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 98.41269956316266 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00086: valid_acc_1 reached 98.41270 (best 98.41270), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=86-valid_acc_1=98.41.ckpt as top 1
INFO:lightning:
Epoch 00086: valid_acc_1 reached 98.41270 (best 98.41270), saving model to ./output/covidctset_mc3_18_bs9_s64/version_0/checkpoints/epoch=86-valid_acc_1=98.41.ckpt as top 1
[2021-03-01 19:32:07,064] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0194  train_acc_1 99.5062
[2021-03-01 19:32:07,064] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1368  valid_acc_1 98.4127
[2021-03-01 19:32:07,064] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:32:07,071] default_module.py->log_info line:141 [INFO]lr=4.1123e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:32:58,018] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 0/45 train_loss 0.0323  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:34:41,283] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9318    0.9762    0.9634    0.9535    0.9698    0.9417        42
          2     0.9875    0.9634    0.9762    0.9753    0.9698    0.9393        82

avg / total     0.9686    0.9677    0.9719    0.9679    0.9698    0.9401       124

Covid class AUC=0.9811265969802555
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00087: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00087: valid_acc_1  was not in top 1
[2021-03-01 19:34:41,403] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0307  train_acc_1 99.0123
[2021-03-01 19:34:41,404] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1881  valid_acc_1 96.8254
[2021-03-01 19:34:41,404] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:34:41,414] default_module.py->log_info line:141 [INFO]lr=3.5112e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:35:18,373] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 0/45 train_loss 0.0058  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:37:23,321] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9318    0.9762    0.9634    0.9535    0.9698    0.9417        42
          2     0.9875    0.9634    0.9762    0.9753    0.9698    0.9393        82

avg / total     0.9686    0.9677    0.9719    0.9679    0.9698    0.9401       124

Covid class AUC=0.9822880371660859
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00088: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00088: valid_acc_1  was not in top 1
[2021-03-01 19:37:23,540] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0398  train_acc_1 99.5062
[2021-03-01 19:37:23,540] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1428  valid_acc_1 96.8254
[2021-03-01 19:37:23,540] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:37:23,551] default_module.py->log_info line:141 [INFO]lr=2.9560e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:38:13,193] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 0/45 train_loss 0.0013  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:40:01,589] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9318    0.9762    0.9634    0.9535    0.9698    0.9417        42
          2     0.9875    0.9634    0.9762    0.9753    0.9698    0.9393        82

avg / total     0.9686    0.9677    0.9719    0.9679    0.9698    0.9401       124

Covid class AUC=0.9822880371660859
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00089: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00089: valid_acc_1  was not in top 1
[2021-03-01 19:40:01,796] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0087  train_acc_1 100.0000
[2021-03-01 19:40:01,796] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1440  valid_acc_1 96.8254
[2021-03-01 19:40:01,796] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:40:01,806] default_module.py->log_info line:141 [INFO]lr=2.4472e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:41:02,455] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 0/45 train_loss 0.0337  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:42:45,162] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9318    0.9762    0.9634    0.9535    0.9698    0.9417        42
          2     0.9875    0.9634    0.9762    0.9753    0.9698    0.9393        82

avg / total     0.9686    0.9677    0.9719    0.9679    0.9698    0.9401       124

Covid class AUC=0.9811265969802555
ACC=0.967741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.82539858136859 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.82539858136859 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00090: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00090: valid_acc_1  was not in top 1
[2021-03-01 19:42:45,285] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0703  train_acc_1 97.5309
[2021-03-01 19:42:45,285] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1684  valid_acc_1 96.8254
[2021-03-01 19:42:45,285] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:42:45,294] default_module.py->log_info line:141 [INFO]lr=1.9853e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:43:33,355] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 0/45 train_loss 0.0016  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:45:17,888] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.981416957026713
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00091: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00091: valid_acc_1  was not in top 1
[2021-03-01 19:45:18,003] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0489  train_acc_1 98.5185
[2021-03-01 19:45:18,004] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1631  valid_acc_1 97.6190
[2021-03-01 19:45:18,004] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:45:18,013] default_module.py->log_info line:141 [INFO]lr=1.5708e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:46:00,103] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 0/45 train_loss 0.0076  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:47:45,416] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.981416957026713
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00092: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00092: valid_acc_1  was not in top 1
[2021-03-01 19:47:45,638] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0259  train_acc_1 99.2593
[2021-03-01 19:47:45,638] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1565  valid_acc_1 97.6190
[2021-03-01 19:47:45,638] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:47:45,647] default_module.py->log_info line:141 [INFO]lr=1.2042e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:48:38,858] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 0/45 train_loss 0.0038  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:50:23,016] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9811265969802555
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00093: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00093: valid_acc_1  was not in top 1
[2021-03-01 19:50:23,127] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0307  train_acc_1 98.7654
[2021-03-01 19:50:23,128] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1447  valid_acc_1 97.6190
[2021-03-01 19:50:23,128] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:50:23,139] default_module.py->log_info line:141 [INFO]lr=8.8564e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:51:26,296] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 0/45 train_loss 0.0798  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:53:11,158] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9811265969802555
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00094: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00094: valid_acc_1  was not in top 1
[2021-03-01 19:53:11,274] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0241  train_acc_1 98.8889
[2021-03-01 19:53:11,274] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1374  valid_acc_1 97.6190
[2021-03-01 19:53:11,275] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:53:11,284] default_module.py->log_info line:141 [INFO]lr=6.1558e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:53:52,247] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 0/45 train_loss 0.0011  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:55:49,594] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9811265969802555
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00095: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00095: valid_acc_1  was not in top 1
[2021-03-01 19:55:49,817] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0227  train_acc_1 99.5062
[2021-03-01 19:55:49,817] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1460  valid_acc_1 97.6190
[2021-03-01 19:55:49,817] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:55:49,830] default_module.py->log_info line:141 [INFO]lr=3.9426e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:56:45,520] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 0/45 train_loss 0.0211  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:58:28,595] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9811265969802555
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00096: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00096: valid_acc_1  was not in top 1
[2021-03-01 19:58:28,826] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0248  train_acc_1 99.5062
[2021-03-01 19:58:28,827] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1398  valid_acc_1 97.6190
[2021-03-01 19:58:28,827] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:58:28,835] default_module.py->log_info line:141 [INFO]lr=2.2190e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:59:18,614] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 0/45 train_loss 0.0064  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:00:59,948] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9811265969802555
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00097: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00097: valid_acc_1  was not in top 1
[2021-03-01 20:01:00,069] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0098  train_acc_1 99.7531
[2021-03-01 20:01:00,069] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1426  valid_acc_1 97.6190
[2021-03-01 20:01:00,069] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:01:00,079] default_module.py->log_info line:141 [INFO]lr=9.8664e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:01:36,600] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 0/45 train_loss 0.0006  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:03:31,369] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.9811265969802555
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00098: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00098: valid_acc_1  was not in top 1
[2021-03-01 20:03:31,837] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0310  train_acc_1 98.5185
[2021-03-01 20:03:31,838] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1419  valid_acc_1 97.6190
[2021-03-01 20:03:31,838] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:03:31,852] default_module.py->log_info line:141 [INFO]lr=2.4672e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:04:39,962] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 0/45 train_loss 0.0145  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:06:22,416] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9535    0.9762    0.9756    0.9647    0.9759    0.9524        42
          2     0.9877    0.9756    0.9762    0.9816    0.9759    0.9523        82

avg / total     0.9761    0.9758    0.9760    0.9759    0.9759    0.9524       124

Covid class AUC=0.981416957026713
ACC=0.9758064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 97.61904907226562 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 97.61904907226562 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00099: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00099: valid_acc_1  was not in top 1
[2021-03-01 20:06:22,535] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0108  train_acc_1 100.0000
[2021-03-01 20:06:22,535] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1376  valid_acc_1 97.6190
[2021-03-01 20:06:22,536] default_module.py->log_info line:141 [INFO]===========================

