[2021-03-01 15:29:32,500] config.py->setup_cfg_with_hparams line:84 [INFO]Running with full config:
DEFAULT_CUDNN_BENCHMARK: True
SEED: 9897
VERSION: 1
abtfs:
    blur:
        blur_limit: 3
        enable: 0
    bright:
        clip_limit: 1
        enable: 1
    channel_dropout:
        drop_range: (1, 1)
        enable: 0
        fill_value: 127
    channel_shuffle:
        enable: 0
    cutout:
        enable: 1
        fill_value: 127
        num_holes: 10
        size: 20
    distortion:
        enable: 0
    hue:
        enable: 0
    noise:
        enable: 1
    random_grid_shuffle:
        enable: 0
        grid: 2
    rotate:
        enable: 1
        p: 1
        rotate_limit: 45
        scale_limit: 0.2
        shift_limit: 0.0625
cam:
    debug: False
    featmaps_module_name: 'glob_avgpool'
    label: -1
    model_path: ''
    save_path: './cam_results'
    scan_path: ''
    weights_module_name: 'fc'
dataloader:
    num_workers: 40
    sample_test: 'default'
    sample_train: 'default'
    sampler:
        replacement: True
        weights_cls: [0, 0.23, 0.77]
dataset:
    batch_size: 9
    dir: '/home/datasets/COVID-19_CTs/COVID-CTset/COVID-CTset'
    is_3d: True
    is_color: False
    is_train: False
    name: 'CTDataset'
    slice_num: 64
    subset_train: 1.0
    subset_valid: 1.0
    test_list: '/home/datasets/COVID-19_CTs/covid_ctset/test_balance.json'
    train_list: '/home/datasets/COVID-19_CTs/covid_ctset/train_balance.json'
    valid_list: '/home/datasets/COVID-19_CTs/covid_ctset/test_balance.json'
hooks:
    early_stopping:
        min_delta: 0.0
        mode: 'max'
        monitor: 'valid_acc_1'
        patience: 20
        setting: 2
        verbose: 1
    model_checkpoint:
        filepath: ''
        mode: 'max'
        monitor: 'valid_acc_1'
        period: 1
        prefix: ''
        save_top_k: 1
        save_weights_only: False
        setting: 2
        verbose: 1
hparams: Namespace(cam_only=False, config_file='./config/covidctset_config.yml', opts=['trainer.gpus', '[3]', 'model.name', 'resnet3d', 'model.model_depth', '18', 'dataset.slice_num', '64', 'dataset.batch_size', '9', 'trainer.logger.test_tube.name', 'covidctset_r3d_18_bs9_s64'], predict_only=False, test_only=False)
input:
    size: (128, 128)
label_transforms:
    name: 'default'
log:
    name: './output/covidctset_r3d_18_bs9_s64/version_1/log.txt'
    path: './output/covidctset_r3d_18_bs9_s64/version_1'
loss:
    class_weight: []
    focal_loss:
        alpha: []
        gamma: 2
        size_average: True
    label_smoothing: 0.1
    name: 'CrossEntropy'
mixup:
    alpha: 0.4
    enable: 0
model:
    classes: 3
    dropout: 0
    finetune: False
    model_depth: 18
    n_input_channels: 1
    name: 'resnet3d'
    pretrained: False
module:
    analyze_result: True
    name: 'CTModule'
optim:
    base_lr: 0.001
    momentum: 0.9
    name: 'adam'
    scheduler:
        gamma: 0.1
        milestones: [10, 25, 35, 50]
        mode: 'min'
        name: 'CosineAnnealingLR'
        patience: 10
        step_size: 10
        t_0: 5
        t_max: 100
        t_mul: 20
        verbose: True
    weight_decay: 0.0005
predict_only:
    load_ckpt:
        checkpoint_path: ''
    load_metric:
        map_location: 'cuda:0'
        on_gpu: True
        tags_csv: ''
        weights_path: ''
    to_pred_file_path: ''
    type: 'ckpt'
topk: [1, 1]
trainer:
    accumulate_grad_batches: 1
    amp_level: 'O1'
    auto_lr_find: False
    auto_scale_batch_size: False
    auto_select_gpus: False
    benchmark: False
    check_val_every_n_epoch: 1
    default_root_dir: './output'
    default_save_path: './output'
    distributed_backend: 'dp'
    fast_dev_run: False
    gpus: [3]
    gradient_clip_val: 0
    log_gpu_memory: ''
    log_save_interval: 100
    logger:
        mlflow:
            experiment_name: 'torchline_logs'
            tracking_uri: './output'
        setting: 2
        test_tube:
            name: 'covidctset_r3d_18_bs9_s64'
            save_dir: './output'
            version: -1
        type: 'test_tube'
    max_epochs: 100
    max_steps: 99999999
    min_epochs: 99
    min_steps: 99999999
    name: 'DefaultTrainer'
    num_nodes: 1
    num_sanity_val_steps: 5
    num_tpu_cores: ''
    overfit_pct: 0.0
    precision: 32
    print_nan_grads: True
    process_position: 0
    progress_bar_refresh_rate: 0
    reload_dataloaders_every_epoch: False
    replace_sampler_ddp: True
    resume_from_checkpoint: ''
    row_log_interval: 10
    show_progress_bar: False
    terminate_on_nan: False
    test_percent_check: 1.0
    track_grad_norm: -1
    train_percent_check: 1.0
    truncated_bptt_steps: ''
    use_amp: False
    val_check_interval: 1.0
    val_percent_check: 1.0
    weights_save_path: ''
    weights_summary: ''
transforms:
    ct:
        randomaffine:
            degrees: (-10, 10)
            enable: 0
            isotropic: True
            p: 0.5
            scales: (0.5, 0.5)
        randomblur:
            enable: 0
            p: 0.5
            std: (0, 4)
        randomelasticdeformation:
            enable: 0
            locked_borders: 0
            max_displacement: (7, 7, 7)
            num_control_points: (4, 4, 4)
            p: 0.5
        randomflip:
            axes: (0, 1, 2)
            enable: 1
            flip_probability: 0.5
            p: 0.5
        randomnoise:
            enable: 0
            mean: (0, 0.25)
            p: 0.5
            std: (0, 0.25)
        randomswap:
            enable: 0
            num_iterations: 100
            p: 0.5
            patch_size: (16, 16, 16)
    img:
        aug_cifar: False
        aug_imagenet: False
        center_crop:
            enable: 0
        color_jitter:
            brightness: 0.1
            contrast: 0.1
            enable: 0
            hue: 0.1
            saturation: 0.1
        random_crop:
            enable: 1
            padding: 0
        random_horizontal_flip:
            enable: 1
            p: 0.5
        random_resized_crop:
            enable: 0
            ratio: (0.75, 1.3333333333333333)
            scale: (0.5, 1.0)
        random_rotation:
            degrees: 10
            enable: 1
        random_vertical_flip:
            enable: 1
            p: 0.5
        resize:
            enable: 1
    name: 'CTTransforms'
    tensor:
        normalization:
            mean: [0.5, 0.5, 0.5]
            std: [0.5, 0.5, 0.5]
        random_erasing:
            enable: 0
            p: 0.5
            ratio: ((0.3, 3.3),)
            scale: (0.02, 0.3)
GPU available: True, used: True
No environment variable for node rank defined. Set as 0.
CUDA_VISIBLE_DEVICES: [3]
If you use TorchIO for your research, please cite the following paper:
Pérez-García et al., TorchIO: a Python library for efficient loading,
preprocessing, augmentation and patch-based sampling of medical images
in deep learning. Link: https://arxiv.org/abs/2003.04696

Generating validation transform ...
Valid transform=Compose(
)
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Sensitivity is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:31:58,999] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000       0.0
          1     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000      42.0
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000       3.0

avg / total     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000      45.0

Covid class AUC=0.5238095238095238
ACC=0.0
[2021-03-01 15:32:47,700] default_module.py->log_info line:141 [INFO]lr=1.0000e-03
Generating training transform ...
Train transform=Compose(
    <torchio.transforms.augmentation.spatial.random_flip.RandomFlip object at 0x7f12c8c338d0>
)
Generating validation transform ...
Valid transform=Compose(
)
None
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:34:40,406] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 0/45 train_loss 1.1735  train_acc_1 11.1111
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:36:54,285] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8421    0.7619    0.9268    0.8000    0.8403    0.6945        42
          2     0.8837    0.9268    0.7619    0.9048    0.8403    0.7178        82

avg / total     0.8696    0.8710    0.8178    0.8693    0.8403    0.7099       124

Covid class AUC=0.769163763066202
ACC=0.8709677419354839
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 64.32748613859478 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)

Epoch 00000: valid_acc_1 reached 64.32749 (best 64.32749), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=0-valid_acc_1=64.33.ckpt as top 1
INFO:lightning:
Epoch 00000: valid_acc_1 reached 64.32749 (best 64.32749), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=0-valid_acc_1=64.33.ckpt as top 1
[2021-03-01 15:36:57,523] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5734  train_acc_1 78.7654
[2021-03-01 15:36:57,523] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6081  valid_acc_1 64.3275
[2021-03-01 15:36:57,524] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:36:57,533] default_module.py->log_info line:141 [INFO]lr=9.9975e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:38:32,161] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 0/45 train_loss 0.3799  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:39:55,485] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8372    0.8571    0.9146    0.8471    0.8854    0.7795        42
          2     0.9259    0.9146    0.8571    0.9202    0.8854    0.7885        82

avg / total     0.8959    0.8952    0.8766    0.8955    0.8854    0.7854       124

Covid class AUC=0.9663182346109176
ACC=0.8951612903225806
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.68254280090332 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.68254280090332 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00001: valid_acc_1 reached 89.68254 (best 89.68254), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=1-valid_acc_1=89.68.ckpt as top 1
INFO:lightning:
Epoch 00001: valid_acc_1 reached 89.68254 (best 89.68254), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=1-valid_acc_1=89.68.ckpt as top 1
[2021-03-01 15:39:57,401] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3936  train_acc_1 83.7037
[2021-03-01 15:39:57,401] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2913  valid_acc_1 89.6825
[2021-03-01 15:39:57,401] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:39:57,407] default_module.py->log_info line:141 [INFO]lr=9.9901e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:41:20,887] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 0/45 train_loss 0.3814  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:43:06,233] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.0238    1.0000    0.0465    0.1543    0.0215        42
          2     0.6667    1.0000    0.0238    0.8000    0.1543    0.0261        82

avg / total     0.7796    0.6694    0.3545    0.5448    0.1543    0.0246       124

Covid class AUC=0.9625435540069686
ACC=0.6693548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 67.4603179522923 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 67.4603179522923 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00002: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00002: valid_acc_1  was not in top 1
[2021-03-01 15:43:06,303] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3552  train_acc_1 86.0494
[2021-03-01 15:43:06,303] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.0597  valid_acc_1 67.4603
[2021-03-01 15:43:06,303] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:43:06,313] default_module.py->log_info line:141 [INFO]lr=9.9778e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:44:29,406] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 0/45 train_loss 0.3945  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:45:31,309] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5970    0.9524    0.6707    0.7339    0.7992    0.6568        42
          2     0.9649    0.6707    0.9524    0.7914    0.7992    0.6208        82

avg / total     0.8403    0.7661    0.8570    0.7719    0.7992    0.6330       124

Covid class AUC=0.9436701509872242
ACC=0.7661290322580645
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.30385507856097 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.30385507856097 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00003: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00003: valid_acc_1  was not in top 1
[2021-03-01 15:45:31,441] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3547  train_acc_1 84.4444
[2021-03-01 15:45:31,442] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4662  valid_acc_1 76.3039
[2021-03-01 15:45:31,442] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:45:31,448] default_module.py->log_info line:141 [INFO]lr=9.9606e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:46:56,919] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 0/45 train_loss 0.1898  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:48:00,969] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6552    0.9048    0.7561    0.7600    0.8271    0.6943        42
          2     0.9394    0.7561    0.9048    0.8378    0.8271    0.6739        82

avg / total     0.8431    0.8065    0.8544    0.8115    0.8271    0.6808       124

Covid class AUC=0.9085365853658536
ACC=0.8064516129032258
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 80.72562435695103 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 80.72562435695103 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00004: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00004: valid_acc_1  was not in top 1
[2021-03-01 15:48:03,210] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3119  train_acc_1 87.7778
[2021-03-01 15:48:03,210] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4058  valid_acc_1 80.7256
[2021-03-01 15:48:03,210] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:48:03,215] default_module.py->log_info line:141 [INFO]lr=9.9384e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:49:33,782] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 0/45 train_loss 0.1179  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:51:01,588] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.4938    0.9524    0.5000    0.6504    0.6901    0.4977        42
          2     0.9535    0.5000    0.9524    0.6560    0.6901    0.4546        82

avg / total     0.7978    0.6532    0.7992    0.6541    0.6901    0.4692       124

Covid class AUC=0.9067944250871081
ACC=0.6532258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 64.96598706926618 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 64.96598706926618 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00005: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00005: valid_acc_1  was not in top 1
[2021-03-01 15:51:01,884] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3214  train_acc_1 88.1482
[2021-03-01 15:51:01,884] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6108  valid_acc_1 64.9660
[2021-03-01 15:51:01,884] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:51:01,893] default_module.py->log_info line:141 [INFO]lr=9.9114e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:52:18,422] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 0/45 train_loss 0.3860  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:54:11,641] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.3095    1.0000    0.4727    0.5563    0.2882        42
          2     0.7387    1.0000    0.3095    0.8497    0.5563    0.3309        82

avg / total     0.8272    0.7661    0.5434    0.7220    0.5563    0.3164       124

Covid class AUC=0.9738675958188152
ACC=0.7661290322580645
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.98412772587368 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.98412772587368 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00006: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00006: valid_acc_1  was not in top 1
[2021-03-01 15:54:12,109] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2968  train_acc_1 86.7901
[2021-03-01 15:54:12,109] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8495  valid_acc_1 76.9841
[2021-03-01 15:54:12,109] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:54:12,116] default_module.py->log_info line:141 [INFO]lr=9.8796e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:55:20,567] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 0/45 train_loss 0.2215  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:56:42,053] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.5476    1.0000    0.7077    0.7400    0.5228        42
          2     0.8119    1.0000    0.5476    0.8962    0.7400    0.5724        82

avg / total     0.8756    0.8468    0.7008    0.8323    0.7400    0.5556       124

Covid class AUC=0.9657375145180023
ACC=0.8467741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.92063556398664 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.92063556398664 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00007: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00007: valid_acc_1  was not in top 1
[2021-03-01 15:56:42,118] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2829  train_acc_1 89.1358
[2021-03-01 15:56:42,118] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3375  valid_acc_1 84.9206
[2021-03-01 15:56:42,118] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:56:42,128] default_module.py->log_info line:141 [INFO]lr=9.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:58:08,392] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 0/45 train_loss 0.3045  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:59:23,820] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5067    0.9048    0.5488    0.6496    0.7046    0.5142        42
          2     0.9184    0.5488    0.9048    0.6870    0.7046    0.4788        82

avg / total     0.7789    0.6694    0.7842    0.6743    0.7046    0.4908       124

Covid class AUC=0.8449477351916376
ACC=0.6693548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 66.78004591805595 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 66.78004591805595 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00008: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00008: valid_acc_1  was not in top 1
[2021-03-01 15:59:23,875] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3170  train_acc_1 88.5185
[2021-03-01 15:59:23,875] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5676  valid_acc_1 66.7800
[2021-03-01 15:59:23,875] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:59:23,884] default_module.py->log_info line:141 [INFO]lr=9.8015e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:00:55,532] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 0/45 train_loss 0.2815  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:02:21,556] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7358    0.9286    0.8293    0.8211    0.8775    0.7777        42
          2     0.9577    0.8293    0.9286    0.8889    0.8775    0.7624        82

avg / total     0.8826    0.8629    0.8949    0.8659    0.8775    0.7676       124

Covid class AUC=0.957026713124274
ACC=0.8629032258064516
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 86.28117915562221 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 86.28117915562221 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00009: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00009: valid_acc_1  was not in top 1
[2021-03-01 16:02:22,972] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2829  train_acc_1 88.1481
[2021-03-01 16:02:22,972] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3059  valid_acc_1 86.2812
[2021-03-01 16:02:22,972] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:02:22,981] default_module.py->log_info line:141 [INFO]lr=9.7553e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:03:33,327] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 0/45 train_loss 0.1601  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:05:14,078] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8718    0.8095    0.9390    0.8395    0.8719    0.7503        42
          2     0.9059    0.9390    0.8095    0.9222    0.8719    0.7700        82

avg / total     0.8943    0.8952    0.8534    0.8942    0.8719    0.7633       124

Covid class AUC=0.9520905923344948
ACC=0.8951612903225806
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.45578302655902 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.45578302655902 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00010: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00010: valid_acc_1  was not in top 1
[2021-03-01 16:05:15,029] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2169  train_acc_1 90.4938
[2021-03-01 16:05:15,029] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2936  valid_acc_1 89.4558
[2021-03-01 16:05:15,029] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:05:15,037] default_module.py->log_info line:141 [INFO]lr=9.7044e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:06:25,237] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 0/45 train_loss 0.3410  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:07:55,851] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7347    0.8571    0.8415    0.7912    0.8493    0.7224        42
          2     0.9200    0.8415    0.8571    0.8790    0.8493    0.7201        82

avg / total     0.8572    0.8468    0.8518    0.8493    0.8493    0.7209       124

Covid class AUC=0.9218931475029036
ACC=0.8467741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.92063576834542 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.92063576834542 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00011: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00011: valid_acc_1  was not in top 1
[2021-03-01 16:07:55,996] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2815  train_acc_1 90.1235
[2021-03-01 16:07:55,996] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3538  valid_acc_1 84.9206
[2021-03-01 16:07:55,997] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:07:56,005] default_module.py->log_info line:141 [INFO]lr=9.6489e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:09:12,530] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 0/45 train_loss 0.1978  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:10:30,330] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.4524    1.0000    0.6230    0.6726    0.4276        42
          2     0.7810    1.0000    0.4524    0.8770    0.6726    0.4772        82

avg / total     0.8551    0.8145    0.6379    0.7910    0.6726    0.4604       124

Covid class AUC=0.9709639953542393
ACC=0.8145161290322581
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 81.7460321017674 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 81.7460321017674 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00012: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00012: valid_acc_1  was not in top 1
[2021-03-01 16:10:30,395] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2696  train_acc_1 88.6420
[2021-03-01 16:10:30,395] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3382  valid_acc_1 81.7460
[2021-03-01 16:10:30,395] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:10:30,404] default_module.py->log_info line:141 [INFO]lr=9.5888e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:11:51,053] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 0/45 train_loss 0.4748  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:13:13,444] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9677    0.7143    0.9878    0.8219    0.8400    0.6863        42
          2     0.8710    0.9878    0.7143    0.9257    0.8400    0.7249        82

avg / total     0.9037    0.8952    0.8069    0.8906    0.8400    0.7118       124

Covid class AUC=0.9802555168408826
ACC=0.8951612903225806
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.68254116603306 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.68254116603306 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00013: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00013: valid_acc_1  was not in top 1
[2021-03-01 16:13:13,901] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3024  train_acc_1 88.6420
[2021-03-01 16:13:13,902] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2299  valid_acc_1 89.6825
[2021-03-01 16:13:13,902] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:13:13,914] default_module.py->log_info line:141 [INFO]lr=9.5241e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:14:38,090] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 0/45 train_loss 0.2251  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:16:03,129] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5000    0.9286    0.5244    0.6500    0.6978    0.5066        42
          2     0.9348    0.5244    0.9286    0.6719    0.6978    0.4673        82

avg / total     0.7875    0.6613    0.7917    0.6645    0.6978    0.4806       124

Covid class AUC=0.8208478513356562
ACC=0.6612903225806451
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 65.306122643607 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 65.306122643607 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00014: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00014: valid_acc_1  was not in top 1
[2021-03-01 16:16:04,121] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3130  train_acc_1 86.7901
[2021-03-01 16:16:04,121] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.7075  valid_acc_1 65.3061
[2021-03-01 16:16:04,121] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:16:04,131] default_module.py->log_info line:141 [INFO]lr=9.4550e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:17:24,235] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 0/45 train_loss 0.1616  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:19:23,527] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.4330    1.0000    0.3293    0.6043    0.5738    0.3514        42
          2     1.0000    0.3293    1.0000    0.4954    0.5738    0.3072        82

avg / total     0.8079    0.5565    0.7728    0.5323    0.5738    0.3221       124

Covid class AUC=0.932636469221835
ACC=0.5564516129032258
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 54.98866319656372 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 54.98866319656372 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00015: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00015: valid_acc_1  was not in top 1
[2021-03-01 16:19:23,596] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3181  train_acc_1 85.1852
[2021-03-01 16:19:23,596] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.4146  valid_acc_1 54.9887
[2021-03-01 16:19:23,597] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:19:23,607] default_module.py->log_info line:141 [INFO]lr=9.3815e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:20:37,403] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 0/45 train_loss 0.2207  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:21:49,248] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6852    0.8810    0.7927    0.7708    0.8357    0.7045        42
          2     0.9286    0.7927    0.8810    0.8553    0.8357    0.6922        82

avg / total     0.8461    0.8226    0.8511    0.8267    0.8357    0.6963       124

Covid class AUC=0.9247967479674797
ACC=0.8225806451612904
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 82.08616747174945 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 82.08616747174945 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00016: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00016: valid_acc_1  was not in top 1
[2021-03-01 16:21:49,416] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2629  train_acc_1 88.5185
[2021-03-01 16:21:49,416] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3758  valid_acc_1 82.0862
[2021-03-01 16:21:49,416] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:21:49,423] default_module.py->log_info line:141 [INFO]lr=9.3037e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:23:18,244] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 0/45 train_loss 0.1023  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:24:20,444] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9722    0.8333    0.9878    0.8974    0.9073    0.8105        42
          2     0.9205    0.9878    0.8333    0.9529    0.9073    0.8359        82

avg / total     0.9380    0.9355    0.8857    0.9341    0.9073    0.8273       124

Covid class AUC=0.977061556329849
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079443795341 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079443795341 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00017: valid_acc_1 reached 93.65079 (best 93.65079), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=17-valid_acc_1=93.65.ckpt as top 1
INFO:lightning:
Epoch 00017: valid_acc_1 reached 93.65079 (best 93.65079), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=17-valid_acc_1=93.65.ckpt as top 1
[2021-03-01 16:24:25,501] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2631  train_acc_1 90.0000
[2021-03-01 16:24:25,511] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2335  valid_acc_1 93.6508
[2021-03-01 16:24:25,511] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:24:25,518] default_module.py->log_info line:141 [INFO]lr=9.2216e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:25:55,434] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 0/45 train_loss 0.2379  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:27:32,492] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9722    0.8333    0.9878    0.8974    0.9073    0.8105        42
          2     0.9205    0.9878    0.8333    0.9529    0.9073    0.8359        82

avg / total     0.9380    0.9355    0.8857    0.9341    0.9073    0.8273       124

Covid class AUC=0.9564459930313588
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079443795341 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079443795341 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00018: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00018: valid_acc_1  was not in top 1
[2021-03-01 16:27:32,652] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2419  train_acc_1 88.6420
[2021-03-01 16:27:32,652] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2343  valid_acc_1 93.6508
[2021-03-01 16:27:32,652] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:27:32,659] default_module.py->log_info line:141 [INFO]lr=9.1354e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:28:43,612] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 0/45 train_loss 0.1030  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:30:40,675] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.5476    1.0000    0.7077    0.7400    0.5228        42
          2     0.8119    1.0000    0.5476    0.8962    0.7400    0.5724        82

avg / total     0.8756    0.8468    0.7008    0.8323    0.7400    0.5556       124

Covid class AUC=0.9404761904761906
ACC=0.8467741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.92063501902989 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.92063501902989 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00019: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00019: valid_acc_1  was not in top 1
[2021-03-01 16:30:40,742] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2254  train_acc_1 91.3580
[2021-03-01 16:30:40,743] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3432  valid_acc_1 84.9206
[2021-03-01 16:30:40,743] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:30:40,753] default_module.py->log_info line:141 [INFO]lr=9.0451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:32:00,731] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 0/45 train_loss 0.5494  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:33:11,453] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5128    0.9524    0.5366    0.6667    0.7149    0.5323        42
          2     0.9565    0.5366    0.9524    0.6875    0.7149    0.4898        82

avg / total     0.8062    0.6774    0.8115    0.6804    0.7149    0.5042       124

Covid class AUC=0.9645760743321719
ACC=0.6774193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 66.89342403411865 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 66.89342403411865 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00020: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00020: valid_acc_1  was not in top 1
[2021-03-01 16:33:11,610] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2294  train_acc_1 90.8642
[2021-03-01 16:33:11,610] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5873  valid_acc_1 66.8934
[2021-03-01 16:33:11,610] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:33:11,620] default_module.py->log_info line:141 [INFO]lr=8.9508e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:34:48,152] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 0/45 train_loss 0.2466  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:36:03,678] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5714    0.9524    0.6341    0.7143    0.7771    0.6232        42
          2     0.9630    0.6341    0.9524    0.7647    0.7771    0.5847        82

avg / total     0.8303    0.7419    0.8446    0.7476    0.7771    0.5977       124

Covid class AUC=0.9311846689895471
ACC=0.7419354838709677
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 73.69614546639579 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 73.69614546639579 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00021: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00021: valid_acc_1  was not in top 1
[2021-03-01 16:36:03,980] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2331  train_acc_1 89.7531
[2021-03-01 16:36:03,981] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5542  valid_acc_1 73.6961
[2021-03-01 16:36:03,981] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:36:03,989] default_module.py->log_info line:141 [INFO]lr=8.8526e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:37:32,136] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 0/45 train_loss 0.1141  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:39:19,792] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5556    0.9524    0.6098    0.7018    0.7620    0.6006        42
          2     0.9615    0.6098    0.9524    0.7463    0.7620    0.5608        82

avg / total     0.8240    0.7258    0.8363    0.7312    0.7620    0.5743       124

Covid class AUC=0.9277003484320557
ACC=0.7258064516129032
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 72.33560126168388 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 72.33560126168388 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00022: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00022: valid_acc_1  was not in top 1
[2021-03-01 16:39:21,338] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2051  train_acc_1 92.2222
[2021-03-01 16:39:21,339] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6204  valid_acc_1 72.3356
[2021-03-01 16:39:21,339] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:39:21,349] default_module.py->log_info line:141 [INFO]lr=8.7506e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:40:35,700] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 0/45 train_loss 0.5643  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:42:01,902] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.3333    1.0000    0.5000    0.5774    0.3111        42
          2     0.7455    1.0000    0.3333    0.8542    0.5774    0.3556        82

avg / total     0.8317    0.7742    0.5591    0.7342    0.5774    0.3405       124

Covid class AUC=0.3803716608594657
ACC=0.7741935483870968
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777814865112 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777814865112 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00023: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00023: valid_acc_1  was not in top 1
[2021-03-01 16:42:01,971] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2667  train_acc_1 88.6420
[2021-03-01 16:42:01,971] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4560  valid_acc_1 77.7778
[2021-03-01 16:42:01,971] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:42:01,982] default_module.py->log_info line:141 [INFO]lr=8.6448e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:43:35,595] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 0/45 train_loss 0.2235  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:44:25,723] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6000    0.5000    0.8293    0.5455    0.6439    0.4010        42
          2     0.7640    0.8293    0.5000    0.7953    0.6439    0.4283        82

avg / total     0.7085    0.7177    0.6115    0.7107    0.6439    0.4190       124

Covid class AUC=0.8083623693379791
ACC=0.717741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 71.99546602794102 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 71.99546602794102 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00024: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00024: valid_acc_1  was not in top 1
[2021-03-01 16:44:28,608] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2367  train_acc_1 89.1358
[2021-03-01 16:44:28,609] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5469  valid_acc_1 71.9955
[2021-03-01 16:44:28,609] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:44:28,617] default_module.py->log_info line:141 [INFO]lr=8.5355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:46:07,151] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 0/45 train_loss 0.1132  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:47:30,194] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5634    0.9524    0.6220    0.7080    0.7696    0.6119        42
          2     0.9623    0.6220    0.9524    0.7556    0.7696    0.5728        82

avg / total     0.8272    0.7339    0.8405    0.7394    0.7696    0.5860       124

Covid class AUC=0.9146341463414634
ACC=0.7338709677419355
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 72.67573765345982 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 72.67573765345982 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00025: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00025: valid_acc_1  was not in top 1
[2021-03-01 16:47:30,485] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2596  train_acc_1 89.2593
[2021-03-01 16:47:30,485] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5228  valid_acc_1 72.6757
[2021-03-01 16:47:30,485] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:47:30,492] default_module.py->log_info line:141 [INFO]lr=8.4227e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:48:44,440] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 0/45 train_loss 0.2794  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:50:15,291] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8056    0.6905    0.9146    0.7436    0.7947    0.6174        42
          2     0.8523    0.9146    0.6905    0.8824    0.7947    0.6457        82

avg / total     0.8364    0.8387    0.7664    0.8354    0.7947    0.6361       124

Covid class AUC=0.914924506387921
ACC=0.8387096774193549
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.12698541368756 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.12698541368756 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00026: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00026: valid_acc_1  was not in top 1
[2021-03-01 16:50:15,997] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1876  train_acc_1 91.9753
[2021-03-01 16:50:15,998] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3684  valid_acc_1 84.1270
[2021-03-01 16:50:15,998] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:50:16,008] default_module.py->log_info line:141 [INFO]lr=8.3066e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:51:25,890] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 0/45 train_loss 0.0620  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:53:08,902] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6667    0.9524    0.7561    0.7843    0.8486    0.7342        42
          2     0.9688    0.7561    0.9524    0.8493    0.8486    0.7060        82

avg / total     0.8664    0.8226    0.8859    0.8273    0.8486    0.7155       124

Covid class AUC=0.9698025551684089
ACC=0.8225806451612904
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 82.08616856166294 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 82.08616856166294 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00027: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00027: valid_acc_1  was not in top 1
[2021-03-01 16:53:09,022] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2719  train_acc_1 89.1358
[2021-03-01 16:53:09,022] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3515  valid_acc_1 82.0862
[2021-03-01 16:53:09,023] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:53:09,029] default_module.py->log_info line:141 [INFO]lr=8.1871e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:54:25,802] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 0/45 train_loss 0.2407  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:55:40,358] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7308    0.9048    0.8293    0.8085    0.8662    0.7560        42
          2     0.9444    0.8293    0.9048    0.8831    0.8662    0.7446        82

avg / total     0.8721    0.8548    0.8792    0.8578    0.8662    0.7485       124

Covid class AUC=0.9439605110336817
ACC=0.8548387096774194
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 85.48752920968192 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 85.48752920968192 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00028: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00028: valid_acc_1  was not in top 1
[2021-03-01 16:55:40,483] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2079  train_acc_1 93.2099
[2021-03-01 16:55:40,483] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3267  valid_acc_1 85.4875
[2021-03-01 16:55:40,484] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:55:40,493] default_module.py->log_info line:141 [INFO]lr=8.0645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:56:55,497] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 0/45 train_loss 0.2726  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:58:25,383] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.5325    0.9762    0.5610    0.6891    0.7400    0.5704        42
          2     0.9787    0.5610    0.9762    0.7132    0.7400    0.5249        82

avg / total     0.8276    0.7016    0.8356    0.7050    0.7400    0.5403       124

Covid class AUC=0.9277003484320557
ACC=0.7016129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 69.72789219447544 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 69.72789219447544 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00029: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00029: valid_acc_1  was not in top 1
[2021-03-01 16:58:25,935] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2460  train_acc_1 91.8519
[2021-03-01 16:58:25,935] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6575  valid_acc_1 69.7279
[2021-03-01 16:58:25,935] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:58:25,941] default_module.py->log_info line:141 [INFO]lr=7.9389e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:00:00,180] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 0/45 train_loss 0.1896  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:01:29,958] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8293    0.8095    0.9146    0.8193    0.8605    0.7326        42
          2     0.9036    0.9146    0.8095    0.9091    0.8605    0.7482        82

avg / total     0.8784    0.8790    0.8451    0.8787    0.8605    0.7429       124

Covid class AUC=0.9369918699186992
ACC=0.8790322580645161
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.0952388218471 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.0952388218471 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00030: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00030: valid_acc_1  was not in top 1
[2021-03-01 17:01:30,139] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2316  train_acc_1 89.3827
[2021-03-01 17:01:30,139] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3112  valid_acc_1 88.0952
[2021-03-01 17:01:30,139] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:01:30,146] default_module.py->log_info line:141 [INFO]lr=7.8104e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:02:32,443] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 0/45 train_loss 0.1167  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:04:26,702] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.3471    1.0000    0.0366    0.5153    0.1913    0.0401        42
          2     1.0000    0.0366    1.0000    0.0706    0.1913    0.0331        82

avg / total     0.7789    0.3629    0.6737    0.2212    0.1913    0.0354       124

Covid class AUC=0.876306620209059
ACC=0.3629032258064516
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 35.71428564616612 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 35.71428564616612 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00031: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00031: valid_acc_1  was not in top 1
[2021-03-01 17:04:26,759] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2444  train_acc_1 90.4938
[2021-03-01 17:04:26,759] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 2.9101  valid_acc_1 35.7143
[2021-03-01 17:04:26,759] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:04:26,767] default_module.py->log_info line:141 [INFO]lr=7.6791e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:05:40,055] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 0/45 train_loss 0.2316  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:07:01,404] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7800    0.9286    0.8659    0.8478    0.8967    0.8090        42
          2     0.9595    0.8659    0.9286    0.9103    0.8967    0.7990        82

avg / total     0.8987    0.8871    0.9073    0.8891    0.8967    0.8024       124

Covid class AUC=0.959349593495935
ACC=0.8870967741935484
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.88888985770089 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.88888985770089 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00032: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00032: valid_acc_1  was not in top 1
[2021-03-01 17:07:01,481] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2287  train_acc_1 91.2346
[2021-03-01 17:07:01,481] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2779  valid_acc_1 88.8889
[2021-03-01 17:07:01,481] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:07:01,491] default_module.py->log_info line:141 [INFO]lr=7.5452e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:08:32,818] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 0/45 train_loss 0.6347  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:10:04,250] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9189    0.8095    0.9634    0.8608    0.8831    0.7679        42
          2     0.9080    0.9634    0.8095    0.9349    0.8831    0.7919        82

avg / total     0.9117    0.9113    0.8616    0.9098    0.8831    0.7838       124

Covid class AUC=0.9706736353077816
ACC=0.9112903225806451
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.26984351021903 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.26984351021903 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00033: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00033: valid_acc_1  was not in top 1
[2021-03-01 17:10:06,507] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2098  train_acc_1 90.9877
[2021-03-01 17:10:06,507] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2500  valid_acc_1 91.2698
[2021-03-01 17:10:06,507] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:10:06,519] default_module.py->log_info line:141 [INFO]lr=7.4088e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:11:19,102] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 0/45 train_loss 0.4203  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:13:14,645] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7091    0.9286    0.8049    0.8041    0.8645    0.7566        42
          2     0.9565    0.8049    0.9286    0.8742    0.8645    0.7381        82

avg / total     0.8727    0.8468    0.8867    0.8504    0.8645    0.7444       124

Covid class AUC=0.9462833914053426
ACC=0.8467741935483871
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 84.46712057931083 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 84.46712057931083 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00034: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00034: valid_acc_1  was not in top 1
[2021-03-01 17:13:14,735] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2467  train_acc_1 90.6173
[2021-03-01 17:13:14,735] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3753  valid_acc_1 84.4671
[2021-03-01 17:13:14,735] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:13:14,744] default_module.py->log_info line:141 [INFO]lr=7.2700e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:14:33,554] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 0/45 train_loss 0.1527  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:15:51,357] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7273    0.7619    0.8537    0.7442    0.8065    0.6444        42
          2     0.8750    0.8537    0.7619    0.8642    0.8065    0.6564        82

avg / total     0.8250    0.8226    0.7930    0.8235    0.8065    0.6523       124

Covid class AUC=0.9407665505226481
ACC=0.8225806451612904
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 82.312926701137 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 82.312926701137 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00035: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00035: valid_acc_1  was not in top 1
[2021-03-01 17:15:51,416] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2254  train_acc_1 92.0988
[2021-03-01 17:15:51,416] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3569  valid_acc_1 82.3129
[2021-03-01 17:15:51,416] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:15:51,426] default_module.py->log_info line:141 [INFO]lr=7.1289e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:17:22,741] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 0/45 train_loss 0.1543  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:18:49,917] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7826    0.8571    0.8780    0.8182    0.8675    0.7510        42
          2     0.9231    0.8780    0.8571    0.9000    0.8675    0.7542        82

avg / total     0.8755    0.8710    0.8642    0.8723    0.8675    0.7531       124

Covid class AUC=0.9497677119628339
ACC=0.8709677419354839
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.07483073643276 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.07483073643276 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00036: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00036: valid_acc_1  was not in top 1
[2021-03-01 17:18:50,665] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2341  train_acc_1 91.8519
[2021-03-01 17:18:50,665] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2858  valid_acc_1 87.0748
[2021-03-01 17:18:50,665] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:18:50,673] default_module.py->log_info line:141 [INFO]lr=6.9857e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:20:11,259] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 0/45 train_loss 0.1135  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:21:53,926] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6349    0.9524    0.7195    0.7619    0.8278    0.7012        42
          2     0.9672    0.7195    0.9524    0.8252    0.8278    0.6693        82

avg / total     0.8547    0.7984    0.8735    0.8037    0.8278    0.6801       124

Covid class AUC=0.9651567944250871
ACC=0.7983870967741935
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 79.70521545410156 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 79.70521545410156 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00037: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00037: valid_acc_1  was not in top 1
Epoch 00038: early stopping
INFO:lightning:Epoch 00038: early stopping
[2021-03-01 17:21:55,052] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2029  train_acc_1 91.1111
[2021-03-01 17:21:55,052] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3981  valid_acc_1 79.7052
[2021-03-01 17:21:55,052] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:21:55,062] default_module.py->log_info line:141 [INFO]lr=6.8406e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:22:57,889] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 0/45 train_loss 0.1131  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:24:32,488] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.4878    0.9524    0.4878    0.6452    0.6816    0.4862        42
          2     0.9524    0.4878    0.9524    0.6452    0.6816    0.4430        82

avg / total     0.7950    0.6452    0.7950    0.6452    0.6816    0.4576       124

Covid class AUC=0.9004065040650406
ACC=0.6451612903225806
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 63.94557884761265 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 63.94557884761265 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00038: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00038: valid_acc_1  was not in top 1
Epoch 00039: early stopping
INFO:lightning:Epoch 00039: early stopping
[2021-03-01 17:24:32,646] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2269  train_acc_1 90.1235
[2021-03-01 17:24:32,647] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6735  valid_acc_1 63.9456
[2021-03-01 17:24:32,647] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:24:32,653] default_module.py->log_info line:141 [INFO]lr=6.6937e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:25:50,783] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 0/45 train_loss 0.2207  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:27:05,868] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.4048    1.0000    0.5763    0.6362    0.3807        42
          2     0.7664    1.0000    0.4048    0.8677    0.6362    0.4289        82

avg / total     0.8455    0.7984    0.6064    0.7690    0.6362    0.4125       124

Covid class AUC=0.9802555168408826
ACC=0.7983870967741935
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 80.15873084749494 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 80.15873084749494 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00039: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00039: valid_acc_1  was not in top 1
Epoch 00040: early stopping
INFO:lightning:Epoch 00040: early stopping
[2021-03-01 17:27:05,934] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1972  train_acc_1 92.3457
[2021-03-01 17:27:05,934] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.8067  valid_acc_1 80.1587
[2021-03-01 17:27:05,934] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:27:05,946] default_module.py->log_info line:141 [INFO]lr=6.5451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:28:25,435] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 0/45 train_loss 0.4226  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:29:39,779] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.7619    1.0000    0.8649    0.8729    0.7438        42
          2     0.8913    1.0000    0.7619    0.9425    0.8729    0.7800        82

avg / total     0.9281    0.9194    0.8425    0.9162    0.8729    0.7678       124

Covid class AUC=0.968931475029036
ACC=0.9193548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.06349236624581 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.06349236624581 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00040: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00040: valid_acc_1  was not in top 1
Epoch 00041: early stopping
INFO:lightning:Epoch 00041: early stopping
[2021-03-01 17:29:41,897] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1784  train_acc_1 93.8272
[2021-03-01 17:29:41,898] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2395  valid_acc_1 92.0635
[2021-03-01 17:29:41,898] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:29:41,908] default_module.py->log_info line:141 [INFO]lr=6.3950e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:31:08,124] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 0/45 train_loss 0.7088  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:31:58,697] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6842    0.9286    0.7805    0.7879    0.8513    0.7355        42
          2     0.9552    0.7805    0.9286    0.8591    0.8513    0.7140        82

avg / total     0.8634    0.8306    0.8784    0.8350    0.8513    0.7213       124

Covid class AUC=0.9509291521486644
ACC=0.8306451612903226
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 83.10657555716378 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 83.10657555716378 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00041: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00041: valid_acc_1  was not in top 1
Epoch 00042: early stopping
INFO:lightning:Epoch 00042: early stopping
[2021-03-01 17:31:58,760] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2187  train_acc_1 91.8519
[2021-03-01 17:31:58,760] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3124  valid_acc_1 83.1066
[2021-03-01 17:31:58,760] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:31:58,769] default_module.py->log_info line:141 [INFO]lr=6.2434e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:32:40,485] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 0/45 train_loss 0.1197  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:33:25,513] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7308    0.9048    0.8293    0.8085    0.8662    0.7560        42
          2     0.9444    0.8293    0.9048    0.8831    0.8662    0.7446        82

avg / total     0.8721    0.8548    0.8792    0.8578    0.8662    0.7485       124

Covid class AUC=0.9494773519163763
ACC=0.8548387096774194
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 85.48752811976841 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 85.48752811976841 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00042: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00042: valid_acc_1  was not in top 1
Epoch 00043: early stopping
INFO:lightning:Epoch 00043: early stopping
[2021-03-01 17:33:25,577] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1852  train_acc_1 92.3457
[2021-03-01 17:33:25,577] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3318  valid_acc_1 85.4875
[2021-03-01 17:33:25,578] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:33:25,588] default_module.py->log_info line:141 [INFO]lr=6.0907e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:34:07,643] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 0/45 train_loss 0.6546  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:34:54,117] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.4941    1.0000    0.4756    0.6614    0.6896    0.5006        42
          2     1.0000    0.4756    1.0000    0.6446    0.6896    0.4507        82

avg / total     0.8287    0.6532    0.8224    0.6503    0.6896    0.4676       124

Covid class AUC=0.940766550522648
ACC=0.6532258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 64.51247228894916 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 64.51247228894916 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00043: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00043: valid_acc_1  was not in top 1
Epoch 00044: early stopping
INFO:lightning:Epoch 00044: early stopping
[2021-03-01 17:34:54,177] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1906  train_acc_1 92.9630
[2021-03-01 17:34:54,177] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6854  valid_acc_1 64.5125
[2021-03-01 17:34:54,177] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:34:54,185] default_module.py->log_info line:141 [INFO]lr=5.9369e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:35:43,754] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 0/45 train_loss 0.3931  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:37:00,583] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8261    0.9048    0.9024    0.8636    0.9036    0.8167        42
          2     0.9487    0.9024    0.9048    0.9250    0.9036    0.8163        82

avg / total     0.9072    0.9032    0.9040    0.9042    0.9036    0.8164       124

Covid class AUC=0.9483159117305459
ACC=0.9032258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.47619192940849 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.47619192940849 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00044: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00044: valid_acc_1  was not in top 1
Epoch 00045: early stopping
INFO:lightning:Epoch 00045: early stopping
[2021-03-01 17:37:00,654] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1859  train_acc_1 93.5802
[2021-03-01 17:37:00,655] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2694  valid_acc_1 90.4762
[2021-03-01 17:37:00,655] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:37:00,663] default_module.py->log_info line:141 [INFO]lr=5.7822e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:38:03,364] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 0/45 train_loss 0.1519  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:39:29,442] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8163    0.9524    0.8902    0.8791    0.9208    0.8531        42
          2     0.9733    0.8902    0.9524    0.9299    0.9208    0.8426        82

avg / total     0.9202    0.9113    0.9313    0.9127    0.9208    0.8462       124

Covid class AUC=0.9840301974448316
ACC=0.9112903225806451
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.26984296526227 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.26984296526227 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00045: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00045: valid_acc_1  was not in top 1
Epoch 00046: early stopping
INFO:lightning:Epoch 00046: early stopping
[2021-03-01 17:39:30,035] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1815  train_acc_1 93.0864
[2021-03-01 17:39:30,035] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2737  valid_acc_1 91.2698
[2021-03-01 17:39:30,036] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:39:30,043] default_module.py->log_info line:141 [INFO]lr=5.6267e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:40:32,613] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 0/45 train_loss 0.0477  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:44:28,001] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.6905    1.0000    0.8169    0.8309    0.6691        42
          2     0.8632    1.0000    0.6905    0.9266    0.8309    0.7118        82

avg / total     0.9095    0.8952    0.7953    0.8894    0.8309    0.6974       124

Covid class AUC=0.9671893147502905
ACC=0.8951612903225806
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.68254007611957 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.68254007611957 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00046: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00046: valid_acc_1  was not in top 1
Epoch 00047: early stopping
INFO:lightning:Epoch 00047: early stopping
[2021-03-01 17:44:33,459] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1854  train_acc_1 92.2222
[2021-03-01 17:44:33,459] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3208  valid_acc_1 89.6825
[2021-03-01 17:44:33,459] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:44:33,470] default_module.py->log_info line:141 [INFO]lr=5.4705e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:47:15,756] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 0/45 train_loss 0.3259  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:49:55,899] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9730    0.8571    0.9878    0.9114    0.9202    0.8356        42
          2     0.9310    0.9878    0.8571    0.9586    0.9202    0.8578        82

avg / total     0.9452    0.9435    0.9014    0.9426    0.9202    0.8503       124

Covid class AUC=0.9703832752613242
ACC=0.9435483870967742
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 94.44444547380719 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 94.44444547380719 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00047: valid_acc_1 reached 94.44445 (best 94.44445), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=47-valid_acc_1=94.44.ckpt as top 1
INFO:lightning:
Epoch 00047: valid_acc_1 reached 94.44445 (best 94.44445), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=47-valid_acc_1=94.44.ckpt as top 1
[2021-03-01 17:49:59,298] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2075  train_acc_1 92.5926
[2021-03-01 17:49:59,298] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2218  valid_acc_1 94.4444
[2021-03-01 17:49:59,298] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:49:59,304] default_module.py->log_info line:141 [INFO]lr=5.3140e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:51:33,781] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 0/45 train_loss 0.0358  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:52:56,138] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7500    0.9286    0.8415    0.8298    0.8839    0.7882        42
          2     0.9583    0.8415    0.9286    0.8961    0.8839    0.7746        82

avg / total     0.8878    0.8710    0.8991    0.8736    0.8839    0.7792       124

Covid class AUC=0.9663182346109175
ACC=0.8709677419354839
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 87.07483019147601 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 87.07483019147601 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00048: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00048: valid_acc_1  was not in top 1
[2021-03-01 17:52:57,322] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1634  train_acc_1 93.8272
[2021-03-01 17:52:57,322] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3014  valid_acc_1 87.0748
[2021-03-01 17:52:57,322] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:52:57,331] default_module.py->log_info line:141 [INFO]lr=5.1571e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:54:13,448] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 0/45 train_loss 0.1837  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:55:53,414] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6562    1.0000    0.7317    0.7925    0.8554    0.7513        42
          2     1.0000    0.7317    1.0000    0.8451    0.8554    0.7121        82

avg / total     0.8836    0.8226    0.9091    0.8272    0.8554    0.7254       124

Covid class AUC=0.9811265969802555
ACC=0.8225806451612904
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 82.31292506626674 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 82.31292506626674 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00049: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00049: valid_acc_1  was not in top 1
[2021-03-01 17:55:53,635] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2068  train_acc_1 92.0988
[2021-03-01 17:55:53,635] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3871  valid_acc_1 82.3129
[2021-03-01 17:55:53,636] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:55:53,644] default_module.py->log_info line:141 [INFO]lr=5.0000e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:57:09,570] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 0/45 train_loss 0.1945  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:58:42,473] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.6667    1.0000    0.8000    0.8165    0.6444        42
          2     0.8542    1.0000    0.6667    0.9213    0.8165    0.6889        82

avg / total     0.9036    0.8871    0.7796    0.8802    0.8165    0.6738       124

Covid class AUC=0.9764808362369338
ACC=0.8870967741935484
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.88888904026577 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.88888904026577 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00050: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00050: valid_acc_1  was not in top 1
[2021-03-01 17:58:43,217] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1697  train_acc_1 94.5679
[2021-03-01 17:58:43,217] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3745  valid_acc_1 88.8889
[2021-03-01 17:58:43,217] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:58:43,227] default_module.py->log_info line:141 [INFO]lr=4.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:59:51,210] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 0/45 train_loss 0.2719  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:01:34,846] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8163    0.9524    0.8902    0.8791    0.9208    0.8531        42
          2     0.9733    0.8902    0.9524    0.9299    0.9208    0.8426        82

avg / total     0.9202    0.9113    0.9313    0.9127    0.9208    0.8462       124

Covid class AUC=0.9909988385598142
ACC=0.9112903225806451
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.26984296526227 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.26984296526227 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00051: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00051: valid_acc_1  was not in top 1
[2021-03-01 18:01:35,188] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2538  train_acc_1 91.4815
[2021-03-01 18:01:35,188] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1953  valid_acc_1 91.2698
[2021-03-01 18:01:35,188] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:01:35,254] default_module.py->log_info line:141 [INFO]lr=4.6860e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:03:16,170] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 0/45 train_loss 0.1420  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:05:12,655] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9667    0.6905    0.9878    0.8056    0.8259    0.6618        42
          2     0.8617    0.9878    0.6905    0.9205    0.8259    0.7023        82

avg / total     0.8973    0.8871    0.7912    0.8815    0.8259    0.6886       124

Covid class AUC=0.9799651567944252
ACC=0.8870967741935484
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.88888931274414 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.88888931274414 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00052: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00052: valid_acc_1  was not in top 1
[2021-03-01 18:05:13,346] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1728  train_acc_1 93.3333
[2021-03-01 18:05:13,346] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2650  valid_acc_1 88.8889
[2021-03-01 18:05:13,346] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:05:13,356] default_module.py->log_info line:141 [INFO]lr=4.5295e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:06:52,310] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 0/45 train_loss 0.0212  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:08:52,442] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6500    0.9286    0.7439    0.7647    0.8311    0.7035        42
          2     0.9531    0.7439    0.9286    0.8356    0.8311    0.6780        82

avg / total     0.8505    0.8065    0.8660    0.8116    0.8311    0.6867       124

Covid class AUC=0.9454123112659698
ACC=0.8064516129032258
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 80.72562408447266 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 80.72562408447266 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00053: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00053: valid_acc_1  was not in top 1
[2021-03-01 18:08:53,159] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2183  train_acc_1 90.0000
[2021-03-01 18:08:53,159] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3766  valid_acc_1 80.7256
[2021-03-01 18:08:53,160] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:08:53,167] default_module.py->log_info line:141 [INFO]lr=4.3733e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:09:58,338] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 0/45 train_loss 0.0359  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:12:07,681] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9500    0.9048    0.9756    0.9268    0.9395    0.8764        42
          2     0.9524    0.9756    0.9048    0.9639    0.9395    0.8889        82

avg / total     0.9516    0.9516    0.9288    0.9513    0.9395    0.8847       124

Covid class AUC=0.9773519163763067
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00054: valid_acc_1 reached 95.23810 (best 95.23810), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=54-valid_acc_1=95.24.ckpt as top 1
INFO:lightning:
Epoch 00054: valid_acc_1 reached 95.23810 (best 95.23810), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=54-valid_acc_1=95.24.ckpt as top 1
[2021-03-01 18:12:09,280] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1633  train_acc_1 94.0741
[2021-03-01 18:12:09,280] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1793  valid_acc_1 95.2381
[2021-03-01 18:12:09,280] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:12:09,286] default_module.py->log_info line:141 [INFO]lr=4.2178e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:13:43,688] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 0/45 train_loss 0.1063  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:15:44,901] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9688    0.7381    0.9878    0.8378    0.8539    0.7109        42
          2     0.8804    0.9878    0.7381    0.9310    0.8539    0.7473        82

avg / total     0.9103    0.9032    0.8227    0.8995    0.8539    0.7350       124

Covid class AUC=0.982288037166086
ACC=0.9032258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.47619138445172 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.47619138445172 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00055: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00055: valid_acc_1  was not in top 1
[2021-03-01 18:15:45,293] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1282  train_acc_1 94.5679
[2021-03-01 18:15:45,294] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2140  valid_acc_1 90.4762
[2021-03-01 18:15:45,294] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:15:45,304] default_module.py->log_info line:141 [INFO]lr=4.0631e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:17:26,265] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 0/45 train_loss 0.0384  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:19:43,865] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9231    0.8571    0.9634    0.8889    0.9087    0.8170        42
          2     0.9294    0.9634    0.8571    0.9461    0.9087    0.8346        82

avg / total     0.9273    0.9274    0.8931    0.9267    0.9087    0.8286       124

Covid class AUC=0.967479674796748
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714394705636 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714394705636 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00056: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00056: valid_acc_1  was not in top 1
[2021-03-01 18:19:44,190] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2018  train_acc_1 91.9753
[2021-03-01 18:19:44,191] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2145  valid_acc_1 92.8571
[2021-03-01 18:19:44,191] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:19:44,197] default_module.py->log_info line:141 [INFO]lr=3.9093e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:21:00,630] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 0/45 train_loss 0.0308  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:22:42,761] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9286    0.9286    0.9634    0.9286    0.9458    0.8915        42
          2     0.9634    0.9634    0.9286    0.9634    0.9458    0.8977        82

avg / total     0.9516    0.9516    0.9404    0.9516    0.9458    0.8956       124

Covid class AUC=0.9793844367015098
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809596470424 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809596470424 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00057: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00057: valid_acc_1  was not in top 1
[2021-03-01 18:22:42,924] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1365  train_acc_1 95.3086
[2021-03-01 18:22:42,924] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1696  valid_acc_1 95.2381
[2021-03-01 18:22:42,924] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:22:42,931] default_module.py->log_info line:141 [INFO]lr=3.7566e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:24:18,737] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 0/45 train_loss 0.0499  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:26:25,804] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.6154    0.9524    0.6951    0.7477    0.8136    0.6791        42
          2     0.9661    0.6951    0.9524    0.8085    0.8136    0.6450        82

avg / total     0.8473    0.7823    0.8652    0.7879    0.8136    0.6565       124

Covid class AUC=0.9695121951219512
ACC=0.782258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.3446717943464 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.3446717943464 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00058: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00058: valid_acc_1  was not in top 1
[2021-03-01 18:26:26,011] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1491  train_acc_1 93.5802
[2021-03-01 18:26:26,011] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4285  valid_acc_1 78.3447
[2021-03-01 18:26:26,012] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:26:26,020] default_module.py->log_info line:141 [INFO]lr=3.6050e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:27:52,005] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 0/45 train_loss 0.0272  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:30:06,330] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9722    0.8333    0.9878    0.8974    0.9073    0.8105        42
          2     0.9205    0.9878    0.8333    0.9529    0.9073    0.8359        82

avg / total     0.9380    0.9355    0.8857    0.9341    0.9073    0.8273       124

Covid class AUC=0.9944831591173054
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079443795341 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079443795341 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00059: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00059: valid_acc_1  was not in top 1
[2021-03-01 18:30:06,497] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1115  train_acc_1 96.1728
[2021-03-01 18:30:06,498] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1609  valid_acc_1 93.6508
[2021-03-01 18:30:06,498] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:30:06,504] default_module.py->log_info line:141 [INFO]lr=3.4549e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:31:01,234] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 0/45 train_loss 0.0449  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:33:05,012] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.8095    1.0000    0.8947    0.8997    0.7941        42
          2     0.9111    1.0000    0.8095    0.9535    0.8997    0.8249        82

avg / total     0.9412    0.9355    0.8740    0.9336    0.8997    0.8145       124

Covid class AUC=0.9668989547038327
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079389299665 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079389299665 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00060: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00060: valid_acc_1  was not in top 1
[2021-03-01 18:33:05,214] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1463  train_acc_1 94.3210
[2021-03-01 18:33:05,215] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2684  valid_acc_1 93.6508
[2021-03-01 18:33:05,215] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:33:05,223] default_module.py->log_info line:141 [INFO]lr=3.3063e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:34:32,098] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 0/45 train_loss 0.0283  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:36:35,054] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7959    0.9286    0.8780    0.8571    0.9030    0.8195        42
          2     0.9600    0.8780    0.9286    0.9172    0.9030    0.8112        82

avg / total     0.9044    0.8952    0.9115    0.8969    0.9030    0.8140       124

Covid class AUC=0.9767711962833914
ACC=0.8951612903225806
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 89.45578275408063 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 89.45578275408063 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00061: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00061: valid_acc_1  was not in top 1
[2021-03-01 18:36:36,273] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1361  train_acc_1 95.0617
[2021-03-01 18:36:36,273] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2191  valid_acc_1 89.4558
[2021-03-01 18:36:36,273] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:36:36,282] default_module.py->log_info line:141 [INFO]lr=3.1594e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:38:10,840] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 0/45 train_loss 0.1457  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:40:18,840] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9459    0.8333    0.9756    0.8861    0.9017    0.8014        42
          2     0.9195    0.9756    0.8333    0.9467    0.9017    0.8246        82

avg / total     0.9285    0.9274    0.8815    0.9262    0.9017    0.8167       124

Covid class AUC=0.9610917537746806
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714394705636 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714394705636 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00062: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00062: valid_acc_1  was not in top 1
[2021-03-01 18:40:19,646] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1138  train_acc_1 96.0494
[2021-03-01 18:40:19,646] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3206  valid_acc_1 92.8571
[2021-03-01 18:40:19,647] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:40:19,656] default_module.py->log_info line:141 [INFO]lr=3.0143e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:41:18,683] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 0/45 train_loss 0.0462  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:43:35,588] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8864    0.9286    0.9390    0.9070    0.9338    0.8710        42
          2     0.9625    0.9390    0.9286    0.9506    0.9338    0.8729        82

avg / total     0.9367    0.9355    0.9321    0.9358    0.9338    0.8722       124

Covid class AUC=0.977061556329849
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.6507955278669 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.6507955278669 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00063: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00063: valid_acc_1  was not in top 1
[2021-03-01 18:43:35,926] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1479  train_acc_1 94.0741
[2021-03-01 18:43:35,926] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1892  valid_acc_1 93.6508
[2021-03-01 18:43:35,926] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:43:35,933] default_module.py->log_info line:141 [INFO]lr=2.8711e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:45:04,904] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 0/45 train_loss 0.1078  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:47:16,443] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8125    0.9286    0.8902    0.8667    0.9092    0.8298        42
          2     0.9605    0.8902    0.9286    0.9241    0.9092    0.8235        82

avg / total     0.9104    0.9032    0.9156    0.9046    0.9092    0.8256       124

Covid class AUC=0.9706736353077816
ACC=0.9032258064516129
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 90.24943324497768 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 90.24943324497768 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00064: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00064: valid_acc_1  was not in top 1
[2021-03-01 18:47:18,506] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1411  train_acc_1 93.8272
[2021-03-01 18:47:18,507] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2336  valid_acc_1 90.2494
[2021-03-01 18:47:18,507] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:47:18,518] default_module.py->log_info line:141 [INFO]lr=2.7300e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:48:43,208] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 0/45 train_loss 0.3223  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:50:54,118] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.7857    1.0000    0.8800    0.8864    0.7689        42
          2     0.9011    1.0000    0.7857    0.9480    0.8864    0.8026        82

avg / total     0.9346    0.9274    0.8583    0.9250    0.8864    0.7911       124

Covid class AUC=0.9767711962833914
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714340209961 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714340209961 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00065: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00065: valid_acc_1  was not in top 1
[2021-03-01 18:50:54,887] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1179  train_acc_1 95.5556
[2021-03-01 18:50:54,887] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.3928  valid_acc_1 92.8571
[2021-03-01 18:50:54,887] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:50:54,895] default_module.py->log_info line:141 [INFO]lr=2.5912e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:51:56,716] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 0/45 train_loss 0.5136  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:54:06,223] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9286    0.9286    0.9634    0.9286    0.9458    0.8915        42
          2     0.9634    0.9634    0.9286    0.9634    0.9458    0.8977        82

avg / total     0.9516    0.9516    0.9404    0.9516    0.9458    0.8956       124

Covid class AUC=0.975609756097561
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00066: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00066: valid_acc_1  was not in top 1
[2021-03-01 18:54:06,669] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1260  train_acc_1 95.3086
[2021-03-01 18:54:06,669] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1667  valid_acc_1 95.2381
[2021-03-01 18:54:06,669] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:54:06,683] default_module.py->log_info line:141 [INFO]lr=2.4548e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:55:31,244] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 0/45 train_loss 0.0469  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:57:48,802] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9512    0.9286    0.9756    0.9398    0.9518    0.9017        42
          2     0.9639    0.9756    0.9286    0.9697    0.9518    0.9102        82

avg / total     0.9596    0.9597    0.9445    0.9596    0.9518    0.9073       124

Covid class AUC=0.9895470383275262
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174700055804 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174700055804 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00067: valid_acc_1 reached 96.03175 (best 96.03175), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=67-valid_acc_1=96.03.ckpt as top 1
INFO:lightning:
Epoch 00067: valid_acc_1 reached 96.03175 (best 96.03175), saving model to ./output/covidctset_r3d_18_bs9_s64/version_1/checkpoints/epoch=67-valid_acc_1=96.03.ckpt as top 1
[2021-03-01 18:57:51,847] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1188  train_acc_1 95.3086
[2021-03-01 18:57:51,847] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1433  valid_acc_1 96.0317
[2021-03-01 18:57:51,848] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:57:51,853] default_module.py->log_info line:141 [INFO]lr=2.3209e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:59:21,726] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 0/45 train_loss 0.0160  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:01:15,985] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9231    0.8571    0.9634    0.8889    0.9087    0.8170        42
          2     0.9294    0.9634    0.8571    0.9461    0.9087    0.8346        82

avg / total     0.9273    0.9274    0.8931    0.9267    0.9087    0.8286       124

Covid class AUC=0.9657375145180024
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714340209961 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714340209961 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00068: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00068: valid_acc_1  was not in top 1
[2021-03-01 19:01:16,652] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1343  train_acc_1 94.6914
[2021-03-01 19:01:16,652] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1948  valid_acc_1 92.8571
[2021-03-01 19:01:16,652] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:01:16,673] default_module.py->log_info line:141 [INFO]lr=2.1896e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:02:42,738] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 0/45 train_loss 0.2436  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:04:43,666] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9000    0.8571    0.9512    0.8780    0.9030    0.8077        42
          2     0.9286    0.9512    0.8571    0.9398    0.9030    0.8230        82

avg / total     0.9189    0.9194    0.8890    0.9189    0.9030    0.8178       124

Covid class AUC=0.9732868757259001
ACC=0.9193548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.06349291120257 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.06349291120257 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00069: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00069: valid_acc_1  was not in top 1
[2021-03-01 19:04:44,055] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1531  train_acc_1 93.5802
[2021-03-01 19:04:44,055] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1980  valid_acc_1 92.0635
[2021-03-01 19:04:44,055] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:04:44,064] default_module.py->log_info line:141 [INFO]lr=2.0611e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:06:29,543] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 0/45 train_loss 0.0157  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:08:25,879] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.8333    1.0000    0.9091    0.9129    0.8194        42
          2     0.9213    1.0000    0.8333    0.9591    0.9129    0.8472        82

avg / total     0.9480    0.9435    0.8898    0.9421    0.9129    0.8378       124

Covid class AUC=0.9883855981416958
ACC=0.9435483870967742
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 94.44444492885044 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 94.44444492885044 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00070: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00070: valid_acc_1  was not in top 1
[2021-03-01 19:08:26,531] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1201  train_acc_1 95.8025
[2021-03-01 19:08:26,531] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2437  valid_acc_1 94.4444
[2021-03-01 19:08:26,531] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:08:26,539] default_module.py->log_info line:141 [INFO]lr=1.9355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:10:02,187] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 0/45 train_loss 0.0454  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:12:00,919] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7500    1.0000    0.8293    0.8571    0.9106    0.8434        42
          2     1.0000    0.8293    1.0000    0.9067    0.9106    0.8151        82

avg / total     0.9153    0.8871    0.9422    0.8899    0.9106    0.8247       124

Covid class AUC=0.9927409988385598
ACC=0.8870967741935484
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 88.88888985770089 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 88.88888985770089 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00071: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00071: valid_acc_1  was not in top 1
[2021-03-01 19:12:02,222] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1898  train_acc_1 94.8148
[2021-03-01 19:12:02,223] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2856  valid_acc_1 88.8889
[2021-03-01 19:12:02,223] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:12:02,236] default_module.py->log_info line:141 [INFO]lr=1.8129e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:13:27,359] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 0/45 train_loss 0.0266  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:15:11,827] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9512    0.9286    0.9756    0.9398    0.9518    0.9017        42
          2     0.9639    0.9756    0.9286    0.9697    0.9518    0.9102        82

avg / total     0.9596    0.9597    0.9445    0.9596    0.9518    0.9073       124

Covid class AUC=0.9933217189314751
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174700055804 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174700055804 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00072: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00072: valid_acc_1  was not in top 1
[2021-03-01 19:15:12,209] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0991  train_acc_1 95.8025
[2021-03-01 19:15:12,209] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1055  valid_acc_1 96.0317
[2021-03-01 19:15:12,209] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:15:12,218] default_module.py->log_info line:141 [INFO]lr=1.6934e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:17:01,862] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 0/45 train_loss 0.0285  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:18:59,457] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8837    0.9048    0.9390    0.8941    0.9217    0.8467        42
          2     0.9506    0.9390    0.9048    0.9448    0.9217    0.8525        82

avg / total     0.9280    0.9274    0.9164    0.9276    0.9217    0.8505       124

Covid class AUC=0.9677700348432057
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714449201312 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714449201312 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00073: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00073: valid_acc_1  was not in top 1
[2021-03-01 19:19:00,649] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0900  train_acc_1 97.0370
[2021-03-01 19:19:00,650] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2001  valid_acc_1 92.8571
[2021-03-01 19:19:00,650] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:19:00,657] default_module.py->log_info line:141 [INFO]lr=1.5773e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:20:33,904] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 0/45 train_loss 0.0428  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:22:36,790] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8667    0.9286    0.9268    0.8966    0.9277    0.8608        42
          2     0.9620    0.9268    0.9286    0.9441    0.9277    0.8605        82

avg / total     0.9297    0.9274    0.9280    0.9280    0.9277    0.8606       124

Covid class AUC=0.9747386759581882
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714394705636 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714394705636 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00074: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00074: valid_acc_1  was not in top 1
[2021-03-01 19:22:37,117] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0942  train_acc_1 97.0370
[2021-03-01 19:22:37,117] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1942  valid_acc_1 92.8571
[2021-03-01 19:22:37,117] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:22:37,124] default_module.py->log_info line:141 [INFO]lr=1.4645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:23:33,740] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 0/45 train_loss 0.1455  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:24:48,606] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7925    1.0000    0.8659    0.8842    0.9305    0.8775        42
          2     1.0000    0.8659    1.0000    0.9281    0.9305    0.8542        82

avg / total     0.9297    0.9113    0.9546    0.9132    0.9305    0.8621       124

Covid class AUC=0.9895470383275261
ACC=0.9112903225806451
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 91.26984242030552 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 91.26984242030552 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00075: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00075: valid_acc_1  was not in top 1
[2021-03-01 19:24:48,986] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1177  train_acc_1 95.8025
[2021-03-01 19:24:48,987] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.2832  valid_acc_1 91.2698
[2021-03-01 19:24:48,987] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:24:48,994] default_module.py->log_info line:141 [INFO]lr=1.3552e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:25:53,929] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 0/45 train_loss 0.0331  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:27:12,518] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9048    0.9048    0.9512    0.9048    0.9277    0.8566        42
          2     0.9512    0.9512    0.9048    0.9512    0.9277    0.8646        82

avg / total     0.9355    0.9355    0.9205    0.9355    0.9277    0.8619       124

Covid class AUC=0.9883855981416958
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079498291016 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079498291016 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00076: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00076: valid_acc_1  was not in top 1
[2021-03-01 19:27:12,819] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1236  train_acc_1 97.2840
[2021-03-01 19:27:12,819] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1496  valid_acc_1 93.6508
[2021-03-01 19:27:12,819] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:27:12,831] default_module.py->log_info line:141 [INFO]lr=1.2494e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:28:11,308] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 0/45 train_loss 0.0303  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:29:13,745] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9706    0.7857    0.9878    0.8684    0.8810    0.7604        42
          2     0.9000    0.9878    0.7857    0.9419    0.8810    0.7918        82

avg / total     0.9239    0.9194    0.8542    0.9170    0.8810    0.7812       124

Covid class AUC=0.9776422764227642
ACC=0.9193548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.06349236624581 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.06349236624581 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00077: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00077: valid_acc_1  was not in top 1
[2021-03-01 19:29:13,939] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.1118  train_acc_1 96.9136
[2021-03-01 19:29:13,939] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1934  valid_acc_1 92.0635
[2021-03-01 19:29:13,939] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:29:13,947] default_module.py->log_info line:141 [INFO]lr=1.1474e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:30:18,760] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 0/45 train_loss 0.1339  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:31:36,572] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9500    0.9048    0.9756    0.9268    0.9395    0.8764        42
          2     0.9524    0.9756    0.9048    0.9639    0.9395    0.8889        82

avg / total     0.9516    0.9516    0.9288    0.9513    0.9395    0.8847       124

Covid class AUC=0.9837398373983739
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00078: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00078: valid_acc_1  was not in top 1
[2021-03-01 19:31:37,013] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0911  train_acc_1 96.7901
[2021-03-01 19:31:37,014] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1457  valid_acc_1 95.2381
[2021-03-01 19:31:37,014] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:31:37,021] default_module.py->log_info line:141 [INFO]lr=1.0492e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:32:42,889] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 0/45 train_loss 0.0117  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:33:51,343] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8511    0.9524    0.9146    0.8989    0.9333    0.8744        42
          2     0.9740    0.9146    0.9524    0.9434    0.9333    0.8678        82

avg / total     0.9324    0.9274    0.9396    0.9283    0.9333    0.8700       124

Covid class AUC=0.9939024390243902
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714449201312 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714449201312 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00079: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00079: valid_acc_1  was not in top 1
[2021-03-01 19:33:51,467] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0480  train_acc_1 98.5185
[2021-03-01 19:33:51,467] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1756  valid_acc_1 92.8571
[2021-03-01 19:33:51,467] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:33:51,477] default_module.py->log_info line:141 [INFO]lr=9.5492e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:34:53,913] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 0/45 train_loss 0.1338  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:36:04,806] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8667    0.9286    0.9268    0.8966    0.9277    0.8608        42
          2     0.9620    0.9268    0.9286    0.9441    0.9277    0.8605        82

avg / total     0.9297    0.9274    0.9280    0.9280    0.9277    0.8606       124

Covid class AUC=0.9819976771196284
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714394705636 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714394705636 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00080: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00080: valid_acc_1  was not in top 1
[2021-03-01 19:36:05,034] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0737  train_acc_1 96.9136
[2021-03-01 19:36:05,034] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1674  valid_acc_1 92.8571
[2021-03-01 19:36:05,035] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:36:05,043] default_module.py->log_info line:141 [INFO]lr=8.6460e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:37:10,786] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 0/45 train_loss 0.0307  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:38:30,601] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9070    0.9286    0.9512    0.9176    0.9398    0.8813        42
          2     0.9630    0.9512    0.9286    0.9571    0.9398    0.8853        82

avg / total     0.9440    0.9435    0.9362    0.9437    0.9398    0.8839       124

Covid class AUC=0.9886759581881533
ACC=0.9435483870967742
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 94.44444601876395 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 94.44444601876395 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00081: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00081: valid_acc_1  was not in top 1
[2021-03-01 19:38:30,787] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0838  train_acc_1 96.6667
[2021-03-01 19:38:30,788] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1382  valid_acc_1 94.4444
[2021-03-01 19:38:30,788] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:38:30,800] default_module.py->log_info line:141 [INFO]lr=7.7836e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:39:36,884] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 0/45 train_loss 0.0272  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:40:32,534] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9048    0.9048    0.9512    0.9048    0.9277    0.8566        42
          2     0.9512    0.9512    0.9048    0.9512    0.9277    0.8646        82

avg / total     0.9355    0.9355    0.9205    0.9355    0.9277    0.8619       124

Covid class AUC=0.9886759581881532
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.6507955278669 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.6507955278669 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00082: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00082: valid_acc_1  was not in top 1
[2021-03-01 19:40:32,880] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0841  train_acc_1 98.0247
[2021-03-01 19:40:32,880] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1421  valid_acc_1 93.6508
[2021-03-01 19:40:32,880] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:40:32,888] default_module.py->log_info line:141 [INFO]lr=6.9629e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:41:32,115] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 0/45 train_loss 0.0264  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:42:46,355] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     1.0000    0.8095    1.0000    0.8947    0.8997    0.7941        42
          2     0.9111    1.0000    0.8095    0.9535    0.8997    0.8249        82

avg / total     0.9412    0.9355    0.8740    0.9336    0.8997    0.8145       124

Covid class AUC=0.9831591173054588
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079389299665 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079389299665 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00083: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00083: valid_acc_1  was not in top 1
[2021-03-01 19:42:46,530] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0645  train_acc_1 98.2716
[2021-03-01 19:42:46,530] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1978  valid_acc_1 93.6508
[2021-03-01 19:42:46,530] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:42:46,545] default_module.py->log_info line:141 [INFO]lr=6.1847e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:43:50,762] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 0/45 train_loss 0.0496  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:45:10,621] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8667    0.9286    0.9268    0.8966    0.9277    0.8608        42
          2     0.9620    0.9268    0.9286    0.9441    0.9277    0.8605        82

avg / total     0.9297    0.9274    0.9280    0.9280    0.9277    0.8606       124

Covid class AUC=0.9886759581881532
ACC=0.9274193548387096
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.85714449201312 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.85714449201312 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00084: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00084: valid_acc_1  was not in top 1
[2021-03-01 19:45:10,797] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0670  train_acc_1 97.5309
[2021-03-01 19:45:10,797] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1523  valid_acc_1 92.8571
[2021-03-01 19:45:10,797] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:45:10,805] default_module.py->log_info line:141 [INFO]lr=5.4497e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:46:12,814] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 0/45 train_loss 0.0356  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:47:14,255] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8478    0.9286    0.9146    0.8864    0.9216    0.8505        42
          2     0.9615    0.9146    0.9286    0.9375    0.9216    0.8481        82

avg / total     0.9230    0.9194    0.9239    0.9202    0.9216    0.8489       124

Covid class AUC=0.9857723577235773
ACC=0.9193548387096774
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 92.06349345615932 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 92.06349345615932 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00085: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00085: valid_acc_1  was not in top 1
[2021-03-01 19:47:14,486] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0878  train_acc_1 97.5309
[2021-03-01 19:47:14,487] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1764  valid_acc_1 92.0635
[2021-03-01 19:47:14,487] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:47:14,495] default_module.py->log_info line:141 [INFO]lr=4.7586e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:48:07,240] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 0/45 train_loss 0.0402  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:49:27,720] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9474    0.8571    0.9756    0.9000    0.9145    0.8263        42
          2     0.9302    0.9756    0.8571    0.9524    0.9145    0.8461        82

avg / total     0.9360    0.9355    0.8973    0.9346    0.9145    0.8394       124

Covid class AUC=0.9898373983739838
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079498291016 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079498291016 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00086: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00086: valid_acc_1  was not in top 1
[2021-03-01 19:49:27,915] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0559  train_acc_1 98.2716
[2021-03-01 19:49:27,915] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1502  valid_acc_1 93.6508
[2021-03-01 19:49:27,915] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:49:27,927] default_module.py->log_info line:141 [INFO]lr=4.1123e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:50:32,672] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 0/45 train_loss 0.0769  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:51:52,018] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8696    0.9524    0.9268    0.9091    0.9395    0.8849        42
          2     0.9744    0.9268    0.9524    0.9500    0.9395    0.8804        82

avg / total     0.9389    0.9355    0.9437    0.9361    0.9395    0.8820       124

Covid class AUC=0.9921602787456446
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.6507955278669 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.6507955278669 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00087: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00087: valid_acc_1  was not in top 1
Epoch 00088: early stopping
INFO:lightning:Epoch 00088: early stopping
[2021-03-01 19:51:52,197] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0623  train_acc_1 98.2716
[2021-03-01 19:51:52,197] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1530  valid_acc_1 93.6508
[2021-03-01 19:51:52,197] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:51:52,204] default_module.py->log_info line:141 [INFO]lr=3.5112e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:52:49,733] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 0/45 train_loss 0.0141  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:53:59,608] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9744    0.9048    0.9878    0.9383    0.9454    0.8863        42
          2     0.9529    0.9878    0.9048    0.9701    0.9454    0.9012        82

avg / total     0.9602    0.9597    0.9329    0.9593    0.9454    0.8961       124

Covid class AUC=0.9880952380952381
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174700055804 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174700055804 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00088: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00088: valid_acc_1  was not in top 1
Epoch 00089: early stopping
INFO:lightning:Epoch 00089: early stopping
[2021-03-01 19:53:59,982] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0665  train_acc_1 98.0247
[2021-03-01 19:53:59,982] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1452  valid_acc_1 96.0317
[2021-03-01 19:53:59,982] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:53:59,997] default_module.py->log_info line:141 [INFO]lr=2.9560e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:55:05,010] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 0/45 train_loss 0.0360  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:56:23,962] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8864    0.9286    0.9390    0.9070    0.9338    0.8710        42
          2     0.9625    0.9390    0.9286    0.9506    0.9338    0.8729        82

avg / total     0.9367    0.9355    0.9321    0.9358    0.9338    0.8722       124

Covid class AUC=0.9901277584204413
ACC=0.9354838709677419
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 93.65079498291016 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 93.65079498291016 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00089: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00089: valid_acc_1  was not in top 1
Epoch 00090: early stopping
INFO:lightning:Epoch 00090: early stopping
[2021-03-01 19:56:24,375] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0434  train_acc_1 98.7654
[2021-03-01 19:56:24,375] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1295  valid_acc_1 93.6508
[2021-03-01 19:56:24,375] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:56:24,388] default_module.py->log_info line:141 [INFO]lr=2.4472e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:57:30,014] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 0/45 train_loss 0.0480  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:58:37,183] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8723    0.9762    0.9268    0.9213    0.9512    0.9092        42
          2     0.9870    0.9268    0.9762    0.9560    0.9512    0.9003        82

avg / total     0.9482    0.9435    0.9595    0.9442    0.9512    0.9033       124

Covid class AUC=0.9927409988385598
ACC=0.9435483870967742
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 94.4444465637207 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 94.4444465637207 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00090: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00090: valid_acc_1  was not in top 1
Epoch 00091: early stopping
INFO:lightning:Epoch 00091: early stopping
[2021-03-01 19:58:37,518] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0510  train_acc_1 98.5185
[2021-03-01 19:58:37,518] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1354  valid_acc_1 94.4444
[2021-03-01 19:58:37,518] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:58:37,524] default_module.py->log_info line:141 [INFO]lr=1.9853e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:59:38,664] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 0/45 train_loss 0.0873  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:00:44,625] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9111    0.9762    0.9512    0.9425    0.9636    0.9309        42
          2     0.9873    0.9512    0.9762    0.9689    0.9636    0.9263        82

avg / total     0.9615    0.9597    0.9677    0.9600    0.9636    0.9278       124

Covid class AUC=0.9924506387921023
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174754551479 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174754551479 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00091: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00091: valid_acc_1  was not in top 1
Epoch 00092: early stopping
INFO:lightning:Epoch 00092: early stopping
[2021-03-01 20:00:44,791] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0627  train_acc_1 98.2716
[2021-03-01 20:00:44,791] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1134  valid_acc_1 96.0317
[2021-03-01 20:00:44,791] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:00:44,800] default_module.py->log_info line:141 [INFO]lr=1.5708e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:01:50,295] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 0/45 train_loss 0.0086  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:03:10,396] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9286    0.9286    0.9634    0.9286    0.9458    0.8915        42
          2     0.9634    0.9634    0.9286    0.9634    0.9458    0.8977        82

avg / total     0.9516    0.9516    0.9404    0.9516    0.9458    0.8956       124

Covid class AUC=0.9927409988385598
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00092: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00092: valid_acc_1  was not in top 1
Epoch 00093: early stopping
INFO:lightning:Epoch 00093: early stopping
[2021-03-01 20:03:10,594] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0292  train_acc_1 99.5062
[2021-03-01 20:03:10,595] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1023  valid_acc_1 95.2381
[2021-03-01 20:03:10,595] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:03:10,602] default_module.py->log_info line:141 [INFO]lr=1.2042e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:04:15,063] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 0/45 train_loss 0.0106  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:05:15,934] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8889    0.9524    0.9390    0.9195    0.9457    0.8955        42
          2     0.9747    0.9390    0.9524    0.9565    0.9457    0.8931        82

avg / total     0.9456    0.9435    0.9479    0.9440    0.9457    0.8939       124

Covid class AUC=0.9927409988385598
ACC=0.9435483870967742
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 94.44444601876395 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 94.44444601876395 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00093: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00093: valid_acc_1  was not in top 1
Epoch 00094: early stopping
INFO:lightning:Epoch 00094: early stopping
[2021-03-01 20:05:16,162] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0303  train_acc_1 99.7531
[2021-03-01 20:05:16,163] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1081  valid_acc_1 94.4444
[2021-03-01 20:05:16,163] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:05:16,171] default_module.py->log_info line:141 [INFO]lr=8.8564e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:06:09,595] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 0/45 train_loss 0.0096  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:07:29,848] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9286    0.9286    0.9634    0.9286    0.9458    0.8915        42
          2     0.9634    0.9634    0.9286    0.9634    0.9458    0.8977        82

avg / total     0.9516    0.9516    0.9404    0.9516    0.9458    0.8956       124

Covid class AUC=0.9924506387921023
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00094: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00094: valid_acc_1  was not in top 1
Epoch 00095: early stopping
INFO:lightning:Epoch 00095: early stopping
[2021-03-01 20:07:30,023] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0498  train_acc_1 98.0247
[2021-03-01 20:07:30,023] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1065  valid_acc_1 95.2381
[2021-03-01 20:07:30,023] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:07:30,031] default_module.py->log_info line:141 [INFO]lr=6.1558e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:08:34,778] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 0/45 train_loss 0.2936  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:09:54,824] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9286    0.9286    0.9634    0.9286    0.9458    0.8915        42
          2     0.9634    0.9634    0.9286    0.9634    0.9458    0.8977        82

avg / total     0.9516    0.9516    0.9404    0.9516    0.9458    0.8956       124

Covid class AUC=0.9927409988385598
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00095: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00095: valid_acc_1  was not in top 1
Epoch 00096: early stopping
INFO:lightning:Epoch 00096: early stopping
[2021-03-01 20:09:54,988] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0688  train_acc_1 96.6667
[2021-03-01 20:09:54,988] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1090  valid_acc_1 95.2381
[2021-03-01 20:09:54,988] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:09:54,995] default_module.py->log_info line:141 [INFO]lr=3.9426e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:10:52,056] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 0/45 train_loss 0.1159  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:12:02,170] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9744    0.9048    0.9878    0.9383    0.9454    0.8863        42
          2     0.9529    0.9878    0.9048    0.9701    0.9454    0.9012        82

avg / total     0.9602    0.9597    0.9329    0.9593    0.9454    0.8961       124

Covid class AUC=0.9921602787456446
ACC=0.9596774193548387
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 96.03174700055804 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 96.03174700055804 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00096: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00096: valid_acc_1  was not in top 1
Epoch 00097: early stopping
INFO:lightning:Epoch 00097: early stopping
[2021-03-01 20:12:02,538] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0471  train_acc_1 98.7654
[2021-03-01 20:12:02,538] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1171  valid_acc_1 96.0317
[2021-03-01 20:12:02,538] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:12:02,546] default_module.py->log_info line:141 [INFO]lr=2.2190e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:13:08,641] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 0/45 train_loss 0.0144  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:14:25,546] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9286    0.9286    0.9634    0.9286    0.9458    0.8915        42
          2     0.9634    0.9634    0.9286    0.9634    0.9458    0.8977        82

avg / total     0.9516    0.9516    0.9404    0.9516    0.9458    0.8956       124

Covid class AUC=0.9927409988385598
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00097: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00097: valid_acc_1  was not in top 1
Epoch 00098: early stopping
INFO:lightning:Epoch 00098: early stopping
[2021-03-01 20:14:25,875] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0478  train_acc_1 98.5185
[2021-03-01 20:14:25,875] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1073  valid_acc_1 95.2381
[2021-03-01 20:14:25,875] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:14:25,883] default_module.py->log_info line:141 [INFO]lr=9.8664e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:15:31,047] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 0/45 train_loss 0.0129  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:16:40,104] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9286    0.9286    0.9634    0.9286    0.9458    0.8915        42
          2     0.9634    0.9634    0.9286    0.9634    0.9458    0.8977        82

avg / total     0.9516    0.9516    0.9404    0.9516    0.9458    0.8956       124

Covid class AUC=0.9924506387921023
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00098: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00098: valid_acc_1  was not in top 1
Epoch 00099: early stopping
INFO:lightning:Epoch 00099: early stopping
[2021-03-01 20:16:40,444] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0262  train_acc_1 99.7531
[2021-03-01 20:16:40,444] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1097  valid_acc_1 95.2381
[2021-03-01 20:16:40,444] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:16:40,459] default_module.py->log_info line:141 [INFO]lr=2.4672e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:17:40,867] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 0/45 train_loss 0.0131  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:18:46,409] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9286    0.9286    0.9634    0.9286    0.9458    0.8915        42
          2     0.9634    0.9634    0.9286    0.9634    0.9458    0.8977        82

avg / total     0.9516    0.9516    0.9404    0.9516    0.9458    0.8956       124

Covid class AUC=0.9927409988385598
ACC=0.9516129032258065
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 95.23809650966099 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 95.23809650966099 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00099: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00099: valid_acc_1  was not in top 1
Epoch 00100: early stopping
INFO:lightning:Epoch 00100: early stopping
[2021-03-01 20:18:46,795] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.0772  train_acc_1 97.7778
[2021-03-01 20:18:46,796] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.1067  valid_acc_1 95.2381
[2021-03-01 20:18:46,796] default_module.py->log_info line:141 [INFO]===========================

