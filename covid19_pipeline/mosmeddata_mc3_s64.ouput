[2021-03-01 15:30:32,223] config.py->setup_cfg_with_hparams line:84 [INFO]Running with full config:
DEFAULT_CUDNN_BENCHMARK: True
SEED: 6489
VERSION: 1
abtfs:
    blur:
        blur_limit: 3
        enable: 0
    bright:
        clip_limit: 1
        enable: 1
    channel_dropout:
        drop_range: (1, 1)
        enable: 0
        fill_value: 127
    channel_shuffle:
        enable: 0
    cutout:
        enable: 1
        fill_value: 127
        num_holes: 10
        size: 20
    distortion:
        enable: 0
    hue:
        enable: 0
    noise:
        enable: 1
    random_grid_shuffle:
        enable: 0
        grid: 2
    rotate:
        enable: 1
        p: 1
        rotate_limit: 45
        scale_limit: 0.2
        shift_limit: 0.0625
cam:
    debug: False
    featmaps_module_name: 'glob_avgpool'
    label: -1
    model_path: ''
    save_path: './cam_results'
    scan_path: ''
    weights_module_name: 'fc'
dataloader:
    num_workers: 40
    sample_test: 'default'
    sample_train: 'default'
    sampler:
        replacement: True
        weights_cls: [0, 0.23, 0.77]
dataset:
    batch_size: 9
    dir: '/home/datasets/COVID-19_CTs/MosMedData/COVID19_1110/pngs'
    is_3d: True
    is_color: False
    is_train: False
    name: 'CTDataset'
    slice_num: 64
    subset_train: 1.0
    subset_valid: 1.0
    test_list: '/home/datasets/COVID-19_CTs/mosmed/nii_png_test.json'
    train_list: '/home/datasets/COVID-19_CTs/mosmed/nii_png_train.json'
    valid_list: '/home/datasets/covid-19_cts/mosmed/nii_png_test.json'
hooks:
    early_stopping:
        min_delta: 0.0
        mode: 'max'
        monitor: 'valid_acc_1'
        patience: 20
        setting: 2
        verbose: 1
    model_checkpoint:
        filepath: ''
        mode: 'max'
        monitor: 'valid_acc_1'
        period: 1
        prefix: ''
        save_top_k: 1
        save_weights_only: False
        setting: 2
        verbose: 1
hparams: Namespace(cam_only=False, config_file='./config/mosmeddata_config.yml', opts=['trainer.gpus', '[2]', 'model.name', 'mc3_18', 'dataset.slice_num', '64', 'dataset.batch_size', '9', 'trainer.logger.test_tube.name', 'mosmeddata_mc3_18_bs9_s64'], predict_only=False, test_only=False)
input:
    size: (128, 128)
label_transforms:
    name: 'default'
log:
    name: './output/mosmeddata_mc3_18_bs9_s64/version_0/log.txt'
    path: './output/mosmeddata_mc3_18_bs9_s64/version_0'
loss:
    class_weight: []
    focal_loss:
        alpha: []
        gamma: 2
        size_average: True
    label_smoothing: 0.1
    name: 'CrossEntropy'
mixup:
    alpha: 0.4
    enable: 0
model:
    classes: 3
    dropout: 0
    finetune: False
    model_depth: 101
    n_input_channels: 1
    name: 'mc3_18'
    pretrained: False
module:
    analyze_result: True
    name: 'CTModule'
optim:
    base_lr: 0.001
    momentum: 0.9
    name: 'adam'
    scheduler:
        gamma: 0.1
        milestones: [10, 25, 35, 50]
        mode: 'min'
        name: 'CosineAnnealingLR'
        patience: 10
        step_size: 10
        t_0: 5
        t_max: 100
        t_mul: 20
        verbose: True
    weight_decay: 0.0005
predict_only:
    load_ckpt:
        checkpoint_path: ''
    load_metric:
        map_location: 'cuda:0'
        on_gpu: True
        tags_csv: ''
        weights_path: ''
    to_pred_file_path: ''
    type: 'ckpt'
topk: [1, 1]
trainer:
    accumulate_grad_batches: 1
    amp_level: 'O1'
    auto_lr_find: False
    auto_scale_batch_size: False
    auto_select_gpus: False
    benchmark: False
    check_val_every_n_epoch: 1
    default_root_dir: './output'
    default_save_path: './output'
    distributed_backend: 'dp'
    fast_dev_run: False
    gpus: [2]
    gradient_clip_val: 0
    log_gpu_memory: ''
    log_save_interval: 100
    logger:
        mlflow:
            experiment_name: 'torchline_logs'
            tracking_uri: './output'
        setting: 2
        test_tube:
            name: 'mosmeddata_mc3_18_bs9_s64'
            save_dir: './output'
            version: -1
        type: 'test_tube'
    max_epochs: 100
    max_steps: 99999999
    min_epochs: 99
    min_steps: 99999999
    name: 'DefaultTrainer'
    num_nodes: 1
    num_sanity_val_steps: 5
    num_tpu_cores: ''
    overfit_pct: 0.0
    precision: 32
    print_nan_grads: True
    process_position: 0
    progress_bar_refresh_rate: 0
    reload_dataloaders_every_epoch: False
    replace_sampler_ddp: True
    resume_from_checkpoint: ''
    row_log_interval: 10
    show_progress_bar: False
    terminate_on_nan: False
    test_percent_check: 1.0
    track_grad_norm: -1
    train_percent_check: 1.0
    truncated_bptt_steps: ''
    use_amp: False
    val_check_interval: 1.0
    val_percent_check: 1.0
    weights_save_path: ''
    weights_summary: ''
transforms:
    ct:
        randomaffine:
            degrees: (-10, 10)
            enable: 0
            isotropic: True
            p: 0.5
            scales: (0.5, 0.5)
        randomblur:
            enable: 0
            p: 0.5
            std: (0, 4)
        randomelasticdeformation:
            enable: 0
            locked_borders: 0
            max_displacement: (7, 7, 7)
            num_control_points: (4, 4, 4)
            p: 0.5
        randomflip:
            axes: (0, 1, 2)
            enable: 1
            flip_probability: 0.5
            p: 0.5
        randomnoise:
            enable: 0
            mean: (0, 0.25)
            p: 0.5
            std: (0, 0.25)
        randomswap:
            enable: 0
            num_iterations: 100
            p: 0.5
            patch_size: (16, 16, 16)
    img:
        aug_cifar: False
        aug_imagenet: False
        center_crop:
            enable: 0
        color_jitter:
            brightness: 0.1
            contrast: 0.1
            enable: 0
            hue: 0.1
            saturation: 0.1
        random_crop:
            enable: 1
            padding: 0
        random_horizontal_flip:
            enable: 1
            p: 0.5
        random_resized_crop:
            enable: 0
            ratio: (0.75, 1.3333333333333333)
            scale: (0.5, 1.0)
        random_rotation:
            degrees: 10
            enable: 1
        random_vertical_flip:
            enable: 1
            p: 0.5
        resize:
            enable: 1
    name: 'CTTransforms'
    tensor:
        normalization:
            mean: [0.5, 0.5, 0.5]
            std: [0.5, 0.5, 0.5]
        random_erasing:
            enable: 0
            p: 0.5
            ratio: ((0.3, 3.3),)
            scale: (0.02, 0.3)
GPU available: True, used: True
No environment variable for node rank defined. Set as 0.
CUDA_VISIBLE_DEVICES: [2]
If you use TorchIO for your research, please cite the following paper:
Pérez-García et al., TorchIO: a Python library for efficient loading,
preprocessing, augmentation and patch-based sampling of medical images
in deep learning. Link: https://arxiv.org/abs/2003.04696

Generating validation transform ...
Valid transform=Compose(
)
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_ranking.py:951: UndefinedMetricWarning: No positive samples in y_true, true positive value should be meaningless
  UndefinedMetricWarning)
[2021-03-01 15:31:40,828] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          2     1.0000    1.0000    0.0000    1.0000    0.0000    0.0000        45

avg / total     1.0000    1.0000    0.0000    1.0000    0.0000    0.0000        45

Covid class AUC=nan
ACC=1.0
[2021-03-01 15:31:54,194] default_module.py->log_info line:141 [INFO]lr=1.0000e-03
Generating training transform ...
Train transform=Compose(
    <torchio.transforms.augmentation.spatial.random_flip.RandomFlip object at 0x7fa99e97af28>
)
Generating validation transform ...
Valid transform=Compose(
)
None
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:32:30,544] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 0/87 train_loss 0.9032  train_acc_1 22.2222
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:35:41,525] default_module.py->log_info line:141 [INFO]Valid Epoch 0/100 step 100/37 valid_loss 0.5619  valid_acc_1 59.6491
[2021-03-01 15:35:51,207] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7895    0.9412    0.1579    0.8587    0.3855    0.1602       255
          2     0.4444    0.1579    0.9412    0.2330    0.3855    0.1370        76

avg / total     0.7103    0.7613    0.3377    0.7150    0.3855    0.1549       331

Covid class AUC=0.6494324045407637
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 79.02494439624604 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)

Epoch 00000: valid_acc_1 reached 79.02494 (best 79.02494), saving model to ./output/mosmeddata_mc3_18_bs9_s64/version_0/checkpoints/epoch=0-valid_acc_1=79.02.ckpt as top 1
INFO:lightning:
Epoch 00000: valid_acc_1 reached 79.02494 (best 79.02494), saving model to ./output/mosmeddata_mc3_18_bs9_s64/version_0/checkpoints/epoch=0-valid_acc_1=79.02.ckpt as top 1
[2021-03-01 15:35:51,772] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5702  train_acc_1 75.5045
[2021-03-01 15:35:51,772] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4856  valid_acc_1 79.0249
[2021-03-01 15:35:51,772] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:35:51,777] default_module.py->log_info line:141 [INFO]lr=9.9975e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:36:17,234] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 0/87 train_loss 0.3391  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:39:26,885] default_module.py->log_info line:141 [INFO]Valid Epoch 1/100 step 100/37 valid_loss 1.1491  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:39:36,973] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5986068111455108
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00001: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00001: valid_acc_1  was not in top 1
[2021-03-01 15:39:37,267] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5419  train_acc_1 76.2963
[2021-03-01 15:39:37,267] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5387  valid_acc_1 77.1772
[2021-03-01 15:39:37,267] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:39:37,289] default_module.py->log_info line:141 [INFO]lr=9.9901e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:40:22,724] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 0/87 train_loss 0.4696  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:43:23,054] default_module.py->log_info line:141 [INFO]Valid Epoch 2/100 step 100/37 valid_loss 0.8224  valid_acc_1 40.4762
[2021-03-01 15:43:32,619] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7727    1.0000    0.0132    0.8718    0.1147    0.0145       255
          2     1.0000    0.0132    1.0000    0.0260    0.1147    0.0119        76

avg / total     0.8249    0.7734    0.2397    0.6776    0.1147    0.0139       331

Covid class AUC=0.567079463364293
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747774381895 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747774381895 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00002: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00002: valid_acc_1  was not in top 1
[2021-03-01 15:43:32,670] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5219  train_acc_1 77.2925
[2021-03-01 15:43:32,670] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5615  valid_acc_1 77.4775
[2021-03-01 15:43:32,670] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:43:32,676] default_module.py->log_info line:141 [INFO]lr=9.9778e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:43:51,855] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 0/87 train_loss 0.4498  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:47:05,059] default_module.py->log_info line:141 [INFO]Valid Epoch 3/100 step 100/37 valid_loss 1.3383  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:47:14,903] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.4461816305469556
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00003: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00003: valid_acc_1  was not in top 1
[2021-03-01 15:47:15,016] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5201  train_acc_1 75.8876
[2021-03-01 15:47:15,016] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5867  valid_acc_1 77.1772
[2021-03-01 15:47:15,016] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:47:15,023] default_module.py->log_info line:141 [INFO]lr=9.9606e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:47:55,647] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 0/87 train_loss 0.9006  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:51:05,923] default_module.py->log_info line:141 [INFO]Valid Epoch 4/100 step 100/37 valid_loss 1.0688  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:51:15,521] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5434468524251806
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00004: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00004: valid_acc_1  was not in top 1
[2021-03-01 15:51:15,579] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5346  train_acc_1 75.7854
[2021-03-01 15:51:15,580] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5333  valid_acc_1 77.1772
[2021-03-01 15:51:15,580] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:51:15,588] default_module.py->log_info line:141 [INFO]lr=9.9384e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:51:35,951] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 0/87 train_loss 0.3930  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:54:38,550] default_module.py->log_info line:141 [INFO]Valid Epoch 5/100 step 100/37 valid_loss 0.7526  valid_acc_1 53.1746
[2021-03-01 15:54:48,316] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8115    0.3882    0.6974    0.5252    0.5203    0.2624       255
          2     0.2536    0.6974    0.3882    0.3719    0.5203    0.2791        76

avg / total     0.6834    0.4592    0.6264    0.4900    0.5203    0.2662       331

Covid class AUC=0.6124355005159958
ACC=0.459214501510574
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 46.07464617651862 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 46.07464617651862 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00005: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00005: valid_acc_1  was not in top 1
[2021-03-01 15:54:48,374] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5166  train_acc_1 76.2708
[2021-03-01 15:54:48,374] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.9193  valid_acc_1 46.0746
[2021-03-01 15:54:48,374] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:54:48,384] default_module.py->log_info line:141 [INFO]lr=9.9114e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:55:17,611] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 0/87 train_loss 0.9188  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:58:44,091] default_module.py->log_info line:141 [INFO]Valid Epoch 6/100 step 100/37 valid_loss 1.0123  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:58:54,109] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6039731682146543
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00006: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00006: valid_acc_1  was not in top 1
[2021-03-01 15:58:54,290] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5341  train_acc_1 76.3985
[2021-03-01 15:58:54,290] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5279  valid_acc_1 77.1772
[2021-03-01 15:58:54,291] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:58:54,298] default_module.py->log_info line:141 [INFO]lr=9.8796e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:59:27,584] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 0/87 train_loss 0.5770  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:02:32,298] default_module.py->log_info line:141 [INFO]Valid Epoch 7/100 step 100/37 valid_loss 1.0907  valid_acc_1 42.8571
[2021-03-01 16:02:42,235] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7785    0.9922    0.0526    0.8724    0.2285    0.0571       255
          2     0.6667    0.0526    0.9922    0.0976    0.2285    0.0473        76

avg / total     0.7528    0.7764    0.2684    0.6945    0.2285    0.0549       331

Covid class AUC=0.6147574819401445
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.7777783161885 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.7777783161885 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00007: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00007: valid_acc_1  was not in top 1
[2021-03-01 16:02:42,303] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5225  train_acc_1 77.0370
[2021-03-01 16:02:42,303] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5254  valid_acc_1 77.7778
[2021-03-01 16:02:42,304] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:02:42,311] default_module.py->log_info line:141 [INFO]lr=9.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:03:10,962] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 0/87 train_loss 0.6280  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:06:20,708] default_module.py->log_info line:141 [INFO]Valid Epoch 8/100 step 100/37 valid_loss 1.1472  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:06:31,180] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5999484004127967
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00008: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00008: valid_acc_1  was not in top 1
[2021-03-01 16:06:31,438] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5246  train_acc_1 76.1175
[2021-03-01 16:06:31,446] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5341  valid_acc_1 77.1772
[2021-03-01 16:06:31,446] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:06:31,453] default_module.py->log_info line:141 [INFO]lr=9.8015e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:07:17,487] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 0/87 train_loss 0.3780  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:10:25,733] default_module.py->log_info line:141 [INFO]Valid Epoch 9/100 step 100/37 valid_loss 1.0891  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:10:35,963] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.568266253869969
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00009: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00009: valid_acc_1  was not in top 1
[2021-03-01 16:10:36,207] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5262  train_acc_1 76.4496
[2021-03-01 16:10:36,208] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5351  valid_acc_1 77.1772
[2021-03-01 16:10:36,208] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:10:36,217] default_module.py->log_info line:141 [INFO]lr=9.7553e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:11:02,647] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 0/87 train_loss 0.4038  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:14:10,604] default_module.py->log_info line:141 [INFO]Valid Epoch 10/100 step 100/37 valid_loss 1.0744  valid_acc_1 42.0635
[2021-03-01 16:14:20,588] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7768    0.9961    0.0395    0.8729    0.1983    0.0431       255
          2     0.7500    0.0395    0.9961    0.0750    0.1983    0.0356        76

avg / total     0.7706    0.7764    0.2591    0.6897    0.1983    0.0414       331

Covid class AUC=0.632765737874097
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.7777781873136 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.7777781873136 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00010: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00010: valid_acc_1  was not in top 1
[2021-03-01 16:14:20,654] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5271  train_acc_1 76.5773
[2021-03-01 16:14:20,654] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5164  valid_acc_1 77.7778
[2021-03-01 16:14:20,654] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:14:20,664] default_module.py->log_info line:141 [INFO]lr=9.7044e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:14:56,356] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 0/87 train_loss 0.5587  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:18:21,744] default_module.py->log_info line:141 [INFO]Valid Epoch 11/100 step 100/37 valid_loss 1.6978  valid_acc_1 60.3175
[2021-03-01 16:18:31,415] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.9048    0.1490    0.9474    0.2559    0.3757    0.1299       255
          2     0.2491    0.9474    0.1490    0.3945    0.3757    0.1524        76

avg / total     0.7542    0.3323    0.7641    0.2877    0.3757    0.1351       331

Covid class AUC=0.6069143446852424
ACC=0.3323262839879154
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 33.204634047843314 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 33.204634047843314 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00011: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00011: valid_acc_1  was not in top 1
[2021-03-01 16:18:31,474] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5366  train_acc_1 76.6539
[2021-03-01 16:18:31,474] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 2.6963  valid_acc_1 33.2046
[2021-03-01 16:18:31,475] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:18:31,482] default_module.py->log_info line:141 [INFO]lr=9.6489e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:18:53,184] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 0/87 train_loss 0.9113  train_acc_1 33.3333
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:21:52,884] default_module.py->log_info line:141 [INFO]Valid Epoch 12/100 step 100/37 valid_loss 1.0982  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:22:02,685] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5999484004127967
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00012: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00012: valid_acc_1  was not in top 1
[2021-03-01 16:22:02,763] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5276  train_acc_1 75.9898
[2021-03-01 16:22:02,763] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5312  valid_acc_1 77.1772
[2021-03-01 16:22:02,763] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:22:02,770] default_module.py->log_info line:141 [INFO]lr=9.5888e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:22:24,464] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 0/87 train_loss 0.2626  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:25:47,859] default_module.py->log_info line:141 [INFO]Valid Epoch 13/100 step 100/37 valid_loss 0.9727  valid_acc_1 41.2698
[2021-03-01 16:25:58,129] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7751    1.0000    0.0263    0.8733    0.1622    0.0289       255
          2     1.0000    0.0263    1.0000    0.0513    0.1622    0.0238        76

avg / total     0.8267    0.7764    0.2499    0.6845    0.1622    0.0277       331

Covid class AUC=0.6057275541795666
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777805843868 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777805843868 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00013: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00013: valid_acc_1  was not in top 1
[2021-03-01 16:25:58,234] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5236  train_acc_1 76.1430
[2021-03-01 16:25:58,234] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5204  valid_acc_1 77.7778
[2021-03-01 16:25:58,234] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:25:58,241] default_module.py->log_info line:141 [INFO]lr=9.5241e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:26:22,455] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 0/87 train_loss 0.8210  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:29:25,633] default_module.py->log_info line:141 [INFO]Valid Epoch 14/100 step 100/37 valid_loss 1.2965  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:29:35,227] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5929308565531476
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00014: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00014: valid_acc_1  was not in top 1
[2021-03-01 16:29:35,287] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5309  train_acc_1 76.2963
[2021-03-01 16:29:35,287] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5681  valid_acc_1 77.1772
[2021-03-01 16:29:35,287] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:29:35,297] default_module.py->log_info line:141 [INFO]lr=9.4550e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:29:58,020] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 0/87 train_loss 0.2099  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:33:06,162] default_module.py->log_info line:141 [INFO]Valid Epoch 15/100 step 100/37 valid_loss 0.8176  valid_acc_1 45.2381
[2021-03-01 16:33:16,246] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7878    0.9608    0.1316    0.8657    0.3556    0.1369       255
          2     0.5000    0.1316    0.9608    0.2083    0.3556    0.1159        76

avg / total     0.7217    0.7704    0.3220    0.7148    0.3556    0.1321       331

Covid class AUC=0.6115067079463363
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.1771783055486 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.1771783055486 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00015: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00015: valid_acc_1  was not in top 1
[2021-03-01 16:33:16,438] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5228  train_acc_1 77.0370
[2021-03-01 16:33:16,439] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5345  valid_acc_1 77.1772
[2021-03-01 16:33:16,439] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:33:16,446] default_module.py->log_info line:141 [INFO]lr=9.3815e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:33:55,472] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 0/87 train_loss 0.5548  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:37:16,319] default_module.py->log_info line:141 [INFO]Valid Epoch 16/100 step 100/37 valid_loss 1.1132  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:37:26,071] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6185758513931888
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00016: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00016: valid_acc_1  was not in top 1
[2021-03-01 16:37:26,155] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5294  train_acc_1 76.9093
[2021-03-01 16:37:26,155] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5314  valid_acc_1 77.1772
[2021-03-01 16:37:26,155] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:37:26,164] default_module.py->log_info line:141 [INFO]lr=9.3037e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:37:47,482] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 0/87 train_loss 0.3787  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:40:54,104] default_module.py->log_info line:141 [INFO]Valid Epoch 17/100 step 100/37 valid_loss 1.0514  valid_acc_1 44.4444
[2021-03-01 16:41:03,852] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7841    0.9686    0.1053    0.8667    0.3193    0.1108       255
          2     0.5000    0.1053    0.9686    0.1739    0.3193    0.0932        76

avg / total     0.7189    0.7704    0.3035    0.7076    0.3193    0.1067       331

Covid class AUC=0.6005675954592363
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717804779878 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717804779878 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00017: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00017: valid_acc_1  was not in top 1
[2021-03-01 16:41:03,913] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5195  train_acc_1 77.6756
[2021-03-01 16:41:03,914] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5294  valid_acc_1 77.1772
[2021-03-01 16:41:03,914] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:41:03,922] default_module.py->log_info line:141 [INFO]lr=9.2216e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:41:44,032] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 0/87 train_loss 0.6480  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:44:55,879] default_module.py->log_info line:141 [INFO]Valid Epoch 18/100 step 100/37 valid_loss 1.0056  valid_acc_1 41.2698
[2021-03-01 16:45:05,499] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7744    0.9961    0.0263    0.8714    0.1619    0.0288       255
          2     0.6667    0.0263    0.9961    0.0506    0.1619    0.0237        76

avg / total     0.7497    0.7734    0.2490    0.6829    0.1619    0.0276       331

Covid class AUC=0.6020123839009289
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747787269387 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747787269387 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00018: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00018: valid_acc_1  was not in top 1
[2021-03-01 16:45:05,566] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5226  train_acc_1 76.7561
[2021-03-01 16:45:05,566] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5225  valid_acc_1 77.4775
[2021-03-01 16:45:05,566] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:45:05,573] default_module.py->log_info line:141 [INFO]lr=9.1354e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:45:26,915] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 0/87 train_loss 0.5216  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:48:47,771] default_module.py->log_info line:141 [INFO]Valid Epoch 19/100 step 100/37 valid_loss 1.1099  valid_acc_1 44.4444
[2021-03-01 16:48:57,838] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7823    0.9725    0.0921    0.8671    0.2993    0.0975       255
          2     0.5000    0.0921    0.9725    0.1556    0.2993    0.0817        76

avg / total     0.7175    0.7704    0.2943    0.7037    0.2993    0.0938       331

Covid class AUC=0.6083075335397317
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717812512372 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717812512372 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00019: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00019: valid_acc_1  was not in top 1
[2021-03-01 16:48:58,023] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5201  train_acc_1 77.0881
[2021-03-01 16:48:58,024] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5351  valid_acc_1 77.1772
[2021-03-01 16:48:58,024] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:48:58,031] default_module.py->log_info line:141 [INFO]lr=9.0451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:49:55,508] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 0/87 train_loss 0.3480  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:53:06,118] default_module.py->log_info line:141 [INFO]Valid Epoch 20/100 step 100/37 valid_loss 1.5023  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:53:15,779] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.602889576883385
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00020: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00020: valid_acc_1  was not in top 1
Epoch 00021: early stopping
INFO:lightning:Epoch 00021: early stopping
[2021-03-01 16:53:15,852] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5113  train_acc_1 77.8033
[2021-03-01 16:53:15,853] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6201  valid_acc_1 77.1772
[2021-03-01 16:53:15,853] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:53:15,859] default_module.py->log_info line:141 [INFO]lr=8.9508e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:53:38,409] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 0/87 train_loss 0.2660  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:56:41,754] default_module.py->log_info line:141 [INFO]Valid Epoch 21/100 step 100/37 valid_loss 1.0123  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:56:51,672] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.615686274509804
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00021: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00021: valid_acc_1  was not in top 1
Epoch 00022: early stopping
INFO:lightning:Epoch 00022: early stopping
[2021-03-01 16:56:51,737] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5221  train_acc_1 77.2925
[2021-03-01 16:56:51,737] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5226  valid_acc_1 77.1772
[2021-03-01 16:56:51,738] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:56:51,744] default_module.py->log_info line:141 [INFO]lr=8.8526e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:57:23,117] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 0/87 train_loss 0.4561  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:00:37,113] default_module.py->log_info line:141 [INFO]Valid Epoch 22/100 step 100/37 valid_loss 1.0815  valid_acc_1 41.2698
[2021-03-01 17:00:46,644] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7751    1.0000    0.0263    0.8733    0.1622    0.0289       255
          2     1.0000    0.0263    1.0000    0.0513    0.1622    0.0238        76

avg / total     0.8267    0.7764    0.2499    0.6845    0.1622    0.0277       331

Covid class AUC=0.6019607843137256
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777805843868 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777805843868 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00022: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00022: valid_acc_1  was not in top 1
Epoch 00023: early stopping
INFO:lightning:Epoch 00023: early stopping
[2021-03-01 17:00:46,713] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5213  train_acc_1 77.3436
[2021-03-01 17:00:46,713] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5282  valid_acc_1 77.7778
[2021-03-01 17:00:46,714] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:00:46,721] default_module.py->log_info line:141 [INFO]lr=8.7506e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:01:12,396] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 0/87 train_loss 0.4398  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:04:15,768] default_module.py->log_info line:141 [INFO]Valid Epoch 23/100 step 100/37 valid_loss 1.0751  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:04:25,446] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.4386996904024768
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00023: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00023: valid_acc_1  was not in top 1
Epoch 00024: early stopping
INFO:lightning:Epoch 00024: early stopping
[2021-03-01 17:04:25,509] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5157  train_acc_1 76.4240
[2021-03-01 17:04:25,509] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5453  valid_acc_1 77.1772
[2021-03-01 17:04:25,509] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:04:25,517] default_module.py->log_info line:141 [INFO]lr=8.6448e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:04:53,840] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 0/87 train_loss 0.4654  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:08:10,526] default_module.py->log_info line:141 [INFO]Valid Epoch 24/100 step 100/37 valid_loss 1.0360  valid_acc_1 40.4762
[2021-03-01 17:08:20,937] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7730    0.9882    0.0263    0.8675    0.1613    0.0285       255
          2     0.4000    0.0263    0.9882    0.0494    0.1613    0.0235        76

avg / total     0.6874    0.7674    0.2472    0.6796    0.1613    0.0274       331

Covid class AUC=0.593343653250774
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.8768775012042 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.8768775012042 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00024: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00024: valid_acc_1  was not in top 1
Epoch 00025: early stopping
INFO:lightning:Epoch 00025: early stopping
[2021-03-01 17:08:21,311] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5176  train_acc_1 76.7816
[2021-03-01 17:08:21,312] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5287  valid_acc_1 76.8769
[2021-03-01 17:08:21,312] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:08:21,330] default_module.py->log_info line:141 [INFO]lr=8.5355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:08:51,170] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 0/87 train_loss 0.5221  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:11:50,488] default_module.py->log_info line:141 [INFO]Valid Epoch 25/100 step 100/37 valid_loss 0.8755  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:12:00,077] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5891124871001031
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00025: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00025: valid_acc_1  was not in top 1
Epoch 00026: early stopping
INFO:lightning:Epoch 00026: early stopping
[2021-03-01 17:12:00,139] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5125  train_acc_1 77.2925
[2021-03-01 17:12:00,139] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5379  valid_acc_1 77.1772
[2021-03-01 17:12:00,139] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:12:00,145] default_module.py->log_info line:141 [INFO]lr=8.4227e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:12:19,061] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 0/87 train_loss 0.5207  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:15:38,383] default_module.py->log_info line:141 [INFO]Valid Epoch 26/100 step 100/37 valid_loss 0.9625  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:15:48,437] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5814757481940145
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00026: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00026: valid_acc_1  was not in top 1
Epoch 00027: early stopping
INFO:lightning:Epoch 00027: early stopping
[2021-03-01 17:15:48,577] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5162  train_acc_1 77.3180
[2021-03-01 17:15:48,577] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5316  valid_acc_1 77.1772
[2021-03-01 17:15:48,577] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:15:48,587] default_module.py->log_info line:141 [INFO]lr=8.3066e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:16:33,446] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 0/87 train_loss 0.3154  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:19:36,091] default_module.py->log_info line:141 [INFO]Valid Epoch 27/100 step 100/37 valid_loss 0.8687  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:19:45,715] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.4023219814241486
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00027: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00027: valid_acc_1  was not in top 1
Epoch 00028: early stopping
INFO:lightning:Epoch 00028: early stopping
[2021-03-01 17:19:45,833] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5225  train_acc_1 77.0370
[2021-03-01 17:19:45,833] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5814  valid_acc_1 77.1772
[2021-03-01 17:19:45,834] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:19:45,842] default_module.py->log_info line:141 [INFO]lr=8.1871e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:20:06,379] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 0/87 train_loss 0.8815  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:23:14,440] default_module.py->log_info line:141 [INFO]Valid Epoch 28/100 step 100/37 valid_loss 1.1636  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:23:24,424] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.602889576883385
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00028: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00028: valid_acc_1  was not in top 1
Epoch 00029: early stopping
INFO:lightning:Epoch 00029: early stopping
[2021-03-01 17:23:24,516] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5343  train_acc_1 77.1903
[2021-03-01 17:23:24,517] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5409  valid_acc_1 77.1772
[2021-03-01 17:23:24,517] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:23:24,525] default_module.py->log_info line:141 [INFO]lr=8.0645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:24:01,603] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 0/87 train_loss 0.2335  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:27:25,314] default_module.py->log_info line:141 [INFO]Valid Epoch 29/100 step 100/37 valid_loss 1.0572  valid_acc_1 42.0635
[2021-03-01 17:27:35,648] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7774    1.0000    0.0395    0.8748    0.1987    0.0433       255
          2     1.0000    0.0395    1.0000    0.0759    0.1987    0.0357        76

avg / total     0.8285    0.7795    0.2600    0.6914    0.1987    0.0415       331

Covid class AUC=0.5862229102167184
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.07807837305842 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.07807837305842 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00029: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00029: valid_acc_1  was not in top 1
Epoch 00030: early stopping
INFO:lightning:Epoch 00030: early stopping
[2021-03-01 17:27:36,350] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5164  train_acc_1 77.3436
[2021-03-01 17:27:36,351] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5271  valid_acc_1 78.0781
[2021-03-01 17:27:36,351] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:27:36,359] default_module.py->log_info line:141 [INFO]lr=7.9389e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:28:36,645] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 0/87 train_loss 0.4416  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:31:42,270] default_module.py->log_info line:141 [INFO]Valid Epoch 30/100 step 100/37 valid_loss 0.7391  valid_acc_1 52.3810
[2021-03-01 17:31:51,897] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8142    0.5843    0.5526    0.6804    0.5683    0.3239       255
          2     0.2838    0.5526    0.5843    0.3750    0.5683    0.3219        76

avg / total     0.6924    0.5770    0.5599    0.6103    0.5683    0.3235       331

Covid class AUC=0.562125902992776
ACC=0.5770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 57.87215807631209 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 57.87215807631209 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00030: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00030: valid_acc_1  was not in top 1
Epoch 00031: early stopping
INFO:lightning:Epoch 00031: early stopping
[2021-03-01 17:31:51,961] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5211  train_acc_1 75.9132
[2021-03-01 17:31:51,961] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6558  valid_acc_1 57.8722
[2021-03-01 17:31:51,961] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:31:51,968] default_module.py->log_info line:141 [INFO]lr=7.8104e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:32:13,032] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 0/87 train_loss 0.2485  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:35:19,519] default_module.py->log_info line:141 [INFO]Valid Epoch 31/100 step 100/37 valid_loss 0.9991  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:35:29,352] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5859649122807017
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00031: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00031: valid_acc_1  was not in top 1
Epoch 00032: early stopping
INFO:lightning:Epoch 00032: early stopping
[2021-03-01 17:35:29,418] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5232  train_acc_1 77.3180
[2021-03-01 17:35:29,419] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5282  valid_acc_1 77.1772
[2021-03-01 17:35:29,419] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:35:29,427] default_module.py->log_info line:141 [INFO]lr=7.6791e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:36:11,371] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 0/87 train_loss 0.5069  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:39:14,423] default_module.py->log_info line:141 [INFO]Valid Epoch 32/100 step 100/37 valid_loss 1.1216  valid_acc_1 42.8571
[2021-03-01 17:39:24,291] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7795    0.9843    0.0658    0.8700    0.2545    0.0707       255
          2     0.5556    0.0658    0.9843    0.1176    0.2545    0.0588        76

avg / total     0.7281    0.7734    0.2767    0.6973    0.2545    0.0680       331

Covid class AUC=0.5995356037151702
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747818199363 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747818199363 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00032: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00032: valid_acc_1  was not in top 1
Epoch 00033: early stopping
INFO:lightning:Epoch 00033: early stopping
[2021-03-01 17:39:24,473] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5072  train_acc_1 77.9055
[2021-03-01 17:39:24,474] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5404  valid_acc_1 77.4775
[2021-03-01 17:39:24,474] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:39:24,481] default_module.py->log_info line:141 [INFO]lr=7.5452e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:39:57,228] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 0/87 train_loss 0.5900  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:45:12,921] default_module.py->log_info line:141 [INFO]Valid Epoch 33/100 step 100/37 valid_loss 1.1240  valid_acc_1 41.2698
[2021-03-01 17:45:22,676] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7744    0.9961    0.0263    0.8714    0.1619    0.0288       255
          2     0.6667    0.0263    0.9961    0.0506    0.1619    0.0237        76

avg / total     0.7497    0.7734    0.2490    0.6829    0.1619    0.0276       331

Covid class AUC=0.5932404540763674
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747787269387 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747787269387 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00033: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00033: valid_acc_1  was not in top 1
Epoch 00034: early stopping
INFO:lightning:Epoch 00034: early stopping
[2021-03-01 17:45:24,554] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5110  train_acc_1 77.2925
[2021-03-01 17:45:24,554] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5361  valid_acc_1 77.4775
[2021-03-01 17:45:24,554] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:45:24,564] default_module.py->log_info line:141 [INFO]lr=7.4088e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:47:20,956] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 0/87 train_loss 0.6334  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:51:48,679] default_module.py->log_info line:141 [INFO]Valid Epoch 34/100 step 100/37 valid_loss 0.9285  valid_acc_1 45.2381
[2021-03-01 17:51:58,855] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7896    0.9569    0.1447    0.8652    0.3721    0.1497       255
          2     0.5000    0.1447    0.9569    0.2245    0.3721    0.1272        76

avg / total     0.7231    0.7704    0.3312    0.7181    0.3721    0.1446       331

Covid class AUC=0.5985036119711041
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717822822365 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717822822365 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00034: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00034: valid_acc_1  was not in top 1
Epoch 00035: early stopping
INFO:lightning:Epoch 00035: early stopping
[2021-03-01 17:52:00,045] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5163  train_acc_1 76.4240
[2021-03-01 17:52:00,045] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5300  valid_acc_1 77.1772
[2021-03-01 17:52:00,045] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:52:00,054] default_module.py->log_info line:141 [INFO]lr=7.2700e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:53:03,058] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 0/87 train_loss 0.4530  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:56:51,861] default_module.py->log_info line:141 [INFO]Valid Epoch 35/100 step 100/37 valid_loss 1.3260  valid_acc_1 41.2698
[2021-03-01 17:57:01,800] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7751    1.0000    0.0263    0.8733    0.1622    0.0289       255
          2     1.0000    0.0263    1.0000    0.0513    0.1622    0.0238        76

avg / total     0.8267    0.7764    0.2499    0.6845    0.1622    0.0277       331

Covid class AUC=0.5846233230134158
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777805843868 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777805843868 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00035: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00035: valid_acc_1  was not in top 1
Epoch 00036: early stopping
INFO:lightning:Epoch 00036: early stopping
[2021-03-01 17:57:01,922] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5051  train_acc_1 77.0115
[2021-03-01 17:57:01,922] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5760  valid_acc_1 77.7778
[2021-03-01 17:57:01,922] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:57:01,933] default_module.py->log_info line:141 [INFO]lr=7.1289e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:57:45,129] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 0/87 train_loss 0.2586  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:01:04,747] default_module.py->log_info line:141 [INFO]Valid Epoch 36/100 step 100/37 valid_loss 1.1819  valid_acc_1 44.4444
[2021-03-01 18:01:14,409] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7841    0.9686    0.1053    0.8667    0.3193    0.1108       255
          2     0.5000    0.1053    0.9686    0.1739    0.3193    0.0932        76

avg / total     0.7189    0.7704    0.3035    0.7076    0.3193    0.1067       331

Covid class AUC=0.5965428276573788
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717797047383 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717797047383 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00036: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00036: valid_acc_1  was not in top 1
Epoch 00037: early stopping
INFO:lightning:Epoch 00037: early stopping
[2021-03-01 18:01:14,496] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5127  train_acc_1 77.0115
[2021-03-01 18:01:14,496] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5569  valid_acc_1 77.1772
[2021-03-01 18:01:14,496] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:01:14,503] default_module.py->log_info line:141 [INFO]lr=6.9857e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:01:35,547] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 0/87 train_loss 0.4768  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:04:39,043] default_module.py->log_info line:141 [INFO]Valid Epoch 37/100 step 100/37 valid_loss 1.0382  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 18:04:49,099] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5851393188854488
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00037: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00037: valid_acc_1  was not in top 1
Epoch 00038: early stopping
INFO:lightning:Epoch 00038: early stopping
[2021-03-01 18:04:49,176] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5127  train_acc_1 76.7816
[2021-03-01 18:04:49,176] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5299  valid_acc_1 77.1772
[2021-03-01 18:04:49,176] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:04:49,183] default_module.py->log_info line:141 [INFO]lr=6.8406e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:05:20,692] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 0/87 train_loss 0.3447  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:08:36,585] default_module.py->log_info line:141 [INFO]Valid Epoch 38/100 step 100/37 valid_loss 1.6329  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 18:08:46,160] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5886480908152734
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00038: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00038: valid_acc_1  was not in top 1
Epoch 00039: early stopping
INFO:lightning:Epoch 00039: early stopping
[2021-03-01 18:08:46,227] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5100  train_acc_1 77.2669
[2021-03-01 18:08:46,227] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6591  valid_acc_1 77.1772
[2021-03-01 18:08:46,227] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:08:46,234] default_module.py->log_info line:141 [INFO]lr=6.6937e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:09:07,984] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 0/87 train_loss 0.2659  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:12:11,545] default_module.py->log_info line:141 [INFO]Valid Epoch 39/100 step 100/37 valid_loss 1.2572  valid_acc_1 42.0635
[2021-03-01 18:12:21,122] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7785    0.9922    0.0526    0.8724    0.2285    0.0571       255
          2     0.6667    0.0526    0.9922    0.0976    0.2285    0.0473        76

avg / total     0.7528    0.7764    0.2684    0.6945    0.2285    0.0549       331

Covid class AUC=0.5916924664602683
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.7777783161885 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.7777783161885 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00039: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00039: valid_acc_1  was not in top 1
Epoch 00040: early stopping
INFO:lightning:Epoch 00040: early stopping
[2021-03-01 18:12:21,190] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5101  train_acc_1 77.4457
[2021-03-01 18:12:21,190] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5644  valid_acc_1 77.7778
[2021-03-01 18:12:21,190] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:12:21,196] default_module.py->log_info line:141 [INFO]lr=6.5451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:12:45,558] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 0/87 train_loss 0.8505  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:15:51,901] default_module.py->log_info line:141 [INFO]Valid Epoch 40/100 step 100/37 valid_loss 1.0814  valid_acc_1 40.4762
[2021-03-01 18:16:02,195] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7727    1.0000    0.0132    0.8718    0.1147    0.0145       255
          2     1.0000    0.0132    1.0000    0.0260    0.1147    0.0119        76

avg / total     0.8249    0.7734    0.2397    0.6776    0.1147    0.0139       331

Covid class AUC=0.5921568627450979
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747774381895 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747774381895 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00040: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00040: valid_acc_1  was not in top 1
Epoch 00041: early stopping
INFO:lightning:Epoch 00041: early stopping
[2021-03-01 18:16:02,536] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5148  train_acc_1 76.9349
[2021-03-01 18:16:02,536] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5328  valid_acc_1 77.4775
[2021-03-01 18:16:02,536] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:16:02,566] default_module.py->log_info line:141 [INFO]lr=6.3950e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:16:43,548] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 0/87 train_loss 0.5441  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:19:43,867] default_module.py->log_info line:141 [INFO]Valid Epoch 41/100 step 100/37 valid_loss 1.2217  valid_acc_1 40.4762
[2021-03-01 18:19:53,453] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7727    1.0000    0.0132    0.8718    0.1147    0.0145       255
          2     1.0000    0.0132    1.0000    0.0260    0.1147    0.0119        76

avg / total     0.8249    0.7734    0.2397    0.6776    0.1147    0.0139       331

Covid class AUC=0.5955624355005159
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747774381895 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747774381895 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00041: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00041: valid_acc_1  was not in top 1
Epoch 00042: early stopping
INFO:lightning:Epoch 00042: early stopping
[2021-03-01 18:19:53,534] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5138  train_acc_1 76.7816
[2021-03-01 18:19:53,535] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5518  valid_acc_1 77.4775
[2021-03-01 18:19:53,535] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:19:53,543] default_module.py->log_info line:141 [INFO]lr=6.2434e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:20:13,061] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 0/87 train_loss 0.3667  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:23:34,252] default_module.py->log_info line:141 [INFO]Valid Epoch 42/100 step 100/37 valid_loss 0.8234  valid_acc_1 43.6508
[2021-03-01 18:23:44,268] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7797    0.8745    0.1711    0.8244    0.3868    0.1601       255
          2     0.2889    0.1711    0.8745    0.2149    0.3868    0.1391        76

avg / total     0.6670    0.7130    0.3326    0.6844    0.3868    0.1553       331

Covid class AUC=0.5471104231166152
ACC=0.7129909365558912
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 71.38567300744958 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 71.38567300744958 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00042: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00042: valid_acc_1  was not in top 1
Epoch 00043: early stopping
INFO:lightning:Epoch 00043: early stopping
[2021-03-01 18:23:44,515] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5094  train_acc_1 77.6501
[2021-03-01 18:23:44,515] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5716  valid_acc_1 71.3857
[2021-03-01 18:23:44,515] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:23:44,524] default_module.py->log_info line:141 [INFO]lr=6.0907e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:24:29,856] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 0/87 train_loss 0.4532  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:27:34,215] default_module.py->log_info line:141 [INFO]Valid Epoch 43/100 step 100/37 valid_loss 0.9956  valid_acc_1 42.8571
[2021-03-01 18:27:43,825] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7799    0.9725    0.0789    0.8656    0.2771    0.0836       255
          2     0.4615    0.0789    0.9725    0.1348    0.2771    0.0699        76

avg / total     0.7068    0.7674    0.2841    0.6978    0.2771    0.0805       331

Covid class AUC=0.5854489164086689
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.79107743340569 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.79107743340569 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00043: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00043: valid_acc_1  was not in top 1
Epoch 00044: early stopping
INFO:lightning:Epoch 00044: early stopping
[2021-03-01 18:27:43,902] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5092  train_acc_1 77.0370
[2021-03-01 18:27:43,903] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5319  valid_acc_1 76.7911
[2021-03-01 18:27:43,903] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:27:43,911] default_module.py->log_info line:141 [INFO]lr=5.9369e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:28:04,997] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 0/87 train_loss 0.3959  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:31:11,884] default_module.py->log_info line:141 [INFO]Valid Epoch 44/100 step 100/37 valid_loss 1.4212  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 18:31:21,606] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5218266253869969
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00044: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00044: valid_acc_1  was not in top 1
Epoch 00045: early stopping
INFO:lightning:Epoch 00045: early stopping
[2021-03-01 18:31:21,757] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5071  train_acc_1 76.4496
[2021-03-01 18:31:21,757] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6034  valid_acc_1 77.1772
[2021-03-01 18:31:21,757] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:31:21,764] default_module.py->log_info line:141 [INFO]lr=5.7822e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:32:01,377] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 0/87 train_loss 0.4970  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:35:16,111] default_module.py->log_info line:141 [INFO]Valid Epoch 45/100 step 100/37 valid_loss 0.8572  valid_acc_1 46.0317
[2021-03-01 18:35:25,866] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7911    0.9059    0.1974    0.8446    0.4228    0.1915       255
          2     0.3846    0.1974    0.9059    0.2609    0.4228    0.1661        76

avg / total     0.6978    0.7432    0.3600    0.7106    0.4228    0.1856       331

Covid class AUC=0.5952528379772962
ACC=0.743202416918429
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 74.38867594744708 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 74.38867594744708 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00045: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00045: valid_acc_1  was not in top 1
Epoch 00046: early stopping
INFO:lightning:Epoch 00046: early stopping
[2021-03-01 18:35:26,031] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5315  train_acc_1 76.8838
[2021-03-01 18:35:26,031] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5522  valid_acc_1 74.3887
[2021-03-01 18:35:26,031] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:35:26,040] default_module.py->log_info line:141 [INFO]lr=5.6267e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:35:58,974] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 0/87 train_loss 0.2640  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:39:01,654] default_module.py->log_info line:141 [INFO]Valid Epoch 46/100 step 100/37 valid_loss 1.1631  valid_acc_1 41.2698
[2021-03-01 18:39:11,528] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7751    1.0000    0.0263    0.8733    0.1622    0.0289       255
          2     1.0000    0.0263    1.0000    0.0513    0.1622    0.0238        76

avg / total     0.8267    0.7764    0.2499    0.6845    0.1622    0.0277       331

Covid class AUC=0.5916408668730649
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777805843868 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777805843868 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00046: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00046: valid_acc_1  was not in top 1
Epoch 00047: early stopping
INFO:lightning:Epoch 00047: early stopping
[2021-03-01 18:39:11,612] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5124  train_acc_1 77.1903
[2021-03-01 18:39:11,612] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5428  valid_acc_1 77.7778
[2021-03-01 18:39:11,612] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:39:11,619] default_module.py->log_info line:141 [INFO]lr=5.4705e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:39:39,532] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 0/87 train_loss 0.3971  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:43:06,789] default_module.py->log_info line:141 [INFO]Valid Epoch 47/100 step 100/37 valid_loss 1.1568  valid_acc_1 42.0635
[2021-03-01 18:43:16,500] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7774    1.0000    0.0395    0.8748    0.1987    0.0433       255
          2     1.0000    0.0395    1.0000    0.0759    0.1987    0.0357        76

avg / total     0.8285    0.7795    0.2600    0.6914    0.1987    0.0415       331

Covid class AUC=0.6090815273477812
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.07807837305842 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.07807837305842 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00047: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00047: valid_acc_1  was not in top 1
Epoch 00048: early stopping
INFO:lightning:Epoch 00048: early stopping
[2021-03-01 18:43:16,580] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5120  train_acc_1 76.8327
[2021-03-01 18:43:16,581] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5393  valid_acc_1 78.0781
[2021-03-01 18:43:16,581] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:43:16,588] default_module.py->log_info line:141 [INFO]lr=5.3140e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:43:37,839] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 0/87 train_loss 0.3849  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:46:38,116] default_module.py->log_info line:141 [INFO]Valid Epoch 48/100 step 100/37 valid_loss 0.9707  valid_acc_1 44.4444
[2021-03-01 18:46:48,226] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7837    0.9804    0.0921    0.8711    0.3005    0.0983       255
          2     0.5833    0.0921    0.9804    0.1591    0.3005    0.0823        76

avg / total     0.7377    0.7764    0.2961    0.7076    0.3005    0.0946       331

Covid class AUC=0.5997936016511868
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.69197824838999 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.69197824838999 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00048: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00048: valid_acc_1  was not in top 1
Epoch 00049: early stopping
INFO:lightning:Epoch 00049: early stopping
[2021-03-01 18:46:48,538] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5144  train_acc_1 76.5006
[2021-03-01 18:46:48,539] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5257  valid_acc_1 77.6920
[2021-03-01 18:46:48,539] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:46:48,546] default_module.py->log_info line:141 [INFO]lr=5.1571e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:47:25,608] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 0/87 train_loss 0.6657  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:50:54,225] default_module.py->log_info line:141 [INFO]Valid Epoch 49/100 step 100/37 valid_loss 1.0018  valid_acc_1 41.2698
[2021-03-01 18:51:03,935] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7757    0.9765    0.0526    0.8646    0.2267    0.0561       255
          2     0.4000    0.0526    0.9765    0.0930    0.2267    0.0466        76

avg / total     0.6894    0.7644    0.2648    0.6874    0.2267    0.0540       331

Covid class AUC=0.5843653250773994
ACC=0.7643504531722054
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.49077698991105 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.49077698991105 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00049: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00049: valid_acc_1  was not in top 1
Epoch 00050: early stopping
INFO:lightning:Epoch 00050: early stopping
[2021-03-01 18:51:04,022] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5023  train_acc_1 77.1392
[2021-03-01 18:51:04,023] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5317  valid_acc_1 76.4908
[2021-03-01 18:51:04,023] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:51:04,029] default_module.py->log_info line:141 [INFO]lr=5.0000e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:51:24,787] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 0/87 train_loss 0.3741  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:54:26,410] default_module.py->log_info line:141 [INFO]Valid Epoch 50/100 step 100/37 valid_loss 1.0311  valid_acc_1 43.6508
[2021-03-01 18:54:36,043] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7819    0.9843    0.0789    0.8715    0.2788    0.0847       255
          2     0.6000    0.0789    0.9843    0.1395    0.2788    0.0707        76

avg / total     0.7402    0.7764    0.2868    0.7035    0.2788    0.0815       331

Covid class AUC=0.5971620227038184
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777857393832 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777857393832 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00050: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00050: valid_acc_1  was not in top 1
Epoch 00051: early stopping
INFO:lightning:Epoch 00051: early stopping
[2021-03-01 18:54:36,155] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5145  train_acc_1 77.4457
[2021-03-01 18:54:36,155] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5283  valid_acc_1 77.7778
[2021-03-01 18:54:36,156] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:54:36,164] default_module.py->log_info line:141 [INFO]lr=4.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:55:02,842] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 0/87 train_loss 0.2871  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:58:08,491] default_module.py->log_info line:141 [INFO]Valid Epoch 51/100 step 100/37 valid_loss 1.0952  valid_acc_1 41.2698
[2021-03-01 18:58:18,811] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7768    0.9961    0.0395    0.8729    0.1983    0.0431       255
          2     0.7500    0.0395    0.9961    0.0750    0.1983    0.0356        76

avg / total     0.7706    0.7764    0.2591    0.6897    0.1983    0.0414       331

Covid class AUC=0.5998968008255934
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.7777781873136 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.7777781873136 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00051: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00051: valid_acc_1  was not in top 1
Epoch 00052: early stopping
INFO:lightning:Epoch 00052: early stopping
[2021-03-01 18:58:18,968] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5108  train_acc_1 77.1903
[2021-03-01 18:58:18,968] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5306  valid_acc_1 77.7778
[2021-03-01 18:58:18,968] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:58:18,975] default_module.py->log_info line:141 [INFO]lr=4.6860e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:58:47,627] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 0/87 train_loss 0.7514  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:01:57,624] default_module.py->log_info line:141 [INFO]Valid Epoch 52/100 step 100/37 valid_loss 0.9208  valid_acc_1 44.4444
[2021-03-01 19:02:07,296] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7883    0.9490    0.1447    0.8612    0.3706    0.1484       255
          2     0.4583    0.1447    0.9490    0.2200    0.3706    0.1263        76

avg / total     0.7125    0.7644    0.3294    0.7140    0.3706    0.1433       331

Covid class AUC=0.595717234262126
ACC=0.7643504531722054
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.4907774796357 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.4907774796357 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00052: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00052: valid_acc_1  was not in top 1
Epoch 00053: early stopping
INFO:lightning:Epoch 00053: early stopping
[2021-03-01 19:02:07,376] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5087  train_acc_1 77.6756
[2021-03-01 19:02:07,376] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5354  valid_acc_1 76.4908
[2021-03-01 19:02:07,376] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:02:07,382] default_module.py->log_info line:141 [INFO]lr=4.5295e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:02:28,355] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 0/87 train_loss 0.4750  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:05:36,029] default_module.py->log_info line:141 [INFO]Valid Epoch 53/100 step 100/37 valid_loss 0.8637  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 19:05:45,877] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5461300309597524
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00053: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00053: valid_acc_1  was not in top 1
Epoch 00054: early stopping
INFO:lightning:Epoch 00054: early stopping
[2021-03-01 19:05:45,946] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5040  train_acc_1 77.5479
[2021-03-01 19:05:45,946] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5496  valid_acc_1 77.1772
[2021-03-01 19:05:45,946] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:05:45,954] default_module.py->log_info line:141 [INFO]lr=4.3733e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:06:28,717] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 0/87 train_loss 0.6856  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:09:35,402] default_module.py->log_info line:141 [INFO]Valid Epoch 54/100 step 100/37 valid_loss 0.9706  valid_acc_1 38.8889
[2021-03-01 19:09:44,961] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7676    0.9843    0.0000    0.8625    0.0000    0.0000       255
          2     0.0000    0.0000    0.9843    0.0000    0.0000    0.0000        76

avg / total     0.5913    0.7583    0.2260    0.6645    0.0000    0.0000       331

Covid class AUC=0.5640866873065016
ACC=0.7583081570996979
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.89017630912163 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.89017630912163 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00054: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00054: valid_acc_1  was not in top 1
Epoch 00055: early stopping
INFO:lightning:Epoch 00055: early stopping
[2021-03-01 19:09:45,052] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5031  train_acc_1 76.8072
[2021-03-01 19:09:45,052] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5355  valid_acc_1 75.8902
[2021-03-01 19:09:45,052] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:09:45,059] default_module.py->log_info line:141 [INFO]lr=4.2178e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:10:03,423] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 0/87 train_loss 0.4881  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:13:08,840] default_module.py->log_info line:141 [INFO]Valid Epoch 55/100 step 100/37 valid_loss 0.9587  valid_acc_1 40.4762
[2021-03-01 19:13:19,247] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7727    1.0000    0.0132    0.8718    0.1147    0.0145       255
          2     1.0000    0.0132    1.0000    0.0260    0.1147    0.0119        76

avg / total     0.8249    0.7734    0.2397    0.6776    0.1147    0.0139       331

Covid class AUC=0.602734778121775
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747774381895 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747774381895 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00055: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00055: valid_acc_1  was not in top 1
Epoch 00056: early stopping
INFO:lightning:Epoch 00056: early stopping
[2021-03-01 19:13:19,545] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5070  train_acc_1 77.7778
[2021-03-01 19:13:19,545] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5228  valid_acc_1 77.4775
[2021-03-01 19:13:19,546] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:13:19,557] default_module.py->log_info line:141 [INFO]lr=4.0631e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:14:09,032] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 0/87 train_loss 0.2524  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:17:25,124] default_module.py->log_info line:141 [INFO]Valid Epoch 56/100 step 100/37 valid_loss 1.0490  valid_acc_1 40.4762
[2021-03-01 19:17:34,698] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7727    1.0000    0.0132    0.8718    0.1147    0.0145       255
          2     1.0000    0.0132    1.0000    0.0260    0.1147    0.0119        76

avg / total     0.8249    0.7734    0.2397    0.6776    0.1147    0.0139       331

Covid class AUC=0.6029411764705883
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747774381895 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747774381895 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00056: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00056: valid_acc_1  was not in top 1
Epoch 00057: early stopping
INFO:lightning:Epoch 00057: early stopping
[2021-03-01 19:17:34,773] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5102  train_acc_1 77.3946
[2021-03-01 19:17:34,774] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5267  valid_acc_1 77.4775
[2021-03-01 19:17:34,774] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:17:34,780] default_module.py->log_info line:141 [INFO]lr=3.9093e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:17:54,935] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 0/87 train_loss 0.4734  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:21:00,693] default_module.py->log_info line:141 [INFO]Valid Epoch 57/100 step 100/37 valid_loss 1.3166  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 19:21:10,719] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6001547987616099
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00057: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00057: valid_acc_1  was not in top 1
Epoch 00058: early stopping
INFO:lightning:Epoch 00058: early stopping
[2021-03-01 19:21:10,811] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5090  train_acc_1 77.1903
[2021-03-01 19:21:10,811] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5721  valid_acc_1 77.1772
[2021-03-01 19:21:10,811] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:21:10,818] default_module.py->log_info line:141 [INFO]lr=3.7566e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:21:44,165] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 0/87 train_loss 0.6392  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:25:08,696] default_module.py->log_info line:141 [INFO]Valid Epoch 58/100 step 100/37 valid_loss 0.9429  valid_acc_1 43.6508
[2021-03-01 19:25:18,558] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7857    0.9490    0.1316    0.8597    0.3534    0.1351       255
          2     0.4348    0.1316    0.9490    0.2020    0.3534    0.1147        76

avg / total     0.7051    0.7613    0.3193    0.7087    0.3534    0.1304       331

Covid class AUC=0.5939112487100103
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.19047729389088 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.19047729389088 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00058: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00058: valid_acc_1  was not in top 1
Epoch 00059: early stopping
INFO:lightning:Epoch 00059: early stopping
[2021-03-01 19:25:18,644] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5098  train_acc_1 77.3946
[2021-03-01 19:25:18,644] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5382  valid_acc_1 76.1905
[2021-03-01 19:25:18,644] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:25:18,649] default_module.py->log_info line:141 [INFO]lr=3.6050e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:25:38,065] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 0/87 train_loss 0.5619  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:28:41,338] default_module.py->log_info line:141 [INFO]Valid Epoch 59/100 step 100/37 valid_loss 1.1624  valid_acc_1 40.4762
[2021-03-01 19:28:51,050] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7727    1.0000    0.0132    0.8718    0.1147    0.0145       255
          2     1.0000    0.0132    1.0000    0.0260    0.1147    0.0119        76

avg / total     0.8249    0.7734    0.2397    0.6776    0.1147    0.0139       331

Covid class AUC=0.6063467492260062
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747774381895 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747774381895 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00059: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00059: valid_acc_1  was not in top 1
Epoch 00060: early stopping
INFO:lightning:Epoch 00060: early stopping
[2021-03-01 19:28:51,637] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5031  train_acc_1 77.8033
[2021-03-01 19:28:51,638] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5400  valid_acc_1 77.4775
[2021-03-01 19:28:51,638] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:28:51,644] default_module.py->log_info line:141 [INFO]lr=3.4549e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:29:20,067] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 0/87 train_loss 0.4975  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:32:31,343] default_module.py->log_info line:141 [INFO]Valid Epoch 60/100 step 100/37 valid_loss 0.8923  valid_acc_1 50.7937
[2021-03-01 19:32:42,081] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8015    0.8235    0.3158    0.8124    0.5100    0.2733       255
          2     0.3478    0.3158    0.8235    0.3310    0.5100    0.2469        76

avg / total     0.6974    0.7069    0.4324    0.7019    0.5100    0.2672       331

Covid class AUC=0.5929824561403508
ACC=0.7069486404833837
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 70.78507214623528 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 70.78507214623528 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00060: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00060: valid_acc_1  was not in top 1
Epoch 00061: early stopping
INFO:lightning:Epoch 00061: early stopping
[2021-03-01 19:32:42,436] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4961  train_acc_1 78.0587
[2021-03-01 19:32:42,436] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5869  valid_acc_1 70.7851
[2021-03-01 19:32:42,436] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:32:42,443] default_module.py->log_info line:141 [INFO]lr=3.3063e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:33:15,636] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 0/87 train_loss 0.3420  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:36:15,035] default_module.py->log_info line:141 [INFO]Valid Epoch 61/100 step 100/37 valid_loss 1.0189  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 19:36:24,626] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6026831785345718
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00061: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00061: valid_acc_1  was not in top 1
Epoch 00062: early stopping
INFO:lightning:Epoch 00062: early stopping
[2021-03-01 19:36:24,695] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5018  train_acc_1 77.1903
[2021-03-01 19:36:24,695] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5287  valid_acc_1 77.1772
[2021-03-01 19:36:24,696] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:36:24,703] default_module.py->log_info line:141 [INFO]lr=3.1594e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:36:44,146] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 0/87 train_loss 0.5736  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:39:47,902] default_module.py->log_info line:141 [INFO]Valid Epoch 62/100 step 100/37 valid_loss 0.9137  valid_acc_1 46.8254
[2021-03-01 19:39:57,626] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7935    0.9647    0.1579    0.8708    0.3903    0.1646       255
          2     0.5714    0.1579    0.9647    0.2474    0.3903    0.1400        76

avg / total     0.7425    0.7795    0.3431    0.7277    0.3903    0.1590       331

Covid class AUC=0.6038699690402477
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.99227894963445 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.99227894963445 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00062: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00062: valid_acc_1  was not in top 1
Epoch 00063: early stopping
INFO:lightning:Epoch 00063: early stopping
[2021-03-01 19:39:57,685] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4989  train_acc_1 78.0587
[2021-03-01 19:39:57,685] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5318  valid_acc_1 77.9923
[2021-03-01 19:39:57,685] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:39:57,693] default_module.py->log_info line:141 [INFO]lr=3.0143e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:40:30,598] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 0/87 train_loss 0.5096  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:43:48,729] default_module.py->log_info line:141 [INFO]Valid Epoch 63/100 step 100/37 valid_loss 0.9321  valid_acc_1 40.4762
[2021-03-01 19:43:58,337] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7733    0.9765    0.0395    0.8631    0.1963    0.0422       255
          2     0.3333    0.0395    0.9765    0.0706    0.1963    0.0349        76

avg / total     0.6723    0.7613    0.2546    0.6811    0.1963    0.0405       331

Covid class AUC=0.5785861713106295
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.19047667529132 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.19047667529132 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00063: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00063: valid_acc_1  was not in top 1
Epoch 00064: early stopping
INFO:lightning:Epoch 00064: early stopping
[2021-03-01 19:43:58,394] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5029  train_acc_1 77.5224
[2021-03-01 19:43:58,394] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5376  valid_acc_1 76.1905
[2021-03-01 19:43:58,394] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:43:58,400] default_module.py->log_info line:141 [INFO]lr=2.8711e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:44:19,455] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 0/87 train_loss 0.5162  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:47:20,054] default_module.py->log_info line:141 [INFO]Valid Epoch 64/100 step 100/37 valid_loss 1.5564  valid_acc_1 40.4762
[2021-03-01 19:47:29,914] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7727    1.0000    0.0132    0.8718    0.1147    0.0145       255
          2     1.0000    0.0132    1.0000    0.0260    0.1147    0.0119        76

avg / total     0.8249    0.7734    0.2397    0.6776    0.1147    0.0139       331

Covid class AUC=0.6005675954592362
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747774381895 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747774381895 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00064: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00064: valid_acc_1  was not in top 1
Epoch 00065: early stopping
INFO:lightning:Epoch 00065: early stopping
[2021-03-01 19:47:30,006] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4953  train_acc_1 78.2886
[2021-03-01 19:47:30,006] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6363  valid_acc_1 77.4775
[2021-03-01 19:47:30,006] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:47:30,013] default_module.py->log_info line:141 [INFO]lr=2.7300e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:47:50,637] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 0/87 train_loss 0.9105  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:51:25,008] default_module.py->log_info line:141 [INFO]Valid Epoch 65/100 step 100/37 valid_loss 1.2370  valid_acc_1 40.4762
[2021-03-01 19:51:35,149] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7733    0.9765    0.0395    0.8631    0.1963    0.0422       255
          2     0.3333    0.0395    0.9765    0.0706    0.1963    0.0349        76

avg / total     0.6723    0.7613    0.2546    0.6811    0.1963    0.0405       331

Covid class AUC=0.5959236326109391
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.19047667529132 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.19047667529132 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00065: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00065: valid_acc_1  was not in top 1
Epoch 00066: early stopping
INFO:lightning:Epoch 00066: early stopping
[2021-03-01 19:51:35,367] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4942  train_acc_1 78.3142
[2021-03-01 19:51:35,368] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5676  valid_acc_1 76.1905
[2021-03-01 19:51:35,368] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:51:35,381] default_module.py->log_info line:141 [INFO]lr=2.5912e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:52:04,202] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 0/87 train_loss 0.7631  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:55:06,103] default_module.py->log_info line:141 [INFO]Valid Epoch 66/100 step 100/37 valid_loss 0.8559  valid_acc_1 46.8254
[2021-03-01 19:55:15,705] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7923    0.9725    0.1447    0.8732    0.3752    0.1524       255
          2     0.6111    0.1447    0.9725    0.2340    0.3752    0.1291        76

avg / total     0.7507    0.7825    0.3348    0.7265    0.3752    0.1471       331

Covid class AUC=0.595201238390093
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257900650437 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257900650437 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00066: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00066: valid_acc_1  was not in top 1
Epoch 00067: early stopping
INFO:lightning:Epoch 00067: early stopping
[2021-03-01 19:55:15,798] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4957  train_acc_1 76.8838
[2021-03-01 19:55:15,798] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5357  valid_acc_1 78.2926
[2021-03-01 19:55:15,798] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:55:15,806] default_module.py->log_info line:141 [INFO]lr=2.4548e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:55:42,878] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 0/87 train_loss 0.2973  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:58:57,410] default_module.py->log_info line:141 [INFO]Valid Epoch 67/100 step 100/37 valid_loss 0.8310  valid_acc_1 48.4127
[2021-03-01 19:59:08,248] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7980    0.9608    0.1842    0.8719    0.4207    0.1907       255
          2     0.5833    0.1842    0.9608    0.2800    0.4207    0.1632        76

avg / total     0.7487    0.7825    0.3625    0.7360    0.4207    0.1844       331

Covid class AUC=0.5887512899896801
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257931580415 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257931580415 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00067: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00067: valid_acc_1  was not in top 1
Epoch 00068: early stopping
INFO:lightning:Epoch 00068: early stopping
[2021-03-01 19:59:08,650] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4879  train_acc_1 77.7778
[2021-03-01 19:59:08,650] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5403  valid_acc_1 78.2926
[2021-03-01 19:59:08,650] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:59:08,661] default_module.py->log_info line:141 [INFO]lr=2.3209e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:59:40,209] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 0/87 train_loss 0.4870  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:02:52,773] default_module.py->log_info line:141 [INFO]Valid Epoch 68/100 step 100/37 valid_loss 0.9063  valid_acc_1 45.2381
[2021-03-01 20:03:02,585] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7868    0.9843    0.1053    0.8746    0.3219    0.1127       255
          2     0.6667    0.1053    0.9843    0.1818    0.3219    0.0945        76

avg / total     0.7592    0.7825    0.3071    0.7155    0.3219    0.1085       331

Covid class AUC=0.5942724458204335
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257882607949 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257882607949 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00068: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00068: valid_acc_1  was not in top 1
Epoch 00069: early stopping
INFO:lightning:Epoch 00069: early stopping
[2021-03-01 20:03:02,663] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4894  train_acc_1 79.3103
[2021-03-01 20:03:02,663] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5215  valid_acc_1 78.2926
[2021-03-01 20:03:02,663] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:03:02,670] default_module.py->log_info line:141 [INFO]lr=2.1896e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:03:40,562] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 0/87 train_loss 0.2765  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:06:44,518] default_module.py->log_info line:141 [INFO]Valid Epoch 69/100 step 100/37 valid_loss 1.0215  valid_acc_1 49.2063
[2021-03-01 20:06:54,118] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7974    0.9569    0.1842    0.8699    0.4198    0.1899       255
          2     0.5600    0.1842    0.9569    0.2772    0.4198    0.1626        76

avg / total     0.7429    0.7795    0.3616    0.7338    0.4198    0.1836       331

Covid class AUC=0.617750257997936
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.99227892385947 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.99227892385947 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00069: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00069: valid_acc_1  was not in top 1
Epoch 00070: early stopping
INFO:lightning:Epoch 00070: early stopping
[2021-03-01 20:06:54,199] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4838  train_acc_1 79.7190
[2021-03-01 20:06:54,200] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5358  valid_acc_1 77.9923
[2021-03-01 20:06:54,200] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:06:54,207] default_module.py->log_info line:141 [INFO]lr=2.0611e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:07:14,227] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 0/87 train_loss 0.4665  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:10:14,855] default_module.py->log_info line:141 [INFO]Valid Epoch 70/100 step 100/37 valid_loss 0.8617  valid_acc_1 44.4444
[2021-03-01 20:10:24,413] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7848    0.9725    0.1053    0.8687    0.3200    0.1113       255
          2     0.5333    0.1053    0.9725    0.1758    0.3200    0.0935        76

avg / total     0.7271    0.7734    0.3044    0.7096    0.3200    0.1072       331

Covid class AUC=0.5895252837977296
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167806264517 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167806264517 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00070: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00070: valid_acc_1  was not in top 1
Epoch 00071: early stopping
INFO:lightning:Epoch 00071: early stopping
[2021-03-01 20:10:24,475] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4874  train_acc_1 76.9604
[2021-03-01 20:10:24,475] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5368  valid_acc_1 77.3917
[2021-03-01 20:10:24,476] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:10:24,482] default_module.py->log_info line:141 [INFO]lr=1.9355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:10:45,137] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 0/87 train_loss 0.3040  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:13:43,157] default_module.py->log_info line:141 [INFO]Valid Epoch 71/100 step 100/37 valid_loss 0.9228  valid_acc_1 50.7937
[2021-03-01 20:13:52,682] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8033    0.9608    0.2105    0.8750    0.4497    0.2174       255
          2     0.6154    0.2105    0.9608    0.3137    0.4497    0.1871        76

avg / total     0.7601    0.7885    0.3828    0.7461    0.4497    0.2105       331

Covid class AUC=0.6152218782249743
ACC=0.7885196374622356
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.89317973884377 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.89317973884377 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00071: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00071: valid_acc_1  was not in top 1
Epoch 00072: early stopping
INFO:lightning:Epoch 00072: early stopping
[2021-03-01 20:13:52,747] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4741  train_acc_1 79.3359
[2021-03-01 20:13:52,747] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5284  valid_acc_1 78.8932
[2021-03-01 20:13:52,747] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:13:52,756] default_module.py->log_info line:141 [INFO]lr=1.8129e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:14:10,538] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 0/87 train_loss 0.4382  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:17:10,743] default_module.py->log_info line:141 [INFO]Valid Epoch 72/100 step 100/37 valid_loss 0.7755  valid_acc_1 54.7619
[2021-03-01 20:17:20,314] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8165    0.8902    0.3289    0.8518    0.5411    0.3093       255
          2     0.4717    0.3289    0.8902    0.3876    0.5411    0.2764        76

avg / total     0.7374    0.7613    0.4578    0.7452    0.5411    0.3017       331

Covid class AUC=0.6379256965944271
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.19047731966586 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.19047731966586 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00072: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00072: valid_acc_1  was not in top 1
Epoch 00073: early stopping
INFO:lightning:Epoch 00073: early stopping
[2021-03-01 20:17:20,386] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4652  train_acc_1 79.4636
[2021-03-01 20:17:20,386] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5622  valid_acc_1 76.1905
[2021-03-01 20:17:20,387] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:17:20,395] default_module.py->log_info line:141 [INFO]lr=1.6934e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:17:41,827] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 0/87 train_loss 0.2699  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:20:41,544] default_module.py->log_info line:141 [INFO]Valid Epoch 73/100 step 100/37 valid_loss 1.0035  valid_acc_1 47.6190
[2021-03-01 20:20:51,139] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7935    0.9647    0.1579    0.8708    0.3903    0.1646       255
          2     0.5714    0.1579    0.9647    0.2474    0.3903    0.1400        76

avg / total     0.7425    0.7795    0.3431    0.7277    0.3903    0.1590       331

Covid class AUC=0.5962848297213622
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.9922788723095 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.9922788723095 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00073: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00073: valid_acc_1  was not in top 1
Epoch 00074: early stopping
INFO:lightning:Epoch 00074: early stopping
[2021-03-01 20:20:51,198] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4816  train_acc_1 78.6462
[2021-03-01 20:20:51,198] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5286  valid_acc_1 77.9923
[2021-03-01 20:20:51,198] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:20:51,205] default_module.py->log_info line:141 [INFO]lr=1.5773e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:21:12,450] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 0/87 train_loss 0.8029  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:24:12,999] default_module.py->log_info line:141 [INFO]Valid Epoch 74/100 step 100/37 valid_loss 0.9411  valid_acc_1 47.6190
[2021-03-01 20:24:22,477] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7961    0.9490    0.1842    0.8658    0.4181    0.1882       255
          2     0.5185    0.1842    0.9490    0.2718    0.4181    0.1614        76

avg / total     0.7323    0.7734    0.3598    0.7294    0.4181    0.1820       331

Covid class AUC=0.637203302373581
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167855236981 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167855236981 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00074: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00074: valid_acc_1  was not in top 1
Epoch 00075: early stopping
INFO:lightning:Epoch 00075: early stopping
[2021-03-01 20:24:22,540] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4686  train_acc_1 80.5875
[2021-03-01 20:24:22,540] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5218  valid_acc_1 77.3917
[2021-03-01 20:24:22,540] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:24:22,546] default_module.py->log_info line:141 [INFO]lr=1.4645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:24:39,985] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 0/87 train_loss 0.5709  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:27:51,156] default_module.py->log_info line:141 [INFO]Valid Epoch 75/100 step 100/37 valid_loss 0.9195  valid_acc_1 48.4127
[2021-03-01 20:28:01,104] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7955    0.9608    0.1711    0.8703    0.4054    0.1773       255
          2     0.5652    0.1711    0.9608    0.2626    0.4054    0.1514        76

avg / total     0.7426    0.7795    0.3524    0.7308    0.4054    0.1714       331

Covid class AUC=0.6311661506707946
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.9922788723095 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.9922788723095 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00075: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00075: valid_acc_1  was not in top 1
Epoch 00076: early stopping
INFO:lightning:Epoch 00076: early stopping
[2021-03-01 20:28:01,188] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4729  train_acc_1 79.0549
[2021-03-01 20:28:01,189] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5207  valid_acc_1 77.9923
[2021-03-01 20:28:01,189] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:28:01,197] default_module.py->log_info line:141 [INFO]lr=1.3552e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:28:21,978] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 0/87 train_loss 0.7953  train_acc_1 44.4444
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:31:21,253] default_module.py->log_info line:141 [INFO]Valid Epoch 76/100 step 100/37 valid_loss 0.8976  valid_acc_1 50.7937
[2021-03-01 20:31:30,829] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8040    0.9490    0.2237    0.8705    0.4607    0.2277       255
          2     0.5667    0.2237    0.9490    0.3208    0.4607    0.1969        76

avg / total     0.7495    0.7825    0.3902    0.7443    0.4607    0.2206       331

Covid class AUC=0.616047471620227
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257918692925 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257918692925 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00076: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00076: valid_acc_1  was not in top 1
Epoch 00077: early stopping
INFO:lightning:Epoch 00077: early stopping
[2021-03-01 20:31:30,909] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4617  train_acc_1 79.2082
[2021-03-01 20:31:30,910] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5330  valid_acc_1 78.2926
[2021-03-01 20:31:30,910] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:31:30,918] default_module.py->log_info line:141 [INFO]lr=1.2494e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:31:49,700] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 0/87 train_loss 0.2632  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:34:50,275] default_module.py->log_info line:141 [INFO]Valid Epoch 77/100 step 100/37 valid_loss 0.9435  valid_acc_1 50.0000
[2021-03-01 20:34:59,796] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8020    0.9529    0.2105    0.8710    0.4479    0.2155       255
          2     0.5714    0.2105    0.9529    0.3077    0.4479    0.1857        76

avg / total     0.7490    0.7825    0.3810    0.7416    0.4479    0.2087       331

Covid class AUC=0.6518575851393189
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257929002917 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257929002917 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00077: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00077: valid_acc_1  was not in top 1
Epoch 00078: early stopping
INFO:lightning:Epoch 00078: early stopping
[2021-03-01 20:34:59,851] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4641  train_acc_1 79.6935
[2021-03-01 20:34:59,852] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5207  valid_acc_1 78.2926
[2021-03-01 20:34:59,852] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:34:59,857] default_module.py->log_info line:141 [INFO]lr=1.1474e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:35:18,703] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 0/87 train_loss 0.3809  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:38:16,474] default_module.py->log_info line:141 [INFO]Valid Epoch 78/100 step 100/37 valid_loss 1.0944  valid_acc_1 43.6508
[2021-03-01 20:38:26,062] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7830    0.9765    0.0921    0.8691    0.2999    0.0979       255
          2     0.5385    0.0921    0.9765    0.1573    0.2999    0.0820        76

avg / total     0.7269    0.7734    0.2952    0.7057    0.2999    0.0942       331

Covid class AUC=0.6460784313725491
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167793377025 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167793377025 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00078: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00078: valid_acc_1  was not in top 1
Epoch 00079: early stopping
INFO:lightning:Epoch 00079: early stopping
[2021-03-01 20:38:26,125] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4567  train_acc_1 80.2554
[2021-03-01 20:38:26,125] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5266  valid_acc_1 77.3917
[2021-03-01 20:38:26,126] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:38:26,133] default_module.py->log_info line:141 [INFO]lr=1.0492e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:38:56,416] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 0/87 train_loss 0.3502  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:41:56,782] default_module.py->log_info line:141 [INFO]Valid Epoch 79/100 step 100/37 valid_loss 0.9654  valid_acc_1 51.5873
[2021-03-01 20:42:06,381] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8082    0.9255    0.2632    0.8629    0.4935    0.2597       255
          2     0.5128    0.2632    0.9255    0.3478    0.4935    0.2274        76

avg / total     0.7404    0.7734    0.4152    0.7446    0.4935    0.2523       331

Covid class AUC=0.6461300309597523
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167842349491 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167842349491 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00079: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00079: valid_acc_1  was not in top 1
Epoch 00080: early stopping
INFO:lightning:Epoch 00080: early stopping
[2021-03-01 20:42:06,453] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4494  train_acc_1 79.9745
[2021-03-01 20:42:06,453] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5407  valid_acc_1 77.3917
[2021-03-01 20:42:06,453] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:42:06,461] default_module.py->log_info line:141 [INFO]lr=9.5492e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:42:25,902] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 0/87 train_loss 0.3491  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:45:25,572] default_module.py->log_info line:141 [INFO]Valid Epoch 80/100 step 100/37 valid_loss 0.9915  valid_acc_1 43.6508
[2021-03-01 20:45:35,133] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7823    0.9725    0.0921    0.8671    0.2993    0.0975       255
          2     0.5000    0.0921    0.9725    0.1556    0.2993    0.0817        76

avg / total     0.7175    0.7704    0.2943    0.7037    0.2993    0.0938       331

Covid class AUC=0.6660990712074304
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.09137767070048 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.09137767070048 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00080: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00080: valid_acc_1  was not in top 1
Epoch 00081: early stopping
INFO:lightning:Epoch 00081: early stopping
[2021-03-01 20:45:35,204] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4479  train_acc_1 80.4087
[2021-03-01 20:45:35,204] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5134  valid_acc_1 77.0914
[2021-03-01 20:45:35,204] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:45:35,210] default_module.py->log_info line:141 [INFO]lr=8.6460e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:45:55,650] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 0/87 train_loss 0.2711  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:48:53,531] default_module.py->log_info line:141 [INFO]Valid Epoch 81/100 step 100/37 valid_loss 1.0282  valid_acc_1 39.6825
[2021-03-01 20:49:03,101] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7706    0.9882    0.0132    0.8660    0.1140    0.0143       255
          2     0.2500    0.0132    0.9882    0.0250    0.1140    0.0117        76

avg / total     0.6511    0.7644    0.2370    0.6729    0.1140    0.0137       331

Covid class AUC=0.6470588235294117
ACC=0.7643504531722054
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.57657718658447 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.57657718658447 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00081: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00081: valid_acc_1  was not in top 1
Epoch 00082: early stopping
INFO:lightning:Epoch 00082: early stopping
[2021-03-01 20:49:03,186] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4506  train_acc_1 80.8429
[2021-03-01 20:49:03,187] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5219  valid_acc_1 76.5766
[2021-03-01 20:49:03,187] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:49:03,193] default_module.py->log_info line:141 [INFO]lr=7.7836e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:49:23,550] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 0/87 train_loss 0.3059  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:52:29,333] default_module.py->log_info line:141 [INFO]Valid Epoch 82/100 step 100/37 valid_loss 1.0329  valid_acc_1 42.0635
[2021-03-01 20:52:38,886] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7781    0.9765    0.0658    0.8661    0.2535    0.0701       255
          2     0.4545    0.0658    0.9765    0.1149    0.2535    0.0584        76

avg / total     0.7038    0.7674    0.2749    0.6936    0.2535    0.0674       331

Covid class AUC=0.6590815273477812
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.79107730453079 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.79107730453079 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00082: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00082: valid_acc_1  was not in top 1
Epoch 00083: early stopping
INFO:lightning:Epoch 00083: early stopping
[2021-03-01 20:52:38,970] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4482  train_acc_1 80.2299
[2021-03-01 20:52:38,970] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5189  valid_acc_1 76.7911
[2021-03-01 20:52:38,970] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:52:38,977] default_module.py->log_info line:141 [INFO]lr=6.9629e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:52:58,614] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 0/87 train_loss 0.5671  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:55:58,426] default_module.py->log_info line:141 [INFO]Valid Epoch 83/100 step 100/37 valid_loss 0.9126  valid_acc_1 53.1746
[2021-03-01 20:56:08,011] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8131    0.9216    0.2895    0.8640    0.5165    0.2836       255
          2     0.5238    0.2895    0.9216    0.3729    0.5165    0.2499        76

avg / total     0.7467    0.7764    0.4346    0.7512    0.5165    0.2759       331

Covid class AUC=0.6507223942208462
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.69197902163944 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.69197902163944 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00083: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00083: valid_acc_1  was not in top 1
Epoch 00084: early stopping
INFO:lightning:Epoch 00084: early stopping
[2021-03-01 20:56:08,072] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4340  train_acc_1 79.9745
[2021-03-01 20:56:08,072] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5312  valid_acc_1 77.6920
[2021-03-01 20:56:08,073] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:56:08,080] default_module.py->log_info line:141 [INFO]lr=6.1847e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:56:29,847] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 0/87 train_loss 0.3766  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:59:29,723] default_module.py->log_info line:141 [INFO]Valid Epoch 84/100 step 100/37 valid_loss 0.9926  valid_acc_1 46.0317
[2021-03-01 20:59:39,319] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7891    0.9686    0.1316    0.8697    0.3570    0.1381       255
          2     0.5556    0.1316    0.9686    0.2128    0.3570    0.1168        76

avg / total     0.7355    0.7764    0.3238    0.7189    0.3570    0.1332       331

Covid class AUC=0.6584107327141383
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.69197842881486 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.69197842881486 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00084: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00084: valid_acc_1  was not in top 1
Epoch 00085: early stopping
INFO:lightning:Epoch 00085: early stopping
[2021-03-01 20:59:39,390] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4362  train_acc_1 79.6169
[2021-03-01 20:59:39,390] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5181  valid_acc_1 77.6920
[2021-03-01 20:59:39,390] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:59:39,396] default_module.py->log_info line:141 [INFO]lr=5.4497e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:59:58,872] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 0/87 train_loss 0.4111  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:03:08,171] default_module.py->log_info line:141 [INFO]Valid Epoch 85/100 step 100/37 valid_loss 0.9815  valid_acc_1 52.3810
[2021-03-01 21:03:18,026] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8087    0.9451    0.2500    0.8716    0.4861    0.2527       255
          2     0.5758    0.2500    0.9451    0.3486    0.4861    0.2199        76

avg / total     0.7552    0.7855    0.4096    0.7515    0.4861    0.2452       331

Covid class AUC=0.6682146542827657
ACC=0.7854984894259819
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.5928796046489 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.5928796046489 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00085: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00085: valid_acc_1  was not in top 1
Epoch 00086: early stopping
INFO:lightning:Epoch 00086: early stopping
[2021-03-01 21:03:18,089] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4266  train_acc_1 80.7918
[2021-03-01 21:03:18,089] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5216  valid_acc_1 78.5929
[2021-03-01 21:03:18,089] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:03:18,095] default_module.py->log_info line:141 [INFO]lr=4.7586e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:03:36,356] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 0/87 train_loss 0.2499  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:06:35,641] default_module.py->log_info line:141 [INFO]Valid Epoch 86/100 step 100/37 valid_loss 0.9702  valid_acc_1 46.8254
[2021-03-01 21:06:45,212] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7910    0.9647    0.1447    0.8693    0.3737    0.1511       255
          2     0.5500    0.1447    0.9647    0.2292    0.3737    0.1282        76

avg / total     0.7357    0.7764    0.3330    0.7223    0.3737    0.1458       331

Covid class AUC=0.6690402476780185
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.69197863501472 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.69197863501472 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00086: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00086: valid_acc_1  was not in top 1
Epoch 00087: early stopping
INFO:lightning:Epoch 00087: early stopping
[2021-03-01 21:06:45,318] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4338  train_acc_1 81.4304
[2021-03-01 21:06:45,319] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5151  valid_acc_1 77.6920
[2021-03-01 21:06:45,319] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:06:45,328] default_module.py->log_info line:141 [INFO]lr=4.1123e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:07:05,253] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 0/87 train_loss 0.3012  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:10:06,086] default_module.py->log_info line:141 [INFO]Valid Epoch 87/100 step 100/37 valid_loss 1.0154  valid_acc_1 49.2063
[2021-03-01 21:10:15,655] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7980    0.9608    0.1842    0.8719    0.4207    0.1907       255
          2     0.5833    0.1842    0.9608    0.2800    0.4207    0.1632        76

avg / total     0.7487    0.7825    0.3625    0.7360    0.4207    0.1844       331

Covid class AUC=0.6722910216718266
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257910960429 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257910960429 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00087: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00087: valid_acc_1  was not in top 1
Epoch 00088: early stopping
INFO:lightning:Epoch 00088: early stopping
[2021-03-01 21:10:15,727] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4194  train_acc_1 80.4853
[2021-03-01 21:10:15,727] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5191  valid_acc_1 78.2926
[2021-03-01 21:10:15,727] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:10:15,735] default_module.py->log_info line:141 [INFO]lr=3.5112e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:10:34,752] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 0/87 train_loss 0.2591  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:13:32,061] default_module.py->log_info line:141 [INFO]Valid Epoch 88/100 step 100/37 valid_loss 0.9701  valid_acc_1 50.0000
[2021-03-01 21:13:41,576] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8000    0.9569    0.1974    0.8714    0.4346    0.2032       255
          2     0.5769    0.1974    0.9569    0.2941    0.4346    0.1745        76

avg / total     0.7488    0.7825    0.3718    0.7389    0.4346    0.1966       331

Covid class AUC=0.673890608875129
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257949622902 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257949622902 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00088: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00088: valid_acc_1  was not in top 1
Epoch 00089: early stopping
INFO:lightning:Epoch 00089: early stopping
[2021-03-01 21:13:41,634] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4188  train_acc_1 81.7880
[2021-03-01 21:13:41,634] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5145  valid_acc_1 78.2926
[2021-03-01 21:13:41,634] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:13:41,639] default_module.py->log_info line:141 [INFO]lr=2.9560e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:13:59,363] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 0/87 train_loss 0.2832  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:16:59,643] default_module.py->log_info line:141 [INFO]Valid Epoch 89/100 step 100/37 valid_loss 0.9731  valid_acc_1 50.7937
[2021-03-01 21:17:09,192] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8026    0.9569    0.2105    0.8730    0.4488    0.2165       255
          2     0.5926    0.2105    0.9569    0.3107    0.4488    0.1864        76

avg / total     0.7544    0.7855    0.3819    0.7439    0.4488    0.2096       331

Covid class AUC=0.6699174406604748
ACC=0.7854984894259819
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.59287955309894 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.59287955309894 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00089: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00089: valid_acc_1  was not in top 1
Epoch 00090: early stopping
INFO:lightning:Epoch 00090: early stopping
[2021-03-01 21:17:09,261] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4308  train_acc_1 80.8685
[2021-03-01 21:17:09,261] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5178  valid_acc_1 78.5929
[2021-03-01 21:17:09,261] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:17:09,267] default_module.py->log_info line:141 [INFO]lr=2.4472e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:17:30,595] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 0/87 train_loss 0.2847  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:20:30,156] default_module.py->log_info line:141 [INFO]Valid Epoch 90/100 step 100/37 valid_loss 1.0363  valid_acc_1 46.0317
[2021-03-01 21:20:39,725] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7891    0.9686    0.1316    0.8697    0.3570    0.1381       255
          2     0.5556    0.1316    0.9686    0.2128    0.3570    0.1168        76

avg / total     0.7355    0.7764    0.3238    0.7189    0.3570    0.1332       331

Covid class AUC=0.6706398348813208
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.6919785061398 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.6919785061398 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00090: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00090: valid_acc_1  was not in top 1
Epoch 00091: early stopping
INFO:lightning:Epoch 00091: early stopping
[2021-03-01 21:20:39,787] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4196  train_acc_1 81.4815
[2021-03-01 21:20:39,787] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5200  valid_acc_1 77.6920
[2021-03-01 21:20:39,787] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:20:39,793] default_module.py->log_info line:141 [INFO]lr=1.9853e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:20:59,508] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 0/87 train_loss 0.3590  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:23:59,125] default_module.py->log_info line:141 [INFO]Valid Epoch 91/100 step 100/37 valid_loss 0.9289  valid_acc_1 52.3810
[2021-03-01 21:24:08,702] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8095    0.9333    0.2632    0.8670    0.4956    0.2621       255
          2     0.5405    0.2632    0.9333    0.3540    0.4956    0.2292        76

avg / total     0.7478    0.7795    0.4170    0.7492    0.4956    0.2545       331

Covid class AUC=0.6690918472652219
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.99227866610966 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.99227866610966 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00091: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00091: valid_acc_1  was not in top 1
Epoch 00092: early stopping
INFO:lightning:Epoch 00092: early stopping
[2021-03-01 21:24:08,790] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4213  train_acc_1 80.9962
[2021-03-01 21:24:08,790] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5197  valid_acc_1 77.9923
[2021-03-01 21:24:08,790] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:24:08,796] default_module.py->log_info line:141 [INFO]lr=1.5708e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:24:27,633] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 0/87 train_loss 0.3301  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:27:32,257] default_module.py->log_info line:141 [INFO]Valid Epoch 92/100 step 100/37 valid_loss 0.9688  valid_acc_1 50.7937
[2021-03-01 21:27:42,059] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8040    0.9490    0.2237    0.8705    0.4607    0.2277       255
          2     0.5667    0.2237    0.9490    0.3208    0.4607    0.1969        76

avg / total     0.7495    0.7825    0.3902    0.7443    0.4607    0.2206       331

Covid class AUC=0.6679566563467492
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257905805433 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257905805433 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00092: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00092: valid_acc_1  was not in top 1
Epoch 00093: early stopping
INFO:lightning:Epoch 00093: early stopping
[2021-03-01 21:27:42,220] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4099  train_acc_1 81.1239
[2021-03-01 21:27:42,221] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5197  valid_acc_1 78.2926
[2021-03-01 21:27:42,221] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:27:42,228] default_module.py->log_info line:141 [INFO]lr=1.2042e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:28:13,324] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 0/87 train_loss 0.2512  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:31:13,457] default_module.py->log_info line:141 [INFO]Valid Epoch 93/100 step 100/37 valid_loss 0.9996  valid_acc_1 49.2063
[2021-03-01 21:31:23,060] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7980    0.9608    0.1842    0.8719    0.4207    0.1907       255
          2     0.5833    0.1842    0.9608    0.2800    0.4207    0.1632        76

avg / total     0.7487    0.7825    0.3625    0.7360    0.4207    0.1844       331

Covid class AUC=0.6699174406604747
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257929002917 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257929002917 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00093: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00093: valid_acc_1  was not in top 1
Epoch 00094: early stopping
INFO:lightning:Epoch 00094: early stopping
[2021-03-01 21:31:23,129] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4182  train_acc_1 80.7663
[2021-03-01 21:31:23,129] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5179  valid_acc_1 78.2926
[2021-03-01 21:31:23,129] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:31:23,135] default_module.py->log_info line:141 [INFO]lr=8.8564e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:31:42,797] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 0/87 train_loss 0.4170  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:34:43,731] default_module.py->log_info line:141 [INFO]Valid Epoch 94/100 step 100/37 valid_loss 0.9963  valid_acc_1 50.0000
[2021-03-01 21:34:53,307] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8007    0.9608    0.1974    0.8734    0.4355    0.2041       255
          2     0.6000    0.1974    0.9608    0.2970    0.4355    0.1752        76

avg / total     0.7546    0.7855    0.3727    0.7411    0.4355    0.1975       331

Covid class AUC=0.6712590299277605
ACC=0.7854984894259819
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.5928796046489 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.5928796046489 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00094: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00094: valid_acc_1  was not in top 1
Epoch 00095: early stopping
INFO:lightning:Epoch 00095: early stopping
[2021-03-01 21:34:53,368] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4156  train_acc_1 81.5581
[2021-03-01 21:34:53,368] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5184  valid_acc_1 78.5929
[2021-03-01 21:34:53,368] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:34:53,374] default_module.py->log_info line:141 [INFO]lr=6.1558e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:35:12,996] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 0/87 train_loss 0.4961  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:38:11,177] default_module.py->log_info line:141 [INFO]Valid Epoch 95/100 step 100/37 valid_loss 1.0036  valid_acc_1 49.2063
[2021-03-01 21:38:20,661] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7980    0.9608    0.1842    0.8719    0.4207    0.1907       255
          2     0.5833    0.1842    0.9608    0.2800    0.4207    0.1632        76

avg / total     0.7487    0.7825    0.3625    0.7360    0.4207    0.1844       331

Covid class AUC=0.6719298245614035
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257929002917 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257929002917 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00095: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00095: valid_acc_1  was not in top 1
Epoch 00096: early stopping
INFO:lightning:Epoch 00096: early stopping
[2021-03-01 21:38:20,721] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3987  train_acc_1 82.6309
[2021-03-01 21:38:20,722] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5180  valid_acc_1 78.2926
[2021-03-01 21:38:20,722] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:38:20,728] default_module.py->log_info line:141 [INFO]lr=3.9426e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:38:39,032] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 0/87 train_loss 0.5934  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:41:39,779] default_module.py->log_info line:141 [INFO]Valid Epoch 96/100 step 100/37 valid_loss 1.0040  valid_acc_1 50.0000
[2021-03-01 21:41:49,328] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8007    0.9608    0.1974    0.8734    0.4355    0.2041       255
          2     0.6000    0.1974    0.9608    0.2970    0.4355    0.1752        76

avg / total     0.7546    0.7855    0.3727    0.7411    0.4355    0.1975       331

Covid class AUC=0.67234262125903
ACC=0.7854984894259819
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.5928796046489 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.5928796046489 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00096: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00096: valid_acc_1  was not in top 1
Epoch 00097: early stopping
INFO:lightning:Epoch 00097: early stopping
[2021-03-01 21:41:49,390] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4112  train_acc_1 82.1711
[2021-03-01 21:41:49,390] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5192  valid_acc_1 78.5929
[2021-03-01 21:41:49,390] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:41:49,397] default_module.py->log_info line:141 [INFO]lr=2.2190e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:42:08,845] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 0/87 train_loss 0.5034  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:45:08,346] default_module.py->log_info line:141 [INFO]Valid Epoch 97/100 step 100/37 valid_loss 0.9891  valid_acc_1 50.0000
[2021-03-01 21:45:17,939] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7993    0.9529    0.1974    0.8694    0.4337    0.2023       255
          2     0.5556    0.1974    0.9529    0.2913    0.4337    0.1739        76

avg / total     0.7434    0.7795    0.3709    0.7367    0.4337    0.1958       331

Covid class AUC=0.6710526315789475
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.9922790269594 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.9922790269594 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00097: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00097: valid_acc_1  was not in top 1
Epoch 00098: early stopping
INFO:lightning:Epoch 00098: early stopping
[2021-03-01 21:45:18,017] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3988  train_acc_1 82.1711
[2021-03-01 21:45:18,017] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5180  valid_acc_1 77.9923
[2021-03-01 21:45:18,017] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:45:18,025] default_module.py->log_info line:141 [INFO]lr=9.8664e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:45:38,375] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 0/87 train_loss 0.2338  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:48:37,076] default_module.py->log_info line:141 [INFO]Valid Epoch 98/100 step 100/37 valid_loss 0.9857  valid_acc_1 50.7937
[2021-03-01 21:48:46,622] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8033    0.9451    0.2237    0.8685    0.4598    0.2267       255
          2     0.5484    0.2237    0.9451    0.3178    0.4598    0.1962        76

avg / total     0.7448    0.7795    0.3893    0.7420    0.4598    0.2197       331

Covid class AUC=0.6722910216718266
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.9922787434346 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.9922787434346 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00098: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00098: valid_acc_1  was not in top 1
Epoch 00099: early stopping
INFO:lightning:Epoch 00099: early stopping
[2021-03-01 21:48:46,708] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4051  train_acc_1 81.8646
[2021-03-01 21:48:46,708] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5192  valid_acc_1 77.9923
[2021-03-01 21:48:46,708] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 21:48:46,717] default_module.py->log_info line:141 [INFO]lr=2.4672e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 21:49:05,754] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 0/87 train_loss 0.7962  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 21:52:15,422] default_module.py->log_info line:141 [INFO]Valid Epoch 99/100 step 100/37 valid_loss 0.9983  valid_acc_1 50.0000
[2021-03-01 21:52:25,359] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8007    0.9608    0.1974    0.8734    0.4355    0.2041       255
          2     0.6000    0.1974    0.9608    0.2970    0.4355    0.1752        76

avg / total     0.7546    0.7855    0.3727    0.7411    0.4355    0.1975       331

Covid class AUC=0.6713106295149638
ACC=0.7854984894259819
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.5928796046489 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.5928796046489 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00099: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00099: valid_acc_1  was not in top 1
Epoch 00100: early stopping
INFO:lightning:Epoch 00100: early stopping
[2021-03-01 21:52:25,436] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4202  train_acc_1 81.6347
[2021-03-01 21:52:25,436] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5196  valid_acc_1 78.5929
[2021-03-01 21:52:25,436] default_module.py->log_info line:141 [INFO]===========================

