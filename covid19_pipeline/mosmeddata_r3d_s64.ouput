[2021-03-01 15:29:31,609] config.py->setup_cfg_with_hparams line:84 [INFO]Running with full config:
DEFAULT_CUDNN_BENCHMARK: True
SEED: 5361
VERSION: 1
abtfs:
    blur:
        blur_limit: 3
        enable: 0
    bright:
        clip_limit: 1
        enable: 1
    channel_dropout:
        drop_range: (1, 1)
        enable: 0
        fill_value: 127
    channel_shuffle:
        enable: 0
    cutout:
        enable: 1
        fill_value: 127
        num_holes: 10
        size: 20
    distortion:
        enable: 0
    hue:
        enable: 0
    noise:
        enable: 1
    random_grid_shuffle:
        enable: 0
        grid: 2
    rotate:
        enable: 1
        p: 1
        rotate_limit: 45
        scale_limit: 0.2
        shift_limit: 0.0625
cam:
    debug: False
    featmaps_module_name: 'glob_avgpool'
    label: -1
    model_path: ''
    save_path: './cam_results'
    scan_path: ''
    weights_module_name: 'fc'
dataloader:
    num_workers: 40
    sample_test: 'default'
    sample_train: 'default'
    sampler:
        replacement: True
        weights_cls: [0, 0.23, 0.77]
dataset:
    batch_size: 9
    dir: '/home/datasets/COVID-19_CTs/MosMedData/COVID19_1110/pngs'
    is_3d: True
    is_color: False
    is_train: False
    name: 'CTDataset'
    slice_num: 64
    subset_train: 1.0
    subset_valid: 1.0
    test_list: '/home/datasets/COVID-19_CTs/mosmed/nii_png_test.json'
    train_list: '/home/datasets/COVID-19_CTs/mosmed/nii_png_train.json'
    valid_list: '/home/datasets/covid-19_cts/mosmed/nii_png_test.json'
hooks:
    early_stopping:
        min_delta: 0.0
        mode: 'max'
        monitor: 'valid_acc_1'
        patience: 20
        setting: 2
        verbose: 1
    model_checkpoint:
        filepath: ''
        mode: 'max'
        monitor: 'valid_acc_1'
        period: 1
        prefix: ''
        save_top_k: 1
        save_weights_only: False
        setting: 2
        verbose: 1
hparams: Namespace(cam_only=False, config_file='./config/mosmeddata_config.yml', opts=['trainer.gpus', '[2]', 'model.name', 'resnet3d', 'model.model_depth', '18', 'dataset.slice_num', '64', 'dataset.batch_size', '9', 'trainer.logger.test_tube.name', 'mosmeddata_r3d_18_bs9_s64'], predict_only=False, test_only=False)
input:
    size: (128, 128)
label_transforms:
    name: 'default'
log:
    name: './output/mosmeddata_r3d_18_bs9_s64/version_1/log.txt'
    path: './output/mosmeddata_r3d_18_bs9_s64/version_1'
loss:
    class_weight: []
    focal_loss:
        alpha: []
        gamma: 2
        size_average: True
    label_smoothing: 0.1
    name: 'CrossEntropy'
mixup:
    alpha: 0.4
    enable: 0
model:
    classes: 3
    dropout: 0
    finetune: False
    model_depth: 18
    n_input_channels: 1
    name: 'resnet3d'
    pretrained: False
module:
    analyze_result: True
    name: 'CTModule'
optim:
    base_lr: 0.001
    momentum: 0.9
    name: 'adam'
    scheduler:
        gamma: 0.1
        milestones: [10, 25, 35, 50]
        mode: 'min'
        name: 'CosineAnnealingLR'
        patience: 10
        step_size: 10
        t_0: 5
        t_max: 100
        t_mul: 20
        verbose: True
    weight_decay: 0.0005
predict_only:
    load_ckpt:
        checkpoint_path: ''
    load_metric:
        map_location: 'cuda:0'
        on_gpu: True
        tags_csv: ''
        weights_path: ''
    to_pred_file_path: ''
    type: 'ckpt'
topk: [1, 1]
trainer:
    accumulate_grad_batches: 1
    amp_level: 'O1'
    auto_lr_find: False
    auto_scale_batch_size: False
    auto_select_gpus: False
    benchmark: False
    check_val_every_n_epoch: 1
    default_root_dir: './output'
    default_save_path: './output'
    distributed_backend: 'dp'
    fast_dev_run: False
    gpus: [2]
    gradient_clip_val: 0
    log_gpu_memory: ''
    log_save_interval: 100
    logger:
        mlflow:
            experiment_name: 'torchline_logs'
            tracking_uri: './output'
        setting: 2
        test_tube:
            name: 'mosmeddata_r3d_18_bs9_s64'
            save_dir: './output'
            version: -1
        type: 'test_tube'
    max_epochs: 100
    max_steps: 99999999
    min_epochs: 99
    min_steps: 99999999
    name: 'DefaultTrainer'
    num_nodes: 1
    num_sanity_val_steps: 5
    num_tpu_cores: ''
    overfit_pct: 0.0
    precision: 32
    print_nan_grads: True
    process_position: 0
    progress_bar_refresh_rate: 0
    reload_dataloaders_every_epoch: False
    replace_sampler_ddp: True
    resume_from_checkpoint: ''
    row_log_interval: 10
    show_progress_bar: False
    terminate_on_nan: False
    test_percent_check: 1.0
    track_grad_norm: -1
    train_percent_check: 1.0
    truncated_bptt_steps: ''
    use_amp: False
    val_check_interval: 1.0
    val_percent_check: 1.0
    weights_save_path: ''
    weights_summary: ''
transforms:
    ct:
        randomaffine:
            degrees: (-10, 10)
            enable: 0
            isotropic: True
            p: 0.5
            scales: (0.5, 0.5)
        randomblur:
            enable: 0
            p: 0.5
            std: (0, 4)
        randomelasticdeformation:
            enable: 0
            locked_borders: 0
            max_displacement: (7, 7, 7)
            num_control_points: (4, 4, 4)
            p: 0.5
        randomflip:
            axes: (0, 1, 2)
            enable: 1
            flip_probability: 0.5
            p: 0.5
        randomnoise:
            enable: 0
            mean: (0, 0.25)
            p: 0.5
            std: (0, 0.25)
        randomswap:
            enable: 0
            num_iterations: 100
            p: 0.5
            patch_size: (16, 16, 16)
    img:
        aug_cifar: False
        aug_imagenet: False
        center_crop:
            enable: 0
        color_jitter:
            brightness: 0.1
            contrast: 0.1
            enable: 0
            hue: 0.1
            saturation: 0.1
        random_crop:
            enable: 1
            padding: 0
        random_horizontal_flip:
            enable: 1
            p: 0.5
        random_resized_crop:
            enable: 0
            ratio: (0.75, 1.3333333333333333)
            scale: (0.5, 1.0)
        random_rotation:
            degrees: 10
            enable: 1
        random_vertical_flip:
            enable: 1
            p: 0.5
        resize:
            enable: 1
    name: 'CTTransforms'
    tensor:
        normalization:
            mean: [0.5, 0.5, 0.5]
            std: [0.5, 0.5, 0.5]
        random_erasing:
            enable: 0
            p: 0.5
            ratio: ((0.3, 3.3),)
            scale: (0.02, 0.3)
GPU available: True, used: True
No environment variable for node rank defined. Set as 0.
CUDA_VISIBLE_DEVICES: [2]
If you use TorchIO for your research, please cite the following paper:
Pérez-García et al., TorchIO: a Python library for efficient loading,
preprocessing, augmentation and patch-based sampling of medical images
in deep learning. Link: https://arxiv.org/abs/2003.04696

Generating validation transform ...
Valid transform=Compose(
)
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Specificity is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Sensitivity is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_ranking.py:951: UndefinedMetricWarning: No positive samples in y_true, true positive value should be meaningless
  UndefinedMetricWarning)
[2021-03-01 15:31:41,117] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          0     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000       0.0
          2     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000      45.0

avg / total     0.0000    0.0000    0.0000    0.0000    0.0000    0.0000      45.0

Covid class AUC=nan
ACC=0.0
[2021-03-01 15:32:51,783] default_module.py->log_info line:141 [INFO]lr=1.0000e-03
Generating training transform ...
Train transform=Compose(
    <torchio.transforms.augmentation.spatial.random_flip.RandomFlip object at 0x7f685cbdc0f0>
)
Generating validation transform ...
Valid transform=Compose(
)
None
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:34:22,326] default_module.py->log_info line:141 [INFO]Train Epoch 0/100 step 0/87 train_loss 1.5902  train_acc_1 0.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:36:54,489] default_module.py->log_info line:141 [INFO]Valid Epoch 0/100 step 100/37 valid_loss 0.9995  valid_acc_1 32.7485
[2021-03-01 15:36:58,844] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7880    0.9765    0.1184    0.8722    0.3401    0.1256       255
          2     0.6000    0.1184    0.9765    0.1978    0.3401    0.1057        76

avg / total     0.7448    0.7795    0.3154    0.7173    0.3401    0.1210       331

Covid class AUC=0.5744582043343653
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 68.78306972412835 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)

Epoch 00000: valid_acc_1 reached 68.78307 (best 68.78307), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=0-valid_acc_1=68.78.ckpt as top 1
INFO:lightning:
Epoch 00000: valid_acc_1 reached 68.78307 (best 68.78307), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=0-valid_acc_1=68.78.ckpt as top 1
[2021-03-01 15:37:02,109] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.6437  train_acc_1 72.6948
[2021-03-01 15:37:02,168] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6160  valid_acc_1 68.7831
[2021-03-01 15:37:02,168] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:37:02,175] default_module.py->log_info line:141 [INFO]lr=9.9975e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:38:15,459] default_module.py->log_info line:141 [INFO]Train Epoch 1/100 step 0/87 train_loss 0.5902  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:39:54,289] default_module.py->log_info line:141 [INFO]Valid Epoch 1/100 step 100/37 valid_loss 0.8059  valid_acc_1 46.0317
[2021-03-01 15:39:58,014] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7914    0.9373    0.1711    0.8582    0.4004    0.1726       255
          2     0.4483    0.1711    0.9373    0.2476    0.4004    0.1480        76

avg / total     0.7126    0.7613    0.3470    0.7180    0.4004    0.1670       331

Covid class AUC=0.601031991744066
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.19047734544084 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.19047734544084 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00001: valid_acc_1 reached 76.19048 (best 76.19048), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=1-valid_acc_1=76.19.ckpt as top 1
INFO:lightning:
Epoch 00001: valid_acc_1 reached 76.19048 (best 76.19048), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=1-valid_acc_1=76.19.ckpt as top 1
[2021-03-01 15:40:02,858] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5521  train_acc_1 75.8110
[2021-03-01 15:40:02,896] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5582  valid_acc_1 76.1905
[2021-03-01 15:40:02,896] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:40:02,906] default_module.py->log_info line:141 [INFO]lr=9.9901e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:41:02,540] default_module.py->log_info line:141 [INFO]Train Epoch 2/100 step 0/87 train_loss 0.4121  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:43:03,746] default_module.py->log_info line:141 [INFO]Valid Epoch 2/100 step 100/37 valid_loss 1.1103  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:43:07,620] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5965944272445819
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00002: valid_acc_1 reached 77.17718 (best 77.17718), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=2-valid_acc_1=77.18.ckpt as top 1
INFO:lightning:
Epoch 00002: valid_acc_1 reached 77.17718 (best 77.17718), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=2-valid_acc_1=77.18.ckpt as top 1
[2021-03-01 15:43:09,115] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5530  train_acc_1 76.2708
[2021-03-01 15:43:09,115] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5462  valid_acc_1 77.1772
[2021-03-01 15:43:09,116] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:43:09,123] default_module.py->log_info line:141 [INFO]lr=9.9778e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:44:17,613] default_module.py->log_info line:141 [INFO]Train Epoch 3/100 step 0/87 train_loss 0.3360  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:46:11,240] default_module.py->log_info line:141 [INFO]Valid Epoch 3/100 step 100/37 valid_loss 0.7725  valid_acc_1 52.3810
[2021-03-01 15:46:14,922] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8030    0.6392    0.4737    0.7118    0.5503    0.3078       255
          2     0.2812    0.4737    0.6392    0.3529    0.5503    0.2978        76

avg / total     0.6832    0.6012    0.5117    0.6294    0.5503    0.3055       331

Covid class AUC=0.5901444788441692
ACC=0.6012084592145015
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 60.27456059326997 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 60.27456059326997 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00003: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00003: valid_acc_1  was not in top 1
[2021-03-01 15:46:16,070] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5349  train_acc_1 77.3946
[2021-03-01 15:46:16,070] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6796  valid_acc_1 60.2746
[2021-03-01 15:46:16,070] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:46:16,080] default_module.py->log_info line:141 [INFO]lr=9.9606e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:47:19,183] default_module.py->log_info line:141 [INFO]Train Epoch 4/100 step 0/87 train_loss 1.0990  train_acc_1 33.3333
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:49:17,473] default_module.py->log_info line:141 [INFO]Valid Epoch 4/100 step 100/37 valid_loss 1.1854  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:49:21,283] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5751805985552114
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00004: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00004: valid_acc_1  was not in top 1
[2021-03-01 15:49:21,555] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5397  train_acc_1 77.1648
[2021-03-01 15:49:21,555] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5522  valid_acc_1 77.1772
[2021-03-01 15:49:21,555] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:49:21,562] default_module.py->log_info line:141 [INFO]lr=9.9384e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:50:01,771] default_module.py->log_info line:141 [INFO]Train Epoch 5/100 step 0/87 train_loss 0.8498  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:51:43,413] default_module.py->log_info line:141 [INFO]Valid Epoch 5/100 step 100/37 valid_loss 2.9907  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 15:51:47,443] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.609545923632611
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00005: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00005: valid_acc_1  was not in top 1
[2021-03-01 15:51:47,758] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5336  train_acc_1 76.5773
[2021-03-01 15:51:47,759] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 1.1366  valid_acc_1 77.1772
[2021-03-01 15:51:47,759] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:51:47,767] default_module.py->log_info line:141 [INFO]lr=9.9114e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:52:25,576] default_module.py->log_info line:141 [INFO]Train Epoch 6/100 step 0/87 train_loss 0.6240  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:54:27,013] default_module.py->log_info line:141 [INFO]Valid Epoch 6/100 step 100/37 valid_loss 0.8538  valid_acc_1 42.0635
[2021-03-01 15:54:31,590] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7768    0.9961    0.0395    0.8729    0.1983    0.0431       255
          2     0.7500    0.0395    0.9961    0.0750    0.1983    0.0356        76

avg / total     0.7706    0.7764    0.2591    0.6897    0.1983    0.0414       331

Covid class AUC=0.5894736842105263
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.7777781873136 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.7777781873136 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00006: valid_acc_1 reached 77.77778 (best 77.77778), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=6-valid_acc_1=77.78.ckpt as top 1
INFO:lightning:
Epoch 00006: valid_acc_1 reached 77.77778 (best 77.77778), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=6-valid_acc_1=77.78.ckpt as top 1
[2021-03-01 15:54:33,757] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5271  train_acc_1 77.4202
[2021-03-01 15:54:33,757] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5401  valid_acc_1 77.7778
[2021-03-01 15:54:33,757] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:54:33,763] default_module.py->log_info line:141 [INFO]lr=9.8796e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:55:35,835] default_module.py->log_info line:141 [INFO]Train Epoch 7/100 step 0/87 train_loss 0.7756  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 15:57:49,076] default_module.py->log_info line:141 [INFO]Valid Epoch 7/100 step 100/37 valid_loss 0.8664  valid_acc_1 42.0635
[2021-03-01 15:57:53,186] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7768    0.9961    0.0395    0.8729    0.1983    0.0431       255
          2     0.7500    0.0395    0.9961    0.0750    0.1983    0.0356        76

avg / total     0.7706    0.7764    0.2591    0.6897    0.1983    0.0414       331

Covid class AUC=0.6054179566563467
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.7777781873136 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.7777781873136 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00007: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00007: valid_acc_1  was not in top 1
[2021-03-01 15:57:53,327] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5289  train_acc_1 76.9349
[2021-03-01 15:57:53,328] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5368  valid_acc_1 77.7778
[2021-03-01 15:57:53,328] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 15:57:53,352] default_module.py->log_info line:141 [INFO]lr=9.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 15:58:45,730] default_module.py->log_info line:141 [INFO]Train Epoch 8/100 step 0/87 train_loss 0.3131  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:00:40,556] default_module.py->log_info line:141 [INFO]Valid Epoch 8/100 step 100/37 valid_loss 0.9284  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:00:44,419] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6011351909184726
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00008: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00008: valid_acc_1  was not in top 1
[2021-03-01 16:00:45,045] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5323  train_acc_1 76.0153
[2021-03-01 16:00:45,045] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5294  valid_acc_1 77.1772
[2021-03-01 16:00:45,045] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:00:45,052] default_module.py->log_info line:141 [INFO]lr=9.8015e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:01:17,304] default_module.py->log_info line:141 [INFO]Train Epoch 9/100 step 0/87 train_loss 0.8499  train_acc_1 44.4444
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:03:21,504] default_module.py->log_info line:141 [INFO]Valid Epoch 9/100 step 100/37 valid_loss 0.6966  valid_acc_1 52.3810
[2021-03-01 16:03:25,795] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7971    0.6471    0.4474    0.7143    0.5380    0.2953       255
          2     0.2742    0.4474    0.6471    0.3400    0.5380    0.2837        76

avg / total     0.6770    0.6012    0.4932    0.6283    0.5380    0.2926       331

Covid class AUC=0.5920536635706914
ACC=0.6012084592145015
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 60.18876106674607 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 60.18876106674607 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00009: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00009: valid_acc_1  was not in top 1
[2021-03-01 16:03:25,940] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5240  train_acc_1 76.7816
[2021-03-01 16:03:25,940] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6545  valid_acc_1 60.1888
[2021-03-01 16:03:25,940] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:03:25,948] default_module.py->log_info line:141 [INFO]lr=9.7553e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:04:02,788] default_module.py->log_info line:141 [INFO]Train Epoch 10/100 step 0/87 train_loss 0.4943  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:05:54,912] default_module.py->log_info line:141 [INFO]Valid Epoch 10/100 step 100/37 valid_loss 0.9181  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:05:57,881] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5862745098039215
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00010: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00010: valid_acc_1  was not in top 1
[2021-03-01 16:06:00,104] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5312  train_acc_1 76.5262
[2021-03-01 16:06:00,104] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5290  valid_acc_1 77.1772
[2021-03-01 16:06:00,104] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:06:00,111] default_module.py->log_info line:141 [INFO]lr=9.7044e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:06:52,589] default_module.py->log_info line:141 [INFO]Train Epoch 11/100 step 0/87 train_loss 0.2687  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:08:30,678] default_module.py->log_info line:141 [INFO]Valid Epoch 11/100 step 100/37 valid_loss 1.0643  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:08:34,275] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5742002063983488
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00011: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00011: valid_acc_1  was not in top 1
[2021-03-01 16:08:36,153] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5210  train_acc_1 77.2925
[2021-03-01 16:08:36,154] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5617  valid_acc_1 77.1772
[2021-03-01 16:08:36,154] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:08:36,185] default_module.py->log_info line:141 [INFO]lr=9.6489e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:09:34,056] default_module.py->log_info line:141 [INFO]Train Epoch 12/100 step 0/87 train_loss 0.2680  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:11:53,776] default_module.py->log_info line:141 [INFO]Valid Epoch 12/100 step 100/37 valid_loss 0.8961  valid_acc_1 40.4762
[2021-03-01 16:11:57,512] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7727    1.0000    0.0132    0.8718    0.1147    0.0145       255
          2     1.0000    0.0132    1.0000    0.0260    0.1147    0.0119        76

avg / total     0.8249    0.7734    0.2397    0.6776    0.1147    0.0139       331

Covid class AUC=0.6115067079463364
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747774381895 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747774381895 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00012: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00012: valid_acc_1  was not in top 1
[2021-03-01 16:11:58,476] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5270  train_acc_1 77.2669
[2021-03-01 16:11:58,476] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5282  valid_acc_1 77.4775
[2021-03-01 16:11:58,477] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:11:58,485] default_module.py->log_info line:141 [INFO]lr=9.5888e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:12:36,348] default_module.py->log_info line:141 [INFO]Train Epoch 13/100 step 0/87 train_loss 0.6942  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:14:26,146] default_module.py->log_info line:141 [INFO]Valid Epoch 13/100 step 100/37 valid_loss 0.9080  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:14:30,540] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5719814241486069
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00013: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00013: valid_acc_1  was not in top 1
[2021-03-01 16:14:31,343] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5146  train_acc_1 77.0115
[2021-03-01 16:14:31,343] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5349  valid_acc_1 77.1772
[2021-03-01 16:14:31,343] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:14:31,351] default_module.py->log_info line:141 [INFO]lr=9.5241e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:15:01,843] default_module.py->log_info line:141 [INFO]Train Epoch 14/100 step 0/87 train_loss 1.0562  train_acc_1 33.3333
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:16:50,327] default_module.py->log_info line:141 [INFO]Valid Epoch 14/100 step 100/37 valid_loss 0.9462  valid_acc_1 42.0635
[2021-03-01 16:16:54,215] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7768    0.9961    0.0395    0.8729    0.1983    0.0431       255
          2     0.7500    0.0395    0.9961    0.0750    0.1983    0.0356        76

avg / total     0.7706    0.7764    0.2591    0.6897    0.1983    0.0414       331

Covid class AUC=0.6041279669762641
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.7777781873136 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.7777781873136 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00014: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00014: valid_acc_1  was not in top 1
[2021-03-01 16:16:54,541] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5133  train_acc_1 77.5479
[2021-03-01 16:16:54,541] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5219  valid_acc_1 77.7778
[2021-03-01 16:16:54,542] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:16:54,549] default_module.py->log_info line:141 [INFO]lr=9.4550e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:17:39,495] default_module.py->log_info line:141 [INFO]Train Epoch 15/100 step 0/87 train_loss 0.5642  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:19:25,040] default_module.py->log_info line:141 [INFO]Valid Epoch 15/100 step 100/37 valid_loss 0.8347  valid_acc_1 43.6508
[2021-03-01 16:19:29,627] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7799    0.9725    0.0789    0.8656    0.2771    0.0836       255
          2     0.4615    0.0789    0.9725    0.1348    0.2771    0.0699        76

avg / total     0.7068    0.7674    0.2841    0.6978    0.2771    0.0805       331

Covid class AUC=0.6028379772961817
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.87687781050398 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.87687781050398 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00015: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00015: valid_acc_1  was not in top 1
[2021-03-01 16:19:29,805] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5099  train_acc_1 76.8327
[2021-03-01 16:19:29,806] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5466  valid_acc_1 76.8769
[2021-03-01 16:19:29,806] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:19:29,813] default_module.py->log_info line:141 [INFO]lr=9.3815e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:20:39,436] default_module.py->log_info line:141 [INFO]Train Epoch 16/100 step 0/87 train_loss 0.4607  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:22:42,097] default_module.py->log_info line:141 [INFO]Valid Epoch 16/100 step 100/37 valid_loss 0.9127  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:22:45,577] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5723942208462331
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00016: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00016: valid_acc_1  was not in top 1
[2021-03-01 16:22:47,588] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5128  train_acc_1 76.2963
[2021-03-01 16:22:47,588] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5193  valid_acc_1 77.1772
[2021-03-01 16:22:47,588] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:22:47,597] default_module.py->log_info line:141 [INFO]lr=9.3037e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:23:42,295] default_module.py->log_info line:141 [INFO]Train Epoch 17/100 step 0/87 train_loss 0.6345  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:25:24,501] default_module.py->log_info line:141 [INFO]Valid Epoch 17/100 step 100/37 valid_loss 0.9985  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:25:28,480] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.4417956656346749
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00017: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00017: valid_acc_1  was not in top 1
[2021-03-01 16:25:28,876] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5256  train_acc_1 76.8327
[2021-03-01 16:25:28,876] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5469  valid_acc_1 77.1772
[2021-03-01 16:25:28,876] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:25:28,889] default_module.py->log_info line:141 [INFO]lr=9.2216e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:26:15,399] default_module.py->log_info line:141 [INFO]Train Epoch 18/100 step 0/87 train_loss 0.4780  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:27:45,066] default_module.py->log_info line:141 [INFO]Valid Epoch 18/100 step 100/37 valid_loss 1.0010  valid_acc_1 46.8254
[2021-03-01 16:27:49,102] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7945    0.9098    0.2105    0.8483    0.4377    0.2049       255
          2     0.4103    0.2105    0.9098    0.2783    0.4377    0.1781        76

avg / total     0.7063    0.7492    0.3711    0.7174    0.4377    0.1988       331

Covid class AUC=0.6449432404540765
ACC=0.7492447129909365
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.07507646406019 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.07507646406019 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00018: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00018: valid_acc_1  was not in top 1
[2021-03-01 16:27:50,741] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5295  train_acc_1 77.4457
[2021-03-01 16:27:50,741] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5311  valid_acc_1 75.0751
[2021-03-01 16:27:50,741] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:27:50,749] default_module.py->log_info line:141 [INFO]lr=9.1354e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:28:41,550] default_module.py->log_info line:141 [INFO]Train Epoch 19/100 step 0/87 train_loss 0.3702  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:30:40,026] default_module.py->log_info line:141 [INFO]Valid Epoch 19/100 step 100/37 valid_loss 0.9169  valid_acc_1 44.4444
[2021-03-01 16:30:44,093] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7907    0.9333    0.1711    0.8561    0.3996    0.1718       255
          2     0.4333    0.1711    0.9333    0.2453    0.3996    0.1475        76

avg / total     0.7086    0.7583    0.3461    0.7159    0.3996    0.1662       331

Covid class AUC=0.6281733746130032
ACC=0.7583081570996979
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.97597733059445 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.97597733059445 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00019: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00019: valid_acc_1  was not in top 1
[2021-03-01 16:30:44,236] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5116  train_acc_1 77.6756
[2021-03-01 16:30:44,237] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5210  valid_acc_1 75.9760
[2021-03-01 16:30:44,237] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:30:44,243] default_module.py->log_info line:141 [INFO]lr=9.0451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:31:55,295] default_module.py->log_info line:141 [INFO]Train Epoch 20/100 step 0/87 train_loss 0.3796  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:33:34,072] default_module.py->log_info line:141 [INFO]Valid Epoch 20/100 step 100/37 valid_loss 1.0523  valid_acc_1 39.6825
[2021-03-01 16:33:38,389] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7697    0.9961    0.0000    0.8684    0.0000    0.0000       255
          2     0.0000    0.0000    0.9961    0.0000    0.0000    0.0000        76

avg / total     0.5930    0.7674    0.2287    0.6690    0.0000    0.0000       331

Covid class AUC=0.6319917440660474
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.87687724345439 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.87687724345439 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00020: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00020: valid_acc_1  was not in top 1
[2021-03-01 16:33:40,129] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5146  train_acc_1 76.7816
[2021-03-01 16:33:40,130] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5209  valid_acc_1 76.8769
[2021-03-01 16:33:40,131] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:33:40,141] default_module.py->log_info line:141 [INFO]lr=8.9508e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:34:50,672] default_module.py->log_info line:141 [INFO]Train Epoch 21/100 step 0/87 train_loss 0.5978  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:36:33,578] default_module.py->log_info line:141 [INFO]Valid Epoch 21/100 step 100/37 valid_loss 1.0582  valid_acc_1 42.8571
[2021-03-01 16:36:37,184] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7795    0.9843    0.0658    0.8700    0.2545    0.0707       255
          2     0.5556    0.0658    0.9843    0.1176    0.2545    0.0588        76

avg / total     0.7281    0.7734    0.2767    0.6973    0.2545    0.0680       331

Covid class AUC=0.6460784313725491
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747818199363 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747818199363 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00021: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00021: valid_acc_1  was not in top 1
[2021-03-01 16:36:37,771] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5065  train_acc_1 77.1392
[2021-03-01 16:36:37,771] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5222  valid_acc_1 77.4775
[2021-03-01 16:36:37,772] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:36:37,779] default_module.py->log_info line:141 [INFO]lr=8.8526e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:37:35,111] default_module.py->log_info line:141 [INFO]Train Epoch 22/100 step 0/87 train_loss 0.4533  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:39:23,581] default_module.py->log_info line:141 [INFO]Valid Epoch 22/100 step 100/37 valid_loss 1.0393  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:39:27,562] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6226522187822497
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00022: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00022: valid_acc_1  was not in top 1
[2021-03-01 16:39:27,799] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5151  train_acc_1 77.1392
[2021-03-01 16:39:27,799] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5251  valid_acc_1 77.1772
[2021-03-01 16:39:27,800] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:39:27,807] default_module.py->log_info line:141 [INFO]lr=8.7506e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:40:20,676] default_module.py->log_info line:141 [INFO]Train Epoch 23/100 step 0/87 train_loss 0.4368  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:42:00,784] default_module.py->log_info line:141 [INFO]Valid Epoch 23/100 step 100/37 valid_loss 1.3479  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:42:04,579] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6132094943240454
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00023: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00023: valid_acc_1  was not in top 1
[2021-03-01 16:42:04,695] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5176  train_acc_1 76.7561
[2021-03-01 16:42:04,695] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5807  valid_acc_1 77.1772
[2021-03-01 16:42:04,695] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:42:04,701] default_module.py->log_info line:141 [INFO]lr=8.6448e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:43:20,836] default_module.py->log_info line:141 [INFO]Train Epoch 24/100 step 0/87 train_loss 0.3539  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:45:44,248] default_module.py->log_info line:141 [INFO]Valid Epoch 24/100 step 100/37 valid_loss 0.9665  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:45:48,142] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.5996388028895769
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00024: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00024: valid_acc_1  was not in top 1
[2021-03-01 16:45:49,243] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5101  train_acc_1 77.0626
[2021-03-01 16:45:49,244] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5249  valid_acc_1 77.1772
[2021-03-01 16:45:49,244] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:45:49,251] default_module.py->log_info line:141 [INFO]lr=8.5355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:46:28,336] default_module.py->log_info line:141 [INFO]Train Epoch 25/100 step 0/87 train_loss 0.4931  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:48:32,084] default_module.py->log_info line:141 [INFO]Valid Epoch 25/100 step 100/37 valid_loss 0.8091  valid_acc_1 50.0000
[2021-03-01 16:48:36,270] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7962    0.6588    0.4342    0.7210    0.5349    0.2925       255
          2     0.2750    0.4342    0.6588    0.3367    0.5349    0.2796        76

avg / total     0.6765    0.6073    0.4858    0.6328    0.5349    0.2895       331

Covid class AUC=0.525077399380805
ACC=0.6072507552870091
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 60.87516135138434 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 60.87516135138434 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00025: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00025: valid_acc_1  was not in top 1
[2021-03-01 16:48:36,606] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5191  train_acc_1 76.3218
[2021-03-01 16:48:36,607] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6550  valid_acc_1 60.8752
[2021-03-01 16:48:36,607] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:48:36,614] default_module.py->log_info line:141 [INFO]lr=8.4227e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:49:04,632] default_module.py->log_info line:141 [INFO]Train Epoch 26/100 step 0/87 train_loss 0.9275  train_acc_1 44.4444
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:51:08,389] default_module.py->log_info line:141 [INFO]Valid Epoch 26/100 step 100/37 valid_loss 1.0227  valid_acc_1 43.6508
[2021-03-01 16:51:11,661] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7846    0.9569    0.1184    0.8622    0.3366    0.1228       255
          2     0.4500    0.1184    0.9569    0.1875    0.3366    0.1038        76

avg / total     0.7077    0.7644    0.3109    0.7073    0.3366    0.1185       331

Covid class AUC=0.6412796697626418
ACC=0.7643504531722054
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.57657759898417 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.57657759898417 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00026: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00026: valid_acc_1  was not in top 1
Epoch 00027: early stopping
INFO:lightning:Epoch 00027: early stopping
[2021-03-01 16:51:13,726] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5044  train_acc_1 77.9566
[2021-03-01 16:51:13,726] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5268  valid_acc_1 76.5766
[2021-03-01 16:51:13,726] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:51:13,731] default_module.py->log_info line:141 [INFO]lr=8.3066e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:51:59,305] default_module.py->log_info line:141 [INFO]Train Epoch 27/100 step 0/87 train_loss 0.3350  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:53:43,815] default_module.py->log_info line:141 [INFO]Valid Epoch 27/100 step 100/37 valid_loss 1.2182  valid_acc_1 41.2698
[2021-03-01 16:53:47,741] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7744    0.9961    0.0263    0.8714    0.1619    0.0288       255
          2     0.6667    0.0263    0.9961    0.0506    0.1619    0.0237        76

avg / total     0.7497    0.7734    0.2490    0.6829    0.1619    0.0276       331

Covid class AUC=0.6350877192982456
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747787269387 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747787269387 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00027: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00027: valid_acc_1  was not in top 1
Epoch 00028: early stopping
INFO:lightning:Epoch 00028: early stopping
[2021-03-01 16:53:48,583] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5044  train_acc_1 77.3946
[2021-03-01 16:53:48,583] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5498  valid_acc_1 77.4775
[2021-03-01 16:53:48,583] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:53:48,592] default_module.py->log_info line:141 [INFO]lr=8.1871e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:54:43,588] default_module.py->log_info line:141 [INFO]Train Epoch 28/100 step 0/87 train_loss 0.5579  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:56:54,208] default_module.py->log_info line:141 [INFO]Valid Epoch 28/100 step 100/37 valid_loss 1.0849  valid_acc_1 44.4444
[2021-03-01 16:56:57,763] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7844    0.9843    0.0921    0.8730    0.3011    0.0987       255
          2     0.6364    0.0921    0.9843    0.1609    0.3011    0.0826        76

avg / total     0.7504    0.7795    0.2970    0.7095    0.3011    0.0950       331

Covid class AUC=0.6454592363261092
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.07807888855805 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.07807888855805 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00028: valid_acc_1 reached 78.07808 (best 78.07808), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=28-valid_acc_1=78.08.ckpt as top 1
INFO:lightning:
Epoch 00028: valid_acc_1 reached 78.07808 (best 78.07808), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=28-valid_acc_1=78.08.ckpt as top 1
[2021-03-01 16:57:00,433] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5084  train_acc_1 76.6794
[2021-03-01 16:57:00,433] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5303  valid_acc_1 78.0781
[2021-03-01 16:57:00,433] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:57:00,437] default_module.py->log_info line:141 [INFO]lr=8.0645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 16:57:46,036] default_module.py->log_info line:141 [INFO]Train Epoch 29/100 step 0/87 train_loss 0.5259  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 16:59:36,818] default_module.py->log_info line:141 [INFO]Valid Epoch 29/100 step 100/37 valid_loss 1.1446  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 16:59:41,027] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6801857585139318
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00029: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00029: valid_acc_1  was not in top 1
[2021-03-01 16:59:41,581] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5155  train_acc_1 76.4240
[2021-03-01 16:59:41,582] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5280  valid_acc_1 77.1772
[2021-03-01 16:59:41,582] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 16:59:41,590] default_module.py->log_info line:141 [INFO]lr=7.9389e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:00:14,787] default_module.py->log_info line:141 [INFO]Train Epoch 30/100 step 0/87 train_loss 0.7531  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:02:21,932] default_module.py->log_info line:141 [INFO]Valid Epoch 30/100 step 100/37 valid_loss 0.8882  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:02:26,487] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6369453044375646
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00030: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00030: valid_acc_1  was not in top 1
[2021-03-01 17:02:26,608] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5063  train_acc_1 76.7561
[2021-03-01 17:02:26,608] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5127  valid_acc_1 77.1772
[2021-03-01 17:02:26,608] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:02:26,615] default_module.py->log_info line:141 [INFO]lr=7.8104e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:03:15,122] default_module.py->log_info line:141 [INFO]Train Epoch 31/100 step 0/87 train_loss 0.2621  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:05:16,855] default_module.py->log_info line:141 [INFO]Valid Epoch 31/100 step 100/37 valid_loss 0.9021  valid_acc_1 46.8254
[2021-03-01 17:05:20,457] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7902    0.8863    0.2105    0.8355    0.4320    0.1992       255
          2     0.3556    0.2105    0.8863    0.2645    0.4320    0.1740        76

avg / total     0.6904    0.7311    0.3657    0.7044    0.4320    0.1934       331

Covid class AUC=0.5793085655314758
ACC=0.7311178247734139
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 73.18747481784305 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 73.18747481784305 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00031: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00031: valid_acc_1  was not in top 1
[2021-03-01 17:05:21,739] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4944  train_acc_1 77.2158
[2021-03-01 17:05:21,739] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5515  valid_acc_1 73.1875
[2021-03-01 17:05:21,739] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:05:21,746] default_module.py->log_info line:141 [INFO]lr=7.6791e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:06:15,501] default_module.py->log_info line:141 [INFO]Train Epoch 32/100 step 0/87 train_loss 0.3847  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:08:18,632] default_module.py->log_info line:141 [INFO]Valid Epoch 32/100 step 100/37 valid_loss 0.8318  valid_acc_1 44.4444
[2021-03-01 17:08:22,697] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7857    0.9922    0.0921    0.8769    0.3023    0.0996       255
          2     0.7778    0.0921    0.9922    0.1647    0.3023    0.0832        76

avg / total     0.7839    0.7855    0.2988    0.7134    0.3023    0.0958       331

Covid class AUC=0.6358617131062952
ACC=0.7854984894259819
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.6786792600477 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.6786792600477 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00032: valid_acc_1 reached 78.67868 (best 78.67868), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=32-valid_acc_1=78.68.ckpt as top 1
INFO:lightning:
Epoch 00032: valid_acc_1 reached 78.67868 (best 78.67868), saving model to ./output/mosmeddata_r3d_18_bs9_s64/version_1/checkpoints/epoch=32-valid_acc_1=78.68.ckpt as top 1
[2021-03-01 17:08:27,546] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4892  train_acc_1 78.1609
[2021-03-01 17:08:27,562] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5164  valid_acc_1 78.6787
[2021-03-01 17:08:27,562] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:08:27,570] default_module.py->log_info line:141 [INFO]lr=7.5452e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:09:02,399] default_module.py->log_info line:141 [INFO]Train Epoch 33/100 step 0/87 train_loss 0.2889  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:11:10,375] default_module.py->log_info line:141 [INFO]Valid Epoch 33/100 step 100/37 valid_loss 1.3385  valid_acc_1 40.4762
[2021-03-01 17:11:15,024] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7737    0.9922    0.0263    0.8694    0.1616    0.0286       255
          2     0.5000    0.0263    0.9922    0.0500    0.1616    0.0236        76

avg / total     0.7109    0.7704    0.2481    0.6813    0.1616    0.0275       331

Covid class AUC=0.6736842105263158
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717768694904 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717768694904 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00033: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00033: valid_acc_1  was not in top 1
[2021-03-01 17:11:15,208] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4967  train_acc_1 77.6756
[2021-03-01 17:11:15,209] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5732  valid_acc_1 77.1772
[2021-03-01 17:11:15,209] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:11:15,216] default_module.py->log_info line:141 [INFO]lr=7.4088e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:11:58,842] default_module.py->log_info line:141 [INFO]Train Epoch 34/100 step 0/87 train_loss 0.3456  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:14:07,854] default_module.py->log_info line:141 [INFO]Valid Epoch 34/100 step 100/37 valid_loss 1.2201  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:14:11,755] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6437048503611972
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00034: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00034: valid_acc_1  was not in top 1
[2021-03-01 17:14:13,578] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5022  train_acc_1 77.3180
[2021-03-01 17:14:13,579] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5472  valid_acc_1 77.1772
[2021-03-01 17:14:13,579] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:14:13,586] default_module.py->log_info line:141 [INFO]lr=7.2700e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:15:06,594] default_module.py->log_info line:141 [INFO]Train Epoch 35/100 step 0/87 train_loss 0.5086  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:17:06,329] default_module.py->log_info line:141 [INFO]Valid Epoch 35/100 step 100/37 valid_loss 0.8663  valid_acc_1 42.8571
[2021-03-01 17:17:10,218] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7812    0.9804    0.0789    0.8696    0.2782    0.0844       255
          2     0.5455    0.0789    0.9804    0.1379    0.2782    0.0704        76

avg / total     0.7271    0.7734    0.2859    0.7016    0.2782    0.0812       331

Covid class AUC=0.6537151702786378
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747818199363 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747818199363 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00035: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00035: valid_acc_1  was not in top 1
[2021-03-01 17:17:10,519] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5048  train_acc_1 77.1903
[2021-03-01 17:17:10,519] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5118  valid_acc_1 77.4775
[2021-03-01 17:17:10,520] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:17:10,527] default_module.py->log_info line:141 [INFO]lr=7.1289e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:17:52,291] default_module.py->log_info line:141 [INFO]Train Epoch 36/100 step 0/87 train_loss 0.5269  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:19:44,242] default_module.py->log_info line:141 [INFO]Valid Epoch 36/100 step 100/37 valid_loss 0.7426  valid_acc_1 46.8254
[2021-03-01 17:19:48,269] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7905    0.9765    0.1316    0.8737    0.3584    0.1393       255
          2     0.6250    0.1316    0.9765    0.2174    0.3584    0.1176        76

avg / total     0.7525    0.7825    0.3256    0.7230    0.3584    0.1344       331

Covid class AUC=0.6638286893704851
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.3783794609276 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.3783794609276 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00036: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00036: valid_acc_1  was not in top 1
[2021-03-01 17:19:49,104] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4975  train_acc_1 77.2669
[2021-03-01 17:19:49,104] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5499  valid_acc_1 78.3784
[2021-03-01 17:19:49,104] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:19:49,110] default_module.py->log_info line:141 [INFO]lr=6.9857e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:20:22,083] default_module.py->log_info line:141 [INFO]Train Epoch 37/100 step 0/87 train_loss 0.4640  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:22:24,380] default_module.py->log_info line:141 [INFO]Valid Epoch 37/100 step 100/37 valid_loss 1.0629  valid_acc_1 45.2381
[2021-03-01 17:22:28,667] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7876    0.9451    0.1447    0.8592    0.3699    0.1477       255
          2     0.4400    0.1447    0.9451    0.2178    0.3699    0.1258        76

avg / total     0.7078    0.7613    0.3285    0.7119    0.3699    0.1427       331

Covid class AUC=0.6277605779153766
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.19047729389088 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.19047729389088 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00037: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00037: valid_acc_1  was not in top 1
[2021-03-01 17:22:28,852] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4868  train_acc_1 76.9093
[2021-03-01 17:22:28,852] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5485  valid_acc_1 76.1905
[2021-03-01 17:22:28,852] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:22:28,858] default_module.py->log_info line:141 [INFO]lr=6.8406e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:23:22,490] default_module.py->log_info line:141 [INFO]Train Epoch 38/100 step 0/87 train_loss 0.4923  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:25:07,271] default_module.py->log_info line:141 [INFO]Valid Epoch 38/100 step 100/37 valid_loss 1.1387  valid_acc_1 39.6825
/home/comp/shwang/py36/lib/python3.6/site-packages/sklearn/metrics/_classification.py:1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[2021-03-01 17:25:11,315] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7704    1.0000    0.0000    0.8703    0.0000    0.0000       255
          2     0.0000    0.0000    1.0000    0.0000    0.0000    0.0000        76

avg / total     0.5935    0.7704    0.2296    0.6705    0.0000    0.0000       331

Covid class AUC=0.6528379772961816
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717742919922 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717742919922 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00038: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00038: valid_acc_1  was not in top 1
[2021-03-01 17:25:11,899] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.5002  train_acc_1 77.1903
[2021-03-01 17:25:11,899] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5275  valid_acc_1 77.1772
[2021-03-01 17:25:11,899] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:25:11,908] default_module.py->log_info line:141 [INFO]lr=6.6937e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:26:08,608] default_module.py->log_info line:141 [INFO]Train Epoch 39/100 step 0/87 train_loss 0.4072  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:28:18,917] default_module.py->log_info line:141 [INFO]Valid Epoch 39/100 step 100/37 valid_loss 0.9348  valid_acc_1 46.0317
[2021-03-01 17:28:22,807] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7900    0.9294    0.1711    0.8541    0.3987    0.1710       255
          2     0.4194    0.1711    0.9294    0.2430    0.3987    0.1469        76

avg / total     0.7049    0.7553    0.3452    0.7137    0.3987    0.1655       331

Covid class AUC=0.6739938080495355
ACC=0.7552870090634441
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.67567711907463 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.67567711907463 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00039: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00039: valid_acc_1  was not in top 1
[2021-03-01 17:28:23,563] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4846  train_acc_1 78.0587
[2021-03-01 17:28:23,563] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5136  valid_acc_1 75.6757
[2021-03-01 17:28:23,564] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:28:23,571] default_module.py->log_info line:141 [INFO]lr=6.5451e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:29:07,445] default_module.py->log_info line:141 [INFO]Train Epoch 40/100 step 0/87 train_loss 0.6497  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:30:56,058] default_module.py->log_info line:141 [INFO]Valid Epoch 40/100 step 100/37 valid_loss 0.8769  valid_acc_1 46.0317
[2021-03-01 17:30:59,523] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7939    0.9216    0.1974    0.8530    0.4265    0.1951       255
          2     0.4286    0.1974    0.9216    0.2703    0.4265    0.1687        76

avg / total     0.7100    0.7553    0.3637    0.7192    0.4265    0.1890       331

Covid class AUC=0.663828689370485
ACC=0.7552870090634441
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.58987692240122 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.58987692240122 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00040: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00040: valid_acc_1  was not in top 1
[2021-03-01 17:31:01,944] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4893  train_acc_1 78.0587
[2021-03-01 17:31:01,944] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5169  valid_acc_1 75.5899
[2021-03-01 17:31:01,944] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:31:01,952] default_module.py->log_info line:141 [INFO]lr=6.3950e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:31:29,680] default_module.py->log_info line:141 [INFO]Train Epoch 41/100 step 0/87 train_loss 0.7892  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:32:33,679] default_module.py->log_info line:141 [INFO]Valid Epoch 41/100 step 100/37 valid_loss 1.2794  valid_acc_1 40.4762
[2021-03-01 17:32:37,259] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7720    0.9961    0.0132    0.8699    0.1145    0.0144       255
          2     0.5000    0.0132    0.9961    0.0256    0.1145    0.0118        76

avg / total     0.7096    0.7704    0.2388    0.6760    0.1145    0.0138       331

Covid class AUC=0.6536119711042312
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717755807412 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717755807412 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00041: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00041: valid_acc_1  was not in top 1
[2021-03-01 17:32:37,443] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4743  train_acc_1 78.4419
[2021-03-01 17:32:37,443] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5547  valid_acc_1 77.1772
[2021-03-01 17:32:37,443] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:32:37,450] default_module.py->log_info line:141 [INFO]lr=6.2434e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:32:57,004] default_module.py->log_info line:141 [INFO]Train Epoch 42/100 step 0/87 train_loss 0.2798  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:34:02,117] default_module.py->log_info line:141 [INFO]Valid Epoch 42/100 step 100/37 valid_loss 1.2691  valid_acc_1 42.8571
[2021-03-01 17:34:05,830] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7791    0.9961    0.0526    0.8744    0.2290    0.0574       255
          2     0.8000    0.0526    0.9961    0.0988    0.2290    0.0475        76

avg / total     0.7839    0.7795    0.2693    0.6963    0.2290    0.0551       331

Covid class AUC=0.6910732714138287
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.07807850193333 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.07807850193333 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00042: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00042: valid_acc_1  was not in top 1
[2021-03-01 17:34:06,032] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4777  train_acc_1 78.9527
[2021-03-01 17:34:06,032] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5502  valid_acc_1 78.0781
[2021-03-01 17:34:06,032] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:34:06,041] default_module.py->log_info line:141 [INFO]lr=6.0907e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:34:25,283] default_module.py->log_info line:141 [INFO]Train Epoch 43/100 step 0/87 train_loss 0.2155  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:35:32,815] default_module.py->log_info line:141 [INFO]Valid Epoch 43/100 step 100/37 valid_loss 1.0107  valid_acc_1 42.8571
[2021-03-01 17:35:35,973] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7819    0.9843    0.0789    0.8715    0.2788    0.0847       255
          2     0.6000    0.0789    0.9843    0.1395    0.2788    0.0707        76

avg / total     0.7402    0.7764    0.2868    0.7035    0.2788    0.0815       331

Covid class AUC=0.6787409700722394
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777836773846 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777836773846 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00043: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00043: valid_acc_1  was not in top 1
[2021-03-01 17:35:36,208] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4860  train_acc_1 77.2925
[2021-03-01 17:35:36,208] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5042  valid_acc_1 77.7778
[2021-03-01 17:35:36,208] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:35:36,215] default_module.py->log_info line:141 [INFO]lr=5.9369e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:36:09,712] default_module.py->log_info line:141 [INFO]Train Epoch 44/100 step 0/87 train_loss 0.4137  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:37:59,539] default_module.py->log_info line:141 [INFO]Valid Epoch 44/100 step 100/37 valid_loss 0.7706  valid_acc_1 53.1746
[2021-03-01 17:38:04,167] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8074    0.8549    0.3158    0.8305    0.5196    0.2845       255
          2     0.3934    0.3158    0.8549    0.3504    0.5196    0.2554        76

avg / total     0.7124    0.7311    0.4396    0.7202    0.5196    0.2778       331

Covid class AUC=0.6804953560371517
ACC=0.7311178247734139
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 73.1016745180697 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 73.1016745180697 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00044: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00044: valid_acc_1  was not in top 1
[2021-03-01 17:38:04,251] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4869  train_acc_1 76.5773
[2021-03-01 17:38:04,251] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5229  valid_acc_1 73.1017
[2021-03-01 17:38:04,252] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:38:04,261] default_module.py->log_info line:141 [INFO]lr=5.7822e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:38:31,965] default_module.py->log_info line:141 [INFO]Train Epoch 45/100 step 0/87 train_loss 0.3757  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:40:31,298] default_module.py->log_info line:141 [INFO]Valid Epoch 45/100 step 100/37 valid_loss 0.8265  valid_acc_1 42.8571
[2021-03-01 17:40:35,541] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7827    0.9608    0.1053    0.8627    0.3180    0.1098       255
          2     0.4444    0.1053    0.9608    0.1702    0.3180    0.0925        76

avg / total     0.7051    0.7644    0.3017    0.7037    0.3180    0.1058       331

Covid class AUC=0.6946852425180597
ACC=0.7643504531722054
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.57657767630913 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.57657767630913 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00045: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00045: valid_acc_1  was not in top 1
[2021-03-01 17:40:35,593] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4825  train_acc_1 77.5224
[2021-03-01 17:40:35,594] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4962  valid_acc_1 76.5766
[2021-03-01 17:40:35,594] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:40:35,602] default_module.py->log_info line:141 [INFO]lr=5.6267e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:41:16,378] default_module.py->log_info line:141 [INFO]Train Epoch 46/100 step 0/87 train_loss 0.2583  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:48:33,921] default_module.py->log_info line:141 [INFO]Valid Epoch 46/100 step 100/37 valid_loss 1.0988  valid_acc_1 39.6825
[2021-03-01 17:48:38,256] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7723    0.9843    0.0263    0.8655    0.1609    0.0284       255
          2     0.3333    0.0263    0.9843    0.0488    0.1609    0.0234        76

avg / total     0.6715    0.7644    0.2463    0.6780    0.1609    0.0272       331

Covid class AUC=0.6705366357069144
ACC=0.7643504531722054
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.57657710925953 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.57657710925953 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00046: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00046: valid_acc_1  was not in top 1
[2021-03-01 17:48:38,587] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4735  train_acc_1 79.3103
[2021-03-01 17:48:38,587] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5249  valid_acc_1 76.5766
[2021-03-01 17:48:38,587] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:48:38,592] default_module.py->log_info line:141 [INFO]lr=5.4705e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:49:39,740] default_module.py->log_info line:141 [INFO]Train Epoch 47/100 step 0/87 train_loss 0.3076  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:52:03,270] default_module.py->log_info line:141 [INFO]Valid Epoch 47/100 step 100/37 valid_loss 1.2179  valid_acc_1 42.0635
[2021-03-01 17:52:06,186] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7778    0.9882    0.0526    0.8705    0.2281    0.0569       255
          2     0.5714    0.0526    0.9882    0.0964    0.2281    0.0471        76

avg / total     0.7304    0.7734    0.2675    0.6927    0.2281    0.0546       331

Covid class AUC=0.6582559339525282
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747813044367 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747813044367 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00047: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00047: valid_acc_1  was not in top 1
[2021-03-01 17:52:08,086] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4758  train_acc_1 78.9783
[2021-03-01 17:52:08,086] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5476  valid_acc_1 77.4775
[2021-03-01 17:52:08,086] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:52:08,096] default_module.py->log_info line:141 [INFO]lr=5.3140e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:53:07,118] default_module.py->log_info line:141 [INFO]Train Epoch 48/100 step 0/87 train_loss 0.4902  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:55:24,268] default_module.py->log_info line:141 [INFO]Valid Epoch 48/100 step 100/37 valid_loss 1.1171  valid_acc_1 41.2698
[2021-03-01 17:55:27,938] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7764    0.9804    0.0526    0.8666    0.2272    0.0564       255
          2     0.4444    0.0526    0.9804    0.0941    0.2272    0.0468        76

avg / total     0.7002    0.7674    0.2657    0.6892    0.2272    0.0542       331

Covid class AUC=0.6640866873065016
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.87687755275417 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.87687755275417 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00048: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00048: valid_acc_1  was not in top 1
[2021-03-01 17:55:29,924] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4705  train_acc_1 77.3946
[2021-03-01 17:55:29,924] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5303  valid_acc_1 76.8769
[2021-03-01 17:55:29,924] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:55:29,931] default_module.py->log_info line:141 [INFO]lr=5.1571e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:56:38,391] default_module.py->log_info line:141 [INFO]Train Epoch 49/100 step 0/87 train_loss 0.5372  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 17:58:22,766] default_module.py->log_info line:141 [INFO]Valid Epoch 49/100 step 100/37 valid_loss 1.1552  valid_acc_1 41.2698
[2021-03-01 17:58:26,987] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7754    0.9882    0.0395    0.8690    0.1975    0.0427       255
          2     0.5000    0.0395    0.9882    0.0732    0.1975    0.0353        76

avg / total     0.7122    0.7704    0.2573    0.6862    0.1975    0.0410       331

Covid class AUC=0.6694014447884417
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717781582394 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717781582394 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00049: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00049: valid_acc_1  was not in top 1
[2021-03-01 17:58:27,315] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4719  train_acc_1 79.5658
[2021-03-01 17:58:27,315] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5315  valid_acc_1 77.1772
[2021-03-01 17:58:27,315] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 17:58:27,322] default_module.py->log_info line:141 [INFO]lr=5.0000e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 17:59:14,439] default_module.py->log_info line:141 [INFO]Train Epoch 50/100 step 0/87 train_loss 0.2699  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:01:31,033] default_module.py->log_info line:141 [INFO]Valid Epoch 50/100 step 100/37 valid_loss 1.3804  valid_acc_1 42.0635
[2021-03-01 18:01:35,531] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7785    0.9922    0.0526    0.8724    0.2285    0.0571       255
          2     0.6667    0.0526    0.9922    0.0976    0.2285    0.0473        76

avg / total     0.7528    0.7764    0.2684    0.6945    0.2285    0.0549       331

Covid class AUC=0.6614035087719299
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777823886356 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777823886356 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00050: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00050: valid_acc_1  was not in top 1
[2021-03-01 18:01:35,900] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4612  train_acc_1 79.2082
[2021-03-01 18:01:35,900] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5803  valid_acc_1 77.7778
[2021-03-01 18:01:35,900] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:01:35,906] default_module.py->log_info line:141 [INFO]lr=4.8429e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:02:56,453] default_module.py->log_info line:141 [INFO]Train Epoch 51/100 step 0/87 train_loss 0.4184  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:05:35,549] default_module.py->log_info line:141 [INFO]Valid Epoch 51/100 step 100/37 valid_loss 0.9079  valid_acc_1 42.0635
[2021-03-01 18:05:39,039] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7796    0.9569    0.0921    0.8592    0.2969    0.0958       255
          2     0.3889    0.0921    0.9569    0.1489    0.2969    0.0805        76

avg / total     0.6899    0.7583    0.2907    0.6961    0.2969    0.0923       331

Covid class AUC=0.6429824561403509
ACC=0.7583081570996979
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.89017638644657 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.89017638644657 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00051: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00051: valid_acc_1  was not in top 1
[2021-03-01 18:05:39,938] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4688  train_acc_1 78.3653
[2021-03-01 18:05:39,938] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5188  valid_acc_1 75.8902
[2021-03-01 18:05:39,939] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:05:39,947] default_module.py->log_info line:141 [INFO]lr=4.6860e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:06:55,816] default_module.py->log_info line:141 [INFO]Train Epoch 52/100 step 0/87 train_loss 0.6907  train_acc_1 55.5556
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:09:36,573] default_module.py->log_info line:141 [INFO]Valid Epoch 52/100 step 100/37 valid_loss 0.8634  valid_acc_1 46.0317
[2021-03-01 18:09:41,576] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7880    0.9765    0.1184    0.8722    0.3401    0.1256       255
          2     0.6000    0.1184    0.9765    0.1978    0.3401    0.1057        76

avg / total     0.7448    0.7795    0.3154    0.7173    0.3401    0.1210       331

Covid class AUC=0.7046955624355005
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.07807894010801 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.07807894010801 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00052: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00052: valid_acc_1  was not in top 1
Epoch 00053: early stopping
INFO:lightning:Epoch 00053: early stopping
[2021-03-01 18:09:41,949] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4732  train_acc_1 78.6973
[2021-03-01 18:09:41,950] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.4877  valid_acc_1 78.0781
[2021-03-01 18:09:41,950] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:09:41,956] default_module.py->log_info line:141 [INFO]lr=4.5295e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:10:35,947] default_module.py->log_info line:141 [INFO]Train Epoch 53/100 step 0/87 train_loss 0.3247  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:13:02,424] default_module.py->log_info line:141 [INFO]Valid Epoch 53/100 step 100/37 valid_loss 1.1302  valid_acc_1 44.4444
[2021-03-01 18:13:06,628] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7848    0.9725    0.1053    0.8687    0.3200    0.1113       255
          2     0.5333    0.1053    0.9725    0.1758    0.3200    0.0935        76

avg / total     0.7271    0.7734    0.3044    0.7096    0.3200    0.1072       331

Covid class AUC=0.6938596491228071
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167806264517 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167806264517 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00053: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00053: valid_acc_1  was not in top 1
Epoch 00054: early stopping
INFO:lightning:Epoch 00054: early stopping
[2021-03-01 18:13:08,205] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4522  train_acc_1 78.7995
[2021-03-01 18:13:08,206] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5261  valid_acc_1 77.3917
[2021-03-01 18:13:08,206] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:13:08,211] default_module.py->log_info line:141 [INFO]lr=4.3733e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:14:14,729] default_module.py->log_info line:141 [INFO]Train Epoch 54/100 step 0/87 train_loss 0.3401  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:16:42,174] default_module.py->log_info line:141 [INFO]Valid Epoch 54/100 step 100/37 valid_loss 0.9856  valid_acc_1 48.4127
[2021-03-01 18:16:46,773] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7954    0.9451    0.1842    0.8638    0.4172    0.1873       255
          2     0.5000    0.1842    0.9451    0.2692    0.4172    0.1609        76

avg / total     0.7276    0.7704    0.3589    0.7273    0.4172    0.1813       331

Covid class AUC=0.6786893704850362
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.09137795422528 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.09137795422528 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00054: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00054: valid_acc_1  was not in top 1
Epoch 00055: early stopping
INFO:lightning:Epoch 00055: early stopping
[2021-03-01 18:16:47,354] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4621  train_acc_1 79.3359
[2021-03-01 18:16:47,355] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5178  valid_acc_1 77.0914
[2021-03-01 18:16:47,355] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:16:47,361] default_module.py->log_info line:141 [INFO]lr=4.2178e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:17:40,500] default_module.py->log_info line:141 [INFO]Train Epoch 55/100 step 0/87 train_loss 0.2739  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:20:16,323] default_module.py->log_info line:141 [INFO]Valid Epoch 55/100 step 100/37 valid_loss 1.0910  valid_acc_1 44.4444
[2021-03-01 18:20:19,446] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7848    0.9725    0.1053    0.8687    0.3200    0.1113       255
          2     0.5333    0.1053    0.9725    0.1758    0.3200    0.0935        76

avg / total     0.7271    0.7734    0.3044    0.7096    0.3200    0.1072       331

Covid class AUC=0.6995356037151702
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167806264517 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167806264517 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00055: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00055: valid_acc_1  was not in top 1
Epoch 00056: early stopping
INFO:lightning:Epoch 00056: early stopping
[2021-03-01 18:20:20,235] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4490  train_acc_1 79.3359
[2021-03-01 18:20:20,236] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5157  valid_acc_1 77.3917
[2021-03-01 18:20:20,236] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:20:20,242] default_module.py->log_info line:141 [INFO]lr=4.0631e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:21:36,863] default_module.py->log_info line:141 [INFO]Train Epoch 56/100 step 0/87 train_loss 0.5054  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:24:22,482] default_module.py->log_info line:141 [INFO]Valid Epoch 56/100 step 100/37 valid_loss 1.1188  valid_acc_1 44.4444
[2021-03-01 18:24:26,851] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7837    0.9804    0.0921    0.8711    0.3005    0.0983       255
          2     0.5833    0.0921    0.9804    0.1591    0.3005    0.0823        76

avg / total     0.7377    0.7764    0.2961    0.7076    0.3005    0.0946       331

Covid class AUC=0.6959752321981423
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.69197824838999 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.69197824838999 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00056: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00056: valid_acc_1  was not in top 1
Epoch 00057: early stopping
INFO:lightning:Epoch 00057: early stopping
[2021-03-01 18:24:27,084] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4550  train_acc_1 78.5951
[2021-03-01 18:24:27,084] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5222  valid_acc_1 77.6920
[2021-03-01 18:24:27,084] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:24:27,098] default_module.py->log_info line:141 [INFO]lr=3.9093e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:25:10,352] default_module.py->log_info line:141 [INFO]Train Epoch 57/100 step 0/87 train_loss 0.6332  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:27:53,691] default_module.py->log_info line:141 [INFO]Valid Epoch 57/100 step 100/37 valid_loss 1.2278  valid_acc_1 44.4444
[2021-03-01 18:27:58,149] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7844    0.9843    0.0921    0.8730    0.3011    0.0987       255
          2     0.6364    0.0921    0.9843    0.1609    0.3011    0.0826        76

avg / total     0.7504    0.7795    0.2970    0.7095    0.3011    0.0950       331

Covid class AUC=0.6836945304437564
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.99227851145976 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.99227851145976 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00057: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00057: valid_acc_1  was not in top 1
Epoch 00058: early stopping
INFO:lightning:Epoch 00058: early stopping
[2021-03-01 18:27:58,435] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4395  train_acc_1 80.3321
[2021-03-01 18:27:58,435] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5440  valid_acc_1 77.9923
[2021-03-01 18:27:58,435] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:27:58,441] default_module.py->log_info line:141 [INFO]lr=3.7566e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:28:57,764] default_module.py->log_info line:141 [INFO]Train Epoch 58/100 step 0/87 train_loss 0.2573  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:31:23,947] default_module.py->log_info line:141 [INFO]Valid Epoch 58/100 step 100/37 valid_loss 0.8747  valid_acc_1 50.0000
[2021-03-01 18:31:28,012] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7941    0.8471    0.2632    0.8197    0.4721    0.2359       255
          2     0.3390    0.2632    0.8471    0.2963    0.4721    0.2099        76

avg / total     0.6896    0.7130    0.3972    0.6995    0.4721    0.2299       331

Covid class AUC=0.6520639834881321
ACC=0.7129909365558912
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 71.38567259504988 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 71.38567259504988 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00058: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00058: valid_acc_1  was not in top 1
Epoch 00059: early stopping
INFO:lightning:Epoch 00059: early stopping
[2021-03-01 18:31:29,004] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4460  train_acc_1 79.4891
[2021-03-01 18:31:29,004] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5407  valid_acc_1 71.3857
[2021-03-01 18:31:29,004] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:31:29,012] default_module.py->log_info line:141 [INFO]lr=3.6050e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:32:29,965] default_module.py->log_info line:141 [INFO]Train Epoch 59/100 step 0/87 train_loss 0.2954  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:34:49,182] default_module.py->log_info line:141 [INFO]Valid Epoch 59/100 step 100/37 valid_loss 1.3846  valid_acc_1 44.4444
[2021-03-01 18:34:53,279] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7840    0.9961    0.0789    0.8774    0.2804    0.0858       255
          2     0.8571    0.0789    0.9961    0.1446    0.2804    0.0714        76

avg / total     0.8008    0.7855    0.2895    0.7091    0.2804    0.0825       331

Covid class AUC=0.6732714138286894
ACC=0.7854984894259819
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.6786791311728 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.6786791311728 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00059: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00059: valid_acc_1  was not in top 1
Epoch 00060: early stopping
INFO:lightning:Epoch 00060: early stopping
[2021-03-01 18:34:54,137] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4473  train_acc_1 80.0766
[2021-03-01 18:34:54,138] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5864  valid_acc_1 78.6787
[2021-03-01 18:34:54,138] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:34:54,144] default_module.py->log_info line:141 [INFO]lr=3.4549e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:35:42,975] default_module.py->log_info line:141 [INFO]Train Epoch 60/100 step 0/87 train_loss 0.2930  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:38:27,611] default_module.py->log_info line:141 [INFO]Valid Epoch 60/100 step 100/37 valid_loss 0.8972  valid_acc_1 51.5873
[2021-03-01 18:38:32,227] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7992    0.8275    0.3026    0.8131    0.5004    0.2636       255
          2     0.3433    0.3026    0.8275    0.3217    0.5004    0.2373        76

avg / total     0.6946    0.7069    0.4231    0.7003    0.5004    0.2575       331

Covid class AUC=0.6267801857585139
ACC=0.7069486404833837
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 70.78507206891034 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 70.78507206891034 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00060: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00060: valid_acc_1  was not in top 1
Epoch 00061: early stopping
INFO:lightning:Epoch 00061: early stopping
[2021-03-01 18:38:32,444] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4325  train_acc_1 79.7190
[2021-03-01 18:38:32,444] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5623  valid_acc_1 70.7851
[2021-03-01 18:38:32,444] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:38:32,450] default_module.py->log_info line:141 [INFO]lr=3.3063e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:39:30,984] default_module.py->log_info line:141 [INFO]Train Epoch 61/100 step 0/87 train_loss 0.2385  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:42:08,898] default_module.py->log_info line:141 [INFO]Valid Epoch 61/100 step 100/37 valid_loss 0.8817  valid_acc_1 48.4127
[2021-03-01 18:42:12,976] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7952    0.9137    0.2105    0.8504    0.4386    0.2059       255
          2     0.4211    0.2105    0.9137    0.2807    0.4386    0.1788        76

avg / total     0.7093    0.7523    0.3720    0.7196    0.4386    0.1997       331

Covid class AUC=0.634984520123839
ACC=0.7522658610271903
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.28957611805684 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.28957611805684 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00061: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00061: valid_acc_1  was not in top 1
Epoch 00062: early stopping
INFO:lightning:Epoch 00062: early stopping
[2021-03-01 18:42:15,419] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4422  train_acc_1 79.2593
[2021-03-01 18:42:15,419] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5317  valid_acc_1 75.2896
[2021-03-01 18:42:15,419] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:42:15,427] default_module.py->log_info line:141 [INFO]lr=3.1594e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:43:13,646] default_module.py->log_info line:141 [INFO]Train Epoch 62/100 step 0/87 train_loss 0.2514  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:45:42,897] default_module.py->log_info line:141 [INFO]Valid Epoch 62/100 step 100/37 valid_loss 0.8778  valid_acc_1 48.4127
[2021-03-01 18:45:46,992] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8013    0.9333    0.2237    0.8623    0.4569    0.2236       255
          2     0.5000    0.2237    0.9333    0.3091    0.4569    0.1940        76

avg / total     0.7322    0.7704    0.3866    0.7353    0.4569    0.2168       331

Covid class AUC=0.6873065015479877
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.09137785112536 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.09137785112536 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00062: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00062: valid_acc_1  was not in top 1
Epoch 00063: early stopping
INFO:lightning:Epoch 00063: early stopping
[2021-03-01 18:45:47,379] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4309  train_acc_1 80.9962
[2021-03-01 18:45:47,379] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5015  valid_acc_1 77.0914
[2021-03-01 18:45:47,379] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:45:47,386] default_module.py->log_info line:141 [INFO]lr=3.0143e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:46:26,524] default_module.py->log_info line:141 [INFO]Train Epoch 63/100 step 0/87 train_loss 0.5919  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:49:12,768] default_module.py->log_info line:141 [INFO]Valid Epoch 63/100 step 100/37 valid_loss 1.1506  valid_acc_1 46.8254
[2021-03-01 18:49:17,222] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7907    0.9333    0.1711    0.8561    0.3996    0.1718       255
          2     0.4333    0.1711    0.9333    0.2453    0.3996    0.1475        76

avg / total     0.7086    0.7583    0.3461    0.7159    0.3996    0.1662       331

Covid class AUC=0.6645510835913312
ACC=0.7583081570996979
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.89017695349617 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.89017695349617 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00063: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00063: valid_acc_1  was not in top 1
Epoch 00064: early stopping
INFO:lightning:Epoch 00064: early stopping
[2021-03-01 18:49:17,395] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4135  train_acc_1 81.0983
[2021-03-01 18:49:17,395] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5619  valid_acc_1 75.8902
[2021-03-01 18:49:17,395] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:49:17,401] default_module.py->log_info line:141 [INFO]lr=2.8711e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:50:24,081] default_module.py->log_info line:141 [INFO]Train Epoch 64/100 step 0/87 train_loss 0.5388  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:52:57,391] default_module.py->log_info line:141 [INFO]Valid Epoch 64/100 step 100/37 valid_loss 0.9423  valid_acc_1 49.2064
[2021-03-01 18:53:00,292] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7938    0.9059    0.2105    0.8462    0.4367    0.2040       255
          2     0.4000    0.2105    0.9059    0.2759    0.4367    0.1775        76

avg / total     0.7034    0.7462    0.3702    0.7152    0.4367    0.1979       331

Covid class AUC=0.6637770897832818
ACC=0.7462235649546828
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 74.68897556614232 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 74.68897556614232 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00064: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00064: valid_acc_1  was not in top 1
Epoch 00065: early stopping
INFO:lightning:Epoch 00065: early stopping
[2021-03-01 18:53:01,095] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4371  train_acc_1 79.7190
[2021-03-01 18:53:01,095] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5291  valid_acc_1 74.6890
[2021-03-01 18:53:01,096] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:53:01,102] default_module.py->log_info line:141 [INFO]lr=2.7300e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:53:49,852] default_module.py->log_info line:141 [INFO]Train Epoch 65/100 step 0/87 train_loss 0.3961  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 18:56:38,814] default_module.py->log_info line:141 [INFO]Valid Epoch 65/100 step 100/37 valid_loss 1.1005  valid_acc_1 46.8254
[2021-03-01 18:56:43,422] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7953    0.9294    0.1974    0.8571    0.4283    0.1969       255
          2     0.4545    0.1974    0.9294    0.2752    0.4283    0.1700        76

avg / total     0.7171    0.7613    0.3655    0.7235    0.4283    0.1907       331

Covid class AUC=0.6647058823529413
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.1904778093905 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.1904778093905 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00065: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00065: valid_acc_1  was not in top 1
Epoch 00066: early stopping
INFO:lightning:Epoch 00066: early stopping
[2021-03-01 18:56:43,683] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4114  train_acc_1 81.2261
[2021-03-01 18:56:43,683] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5479  valid_acc_1 76.1905
[2021-03-01 18:56:43,683] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 18:56:43,695] default_module.py->log_info line:141 [INFO]lr=2.5912e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 18:57:36,711] default_module.py->log_info line:141 [INFO]Train Epoch 66/100 step 0/87 train_loss 0.4535  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:00:31,951] default_module.py->log_info line:141 [INFO]Valid Epoch 66/100 step 100/37 valid_loss 1.2016  valid_acc_1 44.4444
[2021-03-01 19:00:36,276] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7834    0.9647    0.1053    0.8647    0.3187    0.1103       255
          2     0.4706    0.1053    0.9647    0.1720    0.3187    0.0928        76

avg / total     0.7116    0.7674    0.3026    0.7056    0.3187    0.1063       331

Covid class AUC=0.6686274509803921
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.79107761383057 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.79107761383057 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00066: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00066: valid_acc_1  was not in top 1
Epoch 00067: early stopping
INFO:lightning:Epoch 00067: early stopping
[2021-03-01 19:00:37,324] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4103  train_acc_1 82.1711
[2021-03-01 19:00:37,324] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5535  valid_acc_1 76.7911
[2021-03-01 19:00:37,324] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:00:37,329] default_module.py->log_info line:141 [INFO]lr=2.4548e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:01:24,658] default_module.py->log_info line:141 [INFO]Train Epoch 67/100 step 0/87 train_loss 0.4509  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:03:58,648] default_module.py->log_info line:141 [INFO]Valid Epoch 67/100 step 100/37 valid_loss 1.3097  valid_acc_1 44.4444
[2021-03-01 19:04:02,977] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7839    0.9529    0.1184    0.8602    0.3359    0.1223       255
          2     0.4286    0.1184    0.9529    0.1856    0.3359    0.1034        76

avg / total     0.7023    0.7613    0.3100    0.7053    0.3359    0.1179       331

Covid class AUC=0.6689370485036119
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.19047744854076 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.19047744854076 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00067: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00067: valid_acc_1  was not in top 1
Epoch 00068: early stopping
INFO:lightning:Epoch 00068: early stopping
[2021-03-01 19:04:03,266] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3963  train_acc_1 81.8902
[2021-03-01 19:04:03,267] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5871  valid_acc_1 76.1905
[2021-03-01 19:04:03,267] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:04:03,273] default_module.py->log_info line:141 [INFO]lr=2.3209e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:04:46,040] default_module.py->log_info line:141 [INFO]Train Epoch 68/100 step 0/87 train_loss 0.3782  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:07:30,273] default_module.py->log_info line:141 [INFO]Valid Epoch 68/100 step 100/37 valid_loss 1.3482  valid_acc_1 45.2381
[2021-03-01 19:07:35,062] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7848    0.9725    0.1053    0.8687    0.3200    0.1113       255
          2     0.5333    0.1053    0.9725    0.1758    0.3200    0.0935        76

avg / total     0.7271    0.7734    0.3044    0.7096    0.3200    0.1072       331

Covid class AUC=0.6582559339525283
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167819152007 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167819152007 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00068: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00068: valid_acc_1  was not in top 1
Epoch 00069: early stopping
INFO:lightning:Epoch 00069: early stopping
[2021-03-01 19:07:35,353] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4094  train_acc_1 82.1711
[2021-03-01 19:07:35,353] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5964  valid_acc_1 77.3917
[2021-03-01 19:07:35,353] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:07:35,369] default_module.py->log_info line:141 [INFO]lr=2.1896e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:08:54,800] default_module.py->log_info line:141 [INFO]Train Epoch 69/100 step 0/87 train_loss 0.4771  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:11:18,487] default_module.py->log_info line:141 [INFO]Valid Epoch 69/100 step 100/37 valid_loss 1.0652  valid_acc_1 50.0000
[2021-03-01 19:11:22,744] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8040    0.9490    0.2237    0.8705    0.4607    0.2277       255
          2     0.5667    0.2237    0.9490    0.3208    0.4607    0.1969        76

avg / total     0.7495    0.7825    0.3902    0.7443    0.4607    0.2206       331

Covid class AUC=0.6680598555211558
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.29257929002917 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.29257929002917 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00069: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00069: valid_acc_1  was not in top 1
Epoch 00070: early stopping
INFO:lightning:Epoch 00070: early stopping
[2021-03-01 19:11:23,804] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3950  train_acc_1 82.2478
[2021-03-01 19:11:23,805] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5301  valid_acc_1 78.2926
[2021-03-01 19:11:23,805] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:11:23,816] default_module.py->log_info line:141 [INFO]lr=2.0611e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:12:29,904] default_module.py->log_info line:141 [INFO]Train Epoch 70/100 step 0/87 train_loss 0.2384  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:14:54,517] default_module.py->log_info line:141 [INFO]Valid Epoch 70/100 step 100/37 valid_loss 1.0967  valid_acc_1 46.8254
[2021-03-01 19:14:59,089] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7890    0.9529    0.1447    0.8632    0.3714    0.1491       255
          2     0.4783    0.1447    0.9529    0.2222    0.3714    0.1268        76

avg / total     0.7176    0.7674    0.3303    0.7161    0.3714    0.1440       331

Covid class AUC=0.66656346749226
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.79107820665514 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.79107820665514 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00070: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00070: valid_acc_1  was not in top 1
Epoch 00071: early stopping
INFO:lightning:Epoch 00071: early stopping
[2021-03-01 19:14:59,373] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3832  train_acc_1 83.2950
[2021-03-01 19:14:59,374] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5392  valid_acc_1 76.7911
[2021-03-01 19:14:59,374] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:14:59,380] default_module.py->log_info line:141 [INFO]lr=1.9355e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:16:03,907] default_module.py->log_info line:141 [INFO]Train Epoch 71/100 step 0/87 train_loss 0.3911  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:18:32,745] default_module.py->log_info line:141 [INFO]Valid Epoch 71/100 step 100/37 valid_loss 1.2995  valid_acc_1 46.0317
[2021-03-01 19:18:36,795] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7885    0.9647    0.1316    0.8677    0.3563    0.1375       255
          2     0.5263    0.1316    0.9647    0.2105    0.3563    0.1164        76

avg / total     0.7283    0.7734    0.3229    0.7168    0.3563    0.1327       331

Covid class AUC=0.6585139318885449
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167790799527 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167790799527 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00071: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00071: valid_acc_1  was not in top 1
Epoch 00072: early stopping
INFO:lightning:Epoch 00072: early stopping
[2021-03-01 19:18:38,253] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4181  train_acc_1 82.5287
[2021-03-01 19:18:38,253] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5819  valid_acc_1 77.3917
[2021-03-01 19:18:38,254] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:18:38,261] default_module.py->log_info line:141 [INFO]lr=1.8129e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:19:58,757] default_module.py->log_info line:141 [INFO]Train Epoch 72/100 step 0/87 train_loss 0.2354  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:22:28,144] default_module.py->log_info line:141 [INFO]Valid Epoch 72/100 step 100/37 valid_loss 1.1430  valid_acc_1 50.7937
[2021-03-01 19:22:32,424] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8027    0.9412    0.2237    0.8664    0.4588    0.2256       255
          2     0.5312    0.2237    0.9412    0.3148    0.4588    0.1954        76

avg / total     0.7404    0.7764    0.3884    0.7398    0.4588    0.2187       331

Covid class AUC=0.6873065015479876
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.69197912473936 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.69197912473936 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00072: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00072: valid_acc_1  was not in top 1
Epoch 00073: early stopping
INFO:lightning:Epoch 00073: early stopping
[2021-03-01 19:22:32,774] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3934  train_acc_1 83.0651
[2021-03-01 19:22:32,775] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5484  valid_acc_1 77.6920
[2021-03-01 19:22:32,775] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:22:32,782] default_module.py->log_info line:141 [INFO]lr=1.6934e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:23:13,380] default_module.py->log_info line:141 [INFO]Train Epoch 73/100 step 0/87 train_loss 0.2373  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:24:37,535] default_module.py->log_info line:141 [INFO]Valid Epoch 73/100 step 100/37 valid_loss 1.2943  valid_acc_1 47.6190
[2021-03-01 19:24:40,992] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7891    0.9686    0.1316    0.8697    0.3570    0.1381       255
          2     0.5556    0.1316    0.9686    0.2128    0.3570    0.1168        76

avg / total     0.7355    0.7764    0.3238    0.7189    0.3570    0.1332       331

Covid class AUC=0.6777089783281733
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.69197871233966 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.69197871233966 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00073: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00073: valid_acc_1  was not in top 1
Epoch 00074: early stopping
INFO:lightning:Epoch 00074: early stopping
[2021-03-01 19:24:41,258] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.4002  train_acc_1 81.9157
[2021-03-01 19:24:41,259] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5771  valid_acc_1 77.6920
[2021-03-01 19:24:41,259] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:24:41,266] default_module.py->log_info line:141 [INFO]lr=1.5773e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:25:25,467] default_module.py->log_info line:141 [INFO]Train Epoch 74/100 step 0/87 train_loss 0.3587  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:27:02,415] default_module.py->log_info line:141 [INFO]Valid Epoch 74/100 step 100/37 valid_loss 1.1188  valid_acc_1 49.2063
[2021-03-01 19:27:05,636] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7965    0.8902    0.2368    0.8407    0.4592    0.2246       255
          2     0.3913    0.2368    0.8902    0.2951    0.4592    0.1971        76

avg / total     0.7035    0.7402    0.3869    0.7155    0.4592    0.2183       331

Covid class AUC=0.6772445820433437
ACC=0.7401812688821753
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 74.08837496267783 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 74.08837496267783 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00074: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00074: valid_acc_1  was not in top 1
Epoch 00075: early stopping
INFO:lightning:Epoch 00075: early stopping
[2021-03-01 19:27:05,900] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3720  train_acc_1 82.6565
[2021-03-01 19:27:05,901] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5691  valid_acc_1 74.0884
[2021-03-01 19:27:05,901] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:27:05,908] default_module.py->log_info line:141 [INFO]lr=1.4645e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:27:48,411] default_module.py->log_info line:141 [INFO]Train Epoch 75/100 step 0/87 train_loss 0.3460  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:29:07,853] default_module.py->log_info line:141 [INFO]Valid Epoch 75/100 step 100/37 valid_loss 1.0538  valid_acc_1 50.7937
[2021-03-01 19:29:10,937] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8022    0.8745    0.2763    0.8368    0.4916    0.2561       255
          2     0.3962    0.2763    0.8745    0.3256    0.4916    0.2272        76

avg / total     0.7090    0.7372    0.4137    0.7194    0.4916    0.2495       331

Covid class AUC=0.6712074303405573
ACC=0.7371601208459214
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 73.78807495735786 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 73.78807495735786 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00075: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00075: valid_acc_1  was not in top 1
Epoch 00076: early stopping
INFO:lightning:Epoch 00076: early stopping
[2021-03-01 19:29:11,047] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3775  train_acc_1 84.4444
[2021-03-01 19:29:11,048] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5691  valid_acc_1 73.7881
[2021-03-01 19:29:11,048] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:29:11,055] default_module.py->log_info line:141 [INFO]lr=1.3552e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:29:53,218] default_module.py->log_info line:141 [INFO]Train Epoch 76/100 step 0/87 train_loss 0.2219  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:31:27,945] default_module.py->log_info line:141 [INFO]Valid Epoch 76/100 step 100/37 valid_loss 1.1956  valid_acc_1 50.7937
[2021-03-01 19:31:31,262] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7980    0.9294    0.2105    0.8587    0.4423    0.2097       255
          2     0.4706    0.2105    0.9294    0.2909    0.4423    0.1816        76

avg / total     0.7228    0.7644    0.3756    0.7283    0.4423    0.2033       331

Covid class AUC=0.6804437564499485
ACC=0.7643504531722054
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.49077791781039 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.49077791781039 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00076: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00076: valid_acc_1  was not in top 1
Epoch 00077: early stopping
INFO:lightning:Epoch 00077: early stopping
[2021-03-01 19:31:31,478] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3611  train_acc_1 83.7803
[2021-03-01 19:31:31,478] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5667  valid_acc_1 76.4908
[2021-03-01 19:31:31,478] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:31:31,487] default_module.py->log_info line:141 [INFO]lr=1.2494e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:32:17,745] default_module.py->log_info line:141 [INFO]Train Epoch 77/100 step 0/87 train_loss 0.1554  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:33:47,518] default_module.py->log_info line:141 [INFO]Valid Epoch 77/100 step 100/37 valid_loss 1.2244  valid_acc_1 53.9683
[2021-03-01 19:33:50,376] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8061    0.9294    0.2500    0.8634    0.4820    0.2481       255
          2     0.5135    0.2500    0.9294    0.3363    0.4820    0.2166        76

avg / total     0.7389    0.7734    0.4060    0.7424    0.4820    0.2409       331

Covid class AUC=0.6903508771929824
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167875856967 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167875856967 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00077: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00077: valid_acc_1  was not in top 1
Epoch 00078: early stopping
INFO:lightning:Epoch 00078: early stopping
[2021-03-01 19:33:50,449] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3755  train_acc_1 84.5466
[2021-03-01 19:33:50,449] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5798  valid_acc_1 77.3917
[2021-03-01 19:33:50,449] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:33:50,458] default_module.py->log_info line:141 [INFO]lr=1.1474e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:34:33,099] default_module.py->log_info line:141 [INFO]Train Epoch 78/100 step 0/87 train_loss 0.3526  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:36:00,839] default_module.py->log_info line:141 [INFO]Valid Epoch 78/100 step 100/37 valid_loss 1.1762  valid_acc_1 50.0000
[2021-03-01 19:36:04,047] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7967    0.9373    0.1974    0.8613    0.4301    0.1987       255
          2     0.4839    0.1974    0.9373    0.2804    0.4301    0.1713        76

avg / total     0.7248    0.7674    0.3673    0.7279    0.4301    0.1924       331

Covid class AUC=0.684984520123839
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.79107838708 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.79107838708 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00078: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00078: valid_acc_1  was not in top 1
Epoch 00079: early stopping
INFO:lightning:Epoch 00079: early stopping
[2021-03-01 19:36:04,241] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3436  train_acc_1 86.0792
[2021-03-01 19:36:04,241] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5564  valid_acc_1 76.7911
[2021-03-01 19:36:04,241] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:36:04,248] default_module.py->log_info line:141 [INFO]lr=1.0492e-04
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:36:52,293] default_module.py->log_info line:141 [INFO]Train Epoch 79/100 step 0/87 train_loss 0.6678  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:38:24,389] default_module.py->log_info line:141 [INFO]Valid Epoch 79/100 step 100/37 valid_loss 1.1902  valid_acc_1 50.0000
[2021-03-01 19:38:27,786] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7959    0.9176    0.2105    0.8525    0.4395    0.2068       255
          2     0.4324    0.2105    0.9176    0.2832    0.4395    0.1795        76

avg / total     0.7125    0.7553    0.3729    0.7217    0.4395    0.2006       331

Covid class AUC=0.6698658410732715
ACC=0.7552870090634441
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.58987715437605 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.58987715437605 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00079: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00079: valid_acc_1  was not in top 1
Epoch 00080: early stopping
INFO:lightning:Epoch 00080: early stopping
[2021-03-01 19:38:28,062] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3494  train_acc_1 85.0830
[2021-03-01 19:38:28,062] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5767  valid_acc_1 75.5899
[2021-03-01 19:38:28,062] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:38:28,069] default_module.py->log_info line:141 [INFO]lr=9.5492e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:39:15,987] default_module.py->log_info line:141 [INFO]Train Epoch 80/100 step 0/87 train_loss 0.3139  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:40:41,375] default_module.py->log_info line:141 [INFO]Valid Epoch 80/100 step 100/37 valid_loss 1.2827  valid_acc_1 49.2064
[2021-03-01 19:40:45,074] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7980    0.9451    0.1974    0.8654    0.4319    0.2005       255
          2     0.5172    0.1974    0.9451    0.2857    0.4319    0.1726        76

avg / total     0.7335    0.7734    0.3691    0.7323    0.4319    0.1941       331

Covid class AUC=0.6849845201238389
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167875856967 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167875856967 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00080: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00080: valid_acc_1  was not in top 1
Epoch 00081: early stopping
INFO:lightning:Epoch 00081: early stopping
[2021-03-01 19:40:45,535] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3434  train_acc_1 86.2324
[2021-03-01 19:40:45,535] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5879  valid_acc_1 77.3917
[2021-03-01 19:40:45,535] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:40:45,547] default_module.py->log_info line:141 [INFO]lr=8.6460e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:41:31,975] default_module.py->log_info line:141 [INFO]Train Epoch 81/100 step 0/87 train_loss 0.3185  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:42:47,049] default_module.py->log_info line:141 [INFO]Valid Epoch 81/100 step 100/37 valid_loss 1.2333  valid_acc_1 50.7937
[2021-03-01 19:42:50,350] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8028    0.9098    0.2500    0.8529    0.4769    0.2425       255
          2     0.4524    0.2500    0.9098    0.3220    0.4769    0.2124        76

avg / total     0.7223    0.7583    0.4015    0.7310    0.4769    0.2356       331

Covid class AUC=0.6728586171310629
ACC=0.7583081570996979
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 75.89017752054575 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 75.89017752054575 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00081: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00081: valid_acc_1  was not in top 1
Epoch 00082: early stopping
INFO:lightning:Epoch 00082: early stopping
[2021-03-01 19:42:50,841] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3322  train_acc_1 86.0026
[2021-03-01 19:42:50,841] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5954  valid_acc_1 75.8902
[2021-03-01 19:42:50,841] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:42:50,867] default_module.py->log_info line:141 [INFO]lr=7.7836e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:43:40,829] default_module.py->log_info line:141 [INFO]Train Epoch 82/100 step 0/87 train_loss 0.3016  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:45:09,470] default_module.py->log_info line:141 [INFO]Valid Epoch 82/100 step 100/37 valid_loss 1.2954  valid_acc_1 50.7937
[2021-03-01 19:45:12,651] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8020    0.9373    0.2237    0.8644    0.4579    0.2246       255
          2     0.5152    0.2237    0.9373    0.3119    0.4579    0.1947        76

avg / total     0.7361    0.7734    0.3875    0.7375    0.4579    0.2177       331

Covid class AUC=0.6770897832817337
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.39167873279469 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.39167873279469 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00082: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00082: valid_acc_1  was not in top 1
Epoch 00083: early stopping
INFO:lightning:Epoch 00083: early stopping
[2021-03-01 19:45:12,831] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3331  train_acc_1 86.4879
[2021-03-01 19:45:12,831] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6020  valid_acc_1 77.3917
[2021-03-01 19:45:12,831] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:45:12,837] default_module.py->log_info line:141 [INFO]lr=6.9629e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:46:00,900] default_module.py->log_info line:141 [INFO]Train Epoch 83/100 step 0/87 train_loss 0.1856  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:47:15,369] default_module.py->log_info line:141 [INFO]Valid Epoch 83/100 step 100/37 valid_loss 1.2388  valid_acc_1 54.7619
[2021-03-01 19:47:18,734] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8116    0.9294    0.2763    0.8665    0.5068    0.2736       255
          2     0.5385    0.2763    0.9294    0.3652    0.5068    0.2400        76

avg / total     0.7489    0.7795    0.4263    0.7514    0.5068    0.2659       331

Covid class AUC=0.6845201238390092
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.99227980020883 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.99227980020883 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00083: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00083: valid_acc_1  was not in top 1
Epoch 00084: early stopping
INFO:lightning:Epoch 00084: early stopping
[2021-03-01 19:47:19,172] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3064  train_acc_1 87.4074
[2021-03-01 19:47:19,172] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.5901  valid_acc_1 77.9923
[2021-03-01 19:47:19,173] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:47:19,179] default_module.py->log_info line:141 [INFO]lr=6.1847e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:47:58,730] default_module.py->log_info line:141 [INFO]Train Epoch 84/100 step 0/87 train_loss 0.5267  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:49:25,094] default_module.py->log_info line:141 [INFO]Valid Epoch 84/100 step 100/37 valid_loss 1.3540  valid_acc_1 50.0000
[2021-03-01 19:49:28,429] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7967    0.9373    0.1974    0.8613    0.4301    0.1987       255
          2     0.4839    0.1974    0.9373    0.2804    0.4301    0.1713        76

avg / total     0.7248    0.7674    0.3673    0.7279    0.4301    0.1924       331

Covid class AUC=0.6746646026831785
ACC=0.7673716012084593
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.87687868685336 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.87687868685336 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00084: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00084: valid_acc_1  was not in top 1
Epoch 00085: early stopping
INFO:lightning:Epoch 00085: early stopping
[2021-03-01 19:49:28,617] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3456  train_acc_1 84.6999
[2021-03-01 19:49:28,618] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6198  valid_acc_1 76.8769
[2021-03-01 19:49:28,618] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:49:28,625] default_module.py->log_info line:141 [INFO]lr=5.4497e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:50:18,654] default_module.py->log_info line:141 [INFO]Train Epoch 85/100 step 0/87 train_loss 0.3930  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:51:48,054] default_module.py->log_info line:141 [INFO]Valid Epoch 85/100 step 100/37 valid_loss 1.3058  valid_acc_1 49.2064
[2021-03-01 19:51:51,284] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7925    0.9137    0.1974    0.8488    0.4247    0.1933       255
          2     0.4054    0.1974    0.9137    0.2655    0.4247    0.1674        76

avg / total     0.7036    0.7492    0.3618    0.7149    0.4247    0.1873       331

Covid class AUC=0.6715686274509802
ACC=0.7492447129909365
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 74.9892767828864 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 74.9892767828864 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00085: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00085: valid_acc_1  was not in top 1
Epoch 00086: early stopping
INFO:lightning:Epoch 00086: early stopping
[2021-03-01 19:51:51,525] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3147  train_acc_1 87.1264
[2021-03-01 19:51:51,525] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6124  valid_acc_1 74.9893
[2021-03-01 19:51:51,525] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:51:51,533] default_module.py->log_info line:141 [INFO]lr=4.7586e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:52:31,379] default_module.py->log_info line:141 [INFO]Train Epoch 86/100 step 0/87 train_loss 0.2465  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:53:52,788] default_module.py->log_info line:141 [INFO]Valid Epoch 86/100 step 100/37 valid_loss 1.3485  valid_acc_1 49.2064
[2021-03-01 19:53:55,956] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7954    0.9451    0.1842    0.8638    0.4172    0.1873       255
          2     0.5000    0.1842    0.9451    0.2692    0.4172    0.1609        76

avg / total     0.7276    0.7704    0.3589    0.7273    0.4172    0.1813       331

Covid class AUC=0.6729618163054696
ACC=0.770392749244713
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.17717894992313 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.17717894992313 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00086: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00086: valid_acc_1  was not in top 1
Epoch 00087: early stopping
INFO:lightning:Epoch 00087: early stopping
[2021-03-01 19:53:56,199] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3310  train_acc_1 86.1303
[2021-03-01 19:53:56,199] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6133  valid_acc_1 77.1772
[2021-03-01 19:53:56,199] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:53:56,205] default_module.py->log_info line:141 [INFO]lr=4.1123e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:54:43,155] default_module.py->log_info line:141 [INFO]Train Epoch 87/100 step 0/87 train_loss 0.1206  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:56:16,894] default_module.py->log_info line:141 [INFO]Valid Epoch 87/100 step 100/37 valid_loss 1.4052  valid_acc_1 50.7937
[2021-03-01 19:56:20,251] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8000    0.9569    0.1974    0.8714    0.4346    0.2032       255
          2     0.5769    0.1974    0.9569    0.2941    0.4346    0.1745        76

avg / total     0.7488    0.7825    0.3718    0.7389    0.4346    0.1966       331

Covid class AUC=0.6752837977296181
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.37837979600236 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.37837979600236 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00087: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00087: valid_acc_1  was not in top 1
Epoch 00088: early stopping
INFO:lightning:Epoch 00088: early stopping
[2021-03-01 19:56:20,554] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3120  train_acc_1 87.7650
[2021-03-01 19:56:20,554] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6244  valid_acc_1 78.3784
[2021-03-01 19:56:20,554] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:56:20,561] default_module.py->log_info line:141 [INFO]lr=3.5112e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:57:06,517] default_module.py->log_info line:141 [INFO]Train Epoch 88/100 step 0/87 train_loss 0.1844  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 19:58:30,145] default_module.py->log_info line:141 [INFO]Valid Epoch 88/100 step 100/37 valid_loss 1.3478  valid_acc_1 52.3810
[2021-03-01 19:58:33,295] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8074    0.9373    0.2500    0.8675    0.4841    0.2504       255
          2     0.5429    0.2500    0.9373    0.3423    0.4841    0.2182        76

avg / total     0.7467    0.7795    0.4078    0.7469    0.4841    0.2430       331

Covid class AUC=0.6786893704850361
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.07807979068241 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.07807979068241 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00088: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00088: valid_acc_1  was not in top 1
Epoch 00089: early stopping
INFO:lightning:Epoch 00089: early stopping
[2021-03-01 19:58:33,547] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2919  train_acc_1 88.1481
[2021-03-01 19:58:33,547] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6188  valid_acc_1 78.0781
[2021-03-01 19:58:33,547] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 19:58:33,554] default_module.py->log_info line:141 [INFO]lr=2.9560e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 19:59:19,186] default_module.py->log_info line:141 [INFO]Train Epoch 89/100 step 0/87 train_loss 0.2145  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:00:38,340] default_module.py->log_info line:141 [INFO]Valid Epoch 89/100 step 100/37 valid_loss 1.3935  valid_acc_1 50.7937
[2021-03-01 20:00:41,624] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8000    0.9412    0.2105    0.8649    0.4451    0.2126       255
          2     0.5161    0.2105    0.9412    0.2991    0.4451    0.1837        76

avg / total     0.7348    0.7734    0.3783    0.7350    0.4451    0.2060       331

Covid class AUC=0.685500515995872
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747916144294 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747916144294 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00089: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00089: valid_acc_1  was not in top 1
Epoch 00090: early stopping
INFO:lightning:Epoch 00090: early stopping
[2021-03-01 20:00:41,863] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3001  train_acc_1 86.9732
[2021-03-01 20:00:41,864] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6239  valid_acc_1 77.4775
[2021-03-01 20:00:41,864] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:00:41,871] default_module.py->log_info line:141 [INFO]lr=2.4472e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:01:28,790] default_module.py->log_info line:141 [INFO]Train Epoch 90/100 step 0/87 train_loss 0.2267  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:03:03,583] default_module.py->log_info line:141 [INFO]Valid Epoch 90/100 step 100/37 valid_loss 1.1964  valid_acc_1 54.7619
[2021-03-01 20:03:06,902] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8121    0.8980    0.3026    0.8529    0.5213    0.2880       255
          2     0.4694    0.3026    0.8980    0.3680    0.5213    0.2556        76

avg / total     0.7334    0.7613    0.4393    0.7416    0.5213    0.2805       331

Covid class AUC=0.6846233230134159
ACC=0.7613293051359517
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 76.1904775516407 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 76.1904775516407 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00090: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00090: valid_acc_1  was not in top 1
Epoch 00091: early stopping
INFO:lightning:Epoch 00091: early stopping
[2021-03-01 20:03:07,156] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2861  train_acc_1 89.2976
[2021-03-01 20:03:07,156] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6009  valid_acc_1 76.1905
[2021-03-01 20:03:07,157] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:03:07,164] default_module.py->log_info line:141 [INFO]lr=1.9853e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:03:53,480] default_module.py->log_info line:141 [INFO]Train Epoch 91/100 step 0/87 train_loss 0.4755  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:05:15,135] default_module.py->log_info line:141 [INFO]Valid Epoch 91/100 step 100/37 valid_loss 1.4580  valid_acc_1 50.0000
[2021-03-01 20:05:18,269] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8000    0.9569    0.1974    0.8714    0.4346    0.2032       255
          2     0.5769    0.1974    0.9569    0.2941    0.4346    0.1745        76

avg / total     0.7488    0.7825    0.3718    0.7389    0.4346    0.1966       331

Covid class AUC=0.6814241486068112
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.37837979600236 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.37837979600236 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00091: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00091: valid_acc_1  was not in top 1
Epoch 00092: early stopping
INFO:lightning:Epoch 00092: early stopping
[2021-03-01 20:05:18,450] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3174  train_acc_1 87.6373
[2021-03-01 20:05:18,451] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6410  valid_acc_1 78.3784
[2021-03-01 20:05:18,451] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:05:18,459] default_module.py->log_info line:141 [INFO]lr=1.5708e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:05:58,006] default_module.py->log_info line:141 [INFO]Train Epoch 92/100 step 0/87 train_loss 0.3166  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:07:25,673] default_module.py->log_info line:141 [INFO]Valid Epoch 92/100 step 100/37 valid_loss 1.4122  valid_acc_1 52.3810
[2021-03-01 20:07:28,910] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8060    0.9451    0.2368    0.8700    0.4731    0.2397       255
          2     0.5625    0.2368    0.9451    0.3333    0.4731    0.2080        76

avg / total     0.7501    0.7825    0.3995    0.7468    0.4731    0.2324       331

Covid class AUC=0.6835397316821465
ACC=0.7824773413897281
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.37838005375218 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.37838005375218 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00092: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00092: valid_acc_1  was not in top 1
Epoch 00093: early stopping
INFO:lightning:Epoch 00093: early stopping
[2021-03-01 20:07:29,104] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2949  train_acc_1 88.7867
[2021-03-01 20:07:29,104] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6350  valid_acc_1 78.3784
[2021-03-01 20:07:29,104] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:07:29,118] default_module.py->log_info line:141 [INFO]lr=1.2042e-05
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:08:18,235] default_module.py->log_info line:141 [INFO]Train Epoch 93/100 step 0/87 train_loss 0.3183  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:09:48,885] default_module.py->log_info line:141 [INFO]Valid Epoch 93/100 step 100/37 valid_loss 1.3651  valid_acc_1 52.3810
[2021-03-01 20:09:52,073] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8061    0.9294    0.2500    0.8634    0.4820    0.2481       255
          2     0.5135    0.2500    0.9294    0.3363    0.4820    0.2166        76

avg / total     0.7389    0.7734    0.4060    0.7424    0.4820    0.2409       331

Covid class AUC=0.6786377708978328
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747905834301 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747905834301 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00093: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00093: valid_acc_1  was not in top 1
Epoch 00094: early stopping
INFO:lightning:Epoch 00094: early stopping
[2021-03-01 20:09:52,343] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2909  train_acc_1 89.0421
[2021-03-01 20:09:52,343] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6267  valid_acc_1 77.4775
[2021-03-01 20:09:52,343] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:09:52,350] default_module.py->log_info line:141 [INFO]lr=8.8564e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:10:31,012] default_module.py->log_info line:141 [INFO]Train Epoch 94/100 step 0/87 train_loss 0.5960  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:11:50,854] default_module.py->log_info line:141 [INFO]Valid Epoch 94/100 step 100/37 valid_loss 1.3819  valid_acc_1 52.3810
[2021-03-01 20:11:54,244] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8067    0.9490    0.2368    0.8721    0.4741    0.2408       255
          2     0.5806    0.2368    0.9490    0.3364    0.4741    0.2088        76

avg / total     0.7548    0.7855    0.4004    0.7491    0.4741    0.2334       331

Covid class AUC=0.6770381836945304
ACC=0.7854984894259819
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.67868036837191 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.67868036837191 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00094: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00094: valid_acc_1  was not in top 1
Epoch 00095: early stopping
INFO:lightning:Epoch 00095: early stopping
[2021-03-01 20:11:54,491] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.3009  train_acc_1 88.6335
[2021-03-01 20:11:54,491] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6201  valid_acc_1 78.6787
[2021-03-01 20:11:54,492] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:11:54,499] default_module.py->log_info line:141 [INFO]lr=6.1558e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:12:38,998] default_module.py->log_info line:141 [INFO]Train Epoch 95/100 step 0/87 train_loss 0.5067  train_acc_1 66.6667
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:14:14,931] default_module.py->log_info line:141 [INFO]Valid Epoch 95/100 step 100/37 valid_loss 1.4169  valid_acc_1 50.0000
[2021-03-01 20:14:18,174] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8000    0.9412    0.2105    0.8649    0.4451    0.2126       255
          2     0.5161    0.2105    0.9412    0.2991    0.4451    0.1837        76

avg / total     0.7348    0.7734    0.3783    0.7350    0.4451    0.2060       331

Covid class AUC=0.6768317853457172
ACC=0.7734138972809668
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.47747895524309 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.47747895524309 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00095: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00095: valid_acc_1  was not in top 1
Epoch 00096: early stopping
INFO:lightning:Epoch 00096: early stopping
[2021-03-01 20:14:18,451] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2891  train_acc_1 89.1954
[2021-03-01 20:14:18,451] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6407  valid_acc_1 77.4775
[2021-03-01 20:14:18,451] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:14:18,457] default_module.py->log_info line:141 [INFO]lr=3.9426e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:15:02,472] default_module.py->log_info line:141 [INFO]Train Epoch 96/100 step 0/87 train_loss 0.2974  train_acc_1 77.7778
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:16:28,382] default_module.py->log_info line:141 [INFO]Valid Epoch 96/100 step 100/37 valid_loss 1.3657  valid_acc_1 52.3810
[2021-03-01 20:16:31,713] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8047    0.9373    0.2368    0.8659    0.4711    0.2375       255
          2     0.5294    0.2368    0.9373    0.3273    0.4711    0.2064        76

avg / total     0.7415    0.7764    0.3977    0.7423    0.4711    0.2304       331

Covid class AUC=0.678328173374613
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777960493758 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777960493758 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00096: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00096: valid_acc_1  was not in top 1
Epoch 00097: early stopping
INFO:lightning:Epoch 00097: early stopping
[2021-03-01 20:16:31,926] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2645  train_acc_1 89.9106
[2021-03-01 20:16:31,926] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6261  valid_acc_1 77.7778
[2021-03-01 20:16:31,927] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:16:31,933] default_module.py->log_info line:141 [INFO]lr=2.2190e-06
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:17:14,812] default_module.py->log_info line:141 [INFO]Train Epoch 97/100 step 0/87 train_loss 0.1414  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:18:38,773] default_module.py->log_info line:141 [INFO]Valid Epoch 97/100 step 100/37 valid_loss 1.4397  valid_acc_1 50.0000
[2021-03-01 20:18:42,065] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7993    0.9529    0.1974    0.8694    0.4337    0.2023       255
          2     0.5556    0.1974    0.9529    0.2913    0.4337    0.1739        76

avg / total     0.7434    0.7795    0.3709    0.7367    0.4337    0.1958       331

Covid class AUC=0.678328173374613
ACC=0.7794561933534743
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.07807961025753 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.07807961025753 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00097: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00097: valid_acc_1  was not in top 1
Epoch 00098: early stopping
INFO:lightning:Epoch 00098: early stopping
[2021-03-01 20:18:42,363] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2891  train_acc_1 88.5057
[2021-03-01 20:18:42,363] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6371  valid_acc_1 78.0781
[2021-03-01 20:18:42,363] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:18:42,371] default_module.py->log_info line:141 [INFO]lr=9.8664e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:19:12,042] default_module.py->log_info line:141 [INFO]Train Epoch 98/100 step 0/87 train_loss 0.2118  train_acc_1 88.8889
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:20:26,274] default_module.py->log_info line:141 [INFO]Valid Epoch 98/100 step 100/37 valid_loss 1.4600  valid_acc_1 50.0000
[2021-03-01 20:20:29,374] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.7987    0.9490    0.1974    0.8674    0.4328    0.2014       255
          2     0.5357    0.1974    0.9490    0.2885    0.4328    0.1732        76

avg / total     0.7383    0.7764    0.3700    0.7345    0.4328    0.1949       331

Covid class AUC=0.6784829721362228
ACC=0.7764350453172205
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 77.77777942451272 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 77.77777942451272 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00098: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00098: valid_acc_1  was not in top 1
Epoch 00099: early stopping
INFO:lightning:Epoch 00099: early stopping
[2021-03-01 20:20:29,537] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2791  train_acc_1 88.5568
[2021-03-01 20:20:29,538] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6457  valid_acc_1 77.7778
[2021-03-01 20:20:29,538] default_module.py->log_info line:141 [INFO]===========================

[2021-03-01 20:20:29,545] default_module.py->log_info line:141 [INFO]lr=2.4672e-07
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:64: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  acc_results = [torch.tensor(x).to(loss_val.device.index) for x in acc_results]
[2021-03-01 20:20:58,379] default_module.py->log_info line:141 [INFO]Train Epoch 99/100 step 0/87 train_loss 0.0924  train_acc_1 100.0000
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:117: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_loss': torch.tensor(loss_val),
/home/comp/shwang/git/HKBU_HPML_COVID-19/covid19_pipeline/engine/module.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  'valid_acc_1': torch.tensor(val_acc_1),
[2021-03-01 20:22:01,788] default_module.py->log_info line:141 [INFO]Valid Epoch 99/100 step 100/37 valid_loss 1.3398  valid_acc_1 52.3810
[2021-03-01 20:22:04,745] default_module.py->log_info line:141 [INFO]
                   pre       rec       spe        f1       geo       iba       sup

          1     0.8067    0.9490    0.2368    0.8721    0.4741    0.2408       255
          2     0.5806    0.2368    0.9490    0.3364    0.4741    0.2088        76

avg / total     0.7548    0.7855    0.4004    0.7491    0.4741    0.2334       331

Covid class AUC=0.6772445820433436
ACC=0.7854984894259819
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: The metric you returned 78.67868036837191 must be a Torch.Tensor instance, checkpoint not saved HINT: what is the value of valid_acc_1 in validation_end()?
  warnings.warn(*args, **kwargs)
/home/comp/shwang/py36/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:23: RuntimeWarning: 78.67868036837191 is supposed to be a torch.Tensor. Saving checkpoint may not work correctly. HINT: check the value of valid_acc_1 in your validation loop
  warnings.warn(*args, **kwargs)

Epoch 00099: valid_acc_1  was not in top 1
INFO:lightning:
Epoch 00099: valid_acc_1  was not in top 1
Epoch 00100: early stopping
INFO:lightning:Epoch 00100: early stopping
[2021-03-01 20:22:04,824] default_module.py->log_info line:141 [INFO]Final Train: train_loss 0.2821  train_acc_1 88.7612
[2021-03-01 20:22:04,824] default_module.py->log_info line:141 [INFO]FInal Valid: valid_loss 0.6132  valid_acc_1 78.6787
[2021-03-01 20:22:04,825] default_module.py->log_info line:141 [INFO]===========================

